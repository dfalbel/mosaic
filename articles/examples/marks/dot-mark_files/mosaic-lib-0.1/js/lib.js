var LibMosaic=(function(Nc){"use strict";const b3={};function Ky(e,t=!1){let n,r,i=b3;function s(u){n=e(u)?.catch(()=>{}).finally(()=>{if(r){const{event:l}=r;r=null,s(l)}else n=null})||null}function o(u){r={event:u}}function a(u){n?o(u):s(u)}function c(u){i!==u&&requestAnimationFrame(()=>{const l=i;i=b3,a(l)}),i=u}return t?c:a}function Rc(e){return e instanceof qo}class qo{_filterBy;_requestUpdate;_coordinator;_pending;_enabled;_initialized;_request;constructor(t){this._filterBy=t,this._requestUpdate=Ky(()=>this.requestQuery(),!0),this._coordinator=null,this._pending=Promise.resolve(),this._enabled=!0,this._initialized=!1,this._request=null}get coordinator(){return this._coordinator}set coordinator(t){this._coordinator=t}get enabled(){return this._enabled}set enabled(t){t=!!t,this._enabled!==t&&(this._enabled=t,t&&(this._initialized?this._request&&this.requestQuery(this._request===!0?void 0:this._request):this.initialize(),this._request=null))}get pending(){return this._pending}get filterBy(){return this._filterBy}get filterStable(){return!0}async prepare(){}query(t){return null}queryPending(){return this}queryResult(t){return this}queryError(t){return this}requestQuery(t){if(this._enabled){const n=t||this.query(this.filterBy?.predicate(this));return this._coordinator.requestQuery(this,n)}else return this._request=t??!0,null}requestUpdate(){this._enabled?this._requestUpdate():this.requestQuery()}initialize(){this._enabled?this._coordinator&&(this._initialized=!0,this._pending=this.prepare().then(()=>this.requestQuery())):this._initialized=!1}destroy(){this._enabled=!1,this.coordinator?.disconnect(this)}update(){return this}}const _3=Uint8Array.of(65,82,82,79,87,49),hf={V1:0,V4:3,V5:4},ts={NONE:0,Schema:1,DictionaryBatch:2,RecordBatch:3,Tensor:4,SparseTensor:5},j={Dictionary:-1,NONE:0,Null:1,Int:2,Float:3,Binary:4,Utf8:5,Bool:6,Decimal:7,Date:8,Time:9,Timestamp:10,Interval:11,List:12,Struct:13,Union:14,FixedSizeBinary:15,FixedSizeList:16,Map:17,Duration:18,LargeBinary:19,LargeUtf8:20,LargeList:21,RunEndEncoded:22,BinaryView:23,Utf8View:24,ListView:25,LargeListView:26},w3={HALF:0,SINGLE:1,DOUBLE:2},df={DAY:0,MILLISECOND:1},kn={SECOND:0,MILLISECOND:1,MICROSECOND:2,NANOSECOND:3},jo={YEAR_MONTH:0,DAY_TIME:1,MONTH_DAY_NANO:2},Zy={Sparse:0,Dense:1},Mk=Uint8Array,v3=Uint16Array,Tk=Uint32Array,x3=BigUint64Array,S3=Int8Array,$k=Int16Array,ir=Int32Array,Mr=BigInt64Array,Nk=Float32Array,pf=Float64Array;function Rk(e){return e instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&e instanceof SharedArrayBuffer}function Ok(e,t){const n=Math.log2(e)-3;return(t?[S3,$k,ir,Mr]:[Mk,v3,Tk,x3])[n]}function t0(e,t){let n=0,r=e.length;if(r<=2147483648)do{const i=n+r>>>1;e[i]<=t?n=i+1:r=i}while(n<r);else do{const i=Math.trunc((n+r)/2);e[i]<=t?n=i+1:r=i}while(n<r);return n}function e0(e,t,n){if(t(e))return e;throw new Error(n(e))}function sr(e,t,n){return t=Array.isArray(t)?t:Object.values(t),e0(e,r=>t.includes(r),n??(()=>`${e} must be one of ${t}`))}function A3(e,t){for(const[n,r]of Object.entries(e))if(r===t)return n;return"<Unknown>"}const n0=e=>`Unsupported data type: "${A3(j,e)}" (id ${e})`,I3=(e,t,n=!0,r=null)=>({name:e,type:t,nullable:n,metadata:r});function E3(e){return Object.hasOwn(e,"name")&&M3(e.type)}function M3(e){return typeof e?.typeId=="number"}function es(e,t="",n=!0){return E3(e)?e:I3(t,e0(e,M3,()=>"Data type expected."),n)}const Dk=(e,t,n=!1,r=-1)=>({typeId:j.Dictionary,id:r,dictionary:e,indices:t||$3(),ordered:n}),T3=(e=32,t=!0)=>({typeId:j.Int,bitWidth:sr(e,[8,16,32,64]),signed:t,values:Ok(e,t)}),$3=()=>T3(32),Lk=(e=2)=>({typeId:j.Float,precision:sr(e,w3),values:[v3,Nk,pf][e]}),Fk=()=>({typeId:j.Binary,offsets:ir}),Ck=()=>({typeId:j.Utf8,offsets:ir}),kk=(e,t,n=128)=>({typeId:j.Decimal,precision:e,scale:t,bitWidth:sr(n,[32,64,128,256]),values:n===32?ir:x3}),Bk=e=>({typeId:j.Date,unit:sr(e,df),values:e===df.DAY?ir:Mr}),Pk=(e=kn.MILLISECOND,t=32)=>({typeId:j.Time,unit:sr(e,kn),bitWidth:sr(t,[32,64]),values:t===32?ir:Mr}),Uk=(e=kn.MILLISECOND,t=null)=>({typeId:j.Timestamp,unit:sr(e,kn),timezone:t,values:Mr}),zk=(e=jo.MONTH_DAY_NANO)=>({typeId:j.Interval,unit:sr(e,jo),values:e===jo.MONTH_DAY_NANO?void 0:ir}),qk=e=>({typeId:j.List,children:[es(e)],offsets:ir}),jk=e=>({typeId:j.Struct,children:Array.isArray(e)&&E3(e[0])?e:Object.entries(e).map(([t,n])=>I3(t,n))}),Yk=(e,t,n,r)=>(n??=t.map((i,s)=>s),{typeId:j.Union,mode:sr(e,Zy),typeIds:n,typeMap:n.reduce((i,s,o)=>(i[s]=o,i),{}),children:t.map((i,s)=>es(i,`_${s}`)),typeIdForValue:r,offsets:ir}),Vk=e=>({typeId:j.FixedSizeBinary,stride:e}),Wk=(e,t)=>({typeId:j.FixedSizeList,stride:t,children:[es(e)]}),Gk=(e,t)=>({typeId:j.Map,keysSorted:e,children:[t],offsets:ir}),Xk=(e=kn.MILLISECOND)=>({typeId:j.Duration,unit:sr(e,kn),values:Mr}),Hk=()=>({typeId:j.LargeBinary,offsets:Mr}),Qk=()=>({typeId:j.LargeUtf8,offsets:Mr}),Jk=e=>({typeId:j.LargeList,children:[es(e)],offsets:Mr}),Kk=(e,t)=>({typeId:j.RunEndEncoded,children:[e0(es(e,"run_ends"),n=>n.type.typeId===j.Int,()=>"Run-ends must have an integer type."),es(t,"values")]}),Zk=e=>({typeId:j.ListView,children:[es(e,"value")],offsets:ir}),tB=e=>({typeId:j.LargeListView,children:[es(e,"value")],offsets:Mr}),eB=new pf(2).buffer;new Mr(eB);function ns(e){if(e>Number.MAX_SAFE_INTEGER||e<Number.MIN_SAFE_INTEGER)throw Error(`BigInt exceeds integer number representation: ${e}`);return Number(e)}function r0(e,t){return Number(e/t)+Number(e%t)/Number(t)}const Yo=e=>BigInt.asUintN(64,e);function nB(e,t){return BigInt.asIntN(64,e[t])}function rB(e,t){const n=t<<1;let r;return BigInt.asIntN(64,e[n+1])<0?(r=Yo(~e[n])|Yo(~e[n+1])<<64n,r=-(r+1n)):r=e[n]|e[n+1]<<64n,r}function iB(e,t){const n=t<<2;let r;return BigInt.asIntN(64,e[n+3])<0?(r=Yo(~e[n])|Yo(~e[n+1])<<64n|Yo(~e[n+2])<<128n|Yo(~e[n+3])<<192n,r=-(r+1n)):r=e[n]|e[n+1]<<64n|e[n+2]<<128n|e[n+3]<<192n,r}const sB=new TextDecoder("utf-8");new TextEncoder;function yf(e){return sB.decode(e)}const Oc=4;function N3(e,t){return(e[t>>3]&1<<t%8)!==0}function li(e,t){const n=t+ue(e,t),r=n-ue(e,n),i=Bn(e,r);return(s,o,a=null)=>{if(s<i){const c=Bn(e,r+s);if(c)return o(e,n+c)}return a}}function Js(e,t){return t}function Dc(e,t){return!!oB(e,t)}function oB(e,t){return i0(e,t)<<24>>24}function i0(e,t){return e[t]}function Bn(e,t){return aB(e,t)<<16>>16}function aB(e,t){return e[t]|e[t+1]<<8}function ue(e,t){return e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24}function R3(e,t){return ue(e,t)>>>0}function Pn(e,t){return ns(BigInt.asIntN(64,BigInt(R3(e,t))+(BigInt(R3(e,t+Oc))<<32n)))}function mf(e,t){let n=t+ue(e,t);const r=ue(e,n);return n+=Oc,yf(e.subarray(n,n+r))}function rs(e,t,n,r){if(!t)return[];const i=t+ue(e,t);return Array.from({length:ue(e,i)},(s,o)=>r(e,i+Oc+o*n))}const s0=Symbol("rowIndex");function o0(e,t){class n{constructor(s){this[s0]=s}toJSON(){return D3(e,t,this[s0])}}const r=n.prototype;for(let i=0;i<e.length;++i){if(Object.hasOwn(r,e[i]))continue;const s=t[i];Object.defineProperty(r,e[i],{get(){return s.at(this[s0])},enumerable:!0})}return i=>new n(i)}function O3(e,t){return n=>D3(e,t,n)}function D3(e,t,n){const r={};for(let i=0;i<e.length;++i)r[e[i]]=t[i].at(n);return r}function cB(e){return e instanceof Lc}class gf{static ArrayType=null;constructor({length:t,nullCount:n,type:r,validity:i,values:s,offsets:o,sizes:a,children:c}){this.length=t,this.nullCount=n,this.type=r,this.validity=i,this.values=s,this.offsets=o,this.sizes=a,this.children=c,(!n||!this.validity)&&(this.at=u=>this.value(u))}get[Symbol.toStringTag](){return"Batch"}at(t){return this.isValid(t)?this.value(t):null}isValid(t){return N3(this.validity,t)}value(t){return this.values[t]}slice(t,n){const r=n-t,i=Array(r);for(let s=0;s<r;++s)i[s]=this.at(t+s);return i}*[Symbol.iterator](){for(let t=0;t<this.length;++t)yield this.at(t)}}class Lc extends gf{constructor(t){super(t);const{length:n,values:r}=this;this.values=r.subarray(0,n)}slice(t,n){return this.nullCount?super.slice(t,n):this.values.subarray(t,n)}[Symbol.iterator](){return this.nullCount?super[Symbol.iterator]():this.values[Symbol.iterator]()}}class bf extends gf{static ArrayType=pf}class ve extends gf{static ArrayType=Array}class uB extends ve{value(t){return null}}class Vo extends bf{value(t){return ns(this.values[t])}}class lB extends bf{value(t){const n=this.values[t],r=(n&31744)>>10,i=(n&1023)/1024,s=(-1)**((n&32768)>>15);switch(r){case 31:return s*(i?Number.NaN:1/0);case 0:return s*(i?6103515625e-14*i:0)}return s*2**(r-15)*(1+i)}}class fB extends ve{value(t){return N3(this.values,t)}}class hB extends bf{constructor(t){super(t);const{scale:n}=this.type;this.scale=10**n}value(t){return this.values[t]/this.scale}}class L3 extends gf{constructor(t){super(t);const{bitWidth:n,scale:r}=this.type;this.decimal=n===64?nB:n===128?rB:iB,this.scale=10n**BigInt(r)}}class dB extends L3{static ArrayType=pf;value(t){return r0(this.decimal(this.values,t),this.scale)}}class pB extends L3{static ArrayType=Array;value(t){return this.decimal(this.values,t)}}class F3 extends ve{constructor(t){super(t),this.source=t}value(t){return new Date(this.source.value(t))}}class yB extends bf{value(t){return 864e5*this.values[t]}}const mB=Vo;class gB extends Vo{value(t){return super.value(t)*1e3}}const bB=Vo;class _B extends Vo{value(t){return r0(this.values[t],1000n)}}class wB extends Vo{value(t){return r0(this.values[t],1000000n)}}class vB extends ve{value(t){return this.values.subarray(t<<1,t+1<<1)}}class xB extends ve{value(t){const n=this.values,r=t<<4;return Float64Array.of(ue(n,r),ue(n,r+4),Pn(n,r+8))}}const C3=({values:e,offsets:t},n)=>e.subarray(t[n],t[n+1]),k3=({values:e,offsets:t},n)=>e.subarray(ns(t[n]),ns(t[n+1]));class SB extends ve{value(t){return C3(this,t)}}class AB extends ve{value(t){return k3(this,t)}}class IB extends ve{value(t){return yf(C3(this,t))}}class EB extends ve{value(t){return yf(k3(this,t))}}class MB extends ve{value(t){const n=this.offsets;return this.children[0].slice(n[t],n[t+1])}}class TB extends ve{value(t){const n=this.offsets;return this.children[0].slice(ns(n[t]),ns(n[t+1]))}}class $B extends ve{value(t){const n=this.offsets[t],r=n+this.sizes[t];return this.children[0].slice(n,r)}}class NB extends ve{value(t){const n=this.offsets[t],r=n+this.sizes[t];return this.children[0].slice(ns(n),ns(r))}}class B3 extends ve{constructor(t){super(t),this.stride=this.type.stride}}class RB extends B3{value(t){const{stride:n,values:r}=this;return r.subarray(t*n,(t+1)*n)}}class OB extends B3{value(t){const{children:n,stride:r}=this;return n[0].slice(t*r,(t+1)*r)}}function P3({children:e,offsets:t},n){const[r,i]=e[0].children,s=t[n],o=t[n+1],a=[];for(let c=s;c<o;++c)a.push([r.at(c),i.at(c)]);return a}class DB extends ve{value(t){return P3(this,t)}}class LB extends ve{value(t){return new Map(P3(this,t))}}class U3 extends ve{constructor({typeIds:t,...n}){super(n),this.typeIds=t,this.typeMap=this.type.typeMap}value(t,n=t){const{typeIds:r,children:i,typeMap:s}=this;return i[s[r[t]]].at(n)}}class FB extends U3{value(t){return super.value(t,this.offsets[t])}}class z3 extends ve{constructor(t,n=O3){super(t),this.names=this.type.children.map(r=>r.name),this.factory=n(this.names,this.children)}value(t){return this.factory(t)}}class CB extends z3{constructor(t){super(t,o0)}}class kB extends ve{value(t){const[{values:n},r]=this.children;return r.at(t0(n,t))}}let BB=class extends ve{setDictionary(t){return this.dictionary=t,this.cache=t.cache(),this}value(t){return this.cache[this.key(t)]}key(t){return this.values[t]}};class q3 extends ve{constructor({data:t,...n}){super(n),this.data=t}view(t){const{values:n,data:r}=this,i=t<<4;let s=i+4,o=n;const a=ue(o,i);return a>12&&(s=ue(o,i+12),o=r[ue(o,i+8)]),o.subarray(s,s+a)}}class PB extends q3{value(t){return this.view(t)}}class UB extends q3{value(t){return yf(this.view(t))}}function j3(e){let t=[];return{add(n){return t.push(n),this},clear:()=>t=[],done:()=>new zB(t,e)}}class zB{constructor(t,n=t[0]?.type){this.type=n,this.length=t.reduce((s,o)=>s+o.length,0),this.nullCount=t.reduce((s,o)=>s+o.nullCount,0),this.data=t;const r=t.length,i=new Int32Array(r+1);if(r===1){const[s]=t;i[1]=s.length,this.at=o=>s.at(o)}else for(let s=0,o=0;s<r;++s)i[s+1]=o+=t[s].length;this.offsets=i}get[Symbol.toStringTag](){return"Column"}[Symbol.iterator](){const t=this.data;return t.length===1?t[0][Symbol.iterator]():qB(t)}at(t){const{data:n,offsets:r}=this,i=t0(r,t)-1;return n[i]?.at(t-r[i])}get(t){return this.at(t)}toArray(){const{length:t,nullCount:n,data:r}=this,i=!n&&cB(r[0]),s=r.length;if(i&&s===1)return r[0].values;const o=!s||n>0?Array:r[0].constructor.ArrayType??r[0].values.constructor,a=new o(t);return i?jB(a,r):YB(a,r)}cache(){return this._cache??(this._cache=this.toArray())}}function*qB(e){for(let t=0;t<e.length;++t){const n=e[t][Symbol.iterator]();for(let r=n.next();!r.done;r=n.next())yield r.value}}function jB(e,t){for(let n=0,r=0;n<t.length;++n){const{values:i}=t[n];e.set(i,r),r+=i.length}return e}function YB(e,t){let n=-1;for(let r=0;r<t.length;++r){const i=t[r];for(let s=0;s<i.length;++s)e[++n]=i.at(s)}return e}let VB=class Sk{constructor(t,n,r=!1){const i=t.fields.map(o=>o.name);this.schema=t,this.names=i,this.children=n,this.factory=r?o0:O3;const s=[];this.getFactory=o=>s[o]??(s[o]=this.factory(i,n.map(a=>a.data[o])))}get[Symbol.toStringTag](){return"Table"}get numCols(){return this.names.length}get numRows(){return this.children[0]?.length??0}getChildAt(t){return this.children[t]}getChild(t){const n=this.names.findIndex(r=>r===t);return n>-1?this.children[n]:void 0}selectAt(t,n=[]){const{children:r,factory:i,schema:s}=this,{fields:o}=s;return new Sk({...s,fields:t.map((a,c)=>WB(o[a],n[c]))},t.map(a=>r[a]),i===o0)}select(t,n){const r=this.names,i=t.map(s=>r.indexOf(s));return this.selectAt(i,n)}toColumns(){const{children:t,names:n}=this,r={};return n.forEach((i,s)=>r[i]=t[s]?.toArray()??[]),r}toArray(){const{children:t,getFactory:n,numRows:r}=this,i=t[0]?.data??[],s=Array(r);for(let o=0,a=-1;o<i.length;++o){const c=n(o);for(let u=0;u<i[o].length;++u)s[++a]=c(u)}return s}*[Symbol.iterator](){const{children:t,getFactory:n}=this,r=t[0]?.data??[];for(let i=0;i<r.length;++i){const s=n(i);for(let o=0;o<r[i].length;++o)yield s(o)}}at(t){const{children:n,getFactory:r,numRows:i}=this;if(t<0||t>=i)return null;const[{offsets:s}]=n,o=t0(s,t)-1;return r(o)(t-s[o])}get(t){return this.at(t)}};function WB(e,t){return t!=null&&t!==e.name?{...e,name:t}:e}function GB(e,t={}){const{typeId:n,bitWidth:r,mode:i,precision:s,unit:o}=e,{useBigInt:a,useDate:c,useDecimalInt:u,useMap:l,useProxy:h}=t;switch(n){case j.Null:return uB;case j.Bool:return fB;case j.Int:case j.Time:case j.Duration:return a||r<64?Lc:Vo;case j.Float:return s?Lc:lB;case j.Date:return Y3(o===df.DAY?yB:mB,c&&F3);case j.Timestamp:return Y3(o===kn.SECOND?gB:o===kn.MILLISECOND?bB:o===kn.MICROSECOND?_B:wB,c&&F3);case j.Decimal:return r===32?u?Lc:hB:u?pB:dB;case j.Interval:return o===jo.DAY_TIME?vB:o===jo.YEAR_MONTH?Lc:xB;case j.FixedSizeBinary:return RB;case j.Utf8:return IB;case j.LargeUtf8:return EB;case j.Binary:return SB;case j.LargeBinary:return AB;case j.BinaryView:return PB;case j.Utf8View:return UB;case j.List:return MB;case j.LargeList:return TB;case j.Map:return l?LB:DB;case j.ListView:return $B;case j.LargeListView:return NB;case j.FixedSizeList:return OB;case j.Struct:return h?CB:z3;case j.RunEndEncoded:return kB;case j.Dictionary:return BB;case j.Union:return i?FB:U3}throw new Error(n0(n))}function Y3(e,t){return t?class extends t{constructor(r){super(new e(r))}}:e}function XB(e,t){return{offset:Pn(e,t),metadataLength:ue(e,t+8),bodyLength:Pn(e,t+16)}}function V3(e,t){return rs(e,t,24,XB)}function W3(e,t,n){const r=li(e,t);if(r(10,Js,0))throw new Error("Record batch compression not implemented");const i=n<hf.V4?8:0;return{length:r(4,Pn,0),nodes:rs(e,r(6,Js),16,(s,o)=>({length:Pn(s,o),nullCount:Pn(s,o+8)})),regions:rs(e,r(8,Js),16+i,(s,o)=>({offset:Pn(s,o+i),length:Pn(s,o+i+8)})),variadic:rs(e,r(12,Js),8,Pn)}}function HB(e,t,n){const r=li(e,t);return{id:r(4,Pn,0),data:r(6,(i,s)=>W3(i,s,n)),isDelta:r(8,Dc,!1)}}function G3(e,t,n,r){sr(n,j,n0);const i=li(e,t);switch(n){case j.Binary:return Fk();case j.Utf8:return Ck();case j.LargeBinary:return Hk();case j.LargeUtf8:return Qk();case j.List:return qk(r[0]);case j.ListView:return Zk(r[0]);case j.LargeList:return Jk(r[0]);case j.LargeListView:return tB(r[0]);case j.Struct:return jk(r);case j.RunEndEncoded:return Kk(r[0],r[1]);case j.Int:return T3(i(4,ue,0),i(6,Dc,!1));case j.Float:return Lk(i(4,Bn,w3.HALF));case j.Decimal:return kk(i(4,ue,0),i(6,ue,0),i(8,ue,128));case j.Date:return Bk(i(4,Bn,df.MILLISECOND));case j.Time:return Pk(i(4,Bn,kn.MILLISECOND),i(6,ue,32));case j.Timestamp:return Uk(i(4,Bn,kn.SECOND),i(6,mf));case j.Interval:return zk(i(4,Bn,jo.YEAR_MONTH));case j.Duration:return Xk(i(4,Bn,kn.MILLISECOND));case j.FixedSizeBinary:return Vk(i(4,ue,0));case j.FixedSizeList:return Wk(r[0],i(4,ue,0));case j.Map:return Gk(i(4,Dc,!1),r[0]);case j.Union:return Yk(i(4,Bn,Zy.Sparse),r,rs(e,i(6,Js),4,ue))}return{typeId:n}}function a0(e,t){const n=rs(e,t,4,(r,i)=>{const s=li(r,i);return[s(4,mf),s(6,mf)]});return n.length?new Map(n):null}function X3(e,t,n){const r=li(e,t);return{version:n,endianness:r(4,Bn,0),fields:r(6,QB,[]),metadata:r(8,a0)}}function QB(e,t){return rs(e,t,4,H3)}function H3(e,t){const n=li(e,t),r=n(8,i0,j.NONE),i=n(10,Js,0),s=n(12,KB),o=n(14,(c,u)=>JB(c,u));let a=G3(e,i,r,o);return s&&(s.dictionary=a,a=s),{name:n(4,mf),type:a,nullable:n(6,Dc,!1),metadata:n(16,a0)}}function JB(e,t){const n=rs(e,t,4,H3);return n.length?n:null}function KB(e,t){if(!t)return null;const n=li(e,t);return Dk(null,n(6,ZB,$3()),n(8,Dc,!1),n(4,Pn,0))}function ZB(e,t){return G3(e,t,j.Int)}const t9=(e,t)=>`Expected to read ${e} metadata bytes, but only read ${t}.`,e9=(e,t)=>`Expected to read ${e} bytes for message body, but only read ${t}.`,n9=e=>`Unsupported message type: ${e} (${A3(ts,e)})`;function c0(e,t){let n=ue(e,t)||0;if(t+=Oc,n===-1&&(n=ue(e,t)||0,t+=Oc),n===0)return null;const r=e.subarray(t,t+=n);if(r.byteLength<n)throw new Error(t9(n,r.byteLength));const i=li(r,0),s=i(4,Bn,hf.V1),o=i(6,i0,ts.NONE),a=i(8,Js,0),c=i(10,Pn,0);let u;if(a){const l=o===ts.Schema?X3:o===ts.DictionaryBatch?HB:o===ts.RecordBatch?W3:null;if(!l)throw new Error(n9(o));if(u=l(r,a,s),c>0){const h=e.subarray(t,t+=c);if(h.byteLength<c)throw new Error(e9(c,h.byteLength));u.body=h}}return{version:s,type:o,index:t,content:u}}function r9(e){const t=Rk(e)?new Uint8Array(e):e;return t instanceof Uint8Array&&i9(t)?o9(t):s9(t)}function i9(e){if(!e||e.length<4)return!1;for(let t=0;t<6;++t)if(_3[t]!==e[t])return!1;return!0}function s9(e){const t=[e].flat();let n;const r=[],i=[];for(const s of t){if(!(s instanceof Uint8Array))throw new Error("IPC data batch was not a Uint8Array.");let o=0;for(;;){const a=c0(s,o);if(a===null)break;if(o=a.index,!!a.content)switch(a.type){case ts.Schema:n||(n=a.content);break;case ts.RecordBatch:r.push(a.content);break;case ts.DictionaryBatch:i.push(a.content);break}}}return{schema:n,dictionaries:i,records:r,metadata:null}}function o9(e){const t=e.byteLength-(_3.length+4),n=ue(e,t),r=li(e,t-n),i=r(4,Bn,hf.V1),s=r(8,V3,[]),o=r(10,V3,[]);return{schema:r(6,(a,c)=>X3(a,c,i)),dictionaries:s.map(({offset:a})=>c0(e,a).content),records:o.map(({offset:a})=>c0(e,a).content),metadata:r(12,a0)}}function a9(e,t){return c9(r9(e),t)}function c9(e,t={}){const{schema:n={fields:[]},dictionaries:r,records:i}=e,{version:s,fields:o}=n,a=new Map,c=l9(t,s,a),u=new Map;u9(n,f=>{const d=f.type;d.typeId===j.Dictionary&&u.set(d.id,d.dictionary)});const l=new Map;for(const f of r){const{id:d,data:p,isDelta:y,body:g}=f,m=u.get(d),b=u0(m,c({...p,body:g}));if(l.has(d)){const w=l.get(d);y||w.clear(),w.add(b)}else{if(y)throw new Error("Delta update can not be first dictionary batch.");l.set(d,j3(m).add(b))}}l.forEach((f,d)=>a.set(d,f.done()));const h=o.map(f=>j3(f.type));for(const f of i){const d=c(f);o.forEach((p,y)=>h[y].add(u0(p.type,d)))}return new VB(n,h.map(f=>f.done()),t.useProxy)}function u9(e,t){e.fields.forEach(function n(r){t(r),r.type.dictionary?.children?.forEach(n),r.type.children?.forEach(n)})}function l9(e,t,n){const r={version:t,options:e,dictionary:i=>n.get(i)};return i=>{const{length:s,nodes:o,regions:a,variadic:c,body:u}=i;let l=-1,h=-1,f=-1;return{...r,length:s,node:()=>o[++l],buffer:d=>{const{length:p,offset:y}=a[++h];return d?new d(u.buffer,u.byteOffset+y,p/d.BYTES_PER_ELEMENT):u.subarray(y,y+p)},variadic:()=>c[++f],visit(d){return d.map(p=>u0(p.type,this))}}}}function u0(e,t){const{typeId:n}=e,{length:r,options:i,node:s,buffer:o,variadic:a,version:c}=t,u=GB(e,i);if(n===j.Null)return new u({length:r,nullCount:r,type:e});const l={...s(),type:e};switch(n){case j.Bool:case j.Int:case j.Time:case j.Duration:case j.Float:case j.Decimal:case j.Date:case j.Timestamp:case j.Interval:case j.FixedSizeBinary:return new u({...l,validity:o(),values:o(e.values)});case j.Utf8:case j.LargeUtf8:case j.Binary:case j.LargeBinary:return new u({...l,validity:o(),offsets:o(e.offsets),values:o()});case j.BinaryView:case j.Utf8View:return new u({...l,validity:o(),values:o(),data:Array.from({length:a()},()=>o())});case j.List:case j.LargeList:case j.Map:return new u({...l,validity:o(),offsets:o(e.offsets),children:t.visit(e.children)});case j.ListView:case j.LargeListView:return new u({...l,validity:o(),offsets:o(e.offsets),sizes:o(e.offsets),children:t.visit(e.children)});case j.FixedSizeList:case j.Struct:return new u({...l,validity:o(),children:t.visit(e.children)});case j.RunEndEncoded:return new u({...l,children:t.visit(e.children)});case j.Dictionary:{const{id:h,indices:f}=e;return new u({...l,validity:o(),values:o(f.values)}).setDictionary(t.dictionary(h))}case j.Union:return c<hf.V5&&o(),new u({...l,typeIds:o(S3),offsets:e.mode===Zy.Sparse?null:o(e.offsets),children:t.visit(e.children)});default:throw new Error(n0(n))}}new Uint16Array(new Uint8Array([1,0]).buffer)[0];function Fc(e,t={useDate:!0}){return a9(e,t)}function Q3(e){return new _f(e)}class _f{_uri;_queue;_connected;_request;_ws;_events;constructor({uri:t="ws://localhost:3000/",ipc:n=void 0}={}){this._uri=t,this._queue=[],this._connected=!1,this._request=null,this._ws=null;const r=this;this._events={open(){r._connected=!0,r.next()},close(){for(r._connected=!1,r._request=null,r._ws=null;r._queue.length;)r._queue.shift().reject("Socket closed")},error(i){if(r._request){const{reject:s}=r._request;r._request=null,r.next(),s(i)}else console.error("WebSocket error: ",i)},message(i){const{data:s}=i;if(r._request){const{query:o,resolve:a,reject:c}=r._request;if(r._request=null,r.next(),typeof s=="string"){const u=JSON.parse(s);u.error?c(u.error):a(u)}else if(o.type==="exec")a();else if(o.type==="arrow")a(Fc(s,n));else throw new Error(`Unexpected socket data: ${s}`)}else console.log("WebSocket message: ",s)}}}get connected(){return this._connected}init(){this._ws=new WebSocket(this._uri),this._ws.binaryType="arraybuffer";for(const t in this._events)this._ws.addEventListener(t,this._events[t])}enqueue(t,n,r){this._ws==null&&this.init(),this._queue.push({query:t,resolve:n,reject:r}),this._connected&&!this._request&&this.next()}next(){this._queue.length&&(this._request=this._queue.shift(),this._ws.send(JSON.stringify(this._request.query)))}query(t){return new Promise((n,r)=>this.enqueue(t,n,r))}}const l0="COLUMN_REF",f0="COLUMN_PARAM",f9="TABLE_REF",h9="LITERAL",d9="INTERVAL",p9="LIST",J3="UNNEST",K3="ORDER_BY",Z3="CAST",tI="CASE",eI="WHEN",y9="COLLATE",nI="UNARY",rI="UNARY_POSTFIX",iI="BINARY",sI="BETWEEN",oI="NOT_BETWEEN",aI="LOGICAL_OPERATOR",cI="IN",uI="FUNCTION",wf="AGGREGATE",h0="WINDOW",lI="WINDOW_FUNCTION",fI="WINDOW_DEF",hI="WINDOW_FRAME",dI="WINDOW_EXTENT_EXPR",m9="EXPRESSION",d0="FRAGMENT",pI="VERBATIM",p0="PARAM",yI="WITH_CLAUSE",mI="WINDOW_CLAUSE",gI="SELECT_CLAUSE",bI="FROM_CLAUSE",g9="SAMPLE_CLAUSE",_I="SELECT_QUERY",wI="DESCRIBE_QUERY",vI="SET_OPERATION",b9="SCALAR_SUBQUERY";function Tr(e){return e instanceof Un}class Un{type;constructor(t){this.type=t}clone(){const t=new this.constructor;for(const n in this)t[n]=this[n];return t}}class le extends Un{}let y0=class extends le{value;constructor(t){super(h9),this.value=t}toString(){return xI(this.value)}};function xI(e){switch(typeof e){case"number":return Number.isFinite(e)?`${e}`:"NULL";case"string":return`'${e.replaceAll("'","''")}'`;case"boolean":return e?"TRUE":"FALSE";default:if(e==null)return"NULL";if(e instanceof Date){const t=+e;if(Number.isNaN(t))return"NULL";const n=e.getUTCFullYear(),r=e.getUTCMonth(),i=e.getUTCDate();return t===Date.UTC(n,r,i)?`DATE '${n}-${r+1}-${i}'`:`epoch_ms(${t})`}else return e instanceof RegExp?`'${e.source}'`:`${e}`}}let vf=class extends le{param;constructor(t){super(p0),this.param=t}get value(){return this.param.value}toString(){return xI(this.value)}};class _9 extends le{name;args;constructor(t,n=[]){super(uI),this.name=t,this.args=n}toString(){const{name:t,args:n}=this;return`${t}(${n.join(", ")})`}}function Xt(e,...t){return new _9(e,kc(t).map(Nt))}function Dt(e,...t){return new Uc(e,kc(t).map(Nt))}function or(e,...t){return new Ks(new x9(e,kc(t).map(Nt)))}function Cc(e,t){return e.flat().filter(n=>n!=null).map(n=>t(n))}function is(e){return Cc(e,Nt)}function kc(e){const t=e.length;let n=t;for(;n>0&&e[n-1]===void 0;--n);return n<t?e.slice(0,n):e}function SI(e){return e.split(".")}function Wo(e){return`"${e}"`}function m0(e){return e&&w9(e)?e.slice(1,-1):e}function w9(e){return e[0]==='"'&&e[e.length-1]==='"'}class v9 extends Un{name;def;constructor(t,n){super(mI),this.name=t,this.def=n}toString(){return`${Wo(this.name)} AS ${this.def}`}}class Ks extends le{func;def;constructor(t,n=new g0){super(h0),this.func=t,this.def=n}over(t){return new Ks(this.func,this.def.over(t))}partitionby(...t){return new Ks(this.func,this.def.partitionby(...t))}orderby(...t){return new Ks(this.func,this.def.orderby(...t))}frame(t){return new Ks(this.func,this.def.frame(t))}toString(){return`${this.func} OVER ${this.def}`}}class x9 extends le{name;args;ignoreNulls;order;constructor(t,n=[],r=!1,i=[]){super(lI),this.name=t,this.args=n,this.ignoreNulls=r,this.order=is([i])}toString(){const{name:t,args:n,ignoreNulls:r,order:i}=this,s=[n.join(", "),i.length?`ORDER BY ${i.join(", ")}`:"",r?"IGNORE NULLS":""].filter(o=>o).join(" ");return`${t}(${s})`}}class g0 extends Un{name;partition;order;framedef;constructor(t,n,r,i){super(fI),this.name=t,this.partition=n,this.order=r,this.framedef=i}over(t){return xf(this,{name:t})}partitionby(...t){return xf(this,{partition:is(t)})}orderby(...t){return xf(this,{order:is(t)})}frame(t){return xf(this,{framedef:t})}toString(){const{name:t,partition:n,order:r,framedef:i}=this,s=t&&Wo(t),o=[s,n?.length&&`PARTITION BY ${n.join(", ")}`,r?.length&&`ORDER BY ${r.join(", ")}`,i].filter(a=>a);return s&&o.length<2?s:`(${o.join(" ")})`}}function xf(e,t){return new g0(t.name??e.name,t.partition??e.partition,t.order??e.order,t.framedef??e.framedef)}function Sf(e){return e instanceof Af}class Af extends le{table;constructor(t,n){super(t),this.table=n}get column(){return""}toString(){const{column:t,table:n}=this,r=`${n??""}`,i=t==="*"?"*":Wo(t);return(r?r+".":"")+i}}class AI extends Af{name;constructor(t,n){super(l0,n),this.name=t}get column(){return this.name}}function S9(e){return e instanceof II}class II extends Af{param;constructor(t,n){super(f0,n),this.param=t}get column(){return`${this.param.value}`}}function ss(e){return typeof e=="string"}function b0(e){return Array.isArray(e)}function Bc(e){if(e){const t=e;return typeof t?.addEventListener=="function"&&t.dynamic!==!1&&"value"in t}return!1}function If(e,t){const n=TI(t);return Bc(e)?new II(new vf(e),n):new AI(e,n)}class EI extends le{value;hint;constructor(t,n){super(pI),this.value=t,this.hint=n}toString(){return this.value}}function hn(e){return new y0(e)}function A9(e,t){return new EI(e,t)}function Ef(e){return e instanceof MI}class MI extends le{table;constructor(t){super(f9),this.table=[t].flat()}get name(){return this.table[this.table.length-1]}toString(){return this.table.map(t=>Wo(t)).join(".")}}function _0(...e){const t=Cc(e,String);return t?.length?new MI(t):void 0}function Nt(e){return ss(e)?E9(e):Pc(e)}function Mf(e){return ss(e)?A9(e):Pc(e)}function Pc(e){return e instanceof le?e:Bc(e)?new vf(e):hn(e)}function TI(e){return $I(e)}function I9(e){return $I(e)}function $I(e){return ss(e)?M9(e):b0(e)?_0(e):e}function E9(e){const t=SI(e);return If(t.pop(),_0(t))}function M9(e){return _0(SI(e))}function T9(){return new g0}class Uc extends le{name;args;isDistinct;filter;order;constructor(t,n,r=!1,i=null,s=[]){super(wf),this.name=t,this.args=n,this.isDistinct=r,this.filter=i,this.order=is([s])}distinct(t=!0){return new Uc(this.name,this.args,t,this.filter,this.order)}where(t){return ss(t)&&(t=Mf(t)),new Uc(this.name,this.args,this.isDistinct,t,this.order)}argOrder(t){return new Uc(this.name,this.args,this.isDistinct,this.filter,t)}window(){return new Ks(this)}partitionby(...t){return this.window().partitionby(...t)}orderby(...t){return this.window().orderby(...t)}frame(t){return this.window().frame(t)}toString(){const{name:t,args:n,isDistinct:r,filter:i,order:s}=this,o=[r?"DISTINCT":"",n?.length?n.join(", "):t.toLowerCase()==="count"?"*":"",s.length?`ORDER BY ${s.join(", ")}`:""].filter(c=>c).join(" "),a=i?` FILTER (WHERE ${i})`:"";return`${t}(${o})${a}`}}const $9=["any_value","approx_count_distinct","approx_quantile","arbitrary","arg_max","arg_max_null","arg_min","arg_min_null","array_agg","avg","bit_and","bit_or","bit_xor","bitstring_agg","bool_and","bool_or","corr","count","count_star","covar_pop","covar_samp","entropy","favg","first","fsum","geomean","kurtosis_pop","kurtosis","last","mad","max","max_by","median","min","min_by","mode","product","quantile","quantile_cont","quantile_disc","regr_avgx","regr_avgy","regr_count","regr_intercept","regr_r2","regr_sxx","regr_sxy","regr_syy","regr_slope","reservoir_quantile","skewness","stddev","stddev_pop","stddev_samp","string_agg","sum","variance","var_pop","var_samp"];class NI extends le{expr;extent;constructor(t,n,r){super(t),this.expr=n,this.extent=r}toSQL(t){const{extent:n,expr:r}=this;return n?`(${r} ${t} ${n[0]} AND ${n[1]})`:""}}class RI extends NI{constructor(t,n){super(sI,t,n)}toString(){return super.toSQL("BETWEEN")}}class N9 extends NI{constructor(t,n){super(oI,t,n)}toString(){return super.toSQL("NOT BETWEEN")}}class R9 extends le{op;left;right;constructor(t,n,r){super(iI),this.op=t,this.left=n,this.right=r}toString(){return`(${this.left} ${this.op} ${this.right})`}}class zc extends le{expr;_when;_else;constructor(t=void 0,n=[],r=void 0){super(tI),this.expr=t,this._when=n,this._else=r}when(t,n){return new zc(this.expr,this._when.concat(new OI(Nt(t),Nt(n))),this._else)}else(t){return new zc(this.expr,this._when,Nt(t))}toString(){return"CASE "+(this.expr?`${this.expr} `:"")+this._when.join(" ")+(this._else?` ELSE ${this._else}`:"")+" END"}}class OI extends Un{when;then;constructor(t,n){super(eI),this.when=t,this.then=n}toString(){return`WHEN ${this.when} THEN ${this.then}`}}class O9 extends le{expr;cast;constructor(t,n){super(Z3),this.expr=t,this.cast=n}toString(){return`(${this.expr})::${this.cast}`}}class D9 extends le{spans;constructor(t){super(d0),this.spans=t}toString(){return this.spans.join("")}}class L9 extends Un{size;perc;method;seed;constructor(t,n=!1,r,i){super(g9),this.size=t,this.perc=n,this.method=r,this.seed=i}toString(){const{size:t,perc:n,method:r,seed:i}=this,s=r?`${r} `:"",o=i!=null?` REPEATABLE (${i})`:"";return`${s}(${t}${n?"%":" ROWS"})${o}`}}class F9 extends Un{expr;alias;constructor(t,n){super(gI),this.expr=t,this.alias=n}toString(){const{expr:t,alias:n}=this;return!n||C9(t,n)?`${t}`:`${t} AS ${Wo(n)}`}}function C9(e,t){return e instanceof Af&&e.table==null&&e.column===t}class w0 extends Un{name;query;materialized;constructor(t,n,r=null){super(yI),this.name=t,this.query=n,this.materialized=r}toString(){const t=this.materialized,n=t===!0?" MATERIALIZED":t===!1?" NOT MATERIALIZED":"";return`"${this.name}" AS${n} (${this.query})`}}function v0(e){return e instanceof gt}function Tf(e){return e instanceof Go}function k9(e){return e instanceof $f}class gt extends le{static with(...t){return new B9(...t)}static select(...t){return new Go().select(...t)}static from(...t){return new Go().from(...t)}static union(...t){return new $r("UNION",t.flat())}static unionByName(...t){return new $r("UNION BY NAME",t.flat())}static unionAll(...t){return new $r("UNION ALL",t.flat())}static unionAllByName(...t){return new $r("UNION ALL BY NAME",t.flat())}static intersect(...t){return new $r("INTERSECT",t.flat())}static intersectAll(...t){return new $r("INTERSECT ALL",t.flat())}static except(...t){return new $r("EXCEPT",t.flat())}static exceptAll(...t){return new $r("EXCEPT ALL",t.flat())}static describe(t){return new $f(t)}_with=[];_orderby=[];_limitPerc=!1;_limit;_offset;cteFor=null;constructor(t){super(t)}get subqueries(){return[]}clone(){return this}setCteFor(t){this.cteFor=t}with(...t){const n=[],r=(i,s)=>{const o=s.clone();o.setCteFor(this),n.push(new w0(i,o))};return t.flat().forEach(i=>{if(i instanceof w0)n.push(i);else if(i!=null)for(const s in i)r(s,i[s])}),this._with=this._with.concat(n),this}orderby(...t){return this._orderby=this._orderby.concat(is(t)),this}limitPercent(t){return this._limitPerc=!0,this._limit=Nt(t),this}limit(t){return this._limitPerc=!1,this._limit=Nt(t),this}offset(t){return this._offset=Nt(t),this}}class Go extends gt{_select=[];_from=[];_where=[];_sample;_groupby=[];_having=[];_window=[];_qualify=[];_distinct=!1;constructor(){super(_I)}get subqueries(){const t=this.cteFor||this,r=(t instanceof Go?t._with:[]).reduce((s,o)=>(s[o.name]=o.query,s),{}),i=[];return this._from.forEach(({expr:s})=>{if(v0(s))i.push(s);else if(Ef(s)){const o=r[s.name];o&&i.push(o)}}),i}clone(){return Object.assign(new Go,this)}select(...t){const n=new Set,r=[],i=(s,o)=>{const a=m0(o);n.add(a),s&&r.push(new F9(Nt(s),a))};return t.flat().forEach(s=>{if(s!=null)if(ss(s))i(s,s);else if(Sf(s))i(s,s.column);else if(b0(s))i(s[1],s[0]);else if(Tr(s))i(s,`${s}`);else for(const o in s)i(s[o],o)}),this._select=this._select.filter(s=>!n.has(s.alias)).concat(r),this}setSelect(...t){return this._select=[],this.select(...t)}distinct(t=!0){return this._distinct=!!t,this}from(...t){const n=[],r=(i,s)=>{n.push(new DI(I9(i),m0(s)))};return t.flat().forEach(i=>{if(i!=null)if(i instanceof DI)n.push(i);else if(ss(i))r(i,i);else if(Ef(i))r(i,i.name);else if(Tr(i))r(i);else if(b0(i))r(i[1],i[0]);else for(const s in i)r(i[s],s)}),this._from=this._from.concat(n),this}setFrom(...t){return this._from=[],this.from(...t)}sample(t,n,r){let i;if(typeof t=="number"){const s=t>0&&t<1,o=s?t*100:Math.floor(t);i=new L9(o,s,n,r)}else i=t;return this._sample=i??void 0,this}where(...t){return this._where=this._where.concat(Cc(t,Mf)),this}setWhere(...t){return this._where=[],this.where(...t)}groupby(...t){return this._groupby=this._groupby.concat(is(t)),this}setGroupby(...t){return this._groupby=[],this.groupby(...t)}having(...t){return this._having=this._having.concat(Cc(t,Mf)),this}window(...t){const n=[];return t.flat().forEach(r=>{if(r!=null)for(const i in r)n.push(new v9(m0(i),r[i]))}),this._window=this._window.concat(n),this}qualify(...t){return this._qualify=this._qualify.concat(Cc(t,Mf)),this}toString(){const{_with:t,_select:n,_distinct:r,_from:i,_sample:s,_where:o,_groupby:a,_having:c,_window:u,_qualify:l,_orderby:h,_limitPerc:f,_limit:d,_offset:p}=this,y=[];if(t.length&&y.push(`WITH ${t.join(", ")}`),y.push(`SELECT${r?" DISTINCT":""} ${n.join(", ")}`),i.length&&y.push(`FROM ${i.join(", ")}`),o.length){const g=o.map(String).filter(m=>m).join(" AND ");g&&y.push(`WHERE ${g}`)}if(s&&y.push(`USING SAMPLE ${s}`),a.length&&y.push(`GROUP BY ${a.join(", ")}`),c.length){const g=c.map(String).filter(m=>m).join(" AND ");g&&y.push(`HAVING ${g}`)}if(u.length&&y.push(`WINDOW ${u.join(", ")}`),l.length){const g=l.map(String).filter(m=>m).join(" AND ");g&&y.push(`QUALIFY ${g}`)}return h.length&&y.push(`ORDER BY ${h.join(", ")}`),d&&y.push(`LIMIT ${d}${f?"%":""}`),p&&y.push(`OFFSET ${p}`),y.join(" ")}}class $f extends Un{query;constructor(t){super(wI),this.query=t}clone(){return new $f(this.query.clone())}toString(){return`DESCRIBE ${this.query}`}}class $r extends gt{op;queries;constructor(t,n){super(vI),this.op=t,this.queries=n}setCteFor(t){super.setCteFor(t);const{queries:n,cteFor:r}=this;r&&n.forEach(i=>i.setCteFor(r))}get subqueries(){return this.queries}clone(){const{op:t,queries:n,...r}=this;return Object.assign(new $r(t,n),r)}toString(){const{op:t,queries:n,_with:r,_orderby:i,_limitPerc:s,_limit:o,_offset:a}=this,c=[];return r.length&&c.push(`WITH ${r.join(", ")}`),c.push(n.join(` ${t} `)),i.length&&c.push(`ORDER BY ${i.join(", ")}`),o&&c.push(`LIMIT ${o}${s?"%":""}`),a&&c.push(`OFFSET ${a}`),c.join(" ")}}class B9{_with;constructor(...t){this._with=t}select(...t){return gt.select(...t).with(...this._with)}from(...t){return gt.from(...t).with(...this._with)}union(...t){return gt.union(...t).with(...this._with)}unionByName(...t){return gt.unionByName(...t).with(...this._with)}unionAll(...t){return gt.unionAll(...t).with(...this._with)}unionAllByName(...t){return gt.unionAllByName(...t).with(...this._with)}intersect(...t){return gt.intersect(...t).with(...this._with)}intersectAll(...t){return gt.intersectAll(...t).with(...this._with)}except(...t){return gt.except(...t).with(...this._with)}exceptAll(...t){return gt.exceptAll(...t).with(...this._with)}}class DI extends Un{expr;alias;sample;constructor(t,n,r){super(bI),this.expr=t,this.alias=n,this.sample=r}toString(){const{expr:t,alias:n,sample:r}=this,i=v0(t)?`(${t})`:`${t}`;return`${n&&!(Ef(t)&&t.table.join(".")===n)?`${i} AS ${Wo(n)}`:`${i}`}${r?` TABLESAMPLE ${r}`:""}`}}class P9 extends le{expr;values;constructor(t,n){super(cI),this.expr=t,this.values=n}toString(){return`(${this.expr} IN (${this.values.join(", ")}))`}}class U9 extends le{name;steps;constructor(t,n=1){super(d9),this.name=t,this.steps=n}toString(){return`INTERVAL ${this.steps} ${this.name}`}}class z9 extends le{values;constructor(t){super(p9),this.values=t}toString(){return`[${this.values.join(", ")}]`}}class LI extends le{op;clauses;constructor(t,n){super(aI),this.op=t,this.clauses=n}toString(){const t=this.clauses;return t.length===0?"":t.length===1?`${t[0]}`:`(${t.join(` ${this.op} `)})`}}class q9 extends LI{constructor(t){super("AND",t)}}class j9 extends LI{constructor(t){super("OR",t)}}class FI extends le{expr;desc;nullsFirst;constructor(t,n,r){super(K3),this.expr=t,this.desc=n,this.nullsFirst=r}toString(){const{expr:t,desc:n,nullsFirst:r}=this;return`${t}${n?" DESC":n===!1?" ASC":""}${r?" NULLS FIRST":r===!1?" NULLS LAST":""}`}}class CI extends le{op;expr;constructor(t,n,r){super(t),this.op=n,this.expr=r}}class Y9 extends CI{constructor(t,n){super(nI,t,n)}toString(){return`(${this.op} ${this.expr})`}}class V9 extends CI{constructor(t,n){super(rI,t,n)}toString(){return`(${this.expr} ${this.op})`}}class W9 extends le{expr;recursive;maxDepth;constructor(t,n=!1,r=0){super(J3),this.expr=t,this.recursive=n,this.maxDepth=r}toString(){const t=this.recursive?", recursive := true":"",n=this.maxDepth>0?`, max_depth := ${this.maxDepth}`:"";return`UNNEST(${this.expr}${t}${n})`}}const G9="ROWS",X9="RANGE",H9="GROUPS",Q9="PRECEDING",J9="FOLLOWING",kI="CURRENT ROW",BI="UNBOUNDED";let Nf=class extends Un{frameType;extent;exclude;constructor(t,n,r){super(hI),this.frameType=t,this.extent=Bc(n)?new vf(n):n,this.exclude=r}toString(){const{frameType:t,exclude:n,extent:r}=this,[i,s]=Tr(r)?r.value:r,o=PI(i,Q9),a=PI(s,J9);return`${t} BETWEEN ${o} AND ${a}${n?` ${n}`:""}`}};function PI(e,t){return e instanceof K9?e:e!=null&&typeof e!="number"?`${e} ${t}`:e===0?kI:e&&Number.isFinite(e)?`${Math.abs(e)} ${t}`:`${BI} ${t}`}class K9 extends Un{scope;expr;constructor(t,n=null){super(dI),this.scope=t,this.expr=n}toString(){const{scope:t,expr:n}=this;return t===kI?t:`${n??BI} ${t}`}}function qc(e,t){return Dt("arg_max",e,t)}function jc(e,t){return Dt("arg_min",e,t)}function UI(e){return Dt("array_agg",e)}function x0(e){return Dt("avg",e)}function zI(e,t){return Dt("corr",e,t)}function ar(e){return Dt("count",e)}function qI(e,t){return Dt("covar_samp",e,t)}function jI(e,t){return Dt("covar_pop",e,t)}function YI(e){return Dt("entropy",e)}function VI(e){return Dt("first",e)}function WI(e){return Dt("geomean",e)}function GI(e){return Dt("kurtosis",e)}function XI(e){return Dt("mad",e)}function Nr(e){return Dt("max",e)}function HI(e){return Dt("median",e)}function os(e){return Dt("min",e)}function QI(e){return Dt("mode",e)}function JI(e){return Dt("last",e)}function KI(e){return Dt("product",e)}function ZI(e,t){return Dt("quantile",e,t)}function tE(e,t){return Dt("regr_avgx",e,t)}function Z9(e,t){return Dt("regr_avgy",e,t)}function eE(e,t){return Dt("regr_count",e,t)}function tP(e,t){return Dt("regr_intercept",e,t)}function eP(e,t){return Dt("regr_sxx",e,t)}function nP(e,t){return Dt("regr_syy",e,t)}function rP(e,t){return Dt("regr_slope",e,t)}function nE(e){return Dt("skewness",e)}function S0(e){return Dt("stddev",e)}function rE(e){return Dt("stddev_pop",e)}function iE(e){return Dt("string_agg",e)}function ee(e){return Dt("sum",e)}function sE(e){return Dt("var_samp",e)}function oE(e){return Dt("var_pop",e)}function Zs(e,t,n){return e?new zc(void 0,[new OI(Nt(e),Nt(t))],Nt(n)):new zc}function Yc(e,t){return new O9(Nt(e),t)}function Ae(e){return Yc(e,"INTEGER")}function aE(e){return Yc(e,"FLOAT")}function qe(e){return Yc(e,"DOUBLE")}function iP(e,t,n=null){return new w0(e,t,n)}function zn(e,t){return new U9(e,t)}function cE(e){return zn("YEARS",e)}function uE(e){return zn("MONTHS",e)}function lE(e){return zn("DAYS",e)}function fE(e){return zn("HOURS",e)}function hE(e){return zn("MINUTES",e)}function dE(e){return zn("SECONDS",e)}function pE(e){return zn("MILLISECONDS",e)}function yE(e){return zn("MICROSECONDS",e)}function sP(e){return Xt("epoch_ms",e)}function oP(e,t,n=1){return Xt("time_bucket",zn(t,n),e)}function mE(e){return Xt("make_date",2012,Xt("month",e),1)}function gE(e){const t=Nt(e);return Xt("make_date",2012,Xt("month",t),Xt("day",t))}function bE(e){return Xt("make_date",2012,1,Xt("day",e))}function aP(e){return new z9(kc(e).map(Pc))}function Rf(e){return Array.isArray(e)?aP(e):Nt(e)}function cP(e,t){return Xt("list_has_all",Rf(e),Rf(t))}function uP(e,t){return Xt("list_has_any",Rf(e),Rf(t))}function lP(...e){return Xt("greatest",...e)}function A0(e){return Xt("exp",e)}function fP(e){return Xt("log",e)}function Vc(e){return Xt("ln",e)}function as(e){return Xt("sign",e)}function dn(e){return Xt("abs",e)}function Wc(e){return Xt("sqrt",e)}function hP(e){return Xt("ceil",e)}function Rr(e){return Xt("floor",e)}function Gc(e,t){return Xt("round",e,t)}function dP(e,t){return new Y9(e,Nt(t))}function _E(e,t){return new V9(e,Nt(t))}function pn(e,t,n){return new R9(e,Nt(t),Nt(n))}function fi(...e){return new q9(is(e))}function hi(...e){return new j9(is(e))}function wE(e){return dP("NOT",e)}function Of(e){return _E("IS NULL",e)}function cs(e){return _E("IS NOT NULL",e)}function I0(e,t){return pn("&",e,t)}function Ht(e,t){return pn("+",e,t)}function St(e,t){return pn("-",e,t)}function It(e,t){return pn("*",e,t)}function ne(e,t){return pn("/",e,t)}function je(e,t){return pn("**",e,t)}function vE(e,t){return pn("=",e,t)}function Xo(e,t){return pn("<>",e,t)}function Oe(e,t){return pn("<",e,t)}function di(e,t){return pn(">",e,t)}function pi(e,t){return pn("<=",e,t)}function xE(e,t){return pn(">=",e,t)}function SE(e,t){return pn("IS DISTINCT FROM",e,t)}function E0(e,t){return pn("IS NOT DISTINCT FROM",e,t)}function cr(e,t){return new RI(Nt(e),t?.map(Nt))}function AE(e,t){return new N9(Nt(e),t?.map(Nt))}function IE(e,t){return new P9(Nt(e),t.map(Nt))}function pP(e,t){return new FI(Nt(e),!1,t)}function yP(e,t){return new FI(Nt(e),!0,t)}function M0(e){return Xt("st_asgeojson",e)}function mP(e){return Xt("st_x",e)}function gP(e){return Xt("st_y",e)}function Df(e){return Xt("st_centroid",e)}function EE(e){return mP(Df(e))}function ME(e){return gP(Df(e))}function tn(e,...t){return new D9(bP(e,t))}function bP(e,t){const n=[e[0]],r=t.length;for(let i=0,s=0;i<r;){const o=t[i];Tr(o)?n[++s]=o:Bc(o)?n[++s]=new vf(o):n[s]+=ss(o)?o:`${hn(o)}`;const a=e[++i];Tr(n[s])?n[++s]=a:n[s]+=a}return n.filter(i=>i).map(i=>ss(i)?new EI(i):i)}function Xc(e,t,...n){return Xt(e,t,...kc(n).map(Pc))}function _P(e,t,n){return Xc("regexp_matches",e,t,n)}function wP(e,t){return Xc("contains",e,t)}function vP(e,t){return Xc("starts_with",e,t)}function xP(e,t){return Xc("ends_with",e,t)}function TE(e){return Xc("lower",e)}function SP(e,t=!1,n=0){return new W9(Nt(e),t,n)}function $E(...e){return Xt("coalesce",...e)}function NE(){return or("row_number")}function RE(){return or("rank")}function OE(){return or("dense_rank")}function DE(){return or("percent_rank")}function LE(){return or("cume_dist")}function FE(e){return or("ntile",e)}function CE(e,t,n){return or("lag",e,t,n)}function Lf(e,t,n){return or("lead",e,t,n)}function kE(e){return or("first_value",e)}function BE(e){return or("last_value",e)}function PE(e,t){return or("nth_value",e,t)}function UE(e,t){return new Nf(G9,e,t)}function zE(e,t){return new Nf(X9,e,t)}function qE(e,t){return new Nf(H9,e,t)}const jE={[wf]:["args","order","filter"],[sI]:["expr","extent"],[iI]:["left","right"],[tI]:["expr","_when","_else"],[Z3]:["expr"],[y9]:["expr"],[f0]:["param","table"],[l0]:["table"],[wI]:["query"],[m9]:["node"],[d0]:["spans"],[bI]:["expr"],[uI]:["args"],[cI]:["expr","values"],[aI]:["clauses"],[oI]:["expr","extent"],[K3]:["expr"],[p0]:["value"],[b9]:["subquery"],[gI]:["expr"],[_I]:["_with","_select","_from","_where","_sample","_groupby","_having","_window","_qualify","_orderby"],[vI]:["queries","_orderby"],[nI]:["expr"],[rI]:["expr"],[J3]:["expr"],[eI]:["when","then"],[h0]:["func","def"],[mI]:["def"],[fI]:["partition","order","framedef"],[dI]:["expr"],[hI]:["extent"],[lI]:["args"],[yI]:["query"]};function T0(e,t){if(t.has(e))return t.get(e);if(Tr(e)){const n=jE[e.type],r=n?.length??0;if(r>0){e=e.clone();for(let i=0;i<r;++i){const s=n[i],o=e[s];if(Array.isArray(o)){const a=e[s]=o.slice(),c=o.length;for(let u=0;u<c;++u)a[u]=T0(o[u],t)}else o&&(e[s]=T0(o,t))}}}return e}function to(e,t){if(!Tr(e))return;const n=t(e);if(n)return n;const r=jE[e.type],i=r?.length??0;for(let s=0;s<i;++s){const o=e[r[s]];if(Array.isArray(o)){const a=o.length;for(let c=0;c<a;++c)if(o[c]&&Number(to(o[c],t))<0)return n}else if(o&&Number(to(o,t))<0)return-1}}const AP=new RegExp(`^(${$9.join("|")})$`),IP=/(\\'|\\"|"(?:\\"|[^"])*"|'(?:\\'|[^'])*'|\w+\()/g;function EP(e){return e.split(IP).some(t=>t.endsWith("(")&&AP.test(t.slice(0,-1)))}function us(e){let t=0;return to(e,n=>{switch(n.type){case h0:return-1;case wf:return t|=1,-1;case d0:case pI:{let r=`${n}`.toLowerCase();const i=r.indexOf("(select ");return i>=0&&(r=r.slice(0,i)),r.includes(") over ")?-1:EP(r)?(t|=2,-1):1}}}),t}function MP(e){const t=new Set;return to(e,n=>{n.type===wf&&t.add(n)}),Array.from(t)}function $0(e){const t={};return to(e,n=>{(n.type===l0||n.type===f0)&&(t[`${n}`]=n)}),Object.values(t)}function TP(e){const t=new Set;return to(e,n=>{n.type===p0&&t.add(n.param)}),Array.from(t)}function Ho(e,t,{replace:n=!1,temp:r=!1,view:i=!1}={}){return"CREATE"+(n?" OR REPLACE ":" ")+(r?"TEMP ":"")+(i?"VIEW":"TABLE")+(n?" ":" IF NOT EXISTS ")+e+" AS "+t}function YE(e,{strict:t=!1}={}){return"CREATE SCHEMA "+(t?"":"IF NOT EXISTS ")+e}function N0(e){return`INSTALL ${e}; LOAD ${e}`}function $P(e,{columns:t=Object.keys(e?.[0]||{})}={}){let n=[];if(Array.isArray(t)?(n=t,t=n.reduce((i,s)=>(i[s]=s,i),{})):t&&(n=Object.keys(t)),!n.length)throw new Error("Can not create table from empty column set.");const r=[];for(const i of e){const s=n.map(o=>`${Pc(i[o])} AS "${t[o]}"`);r.push(`(SELECT ${s.join(", ")})`)}return r.join(" UNION ALL ")}function Ff(e,t,n,r={},i={}){const{select:s=["*"],where:o,view:a,temp:c,replace:u,...l}=r,h=NP({...i,...l}),f=`${e}('${n}'${h?", "+h:""})`,d=o?` WHERE ${o}`:"",p=`SELECT ${s.join(", ")} FROM ${f}${d}`;return Ho(t,p,{view:a,temp:c,replace:u})}function VE(e,t,n){return Ff("read_csv",e,t,n,{auto_detect:!0,sample_size:-1})}function WE(e,t,n){return Ff("read_json",e,t,n,{auto_detect:!0,format:"auto"})}function GE(e,t,n){return Ff("read_parquet",e,t,n)}function XE(e,t,n={}){const{options:r,...i}=n;if(r){const s=Array.isArray(r)?r.join(", "):typeof r=="string"?r:Object.entries(r).map(([o,a])=>`${o}=${a}`).join(", ");Object.assign(i,{open_options:s.toUpperCase()})}return Ff("st_read",e,t,i)}function HE(e,t,n={}){const{select:r=["*"],...i}=n,s=$P(t),o=r.length===1&&r[0]==="*"?s:`SELECT ${r} FROM ${s}`;return Ho(e,o,i)}function NP(e){return Object.entries(e).map(([t,n])=>`${t}=${R0(n)}`).join(", ")}function R0(e){switch(typeof e){case"boolean":return String(e);case"string":return`'${e}'`;case"undefined":case"object":return e==null?"NULL":Array.isArray(e)?"["+e.map(t=>R0(t)).join(", ")+"]":"{"+Object.entries(e).map(([t,n])=>`'${t}': ${R0(n)}`).join(", ")+"}";default:return`${e}`}}function RP(e,t,n,r,i=!1){const s=i?St(n,qe(e)):St(qe(e),t),o=n===t?0:r/(n-t);return o?It(s,qe(o)):s}function OP(e,t,n,r,i,s){return e.select({index:Ht(Ae(Rr(t)),It(Ae(Rr(n)),i)),...r}).groupby("index",s)}function DP(e,t,n){let{step:r,steps:i=25}=n;const{minstep:s=0,nice:o=!0,base:a}=n;if(o!==!1){const c=t-e,u=a?Math.log(a):Math.LN10;r=r||O0(c,i,s,u);let l=Math.log(r);const h=l>=0?0:~~(-l/u)+1,f=Math.pow(10,-h-1);l=Math.floor(e/r+f)*r,e=e<l?l-r:l,t=Math.ceil(t/r)*r,i=Math.round((t-e)/r)}return{min:e,max:t,steps:i}}function O0(e,t,n=0,r=Math.LN10){let i;const s=Math.ceil(Math.log(t)/r);let o=Math.max(n,Math.pow(10,Math.round(Math.log(e)/r)-s));for(;Math.ceil(e/o)>t;)o*=10;const a=[5,2];for(let c=0,u=a.length;c<u;++c)i=o/a[c],i>=n&&e/i<=t&&(o=i);return o}const QE="year",JE="month",KE="day",Cf="hour",kf="minute",Bf="second",LP="millisecond",FP="microsecond",Hc=1e3,Qc=Hc*60,Jc=Qc*60,Pf=Jc*24,CP=Pf*7,ZE=Pf*30,tM=Pf*365,Kc=[{unit:Bf,step:1,dt:Hc},{unit:Bf,step:5,dt:Hc*5},{unit:Bf,step:15,dt:Hc*15},{unit:Bf,step:30,dt:Hc*30},{unit:kf,step:1,dt:Qc},{unit:kf,step:5,dt:Qc*5},{unit:kf,step:15,dt:Qc*15},{unit:kf,step:30,dt:Qc*30},{unit:Cf,step:1,dt:Jc},{unit:Cf,step:3,dt:Jc*3},{unit:Cf,step:6,dt:Jc*6},{unit:Cf,step:12,dt:Jc*12},{unit:KE,step:1,dt:Pf},{unit:KE,step:7,dt:CP},{unit:JE,step:1,dt:ZE},{unit:JE,step:3,dt:ZE*3},{unit:QE,step:1,dt:tM}];function kP(e,t,n){const r=+t-+e,i=r/n,s=BP(Kc,i,c=>c.dt);let o,a;return s===Kc.length?(o=QE,a=O0(r/tM,n)):s?{unit:o,step:a}=Kc[i/Kc[s-1].dt<Kc[s].dt/i?s-1:s]:(a=O0(r,n),o=a>=1?LP:FP,a=a>=1?a:a*1e3),{unit:o,step:a}}function BP(e,t,n){const r=(a,c)=>Number(a)-Number(c),i=(a,c)=>r(n(a),c);let s=0,o=e.length;if(s<o){if(r(t,t)!==0)return o;do{const a=s+o>>>1;i(e[a],t)<=0?s=a+1:o=a}while(s<o)}return s}function PP(e,t,n={}){const{offset:r=0}=n,{unit:i,step:s=1}=n.interval?{unit:n.interval,step:n.step}:kP(t[0],t[1],n.steps||40),o=oP(e,i,s);return r?Ht(o,zn(i,r*s)):o}function Zc(e){return e}function eM(){return{apply:Zc,invert:Zc,sqlApply:Nt,sqlInvert:Zc}}function UP({base:e=null}={}){if(e==null||e===Math.E)return{apply:Math.log,invert:Math.exp,sqlApply:t=>Vc(t),sqlInvert:t=>A0(t)};if(e===10)return{apply:Math.log10,invert:t=>Math.pow(10,t),sqlApply:t=>fP(t),sqlInvert:t=>je(10,t)};{const t=+e;return{apply:n=>Math.log(n)/Math.log(t),invert:n=>Math.pow(t,n),sqlApply:n=>ne(Vc(n),Vc(t)),sqlInvert:n=>je(t,n)}}}function zP({constant:e=1}={}){const t=+e;return{apply:n=>Math.sign(n)*Math.log1p(Math.abs(n)),invert:n=>Math.sign(n)*Math.exp(Math.abs(n)-t),sqlApply:n=>(n=Nt(n),It(as(n),Vc(Ht(t,dn(n))))),sqlInvert:n=>It(as(n),St(A0(dn(n)),t))}}function qP(){return{apply:e=>Math.sign(e)*Math.sqrt(Math.abs(e)),invert:e=>Math.sign(e)*e*e,sqlApply:e=>(e=Nt(e),It(as(e),Wc(dn(e)))),sqlInvert:e=>It(as(e),je(e,2))}}function jP({exponent:e=1}={}){const t=+e;return{apply:n=>Math.sign(n)*Math.pow(Math.abs(n),t),invert:n=>Math.sign(n)*Math.pow(Math.abs(n),1/t),sqlApply:n=>(n=Nt(n),It(as(n),je(dn(n),t))),sqlInvert:n=>It(as(n),je(dn(n),ne(1,t)))}}function nM(){return{apply:e=>Number(e),invert:e=>new Date(e),sqlApply:e=>e instanceof Date?hn(+e):VP(e)?hn(Number(e.value)):sP(e),sqlInvert:Zc}}const YP={identity:eM,linear:eM,log:UP,symlog:zP,sqrt:qP,pow:jP,time:nM,utc:nM};function D0(e){const t=YP[e.type];if(!t)throw new Error(`Unrecognized scale type: ${e.type}`);return{...e,...t(e)}}function VP(e){return e instanceof y0&&e.value instanceof Date}function WP(e,t,n={},r=D0({type:"linear"})){const[i,s]=t,{offset:o=0}=n,{apply:a,sqlApply:c,sqlInvert:u}=r,l=DP(a(i),a(s),n),h=c(e),f=(l.max-l.min)/l.steps;let d=l.min===0?h:St(h,l.min);return f!==1&&(d=ne(d,qe(f))),d=Rr(o?Ht(o,d):d),f!==1&&(d=It(f,d)),l.min!==0&&(d=Ht(l.min,d)),u(d)}function GP(e,t,n=void 0,r=[]){const i=n?(a=>It(a,n)):(a=>a),s=Rr(t),o=Ht(s,1);return gt.from(gt.unionAll(e.clone().select({i:Ae(s),w:i(St(o,t))}),e.clone().select({i:Ae(o),w:i(St(t,s))}))).select({index:"i",density:ee("w")},r).groupby("index",r).having(Xo("density",0))}function XP(e,t,n,r,i,s=[]){const o=r?m=>It(m,r):Zc,a=(m,b)=>e.clone().select({xp:t,yp:n,i:m,w:b}),c=(m,b)=>Ht(m,It(b,i)),u=Ae(Rr(t)),l=Ae(Rr(n)),h=Ht(u,1),f=Ht(l,1),d=St(t,u),p=St(h,t),y=St(n,l),g=St(f,n);return gt.from(gt.unionAll(a(c(u,l),o(It(p,g))),a(c(u,f),o(It(p,y))),a(c(h,l),o(It(d,g))),a(c(h,f),o(It(d,y))))).select({index:"i",density:ee("w")},s).groupby("index",s).having(Xo("density",0))}function HP(e,t,n,r,i,s,o=[],a=!0){e.select({x:Ae(Rr(t)),y:Ae(Rr(n))});const c=o.concat(r),u=gt.from(e).select(c,{x0:"x",y0:"y",dx:St(Lf("x").over("sw"),"x"),dy:St(Lf("y").over("sw"),"y")}).window({sw:T9().partitionby(c).orderby(pP("x"))}).qualify([hi(Oe("x0",i),Oe(Ht("x0","dx"),i)),hi(Oe("y0",s),Oe(Ht("y0","dy"),s)),hi(di("x0",0),di(Ht("x0","dx"),0)),hi(di("y0",0),di(Ht("y0","dy"),0))]),l=gt.select({x:lP(Nr(dn("dx")),Nr(dn("dy")))}).from("pairs"),h=gt.select({i:Ae(tn`UNNEST(range((${l})))`)}),f=gt.unionAll(gt.select(c,{x:Ht("x0","i"),y:Ht("y0",Ae(Gc(ne(It("i","dy"),"dx"))))}).from("pairs","indices").where([pi(dn("dy"),dn("dx")),Oe("i",dn("dx"))]),gt.select(c,{x:Ht("x0",Ae(Gc(ne(It(It(as("dy"),"i"),"dx"),"dy")))),y:Ht("y0",It(as("dy"),"i"))}).from("pairs","indices").where([di(dn("dy"),dn("dx")),Oe("i",dn("dy"))]),gt.select(c,{x:"x0",y:"y0"}).from("pairs").where(Of("dx"))),d=gt.from("raster").select(c,"x","y",a?{w:ne(1,ar().partitionby(["x"].concat(c)))}:null).where([pi(0,"x"),Oe("x",i),pi(0,"y"),Oe("y",s)]);return gt.with({pairs:u,indices:h,raster:f,points:d}).from("points").select(o,{index:Ht("x",It("y",Ae(i))),density:a?ee("w"):ar()}).groupby("index",o)}function QP(e,t,n,r,i=[]){const s=Ae(Rr(t)),o=v0(e),a=o?"input":e,c=o?gt.with(iP(String(a),e,!0)):gt,u=l=>gt.from(a).select(l).groupby(s,i);return c.union(u([{[n]:os(n),[r]:jc(r,n)},...i]),u([{[n]:Nr(n),[r]:qc(r,n)},...i]),u([{[n]:jc(n,r),[r]:os(r)},...i]),u([{[n]:qc(n,r),[r]:Nr(r)},...i])).orderby(i,n)}function rM(e){let t=2166136261;for(let n=0,r=e.length;n<r;++n){const i=e.charCodeAt(n),s=i&65280;s&&(t=iM(t^s>>8)),t=iM(t^i&255)}return JP(t)>>>0}function iM(e){return e+(e<<1)+(e<<4)+(e<<7)+(e<<8)+(e<<24)}function JP(e){return e+=e<<13,e^=e>>>7,e+=e<<3,e^=e>>>17,e+=e<<5,e&4294967295}function KP(e,t,n){switch(e.name){case"count":case"count_star":return ZP(t,e);case"sum":return oM(t,e);case"avg":return tU(t,e);case"geomean":return eU(t,e);case"arg_max":return nU(t,e);case"arg_min":return rU(t,e);case"variance":case"var_samp":return Uf(t,e,n);case"var_pop":return Uf(t,e,n,!1);case"stddev":case"stddev_samp":return Wc(Uf(t,e,n));case"stddev_pop":return Wc(Uf(t,e,n,!1));case"covar_samp":return zf(t,e,n);case"covar_pop":return zf(t,e,n,!1);case"corr":return aM(t,e,n);case"regr_count":return Qo(t,e).expr;case"regr_avgx":return uM(t,e);case"regr_avgy":return lM(t,e);case"regr_syy":return C0(t,0,e,n);case"regr_sxx":return C0(t,1,e,n);case"regr_sxy":return zf(t,e,n,null);case"regr_slope":return fM(t,e,n);case"regr_intercept":return iU(t,e,n);case"regr_r2":return je(aM(t,e,n),2);case"max":case"min":case"bit_and":case"bit_or":case"bit_xor":case"bool_and":case"bool_or":case"product":{const r=sM(e);return t[r]=e,tn`${e.name}("${r}")`}default:return null}}function sM(e){return"pre_"+rM(`${e}`).toString(16)}function Ye(e,t,n){const r=n?.filter;r&&(t=t.filter?t.where(fi(r,t.filter)):t.where(r));const i=sM(t);return e[i]=t,i}function L0(e,t){const n=Ye(e,ar(t.args[0]),t);return{expr:$E(ee(n),0),name:n}}function ZP(e,t){return $E(oM(e,t),0)}function oM(e,t){return ee(Ye(e,t))}function tU(e,t){const n=Ye(e,t),{expr:r,name:i}=L0(e,t);return ne(ee(It(n,i)),r)}function eU(e,t){const n=t.args[0],r=Ye(e,ee(Vc(n)),t),{expr:i}=L0(e,t);return A0(ne(ee(r),i))}function nU(e,t){const n=Ye(e,t),r=Ye(e,Nr(t.args[1]),t);return qc(n,r)}function rU(e,t){const n=Ye(e,t),r=Ye(e,os(t.args[1]),t);return jc(n,r)}function Uf(e,t,n,r=!0){const i=t.args[0],{expr:s}=L0(e,t),o=St(i,n(i)),a=Ye(e,ee(je(o,2)),t),c=Ye(e,ee(o),t),u=r?St(s,1):s;return ne(St(ee(a),ne(je(ee(c),2),s)),u)}function zf(e,t,n,r=!0){const{expr:i}=Qo(e,t),s=cM(e,t,n),o=tu(e,1,t,n),a=tu(e,0,t,n),c=St(s,ne(It(o,a),i));return r===null?c:r?ne(c,St(i,1)):ne(c,i)}function aM(e,t,n){const{expr:r}=Qo(e,t),i=cM(e,t,n),s=F0(e,1,t,n),o=F0(e,0,t,n),a=tu(e,1,t,n),c=tu(e,0,t,n),u=St(s,ne(je(a,2),r)),l=St(o,ne(je(c,2),r));return ne(St(i,ne(It(a,c),r)),Wc(It(u,l)))}function Qo(e,t){const[n,r]=t.args,i=Ye(e,eE(n,r),t);return{expr:ee(i),name:i}}function tu(e,t,n,r){const i=n.args,s=i[t],o=i[1-t],a=ee(St(s,r(s))).where(cs(o));return ee(Ye(e,a,n))}function F0(e,t,n,r){const i=n.args,s=i[t],o=i[1-t],a=ee(je(St(s,r(s)),2)).where(cs(o));return ee(Ye(e,a,n))}function cM(e,t,n){const[r,i]=t.args,s=ee(It(St(i,n(i)),St(r,n(r))));return ee(Ye(e,s,t))}function uM(e,t){const[n,r]=t.args,{expr:i,name:s}=Qo(e,t),o=Ye(e,tE(n,r),t);return ne(ee(It(o,s)),i)}function lM(e,t){const[n,r]=t.args,{expr:i,name:s}=Qo(e,t),o=Ye(e,Z9(n,r),t);return ne(ee(It(o,s)),i)}function C0(e,t,n,r){const{expr:i}=Qo(e,n),s=tu(e,t,n,r),o=F0(e,t,n,r);return St(o,ne(je(s,2),i))}function fM(e,t,n){const r=zf(e,t,n,null),i=C0(e,1,t,n);return ne(r,i)}function iU(e,t,n){const r=uM(e,t),i=lM(e,t),s=fM(e,t,n);return St(i,It(s,r))}function sU(e){if(!e.filterStable)return null;const t=e.query();if(!Tf(t))return null;const n=qf(t,c=>{const u=c._from[0]?.expr;return Ef(u)?u.name:u});if(typeof n!="string")return null;const r=new Map,i={},s={},o=[],a=c=>{const u=c.column,l=qf(t,h=>h._select.find(f=>f.alias===u)?.expr);return tn`(SELECT avg(${l??c}) FROM "${n}")`};for(const{alias:c,expr:u}of t._select){if(us(u)>1)return null;const l=MP(u);if(l.length===0)o.push(c),i[c]=u;else{for(const h of l){if(h.isDistinct)return null;const f=KP(h,i,a);if(!f)return null;r.set(h,f)}s[c]=T0(u,r)}}return r.size?{group:o,preagg:i,output:s}:null}function qf(e,t){const n=e.subqueries;if(Tf(e)&&n.length===0)return t(e);const r=qf(n[0],t);for(let i=1;i<n.length;++i){const s=qf(n[i],t);if(s!==void 0&&s!==r)return NaN}return r}const oU={skip:!0,result:null};class aU{entries;active;mc;_schema;_enabled;constructor(t,{schema:n="mosaic",enabled:r=!0}={}){this.entries=new Map,this.active=null,this.mc=t,this._schema=n,this._enabled=r}set enabled(t){this._enabled!==t&&(t||this.clear(),this._enabled=t)}get enabled(){return this._enabled}set schema(t){this._schema!==t&&(this.clear(),this._schema=t)}get schema(){return this._schema}dropSchema(){return this.clear(),this.mc.exec(`DROP SCHEMA IF EXISTS "${this.schema}" CASCADE`)}clear(){this.entries.clear(),this.active=null}request(t,n,r){if(!this.enabled||r==null)return null;const{entries:i,mc:s,schema:o}=this,{source:a}=r;if(!a||this.active&&(this.active.source!==a&&this.clear(),this.active?.source===null))return null;let{active:c}=this;if(!c&&(r.predicate==null||(this.active=c=cU(r),c.source===null)))return null;if(i.has(t))return i.get(t);const u=sU(t);let l;if(!u)l=null;else if(n.skip(t,r))l=oU;else{const h=n.remove(a).predicate(t);l=fU(t.query(h),c,u,o),l.result=s.exec([`CREATE SCHEMA IF NOT EXISTS ${o}`,Ho(l.table,l.create,{temp:!1})]),l.result.catch(f=>s.logger().error(f))}return i.set(t,l),l}}function cU(e){const{source:t,meta:n}=e,r=e.predicate,i=$0(r).map(a=>a.column);let s,o;if(!n||!i)return{source:null,columns:o,predicate:s};switch(n.type){case"point":s=a=>a,o=Object.fromEntries(i.map(a=>[`${a}`,Nt(a)]));break;case"interval":{const{scales:a,bin:c,pixelSize:u=1}=n;if(!a)break;const l=a.map(h=>lU(h,u,c));l.some(h=>!h)||(l.length===1?(s=h=>h?cr("active0",h.extent?.map(l[0])):[],o={active0:l[0](r.expr)}):(s=h=>h?fi(h.clauses.map((f,d)=>cr(`active${d}`,f.extent?.map(l[d])))):[],o=Object.fromEntries(r.clauses.map((h,f)=>[`active${f}`,l[f](h.expr)]))))}}return{source:o?t:null,columns:o,predicate:s}}const uU={ceil:hP,round:Gc};function lU(e,t,n){const{type:r,domain:i,range:s,apply:o,sqlApply:a}=D0(e);if(!o)return;const c=uU[`${n}`.toLowerCase()]||Rr,u=i.map(y=>Number(y)),l=o(Math.min(...u)),h=o(Math.max(...u)),f=(r==="identity"?1:Math.abs(s[1]-s[0])/(h-l))/t,d=f===1?y=>y:y=>It(qe(f),y),p=l===0?y=>y:y=>St(y,qe(l));return y=>Ae(c(d(p(a(y)))))}function fU(e,t,n,r){const{group:i,output:s,preagg:o}=n,{columns:a}=t,c=e.setSelect({...o,...a}).groupby(Object.keys(a)),[u]=c.subqueries;if(u){const g=Object.values(a).flatMap(m=>$0(m).map(b=>b.column));hU(u,g)}const l=c._having,h=c._orderby;c._having=[],c._orderby=[];const f=c.toString(),d=(rM(f)>>>0).toString(16),p=`${r}.preagg_${d}`,y=gt.select(i,s).from(p).groupby(i).having(l).orderby(h);return new pU({table:p,create:f,active:t,select:y})}function hU(e,t){const n=new Set,r=i=>{if(!n.has(i)){if(n.add(i),Tf(i)&&i._from.length&&(i.select(t),dU(i))){const s=new Set(i._groupby.flatMap(o=>o instanceof AI?[o.name]:[]));i.groupby(t.filter(o=>!s.has(o)))}i.subqueries.forEach(r)}};r(e)}function dU(e){return e._groupby.length>0||e._select.some(t=>us(t))}class pU{table;create;result;active;select;skip;constructor({table:t,create:n,active:r,select:i}){this.table=t,this.create=n,this.result=null,this.active=r,this.select=i,this.skip=!1}query(t){return this.select.clone().where(this.active.predicate(t))}}function k0(){return{debug(){},info(){},log(){},warn(){},error(){},group(){},groupCollapsed(){},groupEnd(){}}}const eo=Object.freeze({pending:Symbol("pending"),ready:Symbol("ready"),error:Symbol("error"),done:Symbol("done")});class B0 extends Promise{_resolve;_reject;_state;_value;constructor(){let t,n;super((r,i)=>{t=r,n=i}),this._resolve=t,this._reject=n,this._state=eo.pending,this._value=void 0}fulfill(t){if(this._value!==void 0){if(t!==void 0)throw Error("Promise is ready and fulfill has a provided value");this._resolve(this._value)}else{if(t===void 0)throw Error("Promise is neither ready nor has provided value");this._resolve(t)}return this._state=eo.done,this}ready(t){return this._state=eo.ready,this._value=t,this}reject(t){return this._state=eo.error,this._reject(t),this}get state(){return this._state}}B0.prototype.constructor=Promise;function yU(e){return typeof requestAnimationFrame<"u"?requestAnimationFrame(e):typeof setImmediate<"u"?setImmediate(e):setTimeout(e)}function mU(e,t){let n=[],r=0;function i(){const s=gU(n,t);n=[],r=0;for(const o of s)_U(o,e),xU(o,t)}return{add(s,o){s.request.type==="arrow"?(r||=yU(()=>i()),n.push({entry:s,priority:o,index:n.length})):e(s,o)}}}function gU(e,t){const n=[],r=new Map;for(const i of e){const{entry:{request:s}}=i,o=bU(s.query,t);if(!r.has(o)){const a=[];n.push(a),r.set(o,a)}r.get(o).push(i)}return n}function bU(e,t){const n=`${e}`;if(Tf(e)&&!t.get(n)){if(e._where.length||e._qualify.length||e._having.length||e._orderby.length||e._distinct)return n;const r=e.clone().setSelect("*"),i=e._groupby;if(i.length){const s={};e._select.forEach(({alias:o,expr:a})=>s[o]=a),r.setGroupby(i.map(o=>Sf(o)&&s[o.column]||o))}else e._select.some(s=>us(s.expr))&&r.setGroupby("ALL");return`${r}`}else return n}function _U(e,t){if(wU(e))t({request:{type:"arrow",cache:!1,query:e.query=vU(e)},result:e.result=new B0});else for(const{entry:n,priority:r}of e)t(n,r)}function wU(e){if(e.length>1){const t=`${e[0].entry.request.query}`;for(let n=1;n<e.length;++n)if(t!==`${e[n].entry.request.query}`)return!0}return!1}function vU(e){const t=e.maps=[],n=new Map;for(const s of e){const o=s.entry.request.query,a=[];t.push(a);for(const{alias:c,expr:u}of o._select){const l=`${u}`;n.has(l)||n.set(l,[`col${n.size}`,u]);const[h]=n.get(l);a.push([h,c])}}const r=e[0].entry.request.query.clone(),i=r._groupby;if(i.length){const s={};e.maps[0].forEach(([o,a])=>s[a]=o),r.setGroupby(i.map(o=>Sf(o)&&s[o.column]||o))}return r.setSelect(Array.from(n.values()))}async function xU(e,t){const{maps:n,query:r,result:i}=e;if(!n)return;let s;try{s=await i}catch(a){for(const{entry:c}of e)c.result.reject(a);return}const o=k9(r);e.forEach(({entry:a},c)=>{const{request:u,result:l}=a,h=n[c],f=o&&h?AU(s,h):h?SU(s,h):s;u.cache&&t.set(String(u.query),f),l.fulfill(f)})}function SU(e,t){return e.select(t.map(n=>n[0]),t.map(n=>n[1]))}function AU(e,t){const n=new Map(t),r=[];for(const i of e)n.has(i.column_name)&&r.push({...i,column_name:n.get(i.column_name)});return r}const IU=typeof requestIdleCallback<"u"?requestIdleCallback:setTimeout;function EU(){return{get:()=>{},set:(e,t)=>t,clear:()=>{}}}function MU({max:e=1e3,ttl:t=108e5}={}){let n=new Map;function r(){const i=performance.now()-t;let s=null,o=1/0;for(const[a,c]of n){const{last:u}=c;u<o&&(s=a,o=u),i>u&&n.delete(a)}s&&n.delete(s)}return{get(i){const s=n.get(i);if(s)return s.last=performance.now(),s.value},set(i,s){return n.set(i,{last:performance.now(),value:s}),n.size>e&&IU(r),s},clear(){n=new Map}}}class TU{queue;constructor(t){this.queue=Array.from({length:t},()=>({head:null,tail:null}))}isEmpty(){return this.queue.every(t=>!t.head)}insert(t,n){const r=this.queue[n];if(!r)throw new Error(`Invalid queue priority rank: ${n}`);const i={item:t,next:null};r.head===null?r.head=r.tail=i:r.tail=r.tail.next=i}remove(t){for(const n of this.queue){let{head:r,tail:i}=n;for(let s=null,o=r;o;s=o,o=o.next)t(o.item)&&(o===r?r=o.next:s.next=o.next,o===i&&(i=s||r));n.head=r,n.tail=i}}next(){for(const t of this.queue){const{head:n}=t;if(n!==null)return t.head=n.next,t.tail===n&&(t.tail=null),n.item}}}const no=Object.freeze({High:0,Normal:1,Low:2});class $U{queue;db;clientCache;_logger;_logQueries;_consolidate;pendingResults;maxConcurrentRequests;pendingExec;constructor(t=32){this.queue=new TU(3),this.db=null,this.clientCache=null,this._logger=k0(),this._logQueries=!1,this._consolidate=null,this.pendingResults=[],this.maxConcurrentRequests=t,this.pendingExec=!1}next(){if(this.queue.isEmpty()||this.pendingResults.length>this.maxConcurrentRequests||this.pendingExec)return;const t=this.queue.next();if(!t)return;const{request:n,result:r}=t;this.pendingResults.push(r),n.type==="exec"&&(this.pendingExec=!0),this.submit(n,r).finally(()=>{for(;this.pendingResults.length&&this.pendingResults[0].state!==eo.pending;){const i=this.pendingResults.shift();i.state===eo.ready?i.fulfill():i.state===eo.done&&this._logger.warn("Found resolved query in pending results.")}n.type==="exec"&&(this.pendingExec=!1),this.next()})}enqueue(t,n=no.Normal){this.queue.insert(t,n),this.next()}async submit(t,n){try{const{query:r,type:i,cache:s=!1,options:o}=t,a=r?`${r}`:null;if(s){const h=this.clientCache.get(a);if(h){const f=await h;this._logger.debug("Cache"),n.ready(f);return}}const c=performance.now();this._logQueries&&this._logger.debug("Query",{type:i,sql:a,...o});const u=this.db.query({type:i,sql:a,...o});s&&this.clientCache.set(a,u);const l=await u;s&&this.clientCache.set(a,l),this._logger.debug(`Request: ${(performance.now()-c).toFixed(1)}`),n.ready(i==="exec"?null:l)}catch(r){n.reject(r)}}cache(t){return t!==void 0?this.clientCache=t===!0?MU():t||EU():this.clientCache}logger(t){return t?this._logger=t:this._logger}logQueries(t){return t!==void 0?this._logQueries=!!t:this._logQueries}connector(t){return t?this.db=t:this.db}consolidate(t){t&&!this._consolidate?this._consolidate=mU(this.enqueue.bind(this),this.clientCache):!t&&this._consolidate&&(this._consolidate=null)}request(t,n=no.Normal){const r=new B0,i={request:t,result:r};return this._consolidate?this._consolidate.add(i,n):this.enqueue(i,n),r}cancel(t){const n=new Set(t);if(n.size){this.queue.remove(({result:r})=>n.has(r)?(r.reject("Canceled"),!0):!1);for(const r of this.pendingResults)n.has(r)&&r.reject("Canceled")}}clear(){this.queue.remove(({result:t})=>(t.reject("Cleared"),!0));for(const t of this.pendingResults)t.reject("Cleared");this.pendingResults=[]}}let jf;function ls(e){return e?jf=e:jf==null&&(jf=new P0),jf}class P0{manager;preaggregator;clients=new Set;filterGroups=new Map;_logger=k0();constructor(t=new _f,n={}){const{logger:r=console,manager:i=new $U,cache:s=!0,consolidate:o=!0,preagg:a={}}=n;this.manager=i,this.manager.cache(s),this.manager.consolidate(o),this.databaseConnector(t),this.logger(r),this.clear(),this.preaggregator=new aU(this,a)}clear(t={}){const{clients:n=!0,cache:r=!0}=t;this.manager.clear(),n&&(this.filterGroups?.forEach(i=>i.disconnect()),this.filterGroups=new Map,this.clients?.forEach(i=>this.disconnect(i)),this.clients=new Set),r&&this.manager.cache().clear()}databaseConnector(t){return t?this.manager.connector(t):this.manager.connector()}logger(t){return arguments.length&&(this._logger=t||k0(),this.manager.logger(this._logger)),this._logger}cancel(t){this.manager.cancel(t)}exec(t,n={}){const{priority:r=no.Normal}=n;return t=Array.isArray(t)?t.filter(i=>i).join(`;
`):t,this.manager.request({type:"exec",query:t},r)}query(t,n={}){const{type:r="arrow",cache:i=!0,priority:s=no.Normal,...o}=n;return this.manager.request({type:r,query:t,cache:i,options:o},s)}prefetch(t,n={}){return this.query(t,{...n,cache:!0,priority:no.Low})}updateClient(t,n,r=no.Normal){return t.queryPending(),t._pending=this.query(n,{priority:r}).then(i=>t.queryResult(i).update(),i=>{this._logger?.error(i),t.queryError(i)}).catch(i=>this._logger?.error(i))}requestQuery(t,n){return this.preaggregator.clear(),n?this.updateClient(t,n):Promise.resolve(t.update())}connect(t){const{clients:n}=this;if(n?.has(t))throw new Error("Client already connected.");n?.add(t),t.coordinator=this,t.initialize(),NU(this,t.filterBy,t)}disconnect(t){const{clients:n,filterGroups:r}=this;if(!n?.has(t))return;n.delete(t),t.coordinator=null;const i=r?.get(t.filterBy);i&&i.clients.delete(t)}}function NU(e,t,n){if(!t)return;let r=e.filterGroups?.get(t);if(!r){const i=o=>RU(e,t,o),s=()=>OU(e,t);t.addEventListener("activate",i),t.addEventListener("value",s),r={selection:t,clients:new Set,disconnect(){t.removeEventListener("activate",i),t.removeEventListener("value",s)}},e.filterGroups?.set(t,r)}r.clients.add(n)}function RU(e,t,n){const{preaggregator:r,filterGroups:i}=e,{clients:s}=i.get(t);for(const o of s)o.enabled&&r.request(o,t,n)}function OU(e,t){const{preaggregator:n,filterGroups:r}=e,{clients:i}=r.get(t),{active:s}=t;return Promise.allSettled(Array.from(i,o=>{if(!o.enabled)return o.requestQuery();const a=n.request(o,t,s),c=a?null:t.predicate(o);if(a?.skip||!a&&!c)return;const u=a?.query(s.predicate)??o.query(c);return e.updateClient(o,u)}))}function DU(e){const{coordinator:t=ls(),...n}=e,r=new LU(n);return t.connect(r),r}class LU extends qo{_methods;_filterStable;constructor({selection:t=void 0,enabled:n=!0,filterStable:r=!0,...i}){super(t),this.enabled=n,this._methods=i,this._filterStable=r}get filterStable(){return this._filterStable}async prepare(){await this._methods.prepare?.()}query(t){return this._methods.query?.(t)??null}queryResult(t){return this._methods.queryResult?.(t),this}queryPending(){return this._methods.queryPending?.(),this}queryError(t){return this._methods.queryError?.(t),this}}class FU{_callbacks;constructor(){this._callbacks=new Map}addEventListener(t,n){this._callbacks.has(t)||this._callbacks.set(t,{callbacks:new Set,pending:null,queue:new CU}),this._callbacks.get(t).callbacks.add(n)}removeEventListener(t,n){const r=this._callbacks.get(t);r&&r.callbacks.delete(n)}willEmit(t,n){return n}emitQueueFilter(t,n){return null}cancel(t){this._callbacks.get(t)?.queue.clear()}async pending(t){await this._callbacks.get(t)?.pending}emit(t,n){const r=this._callbacks.get(t)||{};if(r.pending)r.queue.enqueue(n,this.emitQueueFilter(t,n));else{const i=this.willEmit(t,n),{callbacks:s,queue:o}=r;if(s?.size){const a=Array.from(s,c=>c(i));r.pending=Promise.allSettled(a).then(()=>{r.pending=null,o.isEmpty()||this.emit(t,o.dequeue())})}}}}class CU{next=null;constructor(){this.clear()}clear(){this.next=null}isEmpty(){return!this.next}enqueue(t,n){const r={value:t};if(n&&this.next){let i=this;for(;i.next;)n(i.next.value)?i=i.next:i.next=i.next.next;i.next=r}else this.next=r}dequeue(){const{next:t}=this;return this.next=t?.next||null,t?.value}}function U0(e,t){return e===t?!1:e instanceof Date&&t instanceof Date?+e!=+t:Array.isArray(e)&&Array.isArray(t)?kU(e,t):!0}function kU(e,t){if(e.length!==t.length)return!0;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!0;return!1}function Sn(e){return e instanceof yi}class yi extends FU{_value;constructor(t){super(),this._value=t}static value(t){return new yi(t)}static array(t){if(t.some(n=>Sn(n))){const n=new yi,r=()=>{n.update(t.map(i=>Sn(i)?i.value:i))};return r(),t.forEach(i=>Sn(i)?i.addEventListener("value",r):0),n}return new yi(t)}get value(){return this._value}update(t,{force:n}={}){return U0(this._value,t)||n?this.emit("value",t):this.cancel("value"),this}willEmit(t,n){return t==="value"&&(this._value=n),n}}function An(e){return e instanceof ro}function Yf(e,t){return new ro(new hM(e),t?[t].flat():void 0)}let ro=class Ak extends yi{_resolved;_resolver;_relay;static intersect({cross:t=!1,empty:n=!1,include:r=[]}={}){return Yf({cross:t,empty:n},r)}static union({cross:t=!1,empty:n=!1,include:r=[]}={}){return Yf({cross:t,empty:n,union:!0},r)}static single({cross:t=!1,empty:n=!1,include:r=[]}={}){return Yf({cross:t,empty:n,single:!0},r)}static crossfilter({empty:t=!1,include:n=[]}={}){return Yf({cross:!0,empty:t},n)}constructor(t=new hM,n=[]){if(super([]),this._resolved=this._value,this._resolver=t,this._relay=new Set,Array.isArray(n))for(const r of n)r._relay.add(this)}clone(){const t=new Ak(this._resolver);return t._value=t._resolved=this._value,t}remove(t){const n=this.clone();return n._value=n._resolved=n._resolver.resolve(this._resolved,{source:t}),n._value.active={source:t},n}get resolver(){return this._resolver}get single(){return this._resolver.single}get clauses(){return super.value}get active(){return this.clauses.active}get value(){return this.active?.value}valueFor(t){return this.clauses.find(n=>n.source===t)?.value}activate(t){this.emit("activate",t),this._relay.forEach(n=>n.activate(t))}update(t){return this._resolved=this._resolver.resolve(this._resolved,t,!0),this._resolved.active=t,this._relay.forEach(n=>n.update(t)),super.update(this._resolved)}reset(t){return t??=this._resolved,t.forEach(n=>n.source?.reset?.()),this._resolved=this._resolved.filter(n=>t.includes(n)),this._relay.forEach(n=>n.reset(t)),super.update(this._resolved=[])}willEmit(t,n){return t==="value"?(this._value=n,this.value):n}emitQueueFilter(t,n){return t==="value"?this._resolver.queueFilter(n):null}skip(t,n){return this._resolver.skip(t,n)}predicate(t=void 0,n=!1){const{clauses:r}=this,i=n?null:r.active;return this._resolver.predicate(r,i,t)}};class hM{union;cross;single;empty;constructor({union:t,cross:n,single:r,empty:i}={}){this.union=!!t,this.cross=!!n,this.single=!!r,this.empty=!!i}resolve(t,n,r=!1){const{source:i,predicate:s}=n,o=t.filter(c=>i!==c.source),a=this.single?[]:o;return this.single&&r&&o.forEach(c=>c.source?.reset?.()),s&&a.push(n),a}skip(t,n){return t==null?!1:!!(this.cross&&n?.clients?.has(t))}predicate(t,n,r){const{empty:i,union:s}=this;if(i&&!t.length)return[hn(!1)];if(this.skip(r,n))return;const o=t.filter(a=>!this.skip(r,a)).map(a=>a.predicate);return s&&o.length>1?hi(o):o}queueFilter(t){if(this.cross){const n=t.active?.source;return r=>r.active?.source!==n}return null}}function dM(e){return new z0(e)}class z0{_uri;_ipc;constructor({uri:t="http://localhost:3000/",ipc:n=void 0}={}){this._uri=t,this._ipc=n}async query(t){const n=fetch(this._uri,{method:"POST",mode:"cors",cache:"no-cache",credentials:"omit",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),r=await n;if(!r.ok)throw new Error(`Query failed with HTTP status ${r.status}: ${await r.text()}`);return t.type==="exec"?n:t.type==="arrow"?Fc(await r.arrayBuffer(),this._ipc):r.json()}}function _t(e,t,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(l){try{u(r.next(l))}catch(h){o(h)}}function c(l){try{u(r.throw(l))}catch(h){o(h)}}function u(l){l.done?s(l.value):i(l.value).then(a,c)}u((r=r.apply(e,t||[])).next())})}function pM(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function xt(e){return this instanceof xt?(this.v=e,this):new xt(e)}function Or(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(e,t||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(d){return function(p){return Promise.resolve(p).then(d,h)}}function a(d,p){r[d]&&(i[d]=function(y){return new Promise(function(g,m){s.push([d,y,g,m])>1||c(d,y)})},p&&(i[d]=p(i[d])))}function c(d,p){try{u(r[d](p))}catch(y){f(s[0][3],y)}}function u(d){d.value instanceof xt?Promise.resolve(d.value.v).then(l,h):f(s[0][2],d)}function l(d){c("next",d)}function h(d){c("throw",d)}function f(d,p){d(p),s.shift(),s.length&&c(s[0][0],s[0][1])}}function Vf(e){var t,n;return t={},r("next"),r("throw",function(i){throw i}),r("return"),t[Symbol.iterator]=function(){return this},t;function r(i,s){t[i]=e[i]?function(o){return(n=!n)?{value:xt(e[i](o)),done:!1}:s?s(o):o}:s}}function io(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof pM=="function"?pM(e):e[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=e[s]&&function(o){return new Promise(function(a,c){o=e[s](o),i(a,c,o.done,o.value)})}}function i(s,o,a,c){Promise.resolve(c).then(function(u){s({value:u,done:a})},o)}}typeof SuppressedError=="function"&&SuppressedError;const BU=new TextDecoder("utf-8"),q0=e=>BU.decode(e),PU=new TextEncoder,j0=e=>PU.encode(e),UU=e=>typeof e=="number",yM=e=>typeof e=="boolean",Te=e=>typeof e=="function",yn=e=>e!=null&&Object(e)===e,so=e=>yn(e)&&Te(e.then),eu=e=>yn(e)&&Te(e[Symbol.iterator]),Jo=e=>yn(e)&&Te(e[Symbol.asyncIterator]),Y0=e=>yn(e)&&yn(e.schema),mM=e=>yn(e)&&"done"in e&&"value"in e,gM=e=>yn(e)&&Te(e.stat)&&UU(e.fd),bM=e=>yn(e)&&V0(e.body),Wf=e=>"_getDOMStream"in e&&"_getNodeStream"in e,zU=e=>yn(e)&&Te(e.abort)&&Te(e.getWriter)&&!Wf(e),V0=e=>yn(e)&&Te(e.cancel)&&Te(e.getReader)&&!Wf(e),qU=e=>yn(e)&&Te(e.end)&&Te(e.write)&&yM(e.writable)&&!Wf(e),_M=e=>yn(e)&&Te(e.read)&&Te(e.pipe)&&yM(e.readable)&&!Wf(e),jU=e=>yn(e)&&Te(e.clear)&&Te(e.bytes)&&Te(e.position)&&Te(e.setPosition)&&Te(e.capacity)&&Te(e.getBufferIdentifier)&&Te(e.createLong),W0=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:ArrayBuffer;function YU(e){const t=e[0]?[e[0]]:[];let n,r,i,s;for(let o,a,c=0,u=0,l=e.length;++c<l;){if(o=t[u],a=e[c],!o||!a||o.buffer!==a.buffer||a.byteOffset<o.byteOffset){a&&(t[++u]=a);continue}if({byteOffset:n,byteLength:i}=o,{byteOffset:r,byteLength:s}=a,n+i<r||r+s<n){a&&(t[++u]=a);continue}t[u]=new Uint8Array(o.buffer,n,r-n+s)}return t}function wM(e,t,n=0,r=t.byteLength){const i=e.byteLength,s=new Uint8Array(e.buffer,e.byteOffset,i),o=new Uint8Array(t.buffer,t.byteOffset,Math.min(r,i));return s.set(o,n),e}function Dr(e,t){const n=YU(e),r=n.reduce((l,h)=>l+h.byteLength,0);let i,s,o,a=0,c=-1;const u=Math.min(t||Number.POSITIVE_INFINITY,r);for(const l=n.length;++c<l;){if(i=n[c],s=i.subarray(0,Math.min(i.length,u-a)),u<=a+s.length){s.length<i.length?n[c]=i.subarray(s.length):s.length===i.length&&c++,o?wM(o,s,a):o=s;break}wM(o||(o=new Uint8Array(u)),s,a),a+=s.length}return[o||new Uint8Array(0),n.slice(c),r-(o?o.byteLength:0)]}function Yt(e,t){let n=mM(t)?t.value:t;return n instanceof e?e===Uint8Array?new e(n.buffer,n.byteOffset,n.byteLength):n:n?(typeof n=="string"&&(n=j0(n)),n instanceof ArrayBuffer?new e(n):n instanceof W0?new e(n):jU(n)?Yt(e,n.bytes()):ArrayBuffer.isView(n)?n.byteLength<=0?new e(0):new e(n.buffer,n.byteOffset,n.byteLength/e.BYTES_PER_ELEMENT):e.from(n)):new e(0)}const nu=e=>Yt(Int32Array,e),vM=e=>Yt(BigInt64Array,e),Rt=e=>Yt(Uint8Array,e),G0=e=>(e.next(),e);function*VU(e,t){const n=function*(i){yield i},r=typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof W0?n(t):eu(t)?t:n(t);return yield*G0((function*(i){let s=null;do s=i.next(yield Yt(e,s));while(!s.done)})(r[Symbol.iterator]())),new e}const WU=e=>VU(Uint8Array,e);function xM(e,t){return Or(this,arguments,function*(){if(so(t))return yield xt(yield xt(yield*Vf(io(xM(e,yield xt(t))))));const r=function(o){return Or(this,arguments,function*(){yield yield xt(yield xt(o))})},i=function(o){return Or(this,arguments,function*(){yield xt(yield*Vf(io(G0((function*(a){let c=null;do c=a.next(yield c?.value);while(!c.done)})(o[Symbol.iterator]())))))})},s=typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof W0?r(t):eu(t)?i(t):Jo(t)?t:r(t);return yield xt(yield*Vf(io(G0((function(o){return Or(this,arguments,function*(){let a=null;do a=yield xt(o.next(yield yield xt(Yt(e,a))));while(!a.done)})})(s[Symbol.asyncIterator]()))))),yield xt(new e)})}const GU=e=>xM(Uint8Array,e);function SM(e,t,n){if(e!==0){n=n.slice(0,t);for(let r=-1,i=n.length;++r<i;)n[r]+=e}return n.subarray(0,t)}function XU(e,t){let n=0;const r=e.length;if(r!==t.length)return!1;if(r>0)do if(e[n]!==t[n])return!1;while(++n<r);return!0}const qn={fromIterable(e){return Gf(HU(e))},fromAsyncIterable(e){return Gf(QU(e))},fromDOMStream(e){return Gf(JU(e))},fromNodeStream(e){return Gf(ZU(e))},toDOMStream(e,t){throw new Error('"toDOMStream" not available in this environment')},toNodeStream(e,t){throw new Error('"toNodeStream" not available in this environment')}},Gf=e=>(e.next(),e);function*HU(e){let t,n=!1,r=[],i,s,o,a=0;function c(){return s==="peek"?Dr(r,o)[0]:([i,r,a]=Dr(r,o),i)}({cmd:s,size:o}=(yield null)||{cmd:"read",size:0});const u=WU(e)[Symbol.iterator]();try{do if({done:t,value:i}=Number.isNaN(o-a)?u.next():u.next(o-a),!t&&i.byteLength>0&&(r.push(i),a+=i.byteLength),t||o<=a)do({cmd:s,size:o}=yield c());while(o<a);while(!t)}catch(l){(n=!0)&&typeof u.throw=="function"&&u.throw(l)}finally{n===!1&&typeof u.return=="function"&&u.return(null)}return null}function QU(e){return Or(this,arguments,function*(){let n,r=!1,i=[],s,o,a,c=0;function u(){return o==="peek"?Dr(i,a)[0]:([s,i,c]=Dr(i,a),s)}({cmd:o,size:a}=(yield yield xt(null))||{cmd:"read",size:0});const l=GU(e)[Symbol.asyncIterator]();try{do if({done:n,value:s}=Number.isNaN(a-c)?yield xt(l.next()):yield xt(l.next(a-c)),!n&&s.byteLength>0&&(i.push(s),c+=s.byteLength),n||a<=c)do({cmd:o,size:a}=yield yield xt(u()));while(a<c);while(!n)}catch(h){(r=!0)&&typeof l.throw=="function"&&(yield xt(l.throw(h)))}finally{r===!1&&typeof l.return=="function"&&(yield xt(l.return(new Uint8Array(0))))}return yield xt(null)})}function JU(e){return Or(this,arguments,function*(){let n=!1,r=!1,i=[],s,o,a,c=0;function u(){return o==="peek"?Dr(i,a)[0]:([s,i,c]=Dr(i,a),s)}({cmd:o,size:a}=(yield yield xt(null))||{cmd:"read",size:0});const l=new KU(e);try{do if({done:n,value:s}=Number.isNaN(a-c)?yield xt(l.read()):yield xt(l.read(a-c)),!n&&s.byteLength>0&&(i.push(Rt(s)),c+=s.byteLength),n||a<=c)do({cmd:o,size:a}=yield yield xt(u()));while(a<c);while(!n)}catch(h){(r=!0)&&(yield xt(l.cancel(h)))}finally{r===!1?yield xt(l.cancel()):e.locked&&l.releaseLock()}return yield xt(null)})}class KU{constructor(t){this.source=t,this.reader=null,this.reader=this.source.getReader(),this.reader.closed.catch(()=>{})}get closed(){return this.reader?this.reader.closed.catch(()=>{}):Promise.resolve()}releaseLock(){this.reader&&this.reader.releaseLock(),this.reader=null}cancel(t){return _t(this,void 0,void 0,function*(){const{reader:n,source:r}=this;n&&(yield n.cancel(t).catch(()=>{})),r&&r.locked&&this.releaseLock()})}read(t){return _t(this,void 0,void 0,function*(){if(t===0)return{done:this.reader==null,value:new Uint8Array(0)};const n=yield this.reader.read();return!n.done&&(n.value=Rt(n)),n})}}const X0=(e,t)=>{const n=i=>r([t,i]);let r;return[t,n,new Promise(i=>(r=i)&&e.once(t,n))]};function ZU(e){return Or(this,arguments,function*(){const n=[];let r="error",i=!1,s=null,o,a,c=0,u=[],l;function h(){return o==="peek"?Dr(u,a)[0]:([l,u,c]=Dr(u,a),l)}if({cmd:o,size:a}=(yield yield xt(null))||{cmd:"read",size:0},e.isTTY)return yield yield xt(new Uint8Array(0)),yield xt(null);try{n[0]=X0(e,"end"),n[1]=X0(e,"error");do{if(n[2]=X0(e,"readable"),[r,s]=yield xt(Promise.race(n.map(d=>d[2]))),r==="error")break;if((i=r==="end")||(Number.isFinite(a-c)?(l=Rt(e.read(a-c)),l.byteLength<a-c&&(l=Rt(e.read()))):l=Rt(e.read()),l.byteLength>0&&(u.push(l),c+=l.byteLength)),i||a<=c)do({cmd:o,size:a}=yield yield xt(h()));while(a<c)}while(!i)}finally{yield xt(f(n,r==="error"?s:null))}return yield xt(null);function f(d,p){return l=u=null,new Promise((y,g)=>{for(const[m,b]of d)e.off(m,b);try{const m=e.destroy;m&&m.call(e,p),p=void 0}catch(m){p=m||p}finally{p!=null?g(p):y()}})}})}var xe;(function(e){e[e.V1=0]="V1",e[e.V2=1]="V2",e[e.V3=2]="V3",e[e.V4=3]="V4",e[e.V5=4]="V5"})(xe||(xe={}));var Ve;(function(e){e[e.Sparse=0]="Sparse",e[e.Dense=1]="Dense"})(Ve||(Ve={}));var We;(function(e){e[e.HALF=0]="HALF",e[e.SINGLE=1]="SINGLE",e[e.DOUBLE=2]="DOUBLE"})(We||(We={}));var jn;(function(e){e[e.DAY=0]="DAY",e[e.MILLISECOND=1]="MILLISECOND"})(jn||(jn={}));var lt;(function(e){e[e.SECOND=0]="SECOND",e[e.MILLISECOND=1]="MILLISECOND",e[e.MICROSECOND=2]="MICROSECOND",e[e.NANOSECOND=3]="NANOSECOND"})(lt||(lt={}));var Lr;(function(e){e[e.YEAR_MONTH=0]="YEAR_MONTH",e[e.DAY_TIME=1]="DAY_TIME",e[e.MONTH_DAY_NANO=2]="MONTH_DAY_NANO"})(Lr||(Lr={}));const H0=2,Fr=4,mi=4,Ut=4,fs=new Int32Array(2),AM=new Float32Array(fs.buffer),IM=new Float64Array(fs.buffer),Xf=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1;var Q0;(function(e){e[e.UTF8_BYTES=1]="UTF8_BYTES",e[e.UTF16_STRING=2]="UTF16_STRING"})(Q0||(Q0={}));let Ko=class Ik{constructor(t){this.bytes_=t,this.position_=0,this.text_decoder_=new TextDecoder}static allocate(t){return new Ik(new Uint8Array(t))}clear(){this.position_=0}bytes(){return this.bytes_}position(){return this.position_}setPosition(t){this.position_=t}capacity(){return this.bytes_.length}readInt8(t){return this.readUint8(t)<<24>>24}readUint8(t){return this.bytes_[t]}readInt16(t){return this.readUint16(t)<<16>>16}readUint16(t){return this.bytes_[t]|this.bytes_[t+1]<<8}readInt32(t){return this.bytes_[t]|this.bytes_[t+1]<<8|this.bytes_[t+2]<<16|this.bytes_[t+3]<<24}readUint32(t){return this.readInt32(t)>>>0}readInt64(t){return BigInt.asIntN(64,BigInt(this.readUint32(t))+(BigInt(this.readUint32(t+4))<<BigInt(32)))}readUint64(t){return BigInt.asUintN(64,BigInt(this.readUint32(t))+(BigInt(this.readUint32(t+4))<<BigInt(32)))}readFloat32(t){return fs[0]=this.readInt32(t),AM[0]}readFloat64(t){return fs[Xf?0:1]=this.readInt32(t),fs[Xf?1:0]=this.readInt32(t+4),IM[0]}writeInt8(t,n){this.bytes_[t]=n}writeUint8(t,n){this.bytes_[t]=n}writeInt16(t,n){this.bytes_[t]=n,this.bytes_[t+1]=n>>8}writeUint16(t,n){this.bytes_[t]=n,this.bytes_[t+1]=n>>8}writeInt32(t,n){this.bytes_[t]=n,this.bytes_[t+1]=n>>8,this.bytes_[t+2]=n>>16,this.bytes_[t+3]=n>>24}writeUint32(t,n){this.bytes_[t]=n,this.bytes_[t+1]=n>>8,this.bytes_[t+2]=n>>16,this.bytes_[t+3]=n>>24}writeInt64(t,n){this.writeInt32(t,Number(BigInt.asIntN(32,n))),this.writeInt32(t+4,Number(BigInt.asIntN(32,n>>BigInt(32))))}writeUint64(t,n){this.writeUint32(t,Number(BigInt.asUintN(32,n))),this.writeUint32(t+4,Number(BigInt.asUintN(32,n>>BigInt(32))))}writeFloat32(t,n){AM[0]=n,this.writeInt32(t,fs[0])}writeFloat64(t,n){IM[0]=n,this.writeInt32(t,fs[Xf?0:1]),this.writeInt32(t+4,fs[Xf?1:0])}getBufferIdentifier(){if(this.bytes_.length<this.position_+Fr+mi)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");let t="";for(let n=0;n<mi;n++)t+=String.fromCharCode(this.readInt8(this.position_+Fr+n));return t}__offset(t,n){const r=t-this.readInt32(t);return n<this.readInt16(r)?this.readInt16(r+n):0}__union(t,n){return t.bb_pos=n+this.readInt32(n),t.bb=this,t}__string(t,n){t+=this.readInt32(t);const r=this.readInt32(t);t+=Fr;const i=this.bytes_.subarray(t,t+r);return n===Q0.UTF8_BYTES?i:this.text_decoder_.decode(i)}__union_with_string(t,n){return typeof t=="string"?this.__string(n):this.__union(t,n)}__indirect(t){return t+this.readInt32(t)}__vector(t){return t+this.readInt32(t)+Fr}__vector_len(t){return this.readInt32(t+this.readInt32(t))}__has_identifier(t){if(t.length!=mi)throw new Error("FlatBuffers: file identifier must be length "+mi);for(let n=0;n<mi;n++)if(t.charCodeAt(n)!=this.readInt8(this.position()+Fr+n))return!1;return!0}createScalarList(t,n){const r=[];for(let i=0;i<n;++i){const s=t(i);s!==null&&r.push(s)}return r}createObjList(t,n){const r=[];for(let i=0;i<n;++i){const s=t(i);s!==null&&r.push(s.unpack())}return r}},EM=class Ek{constructor(t){this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null,this.text_encoder=new TextEncoder;let n;t?n=t:n=1024,this.bb=Ko.allocate(n),this.space=n}clear(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null}forceDefaults(t){this.force_defaults=t}dataBuffer(){return this.bb}asUint8Array(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())}prep(t,n){t>this.minalign&&(this.minalign=t);const r=~(this.bb.capacity()-this.space+n)+1&t-1;for(;this.space<r+t+n;){const i=this.bb.capacity();this.bb=Ek.growByteBuffer(this.bb),this.space+=this.bb.capacity()-i}this.pad(r)}pad(t){for(let n=0;n<t;n++)this.bb.writeInt8(--this.space,0)}writeInt8(t){this.bb.writeInt8(this.space-=1,t)}writeInt16(t){this.bb.writeInt16(this.space-=2,t)}writeInt32(t){this.bb.writeInt32(this.space-=4,t)}writeInt64(t){this.bb.writeInt64(this.space-=8,t)}writeFloat32(t){this.bb.writeFloat32(this.space-=4,t)}writeFloat64(t){this.bb.writeFloat64(this.space-=8,t)}addInt8(t){this.prep(1,0),this.writeInt8(t)}addInt16(t){this.prep(2,0),this.writeInt16(t)}addInt32(t){this.prep(4,0),this.writeInt32(t)}addInt64(t){this.prep(8,0),this.writeInt64(t)}addFloat32(t){this.prep(4,0),this.writeFloat32(t)}addFloat64(t){this.prep(8,0),this.writeFloat64(t)}addFieldInt8(t,n,r){(this.force_defaults||n!=r)&&(this.addInt8(n),this.slot(t))}addFieldInt16(t,n,r){(this.force_defaults||n!=r)&&(this.addInt16(n),this.slot(t))}addFieldInt32(t,n,r){(this.force_defaults||n!=r)&&(this.addInt32(n),this.slot(t))}addFieldInt64(t,n,r){(this.force_defaults||n!==r)&&(this.addInt64(n),this.slot(t))}addFieldFloat32(t,n,r){(this.force_defaults||n!=r)&&(this.addFloat32(n),this.slot(t))}addFieldFloat64(t,n,r){(this.force_defaults||n!=r)&&(this.addFloat64(n),this.slot(t))}addFieldOffset(t,n,r){(this.force_defaults||n!=r)&&(this.addOffset(n),this.slot(t))}addFieldStruct(t,n,r){n!=r&&(this.nested(n),this.slot(t))}nested(t){if(t!=this.offset())throw new TypeError("FlatBuffers: struct must be serialized inline.")}notNested(){if(this.isNested)throw new TypeError("FlatBuffers: object serialization must not be nested.")}slot(t){this.vtable!==null&&(this.vtable[t]=this.offset())}offset(){return this.bb.capacity()-this.space}static growByteBuffer(t){const n=t.capacity();if(n&3221225472)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");const r=n<<1,i=Ko.allocate(r);return i.setPosition(r-n),i.bytes().set(t.bytes(),r-n),i}addOffset(t){this.prep(Fr,0),this.writeInt32(this.offset()-t+Fr)}startObject(t){this.notNested(),this.vtable==null&&(this.vtable=[]),this.vtable_in_use=t;for(let n=0;n<t;n++)this.vtable[n]=0;this.isNested=!0,this.object_start=this.offset()}endObject(){if(this.vtable==null||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);const t=this.offset();let n=this.vtable_in_use-1;for(;n>=0&&this.vtable[n]==0;n--);const r=n+1;for(;n>=0;n--)this.addInt16(this.vtable[n]!=0?t-this.vtable[n]:0);const i=2;this.addInt16(t-this.object_start);const s=(r+i)*H0;this.addInt16(s);let o=0;const a=this.space;t:for(n=0;n<this.vtables.length;n++){const c=this.bb.capacity()-this.vtables[n];if(s==this.bb.readInt16(c)){for(let u=H0;u<s;u+=H0)if(this.bb.readInt16(a+u)!=this.bb.readInt16(c+u))continue t;o=this.vtables[n];break}}return o?(this.space=this.bb.capacity()-t,this.bb.writeInt32(this.space,o-t)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-t,this.offset()-t)),this.isNested=!1,t}finish(t,n,r){const i=r?Ut:0;if(n){const s=n;if(this.prep(this.minalign,Fr+mi+i),s.length!=mi)throw new TypeError("FlatBuffers: file identifier must be length "+mi);for(let o=mi-1;o>=0;o--)this.writeInt8(s.charCodeAt(o))}this.prep(this.minalign,Fr+i),this.addOffset(t),i&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)}finishSizePrefixed(t,n){this.finish(t,n,!0)}requiredField(t,n){const r=this.bb.capacity()-t,i=r-this.bb.readInt32(r);if(!(n<this.bb.readInt16(i)&&this.bb.readInt16(i+n)!=0))throw new TypeError("FlatBuffers: field "+n+" must be set")}startVector(t,n,r){this.notNested(),this.vector_num_elems=n,this.prep(Fr,t*n),this.prep(r,t*n)}endVector(){return this.writeInt32(this.vector_num_elems),this.offset()}createSharedString(t){if(!t)return 0;if(this.string_maps||(this.string_maps=new Map),this.string_maps.has(t))return this.string_maps.get(t);const n=this.createString(t);return this.string_maps.set(t,n),n}createString(t){if(t==null)return 0;let n;return t instanceof Uint8Array?n=t:n=this.text_encoder.encode(t),this.addInt8(0),this.startVector(1,n.length,1),this.bb.setPosition(this.space-=n.length),this.bb.bytes().set(n,this.space),this.endVector()}createByteVector(t){return t==null?0:(this.startVector(1,t.length,1),this.bb.setPosition(this.space-=t.length),this.bb.bytes().set(t,this.space),this.endVector())}createObjectOffset(t){return t===null?0:typeof t=="string"?this.createString(t):t.pack(this)}createObjectOffsetList(t){const n=[];for(let r=0;r<t.length;++r){const i=t[r];if(i!==null)n.push(this.createObjectOffset(i));else throw new TypeError("FlatBuffers: Argument for createObjectOffsetList cannot contain null.")}return n}createStructOffsetList(t,n){return n(this,t.length),this.createObjectOffsetList(t.slice().reverse()),this.endVector()}};var Hf;(function(e){e[e.BUFFER=0]="BUFFER"})(Hf||(Hf={}));var Qf;(function(e){e[e.LZ4_FRAME=0]="LZ4_FRAME",e[e.ZSTD=1]="ZSTD"})(Qf||(Qf={}));class hs{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsBodyCompression(t,n){return(n||new hs).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBodyCompression(t,n){return t.setPosition(t.position()+Ut),(n||new hs).__init(t.readInt32(t.position())+t.position(),t)}codec(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt8(this.bb_pos+t):Qf.LZ4_FRAME}method(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt8(this.bb_pos+t):Hf.BUFFER}static startBodyCompression(t){t.startObject(2)}static addCodec(t,n){t.addFieldInt8(0,n,Qf.LZ4_FRAME)}static addMethod(t,n){t.addFieldInt8(1,n,Hf.BUFFER)}static endBodyCompression(t){return t.endObject()}static createBodyCompression(t,n,r){return hs.startBodyCompression(t),hs.addCodec(t,n),hs.addMethod(t,r),hs.endBodyCompression(t)}}class MM{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}offset(){return this.bb.readInt64(this.bb_pos)}length(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createBuffer(t,n,r){return t.prep(8,16),t.writeInt64(BigInt(r??0)),t.writeInt64(BigInt(n??0)),t.offset()}}let TM=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}length(){return this.bb.readInt64(this.bb_pos)}nullCount(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createFieldNode(t,n,r){return t.prep(8,16),t.writeInt64(BigInt(r??0)),t.writeInt64(BigInt(n??0)),t.offset()}},gi=class m3{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsRecordBatch(t,n){return(n||new m3).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsRecordBatch(t,n){return t.setPosition(t.position()+Ut),(n||new m3).__init(t.readInt32(t.position())+t.position(),t)}length(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):BigInt("0")}nodes(t,n){const r=this.bb.__offset(this.bb_pos,6);return r?(n||new TM).__init(this.bb.__vector(this.bb_pos+r)+t*16,this.bb):null}nodesLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}buffers(t,n){const r=this.bb.__offset(this.bb_pos,8);return r?(n||new MM).__init(this.bb.__vector(this.bb_pos+r)+t*16,this.bb):null}buffersLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}compression(t){const n=this.bb.__offset(this.bb_pos,10);return n?(t||new hs).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null}static startRecordBatch(t){t.startObject(4)}static addLength(t,n){t.addFieldInt64(0,n,BigInt("0"))}static addNodes(t,n){t.addFieldOffset(1,n,0)}static startNodesVector(t,n){t.startVector(16,n,8)}static addBuffers(t,n){t.addFieldOffset(2,n,0)}static startBuffersVector(t,n){t.startVector(16,n,8)}static addCompression(t,n){t.addFieldOffset(3,n,0)}static endRecordBatch(t){return t.endObject()}},Zo=class g3{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsDictionaryBatch(t,n){return(n||new g3).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDictionaryBatch(t,n){return t.setPosition(t.position()+Ut),(n||new g3).__init(t.readInt32(t.position())+t.position(),t)}id(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):BigInt("0")}data(t){const n=this.bb.__offset(this.bb_pos,6);return n?(t||new gi).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null}isDelta(){const t=this.bb.__offset(this.bb_pos,8);return t?!!this.bb.readInt8(this.bb_pos+t):!1}static startDictionaryBatch(t){t.startObject(3)}static addId(t,n){t.addFieldInt64(0,n,BigInt("0"))}static addData(t,n){t.addFieldOffset(1,n,0)}static addIsDelta(t,n){t.addFieldInt8(2,+n,0)}static endDictionaryBatch(t){return t.endObject()}};var ta;(function(e){e[e.Little=0]="Little",e[e.Big=1]="Big"})(ta||(ta={}));var Jf;(function(e){e[e.DenseArray=0]="DenseArray"})(Jf||(Jf={}));class In{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsInt(t,n){return(n||new In).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsInt(t,n){return t.setPosition(t.position()+Ut),(n||new In).__init(t.readInt32(t.position())+t.position(),t)}bitWidth(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}isSigned(){const t=this.bb.__offset(this.bb_pos,6);return t?!!this.bb.readInt8(this.bb_pos+t):!1}static startInt(t){t.startObject(2)}static addBitWidth(t,n){t.addFieldInt32(0,n,0)}static addIsSigned(t,n){t.addFieldInt8(1,+n,0)}static endInt(t){return t.endObject()}static createInt(t,n,r){return In.startInt(t),In.addBitWidth(t,n),In.addIsSigned(t,r),In.endInt(t)}}class bi{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsDictionaryEncoding(t,n){return(n||new bi).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDictionaryEncoding(t,n){return t.setPosition(t.position()+Ut),(n||new bi).__init(t.readInt32(t.position())+t.position(),t)}id(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):BigInt("0")}indexType(t){const n=this.bb.__offset(this.bb_pos,6);return n?(t||new In).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null}isOrdered(){const t=this.bb.__offset(this.bb_pos,8);return t?!!this.bb.readInt8(this.bb_pos+t):!1}dictionaryKind(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt16(this.bb_pos+t):Jf.DenseArray}static startDictionaryEncoding(t){t.startObject(4)}static addId(t,n){t.addFieldInt64(0,n,BigInt("0"))}static addIndexType(t,n){t.addFieldOffset(1,n,0)}static addIsOrdered(t,n){t.addFieldInt8(2,+n,0)}static addDictionaryKind(t,n){t.addFieldInt16(3,n,Jf.DenseArray)}static endDictionaryEncoding(t){return t.endObject()}}class $e{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsKeyValue(t,n){return(n||new $e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsKeyValue(t,n){return t.setPosition(t.position()+Ut),(n||new $e).__init(t.readInt32(t.position())+t.position(),t)}key(t){const n=this.bb.__offset(this.bb_pos,4);return n?this.bb.__string(this.bb_pos+n,t):null}value(t){const n=this.bb.__offset(this.bb_pos,6);return n?this.bb.__string(this.bb_pos+n,t):null}static startKeyValue(t){t.startObject(2)}static addKey(t,n){t.addFieldOffset(0,n,0)}static addValue(t,n){t.addFieldOffset(1,n,0)}static endKeyValue(t){return t.endObject()}static createKeyValue(t,n,r){return $e.startKeyValue(t),$e.addKey(t,n),$e.addValue(t,r),$e.endKeyValue(t)}}let $M=class rf{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsBinary(t,n){return(n||new rf).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBinary(t,n){return t.setPosition(t.position()+Ut),(n||new rf).__init(t.readInt32(t.position())+t.position(),t)}static startBinary(t){t.startObject(0)}static endBinary(t){return t.endObject()}static createBinary(t){return rf.startBinary(t),rf.endBinary(t)}},NM=class sf{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsBool(t,n){return(n||new sf).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBool(t,n){return t.setPosition(t.position()+Ut),(n||new sf).__init(t.readInt32(t.position())+t.position(),t)}static startBool(t){t.startObject(0)}static endBool(t){return t.endObject()}static createBool(t){return sf.startBool(t),sf.endBool(t)}},Kf=class Ic{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsDate(t,n){return(n||new Ic).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDate(t,n){return t.setPosition(t.position()+Ut),(n||new Ic).__init(t.readInt32(t.position())+t.position(),t)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):jn.MILLISECOND}static startDate(t){t.startObject(1)}static addUnit(t,n){t.addFieldInt16(0,n,jn.MILLISECOND)}static endDate(t){return t.endObject()}static createDate(t,n){return Ic.startDate(t),Ic.addUnit(t,n),Ic.endDate(t)}},ea=class Qs{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsDecimal(t,n){return(n||new Qs).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDecimal(t,n){return t.setPosition(t.position()+Ut),(n||new Qs).__init(t.readInt32(t.position())+t.position(),t)}precision(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}scale(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb_pos+t):0}bitWidth(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readInt32(this.bb_pos+t):128}static startDecimal(t){t.startObject(3)}static addPrecision(t,n){t.addFieldInt32(0,n,0)}static addScale(t,n){t.addFieldInt32(1,n,0)}static addBitWidth(t,n){t.addFieldInt32(2,n,128)}static endDecimal(t){return t.endObject()}static createDecimal(t,n,r,i){return Qs.startDecimal(t),Qs.addPrecision(t,n),Qs.addScale(t,r),Qs.addBitWidth(t,i),Qs.endDecimal(t)}},Zf=class Ec{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsDuration(t,n){return(n||new Ec).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDuration(t,n){return t.setPosition(t.position()+Ut),(n||new Ec).__init(t.readInt32(t.position())+t.position(),t)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):lt.MILLISECOND}static startDuration(t){t.startObject(1)}static addUnit(t,n){t.addFieldInt16(0,n,lt.MILLISECOND)}static endDuration(t){return t.endObject()}static createDuration(t,n){return Ec.startDuration(t),Ec.addUnit(t,n),Ec.endDuration(t)}},th=class Mc{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsFixedSizeBinary(t,n){return(n||new Mc).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFixedSizeBinary(t,n){return t.setPosition(t.position()+Ut),(n||new Mc).__init(t.readInt32(t.position())+t.position(),t)}byteWidth(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}static startFixedSizeBinary(t){t.startObject(1)}static addByteWidth(t,n){t.addFieldInt32(0,n,0)}static endFixedSizeBinary(t){return t.endObject()}static createFixedSizeBinary(t,n){return Mc.startFixedSizeBinary(t),Mc.addByteWidth(t,n),Mc.endFixedSizeBinary(t)}},eh=class Tc{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsFixedSizeList(t,n){return(n||new Tc).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFixedSizeList(t,n){return t.setPosition(t.position()+Ut),(n||new Tc).__init(t.readInt32(t.position())+t.position(),t)}listSize(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}static startFixedSizeList(t){t.startObject(1)}static addListSize(t,n){t.addFieldInt32(0,n,0)}static endFixedSizeList(t){return t.endObject()}static createFixedSizeList(t,n){return Tc.startFixedSizeList(t),Tc.addListSize(t,n),Tc.endFixedSizeList(t)}};class Cr{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsFloatingPoint(t,n){return(n||new Cr).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFloatingPoint(t,n){return t.setPosition(t.position()+Ut),(n||new Cr).__init(t.readInt32(t.position())+t.position(),t)}precision(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):We.HALF}static startFloatingPoint(t){t.startObject(1)}static addPrecision(t,n){t.addFieldInt16(0,n,We.HALF)}static endFloatingPoint(t){return t.endObject()}static createFloatingPoint(t,n){return Cr.startFloatingPoint(t),Cr.addPrecision(t,n),Cr.endFloatingPoint(t)}}class kr{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsInterval(t,n){return(n||new kr).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsInterval(t,n){return t.setPosition(t.position()+Ut),(n||new kr).__init(t.readInt32(t.position())+t.position(),t)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Lr.YEAR_MONTH}static startInterval(t){t.startObject(1)}static addUnit(t,n){t.addFieldInt16(0,n,Lr.YEAR_MONTH)}static endInterval(t){return t.endObject()}static createInterval(t,n){return kr.startInterval(t),kr.addUnit(t,n),kr.endInterval(t)}}let RM=class of{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsLargeBinary(t,n){return(n||new of).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsLargeBinary(t,n){return t.setPosition(t.position()+Ut),(n||new of).__init(t.readInt32(t.position())+t.position(),t)}static startLargeBinary(t){t.startObject(0)}static endLargeBinary(t){return t.endObject()}static createLargeBinary(t){return of.startLargeBinary(t),of.endLargeBinary(t)}},OM=class af{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsLargeUtf8(t,n){return(n||new af).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsLargeUtf8(t,n){return t.setPosition(t.position()+Ut),(n||new af).__init(t.readInt32(t.position())+t.position(),t)}static startLargeUtf8(t){t.startObject(0)}static endLargeUtf8(t){return t.endObject()}static createLargeUtf8(t){return af.startLargeUtf8(t),af.endLargeUtf8(t)}},DM=class cf{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsList(t,n){return(n||new cf).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsList(t,n){return t.setPosition(t.position()+Ut),(n||new cf).__init(t.readInt32(t.position())+t.position(),t)}static startList(t){t.startObject(0)}static endList(t){return t.endObject()}static createList(t){return cf.startList(t),cf.endList(t)}},nh=class $c{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsMap(t,n){return(n||new $c).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsMap(t,n){return t.setPosition(t.position()+Ut),(n||new $c).__init(t.readInt32(t.position())+t.position(),t)}keysSorted(){const t=this.bb.__offset(this.bb_pos,4);return t?!!this.bb.readInt8(this.bb_pos+t):!1}static startMap(t){t.startObject(1)}static addKeysSorted(t,n){t.addFieldInt8(0,+n,0)}static endMap(t){return t.endObject()}static createMap(t,n){return $c.startMap(t),$c.addKeysSorted(t,n),$c.endMap(t)}},LM=class uf{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsNull(t,n){return(n||new uf).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsNull(t,n){return t.setPosition(t.position()+Ut),(n||new uf).__init(t.readInt32(t.position())+t.position(),t)}static startNull(t){t.startObject(0)}static endNull(t){return t.endObject()}static createNull(t){return uf.startNull(t),uf.endNull(t)}};class oo{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsStruct_(t,n){return(n||new oo).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsStruct_(t,n){return t.setPosition(t.position()+Ut),(n||new oo).__init(t.readInt32(t.position())+t.position(),t)}static startStruct_(t){t.startObject(0)}static endStruct_(t){return t.endObject()}static createStruct_(t){return oo.startStruct_(t),oo.endStruct_(t)}}class Yn{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsTime(t,n){return(n||new Yn).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsTime(t,n){return t.setPosition(t.position()+Ut),(n||new Yn).__init(t.readInt32(t.position())+t.position(),t)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):lt.MILLISECOND}bitWidth(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb_pos+t):32}static startTime(t){t.startObject(2)}static addUnit(t,n){t.addFieldInt16(0,n,lt.MILLISECOND)}static addBitWidth(t,n){t.addFieldInt32(1,n,32)}static endTime(t){return t.endObject()}static createTime(t,n,r){return Yn.startTime(t),Yn.addUnit(t,n),Yn.addBitWidth(t,r),Yn.endTime(t)}}class Vn{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsTimestamp(t,n){return(n||new Vn).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsTimestamp(t,n){return t.setPosition(t.position()+Ut),(n||new Vn).__init(t.readInt32(t.position())+t.position(),t)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):lt.SECOND}timezone(t){const n=this.bb.__offset(this.bb_pos,6);return n?this.bb.__string(this.bb_pos+n,t):null}static startTimestamp(t){t.startObject(2)}static addUnit(t,n){t.addFieldInt16(0,n,lt.SECOND)}static addTimezone(t,n){t.addFieldOffset(1,n,0)}static endTimestamp(t){return t.endObject()}static createTimestamp(t,n,r){return Vn.startTimestamp(t),Vn.addUnit(t,n),Vn.addTimezone(t,r),Vn.endTimestamp(t)}}class mn{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsUnion(t,n){return(n||new mn).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsUnion(t,n){return t.setPosition(t.position()+Ut),(n||new mn).__init(t.readInt32(t.position())+t.position(),t)}mode(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Ve.Sparse}typeIds(t){const n=this.bb.__offset(this.bb_pos,6);return n?this.bb.readInt32(this.bb.__vector(this.bb_pos+n)+t*4):0}typeIdsLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}typeIdsArray(){const t=this.bb.__offset(this.bb_pos,6);return t?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}static startUnion(t){t.startObject(2)}static addMode(t,n){t.addFieldInt16(0,n,Ve.Sparse)}static addTypeIds(t,n){t.addFieldOffset(1,n,0)}static createTypeIdsVector(t,n){t.startVector(4,n.length,4);for(let r=n.length-1;r>=0;r--)t.addInt32(n[r]);return t.endVector()}static startTypeIdsVector(t,n){t.startVector(4,n,4)}static endUnion(t){return t.endObject()}static createUnion(t,n,r){return mn.startUnion(t),mn.addMode(t,n),mn.addTypeIds(t,r),mn.endUnion(t)}}let FM=class lf{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsUtf8(t,n){return(n||new lf).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsUtf8(t,n){return t.setPosition(t.position()+Ut),(n||new lf).__init(t.readInt32(t.position())+t.position(),t)}static startUtf8(t){t.startObject(0)}static endUtf8(t){return t.endObject()}static createUtf8(t){return lf.startUtf8(t),lf.endUtf8(t)}};var re;(function(e){e[e.NONE=0]="NONE",e[e.Null=1]="Null",e[e.Int=2]="Int",e[e.FloatingPoint=3]="FloatingPoint",e[e.Binary=4]="Binary",e[e.Utf8=5]="Utf8",e[e.Bool=6]="Bool",e[e.Decimal=7]="Decimal",e[e.Date=8]="Date",e[e.Time=9]="Time",e[e.Timestamp=10]="Timestamp",e[e.Interval=11]="Interval",e[e.List=12]="List",e[e.Struct_=13]="Struct_",e[e.Union=14]="Union",e[e.FixedSizeBinary=15]="FixedSizeBinary",e[e.FixedSizeList=16]="FixedSizeList",e[e.Map=17]="Map",e[e.Duration=18]="Duration",e[e.LargeBinary=19]="LargeBinary",e[e.LargeUtf8=20]="LargeUtf8",e[e.LargeList=21]="LargeList",e[e.RunEndEncoded=22]="RunEndEncoded"})(re||(re={}));let Wn=class Jy{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsField(t,n){return(n||new Jy).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsField(t,n){return t.setPosition(t.position()+Ut),(n||new Jy).__init(t.readInt32(t.position())+t.position(),t)}name(t){const n=this.bb.__offset(this.bb_pos,4);return n?this.bb.__string(this.bb_pos+n,t):null}nullable(){const t=this.bb.__offset(this.bb_pos,6);return t?!!this.bb.readInt8(this.bb_pos+t):!1}typeType(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readUint8(this.bb_pos+t):re.NONE}type(t){const n=this.bb.__offset(this.bb_pos,10);return n?this.bb.__union(t,this.bb_pos+n):null}dictionary(t){const n=this.bb.__offset(this.bb_pos,12);return n?(t||new bi).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null}children(t,n){const r=this.bb.__offset(this.bb_pos,14);return r?(n||new Jy).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+t*4),this.bb):null}childrenLength(){const t=this.bb.__offset(this.bb_pos,14);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,n){const r=this.bb.__offset(this.bb_pos,16);return r?(n||new $e).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+t*4),this.bb):null}customMetadataLength(){const t=this.bb.__offset(this.bb_pos,16);return t?this.bb.__vector_len(this.bb_pos+t):0}static startField(t){t.startObject(7)}static addName(t,n){t.addFieldOffset(0,n,0)}static addNullable(t,n){t.addFieldInt8(1,+n,0)}static addTypeType(t,n){t.addFieldInt8(2,n,re.NONE)}static addType(t,n){t.addFieldOffset(3,n,0)}static addDictionary(t,n){t.addFieldOffset(4,n,0)}static addChildren(t,n){t.addFieldOffset(5,n,0)}static createChildrenVector(t,n){t.startVector(4,n.length,4);for(let r=n.length-1;r>=0;r--)t.addOffset(n[r]);return t.endVector()}static startChildrenVector(t,n){t.startVector(4,n,4)}static addCustomMetadata(t,n){t.addFieldOffset(6,n,0)}static createCustomMetadataVector(t,n){t.startVector(4,n.length,4);for(let r=n.length-1;r>=0;r--)t.addOffset(n[r]);return t.endVector()}static startCustomMetadataVector(t,n){t.startVector(4,n,4)}static endField(t){return t.endObject()}},Br=class Zi{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsSchema(t,n){return(n||new Zi).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsSchema(t,n){return t.setPosition(t.position()+Ut),(n||new Zi).__init(t.readInt32(t.position())+t.position(),t)}endianness(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):ta.Little}fields(t,n){const r=this.bb.__offset(this.bb_pos,6);return r?(n||new Wn).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+t*4),this.bb):null}fieldsLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,n){const r=this.bb.__offset(this.bb_pos,8);return r?(n||new $e).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+t*4),this.bb):null}customMetadataLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}features(t){const n=this.bb.__offset(this.bb_pos,10);return n?this.bb.readInt64(this.bb.__vector(this.bb_pos+n)+t*8):BigInt(0)}featuresLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}static startSchema(t){t.startObject(4)}static addEndianness(t,n){t.addFieldInt16(0,n,ta.Little)}static addFields(t,n){t.addFieldOffset(1,n,0)}static createFieldsVector(t,n){t.startVector(4,n.length,4);for(let r=n.length-1;r>=0;r--)t.addOffset(n[r]);return t.endVector()}static startFieldsVector(t,n){t.startVector(4,n,4)}static addCustomMetadata(t,n){t.addFieldOffset(2,n,0)}static createCustomMetadataVector(t,n){t.startVector(4,n.length,4);for(let r=n.length-1;r>=0;r--)t.addOffset(n[r]);return t.endVector()}static startCustomMetadataVector(t,n){t.startVector(4,n,4)}static addFeatures(t,n){t.addFieldOffset(3,n,0)}static createFeaturesVector(t,n){t.startVector(8,n.length,8);for(let r=n.length-1;r>=0;r--)t.addInt64(n[r]);return t.endVector()}static startFeaturesVector(t,n){t.startVector(8,n,8)}static endSchema(t){return t.endObject()}static finishSchemaBuffer(t,n){t.finish(n)}static finishSizePrefixedSchemaBuffer(t,n){t.finish(n,void 0,!0)}static createSchema(t,n,r,i,s){return Zi.startSchema(t),Zi.addEndianness(t,n),Zi.addFields(t,r),Zi.addCustomMetadata(t,i),Zi.addFeatures(t,s),Zi.endSchema(t)}};var Ct;(function(e){e[e.NONE=0]="NONE",e[e.Schema=1]="Schema",e[e.DictionaryBatch=2]="DictionaryBatch",e[e.RecordBatch=3]="RecordBatch",e[e.Tensor=4]="Tensor",e[e.SparseTensor=5]="SparseTensor"})(Ct||(Ct={}));var O;(function(e){e[e.NONE=0]="NONE",e[e.Null=1]="Null",e[e.Int=2]="Int",e[e.Float=3]="Float",e[e.Binary=4]="Binary",e[e.Utf8=5]="Utf8",e[e.Bool=6]="Bool",e[e.Decimal=7]="Decimal",e[e.Date=8]="Date",e[e.Time=9]="Time",e[e.Timestamp=10]="Timestamp",e[e.Interval=11]="Interval",e[e.List=12]="List",e[e.Struct=13]="Struct",e[e.Union=14]="Union",e[e.FixedSizeBinary=15]="FixedSizeBinary",e[e.FixedSizeList=16]="FixedSizeList",e[e.Map=17]="Map",e[e.Duration=18]="Duration",e[e.LargeBinary=19]="LargeBinary",e[e.LargeUtf8=20]="LargeUtf8",e[e.Dictionary=-1]="Dictionary",e[e.Int8=-2]="Int8",e[e.Int16=-3]="Int16",e[e.Int32=-4]="Int32",e[e.Int64=-5]="Int64",e[e.Uint8=-6]="Uint8",e[e.Uint16=-7]="Uint16",e[e.Uint32=-8]="Uint32",e[e.Uint64=-9]="Uint64",e[e.Float16=-10]="Float16",e[e.Float32=-11]="Float32",e[e.Float64=-12]="Float64",e[e.DateDay=-13]="DateDay",e[e.DateMillisecond=-14]="DateMillisecond",e[e.TimestampSecond=-15]="TimestampSecond",e[e.TimestampMillisecond=-16]="TimestampMillisecond",e[e.TimestampMicrosecond=-17]="TimestampMicrosecond",e[e.TimestampNanosecond=-18]="TimestampNanosecond",e[e.TimeSecond=-19]="TimeSecond",e[e.TimeMillisecond=-20]="TimeMillisecond",e[e.TimeMicrosecond=-21]="TimeMicrosecond",e[e.TimeNanosecond=-22]="TimeNanosecond",e[e.DenseUnion=-23]="DenseUnion",e[e.SparseUnion=-24]="SparseUnion",e[e.IntervalDayTime=-25]="IntervalDayTime",e[e.IntervalYearMonth=-26]="IntervalYearMonth",e[e.DurationSecond=-27]="DurationSecond",e[e.DurationMillisecond=-28]="DurationMillisecond",e[e.DurationMicrosecond=-29]="DurationMicrosecond",e[e.DurationNanosecond=-30]="DurationNanosecond"})(O||(O={}));var _i;(function(e){e[e.OFFSET=0]="OFFSET",e[e.DATA=1]="DATA",e[e.VALIDITY=2]="VALIDITY",e[e.TYPE=3]="TYPE"})(_i||(_i={}));const tz=void 0;function ru(e){if(e===null)return"null";if(e===tz)return"undefined";switch(typeof e){case"number":return`${e}`;case"bigint":return`${e}`;case"string":return`"${e}"`}return typeof e[Symbol.toPrimitive]=="function"?e[Symbol.toPrimitive]("string"):ArrayBuffer.isView(e)?e instanceof BigInt64Array||e instanceof BigUint64Array?`[${[...e].map(t=>ru(t))}]`:`[${e}]`:ArrayBuffer.isView(e)?`[${e}]`:JSON.stringify(e,(t,n)=>typeof n=="bigint"?`${n}`:n)}function Qt(e){if(typeof e=="bigint"&&(e<Number.MIN_SAFE_INTEGER||e>Number.MAX_SAFE_INTEGER))throw new TypeError(`${e} is not safe to convert to a number.`);return Number(e)}function CM(e,t){return Qt(e/t)+Qt(e%t)/Qt(t)}const ez=Symbol.for("isArrowBigNum");function ur(e,...t){return t.length===0?Object.setPrototypeOf(Yt(this.TypedArray,e),this.constructor.prototype):Object.setPrototypeOf(new this.TypedArray(e,...t),this.constructor.prototype)}ur.prototype[ez]=!0,ur.prototype.toJSON=function(){return`"${su(this)}"`},ur.prototype.valueOf=function(e){return kM(this,e)},ur.prototype.toString=function(){return su(this)},ur.prototype[Symbol.toPrimitive]=function(e="default"){switch(e){case"number":return kM(this);case"string":return su(this);case"default":return rz(this)}return su(this)};function na(...e){return ur.apply(this,e)}function ra(...e){return ur.apply(this,e)}function iu(...e){return ur.apply(this,e)}Object.setPrototypeOf(na.prototype,Object.create(Int32Array.prototype)),Object.setPrototypeOf(ra.prototype,Object.create(Uint32Array.prototype)),Object.setPrototypeOf(iu.prototype,Object.create(Uint32Array.prototype)),Object.assign(na.prototype,ur.prototype,{constructor:na,signed:!0,TypedArray:Int32Array,BigIntArray:BigInt64Array}),Object.assign(ra.prototype,ur.prototype,{constructor:ra,signed:!1,TypedArray:Uint32Array,BigIntArray:BigUint64Array}),Object.assign(iu.prototype,ur.prototype,{constructor:iu,signed:!0,TypedArray:Uint32Array,BigIntArray:BigUint64Array});const nz=BigInt(4294967296)*BigInt(4294967296)-BigInt(1);function kM(e,t){const{buffer:n,byteOffset:r,byteLength:i,signed:s}=e,o=new BigUint64Array(n,r,i/8),a=s&&o.at(-1)&BigInt(1)<<BigInt(63);let c=BigInt(0),u=0;if(a){for(const l of o)c|=(l^nz)*(BigInt(1)<<BigInt(64*u++));c*=BigInt(-1),c-=BigInt(1)}else for(const l of o)c|=l*(BigInt(1)<<BigInt(64*u++));if(typeof t=="number"){const l=BigInt(Math.pow(10,t)),h=c/l,f=c%l;return Qt(h)+Qt(f)/Qt(l)}return Qt(c)}function su(e){if(e.byteLength===8)return`${new e.BigIntArray(e.buffer,e.byteOffset,1)[0]}`;if(!e.signed)return J0(e);let t=new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2);if(new Int16Array([t.at(-1)])[0]>=0)return J0(e);t=t.slice();let r=1;for(let s=0;s<t.length;s++){const o=t[s],a=~o+r;t[s]=a,r&=o===0?1:0}return`-${J0(t)}`}function rz(e){return e.byteLength===8?new e.BigIntArray(e.buffer,e.byteOffset,1)[0]:su(e)}function J0(e){let t="";const n=new Uint32Array(2);let r=new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2);const i=new Uint32Array((r=new Uint16Array(r).reverse()).buffer);let s=-1;const o=r.length-1;do{for(n[0]=r[s=0];s<o;)r[s++]=n[1]=n[0]/10,n[0]=(n[0]-n[1]*10<<16)+r[s];r[s]=n[1]=n[0]/10,n[0]=n[0]-n[1]*10,t=`${n[0]}${t}`}while(i[0]||i[1]||i[2]||i[3]);return t??"0"}class K0{static new(t,n){switch(n){case!0:return new na(t);case!1:return new ra(t)}switch(t.constructor){case Int8Array:case Int16Array:case Int32Array:case BigInt64Array:return new na(t)}return t.byteLength===16?new iu(t):new ra(t)}static signed(t){return new na(t)}static unsigned(t){return new ra(t)}static decimal(t){return new iu(t)}constructor(t,n){return K0.new(t,n)}}var BM,PM,UM,zM,qM,jM,YM,VM,WM,GM,XM,HM,QM,JM,KM,ZM,t6,e6,n6,r6,i6,s6;class Z{static isNull(t){return t?.typeId===O.Null}static isInt(t){return t?.typeId===O.Int}static isFloat(t){return t?.typeId===O.Float}static isBinary(t){return t?.typeId===O.Binary}static isLargeBinary(t){return t?.typeId===O.LargeBinary}static isUtf8(t){return t?.typeId===O.Utf8}static isLargeUtf8(t){return t?.typeId===O.LargeUtf8}static isBool(t){return t?.typeId===O.Bool}static isDecimal(t){return t?.typeId===O.Decimal}static isDate(t){return t?.typeId===O.Date}static isTime(t){return t?.typeId===O.Time}static isTimestamp(t){return t?.typeId===O.Timestamp}static isInterval(t){return t?.typeId===O.Interval}static isDuration(t){return t?.typeId===O.Duration}static isList(t){return t?.typeId===O.List}static isStruct(t){return t?.typeId===O.Struct}static isUnion(t){return t?.typeId===O.Union}static isFixedSizeBinary(t){return t?.typeId===O.FixedSizeBinary}static isFixedSizeList(t){return t?.typeId===O.FixedSizeList}static isMap(t){return t?.typeId===O.Map}static isDictionary(t){return t?.typeId===O.Dictionary}static isDenseUnion(t){return Z.isUnion(t)&&t.mode===Ve.Dense}static isSparseUnion(t){return Z.isUnion(t)&&t.mode===Ve.Sparse}constructor(t){this.typeId=t}}BM=Symbol.toStringTag,Z[BM]=(e=>(e.children=null,e.ArrayType=Array,e.OffsetArrayType=Int32Array,e[Symbol.toStringTag]="DataType"))(Z.prototype);class ds extends Z{constructor(){super(O.Null)}toString(){return"Null"}}PM=Symbol.toStringTag,ds[PM]=(e=>e[Symbol.toStringTag]="Null")(ds.prototype);class ao extends Z{constructor(t,n){super(O.Int),this.isSigned=t,this.bitWidth=n}get ArrayType(){switch(this.bitWidth){case 8:return this.isSigned?Int8Array:Uint8Array;case 16:return this.isSigned?Int16Array:Uint16Array;case 32:return this.isSigned?Int32Array:Uint32Array;case 64:return this.isSigned?BigInt64Array:BigUint64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}}UM=Symbol.toStringTag,ao[UM]=(e=>(e.isSigned=null,e.bitWidth=null,e[Symbol.toStringTag]="Int"))(ao.prototype);class ou extends ao{constructor(){super(!0,32)}get ArrayType(){return Int32Array}}Object.defineProperty(ou.prototype,"ArrayType",{value:Int32Array});class rh extends Z{constructor(t){super(O.Float),this.precision=t}get ArrayType(){switch(this.precision){case We.HALF:return Uint16Array;case We.SINGLE:return Float32Array;case We.DOUBLE:return Float64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`Float${this.precision<<5||16}`}}zM=Symbol.toStringTag,rh[zM]=(e=>(e.precision=null,e[Symbol.toStringTag]="Float"))(rh.prototype);class ih extends Z{constructor(){super(O.Binary)}toString(){return"Binary"}}qM=Symbol.toStringTag,ih[qM]=(e=>(e.ArrayType=Uint8Array,e[Symbol.toStringTag]="Binary"))(ih.prototype);class sh extends Z{constructor(){super(O.LargeBinary)}toString(){return"LargeBinary"}}jM=Symbol.toStringTag,sh[jM]=(e=>(e.ArrayType=Uint8Array,e.OffsetArrayType=BigInt64Array,e[Symbol.toStringTag]="LargeBinary"))(sh.prototype);class oh extends Z{constructor(){super(O.Utf8)}toString(){return"Utf8"}}YM=Symbol.toStringTag,oh[YM]=(e=>(e.ArrayType=Uint8Array,e[Symbol.toStringTag]="Utf8"))(oh.prototype);class ah extends Z{constructor(){super(O.LargeUtf8)}toString(){return"LargeUtf8"}}VM=Symbol.toStringTag,ah[VM]=(e=>(e.ArrayType=Uint8Array,e.OffsetArrayType=BigInt64Array,e[Symbol.toStringTag]="LargeUtf8"))(ah.prototype);class ch extends Z{constructor(){super(O.Bool)}toString(){return"Bool"}}WM=Symbol.toStringTag,ch[WM]=(e=>(e.ArrayType=Uint8Array,e[Symbol.toStringTag]="Bool"))(ch.prototype);class uh extends Z{constructor(t,n,r=128){super(O.Decimal),this.scale=t,this.precision=n,this.bitWidth=r}toString(){return`Decimal[${this.precision}e${this.scale>0?"+":""}${this.scale}]`}}GM=Symbol.toStringTag,uh[GM]=(e=>(e.scale=null,e.precision=null,e.ArrayType=Uint32Array,e[Symbol.toStringTag]="Decimal"))(uh.prototype);class lh extends Z{constructor(t){super(O.Date),this.unit=t}toString(){return`Date${(this.unit+1)*32}<${jn[this.unit]}>`}get ArrayType(){return this.unit===jn.DAY?Int32Array:BigInt64Array}}XM=Symbol.toStringTag,lh[XM]=(e=>(e.unit=null,e[Symbol.toStringTag]="Date"))(lh.prototype);class fh extends Z{constructor(t,n){super(O.Time),this.unit=t,this.bitWidth=n}toString(){return`Time${this.bitWidth}<${lt[this.unit]}>`}get ArrayType(){switch(this.bitWidth){case 32:return Int32Array;case 64:return BigInt64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}}HM=Symbol.toStringTag,fh[HM]=(e=>(e.unit=null,e.bitWidth=null,e[Symbol.toStringTag]="Time"))(fh.prototype);class hh extends Z{constructor(t,n){super(O.Timestamp),this.unit=t,this.timezone=n}toString(){return`Timestamp<${lt[this.unit]}${this.timezone?`, ${this.timezone}`:""}>`}}QM=Symbol.toStringTag,hh[QM]=(e=>(e.unit=null,e.timezone=null,e.ArrayType=BigInt64Array,e[Symbol.toStringTag]="Timestamp"))(hh.prototype);class dh extends Z{constructor(t){super(O.Interval),this.unit=t}toString(){return`Interval<${Lr[this.unit]}>`}}JM=Symbol.toStringTag,dh[JM]=(e=>(e.unit=null,e.ArrayType=Int32Array,e[Symbol.toStringTag]="Interval"))(dh.prototype);class ph extends Z{constructor(t){super(O.Duration),this.unit=t}toString(){return`Duration<${lt[this.unit]}>`}}KM=Symbol.toStringTag,ph[KM]=(e=>(e.unit=null,e.ArrayType=BigInt64Array,e[Symbol.toStringTag]="Duration"))(ph.prototype);class yh extends Z{constructor(t){super(O.List),this.children=[t]}toString(){return`List<${this.valueType}>`}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}}ZM=Symbol.toStringTag,yh[ZM]=(e=>(e.children=null,e[Symbol.toStringTag]="List"))(yh.prototype);class en extends Z{constructor(t){super(O.Struct),this.children=t}toString(){return`Struct<{${this.children.map(t=>`${t.name}:${t.type}`).join(", ")}}>`}}t6=Symbol.toStringTag,en[t6]=(e=>(e.children=null,e[Symbol.toStringTag]="Struct"))(en.prototype);class mh extends Z{constructor(t,n,r){super(O.Union),this.mode=t,this.children=r,this.typeIds=n=Int32Array.from(n),this.typeIdToChildIndex=n.reduce((i,s,o)=>(i[s]=o)&&i||i,Object.create(null))}toString(){return`${this[Symbol.toStringTag]}<${this.children.map(t=>`${t.type}`).join(" | ")}>`}}e6=Symbol.toStringTag,mh[e6]=(e=>(e.mode=null,e.typeIds=null,e.children=null,e.typeIdToChildIndex=null,e.ArrayType=Int8Array,e[Symbol.toStringTag]="Union"))(mh.prototype);class gh extends Z{constructor(t){super(O.FixedSizeBinary),this.byteWidth=t}toString(){return`FixedSizeBinary[${this.byteWidth}]`}}n6=Symbol.toStringTag,gh[n6]=(e=>(e.byteWidth=null,e.ArrayType=Uint8Array,e[Symbol.toStringTag]="FixedSizeBinary"))(gh.prototype);class bh extends Z{constructor(t,n){super(O.FixedSizeList),this.listSize=t,this.children=[n]}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}}r6=Symbol.toStringTag,bh[r6]=(e=>(e.children=null,e.listSize=null,e[Symbol.toStringTag]="FixedSizeList"))(bh.prototype);class _h extends Z{constructor(t,n=!1){var r,i,s;if(super(O.Map),this.children=[t],this.keysSorted=n,t&&(t.name="entries",!((r=t?.type)===null||r===void 0)&&r.children)){const o=(i=t?.type)===null||i===void 0?void 0:i.children[0];o&&(o.name="key");const a=(s=t?.type)===null||s===void 0?void 0:s.children[1];a&&(a.name="value")}}get keyType(){return this.children[0].type.children[0].type}get valueType(){return this.children[0].type.children[1].type}get childType(){return this.children[0].type}toString(){return`Map<{${this.children[0].type.children.map(t=>`${t.name}:${t.type}`).join(", ")}}>`}}i6=Symbol.toStringTag,_h[i6]=(e=>(e.children=null,e.keysSorted=null,e[Symbol.toStringTag]="Map_"))(_h.prototype);const iz=(e=>()=>++e)(-1);class ia extends Z{constructor(t,n,r,i){super(O.Dictionary),this.indices=n,this.dictionary=t,this.isOrdered=i||!1,this.id=r==null?iz():Qt(r)}get children(){return this.dictionary.children}get valueType(){return this.dictionary}get ArrayType(){return this.dictionary.ArrayType}toString(){return`Dictionary<${this.indices}, ${this.dictionary}>`}}s6=Symbol.toStringTag,ia[s6]=(e=>(e.id=null,e.indices=null,e.isOrdered=null,e.dictionary=null,e[Symbol.toStringTag]="Dictionary"))(ia.prototype);function wi(e){const t=e;switch(e.typeId){case O.Decimal:return e.bitWidth/32;case O.Interval:return 1+t.unit;case O.FixedSizeList:return t.listSize;case O.FixedSizeBinary:return t.byteWidth;default:return 1}}class At{visitMany(t,...n){return t.map((r,i)=>this.visit(r,...n.map(s=>s[i])))}visit(...t){return this.getVisitFn(t[0],!1).apply(this,t)}getVisitFn(t,n=!0){return sz(this,t,n)}getVisitFnByTypeId(t,n=!0){return sa(this,t,n)}visitNull(t,...n){return null}visitBool(t,...n){return null}visitInt(t,...n){return null}visitFloat(t,...n){return null}visitUtf8(t,...n){return null}visitLargeUtf8(t,...n){return null}visitBinary(t,...n){return null}visitLargeBinary(t,...n){return null}visitFixedSizeBinary(t,...n){return null}visitDate(t,...n){return null}visitTimestamp(t,...n){return null}visitTime(t,...n){return null}visitDecimal(t,...n){return null}visitList(t,...n){return null}visitStruct(t,...n){return null}visitUnion(t,...n){return null}visitDictionary(t,...n){return null}visitInterval(t,...n){return null}visitDuration(t,...n){return null}visitFixedSizeList(t,...n){return null}visitMap(t,...n){return null}}function sz(e,t,n=!0){return typeof t=="number"?sa(e,t,n):typeof t=="string"&&t in O?sa(e,O[t],n):t&&t instanceof Z?sa(e,o6(t),n):t?.type&&t.type instanceof Z?sa(e,o6(t.type),n):sa(e,O.NONE,n)}function sa(e,t,n=!0){let r=null;switch(t){case O.Null:r=e.visitNull;break;case O.Bool:r=e.visitBool;break;case O.Int:r=e.visitInt;break;case O.Int8:r=e.visitInt8||e.visitInt;break;case O.Int16:r=e.visitInt16||e.visitInt;break;case O.Int32:r=e.visitInt32||e.visitInt;break;case O.Int64:r=e.visitInt64||e.visitInt;break;case O.Uint8:r=e.visitUint8||e.visitInt;break;case O.Uint16:r=e.visitUint16||e.visitInt;break;case O.Uint32:r=e.visitUint32||e.visitInt;break;case O.Uint64:r=e.visitUint64||e.visitInt;break;case O.Float:r=e.visitFloat;break;case O.Float16:r=e.visitFloat16||e.visitFloat;break;case O.Float32:r=e.visitFloat32||e.visitFloat;break;case O.Float64:r=e.visitFloat64||e.visitFloat;break;case O.Utf8:r=e.visitUtf8;break;case O.LargeUtf8:r=e.visitLargeUtf8;break;case O.Binary:r=e.visitBinary;break;case O.LargeBinary:r=e.visitLargeBinary;break;case O.FixedSizeBinary:r=e.visitFixedSizeBinary;break;case O.Date:r=e.visitDate;break;case O.DateDay:r=e.visitDateDay||e.visitDate;break;case O.DateMillisecond:r=e.visitDateMillisecond||e.visitDate;break;case O.Timestamp:r=e.visitTimestamp;break;case O.TimestampSecond:r=e.visitTimestampSecond||e.visitTimestamp;break;case O.TimestampMillisecond:r=e.visitTimestampMillisecond||e.visitTimestamp;break;case O.TimestampMicrosecond:r=e.visitTimestampMicrosecond||e.visitTimestamp;break;case O.TimestampNanosecond:r=e.visitTimestampNanosecond||e.visitTimestamp;break;case O.Time:r=e.visitTime;break;case O.TimeSecond:r=e.visitTimeSecond||e.visitTime;break;case O.TimeMillisecond:r=e.visitTimeMillisecond||e.visitTime;break;case O.TimeMicrosecond:r=e.visitTimeMicrosecond||e.visitTime;break;case O.TimeNanosecond:r=e.visitTimeNanosecond||e.visitTime;break;case O.Decimal:r=e.visitDecimal;break;case O.List:r=e.visitList;break;case O.Struct:r=e.visitStruct;break;case O.Union:r=e.visitUnion;break;case O.DenseUnion:r=e.visitDenseUnion||e.visitUnion;break;case O.SparseUnion:r=e.visitSparseUnion||e.visitUnion;break;case O.Dictionary:r=e.visitDictionary;break;case O.Interval:r=e.visitInterval;break;case O.IntervalDayTime:r=e.visitIntervalDayTime||e.visitInterval;break;case O.IntervalYearMonth:r=e.visitIntervalYearMonth||e.visitInterval;break;case O.Duration:r=e.visitDuration;break;case O.DurationSecond:r=e.visitDurationSecond||e.visitDuration;break;case O.DurationMillisecond:r=e.visitDurationMillisecond||e.visitDuration;break;case O.DurationMicrosecond:r=e.visitDurationMicrosecond||e.visitDuration;break;case O.DurationNanosecond:r=e.visitDurationNanosecond||e.visitDuration;break;case O.FixedSizeList:r=e.visitFixedSizeList;break;case O.Map:r=e.visitMap;break}if(typeof r=="function")return r;if(!n)return()=>null;throw new Error(`Unrecognized type '${O[t]}'`)}function o6(e){switch(e.typeId){case O.Null:return O.Null;case O.Int:{const{bitWidth:t,isSigned:n}=e;switch(t){case 8:return n?O.Int8:O.Uint8;case 16:return n?O.Int16:O.Uint16;case 32:return n?O.Int32:O.Uint32;case 64:return n?O.Int64:O.Uint64}return O.Int}case O.Float:switch(e.precision){case We.HALF:return O.Float16;case We.SINGLE:return O.Float32;case We.DOUBLE:return O.Float64}return O.Float;case O.Binary:return O.Binary;case O.LargeBinary:return O.LargeBinary;case O.Utf8:return O.Utf8;case O.LargeUtf8:return O.LargeUtf8;case O.Bool:return O.Bool;case O.Decimal:return O.Decimal;case O.Time:switch(e.unit){case lt.SECOND:return O.TimeSecond;case lt.MILLISECOND:return O.TimeMillisecond;case lt.MICROSECOND:return O.TimeMicrosecond;case lt.NANOSECOND:return O.TimeNanosecond}return O.Time;case O.Timestamp:switch(e.unit){case lt.SECOND:return O.TimestampSecond;case lt.MILLISECOND:return O.TimestampMillisecond;case lt.MICROSECOND:return O.TimestampMicrosecond;case lt.NANOSECOND:return O.TimestampNanosecond}return O.Timestamp;case O.Date:switch(e.unit){case jn.DAY:return O.DateDay;case jn.MILLISECOND:return O.DateMillisecond}return O.Date;case O.Interval:switch(e.unit){case Lr.DAY_TIME:return O.IntervalDayTime;case Lr.YEAR_MONTH:return O.IntervalYearMonth}return O.Interval;case O.Duration:switch(e.unit){case lt.SECOND:return O.DurationSecond;case lt.MILLISECOND:return O.DurationMillisecond;case lt.MICROSECOND:return O.DurationMicrosecond;case lt.NANOSECOND:return O.DurationNanosecond}return O.Duration;case O.Map:return O.Map;case O.List:return O.List;case O.Struct:return O.Struct;case O.Union:switch(e.mode){case Ve.Dense:return O.DenseUnion;case Ve.Sparse:return O.SparseUnion}return O.Union;case O.FixedSizeBinary:return O.FixedSizeBinary;case O.FixedSizeList:return O.FixedSizeList;case O.Dictionary:return O.Dictionary}throw new Error(`Unrecognized type '${O[e.typeId]}'`)}At.prototype.visitInt8=null,At.prototype.visitInt16=null,At.prototype.visitInt32=null,At.prototype.visitInt64=null,At.prototype.visitUint8=null,At.prototype.visitUint16=null,At.prototype.visitUint32=null,At.prototype.visitUint64=null,At.prototype.visitFloat16=null,At.prototype.visitFloat32=null,At.prototype.visitFloat64=null,At.prototype.visitDateDay=null,At.prototype.visitDateMillisecond=null,At.prototype.visitTimestampSecond=null,At.prototype.visitTimestampMillisecond=null,At.prototype.visitTimestampMicrosecond=null,At.prototype.visitTimestampNanosecond=null,At.prototype.visitTimeSecond=null,At.prototype.visitTimeMillisecond=null,At.prototype.visitTimeMicrosecond=null,At.prototype.visitTimeNanosecond=null,At.prototype.visitDenseUnion=null,At.prototype.visitSparseUnion=null,At.prototype.visitIntervalDayTime=null,At.prototype.visitIntervalYearMonth=null,At.prototype.visitDuration=null,At.prototype.visitDurationSecond=null,At.prototype.visitDurationMillisecond=null,At.prototype.visitDurationMicrosecond=null,At.prototype.visitDurationNanosecond=null;const a6=new Float64Array(1),oa=new Uint32Array(a6.buffer);function c6(e){const t=(e&31744)>>10,n=(e&1023)/1024,r=Math.pow(-1,(e&32768)>>15);switch(t){case 31:return r*(n?Number.NaN:1/0);case 0:return r*(n?6103515625e-14*n:0)}return r*Math.pow(2,t-15)*(1+n)}function oz(e){if(e!==e)return 32256;a6[0]=e;const t=(oa[1]&2147483648)>>16&65535;let n=oa[1]&2146435072,r=0;return n>=1089470464?oa[0]>0?n=31744:(n=(n&2080374784)>>16,r=(oa[1]&1048575)>>10):n<=1056964608?(r=1048576+(oa[1]&1048575),r=1048576+(r<<(n>>20)-998)>>21,n=0):(n=n-1056964608>>10,r=(oa[1]&1048575)+512>>10),t|n|r&65535}class ft extends At{}function yt(e){return(t,n,r)=>{if(t.setValid(n,r!=null))return e(t,n,r)}}const az=(e,t,n)=>{e[t]=Math.floor(n/864e5)},u6=(e,t,n,r)=>{if(n+1<t.length){const i=Qt(t[n]),s=Qt(t[n+1]);e.set(r.subarray(0,s-i),i)}},cz=({offset:e,values:t},n,r)=>{const i=e+n;r?t[i>>3]|=1<<i%8:t[i>>3]&=~(1<<i%8)},vi=({values:e},t,n)=>{e[t]=n},Z0=({values:e},t,n)=>{e[t]=n},l6=({values:e},t,n)=>{e[t]=oz(n)},uz=(e,t,n)=>{switch(e.type.precision){case We.HALF:return l6(e,t,n);case We.SINGLE:case We.DOUBLE:return Z0(e,t,n)}},f6=({values:e},t,n)=>{az(e,t,n.valueOf())},h6=({values:e},t,n)=>{e[t]=BigInt(n)},lz=({stride:e,values:t},n,r)=>{t.set(r.subarray(0,e),e*n)},d6=({values:e,valueOffsets:t},n,r)=>u6(e,t,n,r),p6=({values:e,valueOffsets:t},n,r)=>u6(e,t,n,j0(r)),fz=(e,t,n)=>{e.type.unit===jn.DAY?f6(e,t,n):h6(e,t,n)},y6=({values:e},t,n)=>{e[t]=BigInt(n/1e3)},m6=({values:e},t,n)=>{e[t]=BigInt(n)},g6=({values:e},t,n)=>{e[t]=BigInt(n*1e3)},b6=({values:e},t,n)=>{e[t]=BigInt(n*1e6)},hz=(e,t,n)=>{switch(e.type.unit){case lt.SECOND:return y6(e,t,n);case lt.MILLISECOND:return m6(e,t,n);case lt.MICROSECOND:return g6(e,t,n);case lt.NANOSECOND:return b6(e,t,n)}},_6=({values:e},t,n)=>{e[t]=n},w6=({values:e},t,n)=>{e[t]=n},v6=({values:e},t,n)=>{e[t]=n},x6=({values:e},t,n)=>{e[t]=n},dz=(e,t,n)=>{switch(e.type.unit){case lt.SECOND:return _6(e,t,n);case lt.MILLISECOND:return w6(e,t,n);case lt.MICROSECOND:return v6(e,t,n);case lt.NANOSECOND:return x6(e,t,n)}},pz=({values:e,stride:t},n,r)=>{e.set(r.subarray(0,t),t*n)},yz=(e,t,n)=>{const r=e.children[0],i=e.valueOffsets,s=Gn.getVisitFn(r);if(Array.isArray(n))for(let o=-1,a=i[t],c=i[t+1];a<c;)s(r,a++,n[++o]);else for(let o=-1,a=i[t],c=i[t+1];a<c;)s(r,a++,n.get(++o))},mz=(e,t,n)=>{const r=e.children[0],{valueOffsets:i}=e,s=Gn.getVisitFn(r);let{[t]:o,[t+1]:a}=i;const c=n instanceof Map?n.entries():Object.entries(n);for(const u of c)if(s(r,o,u),++o>=a)break},gz=(e,t)=>(n,r,i,s)=>r&&n(r,e,t[s]),bz=(e,t)=>(n,r,i,s)=>r&&n(r,e,t.get(s)),_z=(e,t)=>(n,r,i,s)=>r&&n(r,e,t.get(i.name)),wz=(e,t)=>(n,r,i,s)=>r&&n(r,e,t[i.name]),vz=(e,t,n)=>{const r=e.type.children.map(s=>Gn.getVisitFn(s.type)),i=n instanceof Map?_z(t,n):n instanceof de?bz(t,n):Array.isArray(n)?gz(t,n):wz(t,n);e.type.children.forEach((s,o)=>i(r[o],e.children[o],s,o))},xz=(e,t,n)=>{e.type.mode===Ve.Dense?S6(e,t,n):A6(e,t,n)},S6=(e,t,n)=>{const r=e.type.typeIdToChildIndex[e.typeIds[t]],i=e.children[r];Gn.visit(i,e.valueOffsets[t],n)},A6=(e,t,n)=>{const r=e.type.typeIdToChildIndex[e.typeIds[t]],i=e.children[r];Gn.visit(i,t,n)},Sz=(e,t,n)=>{var r;(r=e.dictionary)===null||r===void 0||r.set(e.values[t],n)},Az=(e,t,n)=>{e.type.unit===Lr.DAY_TIME?I6(e,t,n):E6(e,t,n)},I6=({values:e},t,n)=>{e.set(n.subarray(0,2),2*t)},E6=({values:e},t,n)=>{e[t]=n[0]*12+n[1]%12},M6=({values:e},t,n)=>{e[t]=n},T6=({values:e},t,n)=>{e[t]=n},$6=({values:e},t,n)=>{e[t]=n},N6=({values:e},t,n)=>{e[t]=n},Iz=(e,t,n)=>{switch(e.type.unit){case lt.SECOND:return M6(e,t,n);case lt.MILLISECOND:return T6(e,t,n);case lt.MICROSECOND:return $6(e,t,n);case lt.NANOSECOND:return N6(e,t,n)}},Ez=(e,t,n)=>{const{stride:r}=e,i=e.children[0],s=Gn.getVisitFn(i);if(Array.isArray(n))for(let o=-1,a=t*r;++o<r;)s(i,a+o,n[o]);else for(let o=-1,a=t*r;++o<r;)s(i,a+o,n.get(o))};ft.prototype.visitBool=yt(cz),ft.prototype.visitInt=yt(vi),ft.prototype.visitInt8=yt(vi),ft.prototype.visitInt16=yt(vi),ft.prototype.visitInt32=yt(vi),ft.prototype.visitInt64=yt(vi),ft.prototype.visitUint8=yt(vi),ft.prototype.visitUint16=yt(vi),ft.prototype.visitUint32=yt(vi),ft.prototype.visitUint64=yt(vi),ft.prototype.visitFloat=yt(uz),ft.prototype.visitFloat16=yt(l6),ft.prototype.visitFloat32=yt(Z0),ft.prototype.visitFloat64=yt(Z0),ft.prototype.visitUtf8=yt(p6),ft.prototype.visitLargeUtf8=yt(p6),ft.prototype.visitBinary=yt(d6),ft.prototype.visitLargeBinary=yt(d6),ft.prototype.visitFixedSizeBinary=yt(lz),ft.prototype.visitDate=yt(fz),ft.prototype.visitDateDay=yt(f6),ft.prototype.visitDateMillisecond=yt(h6),ft.prototype.visitTimestamp=yt(hz),ft.prototype.visitTimestampSecond=yt(y6),ft.prototype.visitTimestampMillisecond=yt(m6),ft.prototype.visitTimestampMicrosecond=yt(g6),ft.prototype.visitTimestampNanosecond=yt(b6),ft.prototype.visitTime=yt(dz),ft.prototype.visitTimeSecond=yt(_6),ft.prototype.visitTimeMillisecond=yt(w6),ft.prototype.visitTimeMicrosecond=yt(v6),ft.prototype.visitTimeNanosecond=yt(x6),ft.prototype.visitDecimal=yt(pz),ft.prototype.visitList=yt(yz),ft.prototype.visitStruct=yt(vz),ft.prototype.visitUnion=yt(xz),ft.prototype.visitDenseUnion=yt(S6),ft.prototype.visitSparseUnion=yt(A6),ft.prototype.visitDictionary=yt(Sz),ft.prototype.visitInterval=yt(Az),ft.prototype.visitIntervalDayTime=yt(I6),ft.prototype.visitIntervalYearMonth=yt(E6),ft.prototype.visitDuration=yt(Iz),ft.prototype.visitDurationSecond=yt(M6),ft.prototype.visitDurationMillisecond=yt(T6),ft.prototype.visitDurationMicrosecond=yt($6),ft.prototype.visitDurationNanosecond=yt(N6),ft.prototype.visitFixedSizeList=yt(Ez),ft.prototype.visitMap=yt(mz);const Gn=new ft,lr=Symbol.for("parent"),aa=Symbol.for("rowIndex");class tm{constructor(t,n){return this[lr]=t,this[aa]=n,new Proxy(this,new Tz)}toArray(){return Object.values(this.toJSON())}toJSON(){const t=this[aa],n=this[lr],r=n.type.children,i={};for(let s=-1,o=r.length;++s<o;)i[r[s].name]=gn.visit(n.children[s],t);return i}toString(){return`{${[...this].map(([t,n])=>`${ru(t)}: ${ru(n)}`).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}[Symbol.iterator](){return new Mz(this[lr],this[aa])}}class Mz{constructor(t,n){this.childIndex=0,this.children=t.children,this.rowIndex=n,this.childFields=t.type.children,this.numChildren=this.childFields.length}[Symbol.iterator](){return this}next(){const t=this.childIndex;return t<this.numChildren?(this.childIndex=t+1,{done:!1,value:[this.childFields[t].name,gn.visit(this.children[t],this.rowIndex)]}):{done:!0,value:null}}}Object.defineProperties(tm.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[lr]:{writable:!0,enumerable:!1,configurable:!1,value:null},[aa]:{writable:!0,enumerable:!1,configurable:!1,value:-1}});class Tz{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(t){return t[lr].type.children.map(n=>n.name)}has(t,n){return t[lr].type.children.findIndex(r=>r.name===n)!==-1}getOwnPropertyDescriptor(t,n){if(t[lr].type.children.findIndex(r=>r.name===n)!==-1)return{writable:!0,enumerable:!0,configurable:!0}}get(t,n){if(Reflect.has(t,n))return t[n];const r=t[lr].type.children.findIndex(i=>i.name===n);if(r!==-1){const i=gn.visit(t[lr].children[r],t[aa]);return Reflect.set(t,n,i),i}}set(t,n,r){const i=t[lr].type.children.findIndex(s=>s.name===n);return i!==-1?(Gn.visit(t[lr].children[i],t[aa],r),Reflect.set(t,n,r)):Reflect.has(t,n)||typeof n=="symbol"?Reflect.set(t,n,r):!1}}class st extends At{}function ht(e){return(t,n)=>t.getValid(n)?e(t,n):null}const $z=(e,t)=>864e5*e[t],Nz=(e,t)=>null,R6=(e,t,n)=>{if(n+1>=t.length)return null;const r=Qt(t[n]),i=Qt(t[n+1]);return e.subarray(r,i)},Rz=({offset:e,values:t},n)=>{const r=e+n;return(t[r>>3]&1<<r%8)!==0},O6=({values:e},t)=>$z(e,t),D6=({values:e},t)=>Qt(e[t]),ps=({stride:e,values:t},n)=>t[e*n],Oz=({stride:e,values:t},n)=>c6(t[e*n]),L6=({values:e},t)=>e[t],Dz=({stride:e,values:t},n)=>t.subarray(e*n,e*(n+1)),F6=({values:e,valueOffsets:t},n)=>R6(e,t,n),C6=({values:e,valueOffsets:t},n)=>{const r=R6(e,t,n);return r!==null?q0(r):null},Lz=({values:e},t)=>e[t],Fz=({type:e,values:t},n)=>e.precision!==We.HALF?t[n]:c6(t[n]),Cz=(e,t)=>e.type.unit===jn.DAY?O6(e,t):D6(e,t),k6=({values:e},t)=>1e3*Qt(e[t]),B6=({values:e},t)=>Qt(e[t]),P6=({values:e},t)=>CM(e[t],BigInt(1e3)),U6=({values:e},t)=>CM(e[t],BigInt(1e6)),kz=(e,t)=>{switch(e.type.unit){case lt.SECOND:return k6(e,t);case lt.MILLISECOND:return B6(e,t);case lt.MICROSECOND:return P6(e,t);case lt.NANOSECOND:return U6(e,t)}},z6=({values:e},t)=>e[t],q6=({values:e},t)=>e[t],j6=({values:e},t)=>e[t],Y6=({values:e},t)=>e[t],Bz=(e,t)=>{switch(e.type.unit){case lt.SECOND:return z6(e,t);case lt.MILLISECOND:return q6(e,t);case lt.MICROSECOND:return j6(e,t);case lt.NANOSECOND:return Y6(e,t)}},Pz=({values:e,stride:t},n)=>K0.decimal(e.subarray(t*n,t*(n+1))),Uz=(e,t)=>{const{valueOffsets:n,stride:r,children:i}=e,{[t*r]:s,[t*r+1]:o}=n,c=i[0].slice(s,o-s);return new de([c])},zz=(e,t)=>{const{valueOffsets:n,children:r}=e,{[t]:i,[t+1]:s}=n,o=r[0];return new nm(o.slice(i,s-i))},qz=(e,t)=>new tm(e,t),jz=(e,t)=>e.type.mode===Ve.Dense?V6(e,t):W6(e,t),V6=(e,t)=>{const n=e.type.typeIdToChildIndex[e.typeIds[t]],r=e.children[n];return gn.visit(r,e.valueOffsets[t])},W6=(e,t)=>{const n=e.type.typeIdToChildIndex[e.typeIds[t]],r=e.children[n];return gn.visit(r,t)},Yz=(e,t)=>{var n;return(n=e.dictionary)===null||n===void 0?void 0:n.get(e.values[t])},Vz=(e,t)=>e.type.unit===Lr.DAY_TIME?G6(e,t):X6(e,t),G6=({values:e},t)=>e.subarray(2*t,2*(t+1)),X6=({values:e},t)=>{const n=e[t],r=new Int32Array(2);return r[0]=Math.trunc(n/12),r[1]=Math.trunc(n%12),r},H6=({values:e},t)=>e[t],Q6=({values:e},t)=>e[t],J6=({values:e},t)=>e[t],K6=({values:e},t)=>e[t],Wz=(e,t)=>{switch(e.type.unit){case lt.SECOND:return H6(e,t);case lt.MILLISECOND:return Q6(e,t);case lt.MICROSECOND:return J6(e,t);case lt.NANOSECOND:return K6(e,t)}},Gz=(e,t)=>{const{stride:n,children:r}=e,s=r[0].slice(t*n,n);return new de([s])};st.prototype.visitNull=ht(Nz),st.prototype.visitBool=ht(Rz),st.prototype.visitInt=ht(Lz),st.prototype.visitInt8=ht(ps),st.prototype.visitInt16=ht(ps),st.prototype.visitInt32=ht(ps),st.prototype.visitInt64=ht(L6),st.prototype.visitUint8=ht(ps),st.prototype.visitUint16=ht(ps),st.prototype.visitUint32=ht(ps),st.prototype.visitUint64=ht(L6),st.prototype.visitFloat=ht(Fz),st.prototype.visitFloat16=ht(Oz),st.prototype.visitFloat32=ht(ps),st.prototype.visitFloat64=ht(ps),st.prototype.visitUtf8=ht(C6),st.prototype.visitLargeUtf8=ht(C6),st.prototype.visitBinary=ht(F6),st.prototype.visitLargeBinary=ht(F6),st.prototype.visitFixedSizeBinary=ht(Dz),st.prototype.visitDate=ht(Cz),st.prototype.visitDateDay=ht(O6),st.prototype.visitDateMillisecond=ht(D6),st.prototype.visitTimestamp=ht(kz),st.prototype.visitTimestampSecond=ht(k6),st.prototype.visitTimestampMillisecond=ht(B6),st.prototype.visitTimestampMicrosecond=ht(P6),st.prototype.visitTimestampNanosecond=ht(U6),st.prototype.visitTime=ht(Bz),st.prototype.visitTimeSecond=ht(z6),st.prototype.visitTimeMillisecond=ht(q6),st.prototype.visitTimeMicrosecond=ht(j6),st.prototype.visitTimeNanosecond=ht(Y6),st.prototype.visitDecimal=ht(Pz),st.prototype.visitList=ht(Uz),st.prototype.visitStruct=ht(qz),st.prototype.visitUnion=ht(jz),st.prototype.visitDenseUnion=ht(V6),st.prototype.visitSparseUnion=ht(W6),st.prototype.visitDictionary=ht(Yz),st.prototype.visitInterval=ht(Vz),st.prototype.visitIntervalDayTime=ht(G6),st.prototype.visitIntervalYearMonth=ht(X6),st.prototype.visitDuration=ht(Wz),st.prototype.visitDurationSecond=ht(H6),st.prototype.visitDurationMillisecond=ht(Q6),st.prototype.visitDurationMicrosecond=ht(J6),st.prototype.visitDurationNanosecond=ht(K6),st.prototype.visitFixedSizeList=ht(Gz),st.prototype.visitMap=ht(zz);const gn=new st,ca=Symbol.for("keys"),ua=Symbol.for("vals"),la=Symbol.for("kKeysAsStrings"),em=Symbol.for("_kKeysAsStrings");class nm{constructor(t){return this[ca]=new de([t.children[0]]).memoize(),this[ua]=t.children[1],new Proxy(this,new Hz)}get[la](){return this[em]||(this[em]=Array.from(this[ca].toArray(),String))}[Symbol.iterator](){return new Xz(this[ca],this[ua])}get size(){return this[ca].length}toArray(){return Object.values(this.toJSON())}toJSON(){const t=this[ca],n=this[ua],r={};for(let i=-1,s=t.length;++i<s;)r[t.get(i)]=gn.visit(n,i);return r}toString(){return`{${[...this].map(([t,n])=>`${ru(t)}: ${ru(n)}`).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}}class Xz{constructor(t,n){this.keys=t,this.vals=n,this.keyIndex=0,this.numKeys=t.length}[Symbol.iterator](){return this}next(){const t=this.keyIndex;return t===this.numKeys?{done:!0,value:null}:(this.keyIndex++,{done:!1,value:[this.keys.get(t),gn.visit(this.vals,t)]})}}class Hz{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(t){return t[la]}has(t,n){return t[la].includes(n)}getOwnPropertyDescriptor(t,n){if(t[la].indexOf(n)!==-1)return{writable:!0,enumerable:!0,configurable:!0}}get(t,n){if(Reflect.has(t,n))return t[n];const r=t[la].indexOf(n);if(r!==-1){const i=gn.visit(Reflect.get(t,ua),r);return Reflect.set(t,n,i),i}}set(t,n,r){const i=t[la].indexOf(n);return i!==-1?(Gn.visit(Reflect.get(t,ua),i,r),Reflect.set(t,n,r)):Reflect.has(t,n)?Reflect.set(t,n,r):!1}}Object.defineProperties(nm.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[ca]:{writable:!0,enumerable:!1,configurable:!1,value:null},[ua]:{writable:!0,enumerable:!1,configurable:!1,value:null},[em]:{writable:!0,enumerable:!1,configurable:!1,value:null}});let Z6;function tT(e,t,n,r){const{length:i=0}=e;let s=typeof t!="number"?0:t,o=typeof n!="number"?i:n;return s<0&&(s=(s%i+i)%i),o<0&&(o=(o%i+i)%i),o<s&&(Z6=s,s=o,o=Z6),o>i&&(o=i),r?r(e,s,o):[s,o]}const rm=(e,t)=>e<0?t+e:e,eT=e=>e!==e;function fa(e){if(typeof e!=="object"||e===null)return eT(e)?eT:n=>n===e;if(e instanceof Date){const n=e.valueOf();return r=>r instanceof Date?r.valueOf()===n:!1}return ArrayBuffer.isView(e)?n=>n?XU(e,n):!1:e instanceof Map?Jz(e):Array.isArray(e)?Qz(e):e instanceof de?Kz(e):Zz(e,!0)}function Qz(e){const t=[];for(let n=-1,r=e.length;++n<r;)t[n]=fa(e[n]);return wh(t)}function Jz(e){let t=-1;const n=[];for(const r of e.values())n[++t]=fa(r);return wh(n)}function Kz(e){const t=[];for(let n=-1,r=e.length;++n<r;)t[n]=fa(e.get(n));return wh(t)}function Zz(e,t=!1){const n=Object.keys(e);if(!t&&n.length===0)return()=>!1;const r=[];for(let i=-1,s=n.length;++i<s;)r[i]=fa(e[n[i]]);return wh(r,n)}function wh(e,t){return n=>{if(!n||typeof n!="object")return!1;switch(n.constructor){case Array:return tq(e,n);case Map:return nT(e,n,n.keys());case nm:case tm:case Object:case void 0:return nT(e,n,t||Object.keys(n))}return n instanceof de?eq(e,n):!1}}function tq(e,t){const n=e.length;if(t.length!==n)return!1;for(let r=-1;++r<n;)if(!e[r](t[r]))return!1;return!0}function eq(e,t){const n=e.length;if(t.length!==n)return!1;for(let r=-1;++r<n;)if(!e[r](t.get(r)))return!1;return!0}function nT(e,t,n){const r=n[Symbol.iterator](),i=t instanceof Map?t.keys():Object.keys(t)[Symbol.iterator](),s=t instanceof Map?t.values():Object.values(t)[Symbol.iterator]();let o=0;const a=e.length;let c=s.next(),u=r.next(),l=i.next();for(;o<a&&!u.done&&!l.done&&!c.done&&!(u.value!==l.value||!e[o](c.value));++o,u=r.next(),l=i.next(),c=s.next());return o===a&&u.done&&l.done&&c.done?!0:(r.return&&r.return(),i.return&&i.return(),s.return&&s.return(),!1)}function rT(e,t,n,r){return(n&1<<r)!==0}function nq(e,t,n,r){return(n&1<<r)>>r}function vh(e,t,n){const r=n.byteLength+7&-8;if(e>0||n.byteLength<r){const i=new Uint8Array(r);return i.set(e%8===0?n.subarray(e>>3):xh(new im(n,e,t,null,rT)).subarray(0,r)),i}return n}function xh(e){const t=[];let n=0,r=0,i=0;for(const o of e)o&&(i|=1<<r),++r===8&&(t[n++]=i,i=r=0);(n===0||r>0)&&(t[n++]=i);const s=new Uint8Array(t.length+7&-8);return s.set(t),s}class im{constructor(t,n,r,i,s){this.bytes=t,this.length=r,this.context=i,this.get=s,this.bit=n%8,this.byteIndex=n>>3,this.byte=t[this.byteIndex++],this.index=0}next(){return this.index<this.length?(this.bit===8&&(this.bit=0,this.byte=this.bytes[this.byteIndex++]),{value:this.get(this.context,this.index++,this.byte,this.bit++)}):{done:!0,value:null}}[Symbol.iterator](){return this}}function sm(e,t,n){if(n-t<=0)return 0;if(n-t<8){let s=0;for(const o of new im(e,t,n-t,e,nq))s+=o;return s}const r=n>>3<<3,i=t+(t%8===0?0:8-t%8);return sm(e,t,i)+sm(e,r,n)+rq(e,i>>3,r-i>>3)}function rq(e,t,n){let r=0,i=Math.trunc(t);const s=new DataView(e.buffer,e.byteOffset,e.byteLength),o=n===void 0?e.byteLength:i+n;for(;o-i>=4;)r+=om(s.getUint32(i)),i+=4;for(;o-i>=2;)r+=om(s.getUint16(i)),i+=2;for(;o-i>=1;)r+=om(s.getUint8(i)),i+=1;return r}function om(e){let t=Math.trunc(e);return t=t-(t>>>1&1431655765),t=(t&858993459)+(t>>>2&858993459),(t+(t>>>4)&252645135)*16843009>>>24}const iq=-1;class Vt{get typeId(){return this.type.typeId}get ArrayType(){return this.type.ArrayType}get buffers(){return[this.valueOffsets,this.values,this.nullBitmap,this.typeIds]}get nullable(){if(this._nullCount!==0){const{type:t}=this;return Z.isSparseUnion(t)?this.children.some(n=>n.nullable):Z.isDenseUnion(t)?this.children.some(n=>n.nullable):this.nullBitmap&&this.nullBitmap.byteLength>0}return!0}get byteLength(){let t=0;const{valueOffsets:n,values:r,nullBitmap:i,typeIds:s}=this;return n&&(t+=n.byteLength),r&&(t+=r.byteLength),i&&(t+=i.byteLength),s&&(t+=s.byteLength),this.children.reduce((o,a)=>o+a.byteLength,t)}get nullCount(){if(Z.isUnion(this.type))return this.children.reduce((r,i)=>r+i.nullCount,0);let t=this._nullCount,n;return t<=iq&&(n=this.nullBitmap)&&(this._nullCount=t=n.length===0?0:this.length-sm(n,this.offset,this.offset+this.length)),t}constructor(t,n,r,i,s,o=[],a){this.type=t,this.children=o,this.dictionary=a,this.offset=Math.floor(Math.max(n||0,0)),this.length=Math.floor(Math.max(r||0,0)),this._nullCount=Math.floor(Math.max(i||0,-1));let c;s instanceof Vt?(this.stride=s.stride,this.values=s.values,this.typeIds=s.typeIds,this.nullBitmap=s.nullBitmap,this.valueOffsets=s.valueOffsets):(this.stride=wi(t),s&&((c=s[0])&&(this.valueOffsets=c),(c=s[1])&&(this.values=c),(c=s[2])&&(this.nullBitmap=c),(c=s[3])&&(this.typeIds=c)))}getValid(t){const{type:n}=this;if(Z.isUnion(n)){const r=n,i=this.children[r.typeIdToChildIndex[this.typeIds[t]]],s=r.mode===Ve.Dense?this.valueOffsets[t]:t;return i.getValid(s)}if(this.nullable&&this.nullCount>0){const r=this.offset+t;return(this.nullBitmap[r>>3]&1<<r%8)!==0}return!0}setValid(t,n){let r;const{type:i}=this;if(Z.isUnion(i)){const s=i,o=this.children[s.typeIdToChildIndex[this.typeIds[t]]],a=s.mode===Ve.Dense?this.valueOffsets[t]:t;r=o.getValid(a),o.setValid(a,n)}else{let{nullBitmap:s}=this;const{offset:o,length:a}=this,c=o+t,u=1<<c%8,l=c>>3;(!s||s.byteLength<=l)&&(s=new Uint8Array((o+a+63&-64)>>3).fill(255),this.nullCount>0?(s.set(vh(o,a,this.nullBitmap),0),Object.assign(this,{nullBitmap:s})):Object.assign(this,{nullBitmap:s,_nullCount:0}));const h=s[l];r=(h&u)!==0,s[l]=n?h|u:h&~u}return r!==!!n&&(this._nullCount=this.nullCount+(n?-1:1)),n}clone(t=this.type,n=this.offset,r=this.length,i=this._nullCount,s=this,o=this.children){return new Vt(t,n,r,i,s,o,this.dictionary)}slice(t,n){const{stride:r,typeId:i,children:s}=this,o=+(this._nullCount===0)-1,a=i===16?r:1,c=this._sliceBuffers(t,n,r,i);return this.clone(this.type,this.offset+t,n,o,c,s.length===0||this.valueOffsets?s:this._sliceChildren(s,a*t,a*n))}_changeLengthAndBackfillNullBitmap(t){if(this.typeId===O.Null)return this.clone(this.type,0,t,0);const{length:n,nullCount:r}=this,i=new Uint8Array((t+63&-64)>>3).fill(255,0,n>>3);i[n>>3]=(1<<n-(n&-8))-1,r>0&&i.set(vh(this.offset,n,this.nullBitmap),0);const s=this.buffers;return s[_i.VALIDITY]=i,this.clone(this.type,0,t,r+(t-n),s)}_sliceBuffers(t,n,r,i){let s;const{buffers:o}=this;return(s=o[_i.TYPE])&&(o[_i.TYPE]=s.subarray(t,t+n)),(s=o[_i.OFFSET])&&(o[_i.OFFSET]=s.subarray(t,t+n+1))||(s=o[_i.DATA])&&(o[_i.DATA]=i===6?s:s.subarray(r*t,r*(t+n))),o}_sliceChildren(t,n,r){return t.map(i=>i.slice(n,r))}}Vt.prototype.children=Object.freeze([]);class au extends At{visit(t){return this.getVisitFn(t.type).call(this,t)}visitNull(t){const{["type"]:n,["offset"]:r=0,["length"]:i=0}=t;return new Vt(n,r,i,i)}visitBool(t){const{["type"]:n,["offset"]:r=0}=t,i=Rt(t.nullBitmap),s=Yt(n.ArrayType,t.data),{["length"]:o=s.length>>3,["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Vt(n,r,o,a,[void 0,s,i])}visitInt(t){const{["type"]:n,["offset"]:r=0}=t,i=Rt(t.nullBitmap),s=Yt(n.ArrayType,t.data),{["length"]:o=s.length,["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Vt(n,r,o,a,[void 0,s,i])}visitFloat(t){const{["type"]:n,["offset"]:r=0}=t,i=Rt(t.nullBitmap),s=Yt(n.ArrayType,t.data),{["length"]:o=s.length,["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Vt(n,r,o,a,[void 0,s,i])}visitUtf8(t){const{["type"]:n,["offset"]:r=0}=t,i=Rt(t.data),s=Rt(t.nullBitmap),o=nu(t.valueOffsets),{["length"]:a=o.length-1,["nullCount"]:c=t.nullBitmap?-1:0}=t;return new Vt(n,r,a,c,[o,i,s])}visitLargeUtf8(t){const{["type"]:n,["offset"]:r=0}=t,i=Rt(t.data),s=Rt(t.nullBitmap),o=vM(t.valueOffsets),{["length"]:a=o.length-1,["nullCount"]:c=t.nullBitmap?-1:0}=t;return new Vt(n,r,a,c,[o,i,s])}visitBinary(t){const{["type"]:n,["offset"]:r=0}=t,i=Rt(t.data),s=Rt(t.nullBitmap),o=nu(t.valueOffsets),{["length"]:a=o.length-1,["nullCount"]:c=t.nullBitmap?-1:0}=t;return new Vt(n,r,a,c,[o,i,s])}visitLargeBinary(t){const{["type"]:n,["offset"]:r=0}=t,i=Rt(t.data),s=Rt(t.nullBitmap),o=vM(t.valueOffsets),{["length"]:a=o.length-1,["nullCount"]:c=t.nullBitmap?-1:0}=t;return new Vt(n,r,a,c,[o,i,s])}visitFixedSizeBinary(t){const{["type"]:n,["offset"]:r=0}=t,i=Rt(t.nullBitmap),s=Yt(n.ArrayType,t.data),{["length"]:o=s.length/wi(n),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Vt(n,r,o,a,[void 0,s,i])}visitDate(t){const{["type"]:n,["offset"]:r=0}=t,i=Rt(t.nullBitmap),s=Yt(n.ArrayType,t.data),{["length"]:o=s.length/wi(n),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Vt(n,r,o,a,[void 0,s,i])}visitTimestamp(t){const{["type"]:n,["offset"]:r=0}=t,i=Rt(t.nullBitmap),s=Yt(n.ArrayType,t.data),{["length"]:o=s.length/wi(n),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Vt(n,r,o,a,[void 0,s,i])}visitTime(t){const{["type"]:n,["offset"]:r=0}=t,i=Rt(t.nullBitmap),s=Yt(n.ArrayType,t.data),{["length"]:o=s.length/wi(n),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Vt(n,r,o,a,[void 0,s,i])}visitDecimal(t){const{["type"]:n,["offset"]:r=0}=t,i=Rt(t.nullBitmap),s=Yt(n.ArrayType,t.data),{["length"]:o=s.length/wi(n),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Vt(n,r,o,a,[void 0,s,i])}visitList(t){const{["type"]:n,["offset"]:r=0,["child"]:i}=t,s=Rt(t.nullBitmap),o=nu(t.valueOffsets),{["length"]:a=o.length-1,["nullCount"]:c=t.nullBitmap?-1:0}=t;return new Vt(n,r,a,c,[o,void 0,s],[i])}visitStruct(t){const{["type"]:n,["offset"]:r=0,["children"]:i=[]}=t,s=Rt(t.nullBitmap),{length:o=i.reduce((c,{length:u})=>Math.max(c,u),0),nullCount:a=t.nullBitmap?-1:0}=t;return new Vt(n,r,o,a,[void 0,void 0,s],i)}visitUnion(t){const{["type"]:n,["offset"]:r=0,["children"]:i=[]}=t,s=Yt(n.ArrayType,t.typeIds),{["length"]:o=s.length,["nullCount"]:a=-1}=t;if(Z.isSparseUnion(n))return new Vt(n,r,o,a,[void 0,void 0,void 0,s],i);const c=nu(t.valueOffsets);return new Vt(n,r,o,a,[c,void 0,void 0,s],i)}visitDictionary(t){const{["type"]:n,["offset"]:r=0}=t,i=Rt(t.nullBitmap),s=Yt(n.indices.ArrayType,t.data),{["dictionary"]:o=new de([new au().visit({type:n.dictionary})])}=t,{["length"]:a=s.length,["nullCount"]:c=t.nullBitmap?-1:0}=t;return new Vt(n,r,a,c,[void 0,s,i],[],o)}visitInterval(t){const{["type"]:n,["offset"]:r=0}=t,i=Rt(t.nullBitmap),s=Yt(n.ArrayType,t.data),{["length"]:o=s.length/wi(n),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Vt(n,r,o,a,[void 0,s,i])}visitDuration(t){const{["type"]:n,["offset"]:r=0}=t,i=Rt(t.nullBitmap),s=Yt(n.ArrayType,t.data),{["length"]:o=s.length,["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Vt(n,r,o,a,[void 0,s,i])}visitFixedSizeList(t){const{["type"]:n,["offset"]:r=0,["child"]:i=new au().visit({type:n.valueType})}=t,s=Rt(t.nullBitmap),{["length"]:o=i.length/wi(n),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new Vt(n,r,o,a,[void 0,void 0,s],[i])}visitMap(t){const{["type"]:n,["offset"]:r=0,["child"]:i=new au().visit({type:n.childType})}=t,s=Rt(t.nullBitmap),o=nu(t.valueOffsets),{["length"]:a=o.length-1,["nullCount"]:c=t.nullBitmap?-1:0}=t;return new Vt(n,r,a,c,[o,void 0,s],[i])}}const sq=new au;function Et(e){return sq.visit(e)}class iT{constructor(t=0,n){this.numChunks=t,this.getChunkIterator=n,this.chunkIndex=0,this.chunkIterator=this.getChunkIterator(0)}next(){for(;this.chunkIndex<this.numChunks;){const t=this.chunkIterator.next();if(!t.done)return t;++this.chunkIndex<this.numChunks&&(this.chunkIterator=this.getChunkIterator(this.chunkIndex))}return{done:!0,value:null}}[Symbol.iterator](){return this}}function oq(e){return e.some(t=>t.nullable)}function sT(e){return e.reduce((t,n)=>t+n.nullCount,0)}function oT(e){return e.reduce((t,n,r)=>(t[r+1]=t[r]+n.length,t),new Uint32Array(e.length+1))}function aT(e,t,n,r){const i=[];for(let s=-1,o=e.length;++s<o;){const a=e[s],c=t[s],{length:u}=a;if(c>=r)break;if(n>=c+u)continue;if(c>=n&&c+u<=r){i.push(a);continue}const l=Math.max(0,n-c),h=Math.min(r-c,u);i.push(a.slice(l,h-l))}return i.length===0&&i.push(e[0].slice(0,0)),i}function am(e,t,n,r){let i=0,s=0,o=t.length-1;do{if(i>=o-1)return n<t[o]?r(e,i,n-t[i]):null;s=i+Math.trunc((o-i)*.5),n<t[s]?o=s:i=s}while(i<o)}function cm(e,t){return e.getValid(t)}function Sh(e){function t(n,r,i){return e(n[r],i)}return function(n){const r=this.data;return am(r,this._offsets,n,t)}}function cT(e){let t;function n(r,i,s){return e(r[i],s,t)}return function(r,i){const s=this.data;t=i;const o=am(s,this._offsets,r,n);return t=void 0,o}}function uT(e){let t;function n(r,i,s){let o=s,a=0,c=0;for(let u=i-1,l=r.length;++u<l;){const h=r[u];if(~(a=e(h,t,o)))return c+a;o=0,c+=h.length}return-1}return function(r,i){t=r;const s=this.data,o=typeof i!="number"?n(s,0,0):am(s,this._offsets,i,n);return t=void 0,o}}class ot extends At{}function aq(e,t){return t===null&&e.length>0?0:-1}function cq(e,t){const{nullBitmap:n}=e;if(!n||e.nullCount<=0)return-1;let r=0;for(const i of new im(n,e.offset+(t||0),e.length,n,rT)){if(!i)return r;++r}return-1}function bt(e,t,n){if(t===void 0)return-1;if(t===null)switch(e.typeId){case O.Union:break;case O.Dictionary:break;default:return cq(e,n)}const r=gn.getVisitFn(e),i=fa(t);for(let s=(n||0)-1,o=e.length;++s<o;)if(i(r(e,s)))return s;return-1}function lT(e,t,n){const r=gn.getVisitFn(e),i=fa(t);for(let s=(n||0)-1,o=e.length;++s<o;)if(i(r(e,s)))return s;return-1}ot.prototype.visitNull=aq,ot.prototype.visitBool=bt,ot.prototype.visitInt=bt,ot.prototype.visitInt8=bt,ot.prototype.visitInt16=bt,ot.prototype.visitInt32=bt,ot.prototype.visitInt64=bt,ot.prototype.visitUint8=bt,ot.prototype.visitUint16=bt,ot.prototype.visitUint32=bt,ot.prototype.visitUint64=bt,ot.prototype.visitFloat=bt,ot.prototype.visitFloat16=bt,ot.prototype.visitFloat32=bt,ot.prototype.visitFloat64=bt,ot.prototype.visitUtf8=bt,ot.prototype.visitLargeUtf8=bt,ot.prototype.visitBinary=bt,ot.prototype.visitLargeBinary=bt,ot.prototype.visitFixedSizeBinary=bt,ot.prototype.visitDate=bt,ot.prototype.visitDateDay=bt,ot.prototype.visitDateMillisecond=bt,ot.prototype.visitTimestamp=bt,ot.prototype.visitTimestampSecond=bt,ot.prototype.visitTimestampMillisecond=bt,ot.prototype.visitTimestampMicrosecond=bt,ot.prototype.visitTimestampNanosecond=bt,ot.prototype.visitTime=bt,ot.prototype.visitTimeSecond=bt,ot.prototype.visitTimeMillisecond=bt,ot.prototype.visitTimeMicrosecond=bt,ot.prototype.visitTimeNanosecond=bt,ot.prototype.visitDecimal=bt,ot.prototype.visitList=bt,ot.prototype.visitStruct=bt,ot.prototype.visitUnion=bt,ot.prototype.visitDenseUnion=lT,ot.prototype.visitSparseUnion=lT,ot.prototype.visitDictionary=bt,ot.prototype.visitInterval=bt,ot.prototype.visitIntervalDayTime=bt,ot.prototype.visitIntervalYearMonth=bt,ot.prototype.visitDuration=bt,ot.prototype.visitDurationSecond=bt,ot.prototype.visitDurationMillisecond=bt,ot.prototype.visitDurationMicrosecond=bt,ot.prototype.visitDurationNanosecond=bt,ot.prototype.visitFixedSizeList=bt,ot.prototype.visitMap=bt;const Ah=new ot;class at extends At{}function dt(e){const{type:t}=e;if(e.nullCount===0&&e.stride===1&&(Z.isInt(t)&&t.bitWidth!==64||Z.isTime(t)&&t.bitWidth!==64||Z.isFloat(t)&&t.precision!==We.HALF))return new iT(e.data.length,r=>{const i=e.data[r];return i.values.subarray(0,i.length)[Symbol.iterator]()});let n=0;return new iT(e.data.length,r=>{const s=e.data[r].length,o=e.slice(n,n+s);return n+=s,new uq(o)})}class uq{constructor(t){this.vector=t,this.index=0}next(){return this.index<this.vector.length?{value:this.vector.get(this.index++)}:{done:!0,value:null}}[Symbol.iterator](){return this}}at.prototype.visitNull=dt,at.prototype.visitBool=dt,at.prototype.visitInt=dt,at.prototype.visitInt8=dt,at.prototype.visitInt16=dt,at.prototype.visitInt32=dt,at.prototype.visitInt64=dt,at.prototype.visitUint8=dt,at.prototype.visitUint16=dt,at.prototype.visitUint32=dt,at.prototype.visitUint64=dt,at.prototype.visitFloat=dt,at.prototype.visitFloat16=dt,at.prototype.visitFloat32=dt,at.prototype.visitFloat64=dt,at.prototype.visitUtf8=dt,at.prototype.visitLargeUtf8=dt,at.prototype.visitBinary=dt,at.prototype.visitLargeBinary=dt,at.prototype.visitFixedSizeBinary=dt,at.prototype.visitDate=dt,at.prototype.visitDateDay=dt,at.prototype.visitDateMillisecond=dt,at.prototype.visitTimestamp=dt,at.prototype.visitTimestampSecond=dt,at.prototype.visitTimestampMillisecond=dt,at.prototype.visitTimestampMicrosecond=dt,at.prototype.visitTimestampNanosecond=dt,at.prototype.visitTime=dt,at.prototype.visitTimeSecond=dt,at.prototype.visitTimeMillisecond=dt,at.prototype.visitTimeMicrosecond=dt,at.prototype.visitTimeNanosecond=dt,at.prototype.visitDecimal=dt,at.prototype.visitList=dt,at.prototype.visitStruct=dt,at.prototype.visitUnion=dt,at.prototype.visitDenseUnion=dt,at.prototype.visitSparseUnion=dt,at.prototype.visitDictionary=dt,at.prototype.visitInterval=dt,at.prototype.visitIntervalDayTime=dt,at.prototype.visitIntervalYearMonth=dt,at.prototype.visitDuration=dt,at.prototype.visitDurationSecond=dt,at.prototype.visitDurationMillisecond=dt,at.prototype.visitDurationMicrosecond=dt,at.prototype.visitDurationNanosecond=dt,at.prototype.visitFixedSizeList=dt,at.prototype.visitMap=dt;const um=new at;var fT;const hT={},dT={};let de=class Uo{constructor(t){var n,r,i;const s=t[0]instanceof Uo?t.flatMap(a=>a.data):t;if(s.length===0||s.some(a=>!(a instanceof Vt)))throw new TypeError("Vector constructor expects an Array of Data instances.");const o=(n=s[0])===null||n===void 0?void 0:n.type;switch(s.length){case 0:this._offsets=[0];break;case 1:{const{get:a,set:c,indexOf:u}=hT[o.typeId],l=s[0];this.isValid=h=>cm(l,h),this.get=h=>a(l,h),this.set=(h,f)=>c(l,h,f),this.indexOf=h=>u(l,h),this._offsets=[0,l.length];break}default:Object.setPrototypeOf(this,dT[o.typeId]),this._offsets=oT(s);break}this.data=s,this.type=o,this.stride=wi(o),this.numChildren=(i=(r=o.children)===null||r===void 0?void 0:r.length)!==null&&i!==void 0?i:0,this.length=this._offsets.at(-1)}get byteLength(){return this.data.reduce((t,n)=>t+n.byteLength,0)}get nullable(){return oq(this.data)}get nullCount(){return sT(this.data)}get ArrayType(){return this.type.ArrayType}get[Symbol.toStringTag](){return`${this.VectorName}<${this.type[Symbol.toStringTag]}>`}get VectorName(){return`${O[this.type.typeId]}Vector`}isValid(t){return!1}get(t){return null}at(t){return this.get(rm(t,this.length))}set(t,n){}indexOf(t,n){return-1}includes(t,n){return this.indexOf(t,n)>-1}[Symbol.iterator](){return um.visit(this)}concat(...t){return new Uo(this.data.concat(t.flatMap(n=>n.data).flat(Number.POSITIVE_INFINITY)))}slice(t,n){return new Uo(tT(this,t,n,({data:r,_offsets:i},s,o)=>aT(r,i,s,o)))}toJSON(){return[...this]}toArray(){const{type:t,data:n,length:r,stride:i,ArrayType:s}=this;switch(t.typeId){case O.Int:case O.Float:case O.Decimal:case O.Time:case O.Timestamp:switch(n.length){case 0:return new s;case 1:return n[0].values.subarray(0,r*i);default:return n.reduce((o,{values:a,length:c})=>(o.array.set(a.subarray(0,c*i),o.offset),o.offset+=c*i,o),{array:new s(r*i),offset:0}).array}}return[...this]}toString(){return`[${[...this].join(",")}]`}getChild(t){var n;return this.getChildAt((n=this.type.children)===null||n===void 0?void 0:n.findIndex(r=>r.name===t))}getChildAt(t){return t>-1&&t<this.numChildren?new Uo(this.data.map(({children:n})=>n[t])):null}get isMemoized(){return Z.isDictionary(this.type)?this.data[0].dictionary.isMemoized:!1}memoize(){if(Z.isDictionary(this.type)){const t=new Ih(this.data[0].dictionary),n=this.data.map(r=>{const i=r.clone();return i.dictionary=t,i});return new Uo(n)}return new Ih(this)}unmemoize(){if(Z.isDictionary(this.type)&&this.isMemoized){const t=this.data[0].dictionary.unmemoize(),n=this.data.map(r=>{const i=r.clone();return i.dictionary=t,i});return new Uo(n)}return this}};fT=Symbol.toStringTag,de[fT]=(e=>{e.type=Z.prototype,e.data=[],e.length=0,e.stride=1,e.numChildren=0,e._offsets=new Uint32Array([0]),e[Symbol.isConcatSpreadable]=!0;const t=Object.keys(O).map(n=>O[n]).filter(n=>typeof n=="number"&&n!==O.NONE);for(const n of t){const r=gn.getVisitFnByTypeId(n),i=Gn.getVisitFnByTypeId(n),s=Ah.getVisitFnByTypeId(n);hT[n]={get:r,set:i,indexOf:s},dT[n]=Object.create(e,{isValid:{value:Sh(cm)},get:{value:Sh(gn.getVisitFnByTypeId(n))},set:{value:cT(Gn.getVisitFnByTypeId(n))},indexOf:{value:uT(Ah.getVisitFnByTypeId(n))}})}return"Vector"})(de.prototype);class Ih extends de{constructor(t){super(t.data);const n=this.get,r=this.set,i=this.slice,s=new Array(this.length);Object.defineProperty(this,"get",{value(o){const a=s[o];if(a!==void 0)return a;const c=n.call(this,o);return s[o]=c,c}}),Object.defineProperty(this,"set",{value(o,a){r.call(this,o,a),s[o]=a}}),Object.defineProperty(this,"slice",{value:(o,a)=>new Ih(i.call(this,o,a))}),Object.defineProperty(this,"isMemoized",{value:!0}),Object.defineProperty(this,"unmemoize",{value:()=>new de(this.data)}),Object.defineProperty(this,"memoize",{value:()=>this})}}class lm{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}offset(){return this.bb.readInt64(this.bb_pos)}metaDataLength(){return this.bb.readInt32(this.bb_pos+8)}bodyLength(){return this.bb.readInt64(this.bb_pos+16)}static sizeOf(){return 24}static createBlock(t,n,r,i){return t.prep(8,24),t.writeInt64(BigInt(i??0)),t.pad(4),t.writeInt32(r),t.writeInt64(BigInt(n??0)),t.offset()}}class En{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsFooter(t,n){return(n||new En).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFooter(t,n){return t.setPosition(t.position()+Ut),(n||new En).__init(t.readInt32(t.position())+t.position(),t)}version(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):xe.V1}schema(t){const n=this.bb.__offset(this.bb_pos,6);return n?(t||new Br).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null}dictionaries(t,n){const r=this.bb.__offset(this.bb_pos,8);return r?(n||new lm).__init(this.bb.__vector(this.bb_pos+r)+t*24,this.bb):null}dictionariesLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}recordBatches(t,n){const r=this.bb.__offset(this.bb_pos,10);return r?(n||new lm).__init(this.bb.__vector(this.bb_pos+r)+t*24,this.bb):null}recordBatchesLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,n){const r=this.bb.__offset(this.bb_pos,12);return r?(n||new $e).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+t*4),this.bb):null}customMetadataLength(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}static startFooter(t){t.startObject(5)}static addVersion(t,n){t.addFieldInt16(0,n,xe.V1)}static addSchema(t,n){t.addFieldOffset(1,n,0)}static addDictionaries(t,n){t.addFieldOffset(2,n,0)}static startDictionariesVector(t,n){t.startVector(24,n,8)}static addRecordBatches(t,n){t.addFieldOffset(3,n,0)}static startRecordBatchesVector(t,n){t.startVector(24,n,8)}static addCustomMetadata(t,n){t.addFieldOffset(4,n,0)}static createCustomMetadataVector(t,n){t.startVector(4,n.length,4);for(let r=n.length-1;r>=0;r--)t.addOffset(n[r]);return t.endVector()}static startCustomMetadataVector(t,n){t.startVector(4,n,4)}static endFooter(t){return t.endObject()}static finishFooterBuffer(t,n){t.finish(n)}static finishSizePrefixedFooterBuffer(t,n){t.finish(n,void 0,!0)}}class zt{constructor(t=[],n,r,i=xe.V5){this.fields=t||[],this.metadata=n||new Map,r||(r=fm(this.fields)),this.dictionaries=r,this.metadataVersion=i}get[Symbol.toStringTag](){return"Schema"}get names(){return this.fields.map(t=>t.name)}toString(){return`Schema<{ ${this.fields.map((t,n)=>`${n}: ${t}`).join(", ")} }>`}select(t){const n=new Set(t),r=this.fields.filter(i=>n.has(i.name));return new zt(r,this.metadata)}selectAt(t){const n=t.map(r=>this.fields[r]).filter(Boolean);return new zt(n,this.metadata)}assign(...t){const n=t[0]instanceof zt?t[0]:Array.isArray(t[0])?new zt(t[0]):new zt(t),r=[...this.fields],i=Eh(Eh(new Map,this.metadata),n.metadata),s=n.fields.filter(a=>{const c=r.findIndex(u=>u.name===a.name);return~c?(r[c]=a.clone({metadata:Eh(Eh(new Map,r[c].metadata),a.metadata)}))&&!1:!0}),o=fm(s,new Map);return new zt([...r,...s],i,new Map([...this.dictionaries,...o]))}}zt.prototype.fields=null,zt.prototype.metadata=null,zt.prototype.dictionaries=null;class se{static new(...t){let[n,r,i,s]=t;return t[0]&&typeof t[0]=="object"&&({name:n}=t[0],r===void 0&&(r=t[0].type),i===void 0&&(i=t[0].nullable),s===void 0&&(s=t[0].metadata)),new se(`${n}`,r,i,s)}constructor(t,n,r=!1,i){this.name=t,this.type=n,this.nullable=r,this.metadata=i||new Map}get typeId(){return this.type.typeId}get[Symbol.toStringTag](){return"Field"}toString(){return`${this.name}: ${this.type}`}clone(...t){let[n,r,i,s]=t;return!t[0]||typeof t[0]!="object"?[n=this.name,r=this.type,i=this.nullable,s=this.metadata]=t:{name:n=this.name,type:r=this.type,nullable:i=this.nullable,metadata:s=this.metadata}=t[0],se.new(n,r,i,s)}}se.prototype.type=null,se.prototype.name=null,se.prototype.nullable=null,se.prototype.metadata=null;function Eh(e,t){return new Map([...e||new Map,...t||new Map])}function fm(e,t=new Map){for(let n=-1,r=e.length;++n<r;){const s=e[n].type;if(Z.isDictionary(s)){if(!t.has(s.id))t.set(s.id,s.dictionary);else if(t.get(s.id)!==s.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}s.children&&s.children.length>0&&fm(s.children,t)}return t}var lq=EM,fq=Ko;class cu{static decode(t){t=new fq(Rt(t));const n=En.getRootAsFooter(t),r=zt.decode(n.schema(),new Map,n.version());return new hq(r,n)}static encode(t){const n=new lq,r=zt.encode(n,t.schema);En.startRecordBatchesVector(n,t.numRecordBatches);for(const o of[...t.recordBatches()].slice().reverse())ys.encode(n,o);const i=n.endVector();En.startDictionariesVector(n,t.numDictionaries);for(const o of[...t.dictionaryBatches()].slice().reverse())ys.encode(n,o);const s=n.endVector();return En.startFooter(n),En.addSchema(n,r),En.addVersion(n,xe.V5),En.addRecordBatches(n,i),En.addDictionaries(n,s),En.finishFooterBuffer(n,En.endFooter(n)),n.asUint8Array()}get numRecordBatches(){return this._recordBatches.length}get numDictionaries(){return this._dictionaryBatches.length}constructor(t,n=xe.V5,r,i){this.schema=t,this.version=n,r&&(this._recordBatches=r),i&&(this._dictionaryBatches=i)}*recordBatches(){for(let t,n=-1,r=this.numRecordBatches;++n<r;)(t=this.getRecordBatch(n))&&(yield t)}*dictionaryBatches(){for(let t,n=-1,r=this.numDictionaries;++n<r;)(t=this.getDictionaryBatch(n))&&(yield t)}getRecordBatch(t){return t>=0&&t<this.numRecordBatches&&this._recordBatches[t]||null}getDictionaryBatch(t){return t>=0&&t<this.numDictionaries&&this._dictionaryBatches[t]||null}}class hq extends cu{get numRecordBatches(){return this._footer.recordBatchesLength()}get numDictionaries(){return this._footer.dictionariesLength()}constructor(t,n){super(t,n.version()),this._footer=n}getRecordBatch(t){if(t>=0&&t<this.numRecordBatches){const n=this._footer.recordBatches(t);if(n)return ys.decode(n)}return null}getDictionaryBatch(t){if(t>=0&&t<this.numDictionaries){const n=this._footer.dictionaries(t);if(n)return ys.decode(n)}return null}}class ys{static decode(t){return new ys(t.metaDataLength(),t.bodyLength(),t.offset())}static encode(t,n){const{metaDataLength:r}=n,i=BigInt(n.offset),s=BigInt(n.bodyLength);return lm.createBlock(t,i,r,s)}constructor(t,n,r){this.metaDataLength=t,this.offset=Qt(r),this.bodyLength=Qt(n)}}const pe=Object.freeze({done:!0,value:void 0});class pT{constructor(t){this._json=t}get schema(){return this._json.schema}get batches(){return this._json.batches||[]}get dictionaries(){return this._json.dictionaries||[]}}class hm{tee(){return this._getDOMStream().tee()}pipe(t,n){return this._getNodeStream().pipe(t,n)}pipeTo(t,n){return this._getDOMStream().pipeTo(t,n)}pipeThrough(t,n){return this._getDOMStream().pipeThrough(t,n)}_getDOMStream(){return this._DOMStream||(this._DOMStream=this.toDOMStream())}_getNodeStream(){return this._nodeStream||(this._nodeStream=this.toNodeStream())}}class dq extends hm{constructor(){super(),this._values=[],this.resolvers=[],this._closedPromise=new Promise(t=>this._closedPromiseResolve=t)}get closed(){return this._closedPromise}cancel(t){return _t(this,void 0,void 0,function*(){yield this.return(t)})}write(t){this._ensureOpen()&&(this.resolvers.length<=0?this._values.push(t):this.resolvers.shift().resolve({done:!1,value:t}))}abort(t){this._closedPromiseResolve&&(this.resolvers.length<=0?this._error={error:t}:this.resolvers.shift().reject({done:!0,value:t}))}close(){if(this._closedPromiseResolve){const{resolvers:t}=this;for(;t.length>0;)t.shift().resolve(pe);this._closedPromiseResolve(),this._closedPromiseResolve=void 0}}[Symbol.asyncIterator](){return this}toDOMStream(t){return qn.toDOMStream(this._closedPromiseResolve||this._error?this:this._values,t)}toNodeStream(t){return qn.toNodeStream(this._closedPromiseResolve||this._error?this:this._values,t)}throw(t){return _t(this,void 0,void 0,function*(){return yield this.abort(t),pe})}return(t){return _t(this,void 0,void 0,function*(){return yield this.close(),pe})}read(t){return _t(this,void 0,void 0,function*(){return(yield this.next(t,"read")).value})}peek(t){return _t(this,void 0,void 0,function*(){return(yield this.next(t,"peek")).value})}next(...t){return this._values.length>0?Promise.resolve({done:!1,value:this._values.shift()}):this._error?Promise.reject({done:!0,value:this._error.error}):this._closedPromiseResolve?new Promise((n,r)=>{this.resolvers.push({resolve:n,reject:r})}):Promise.resolve(pe)}_ensureOpen(){if(this._closedPromiseResolve)return!0;throw new Error("AsyncQueue is closed")}}class Mh extends dq{write(t){if((t=Rt(t)).byteLength>0)return super.write(t)}toString(t=!1){return t?q0(this.toUint8Array(!0)):this.toUint8Array(!1).then(q0)}toUint8Array(t=!1){return t?Dr(this._values)[0]:_t(this,void 0,void 0,function*(){var n,r,i,s;const o=[];let a=0;try{for(var c=!0,u=io(this),l;l=yield u.next(),n=l.done,!n;c=!0){s=l.value,c=!1;const h=s;o.push(h),a+=h.byteLength}}catch(h){r={error:h}}finally{try{!c&&!n&&(i=u.return)&&(yield i.call(u))}finally{if(r)throw r.error}}return Dr(o,a)[0]})}}class Th{constructor(t){t&&(this.source=new pq(qn.fromIterable(t)))}[Symbol.iterator](){return this}next(t){return this.source.next(t)}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}peek(t){return this.source.peek(t)}read(t){return this.source.read(t)}}class ha{constructor(t){t instanceof ha?this.source=t.source:t instanceof Mh?this.source=new co(qn.fromAsyncIterable(t)):_M(t)?this.source=new co(qn.fromNodeStream(t)):V0(t)?this.source=new co(qn.fromDOMStream(t)):bM(t)?this.source=new co(qn.fromDOMStream(t.body)):eu(t)?this.source=new co(qn.fromIterable(t)):so(t)?this.source=new co(qn.fromAsyncIterable(t)):Jo(t)&&(this.source=new co(qn.fromAsyncIterable(t)))}[Symbol.asyncIterator](){return this}next(t){return this.source.next(t)}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}get closed(){return this.source.closed}cancel(t){return this.source.cancel(t)}peek(t){return this.source.peek(t)}read(t){return this.source.read(t)}}class pq{constructor(t){this.source=t}cancel(t){this.return(t)}peek(t){return this.next(t,"peek").value}read(t){return this.next(t,"read").value}next(t,n="read"){return this.source.next({cmd:n,size:t})}throw(t){return Object.create(this.source.throw&&this.source.throw(t)||pe)}return(t){return Object.create(this.source.return&&this.source.return(t)||pe)}}class co{constructor(t){this.source=t,this._closedPromise=new Promise(n=>this._closedPromiseResolve=n)}cancel(t){return _t(this,void 0,void 0,function*(){yield this.return(t)})}get closed(){return this._closedPromise}read(t){return _t(this,void 0,void 0,function*(){return(yield this.next(t,"read")).value})}peek(t){return _t(this,void 0,void 0,function*(){return(yield this.next(t,"peek")).value})}next(t){return _t(this,arguments,void 0,function*(n,r="read"){return yield this.source.next({cmd:r,size:n})})}throw(t){return _t(this,void 0,void 0,function*(){const n=this.source.throw&&(yield this.source.throw(t))||pe;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(n)})}return(t){return _t(this,void 0,void 0,function*(){const n=this.source.return&&(yield this.source.return(t))||pe;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(n)})}}class yT extends Th{constructor(t,n){super(),this.position=0,this.buffer=Rt(t),this.size=n===void 0?this.buffer.byteLength:n}readInt32(t){const{buffer:n,byteOffset:r}=this.readAt(t,4);return new DataView(n,r).getInt32(0,!0)}seek(t){return this.position=Math.min(t,this.size),t<this.size}read(t){const{buffer:n,size:r,position:i}=this;return n&&i<r?(typeof t!="number"&&(t=Number.POSITIVE_INFINITY),this.position=Math.min(r,i+Math.min(r-i,t)),n.subarray(i,this.position)):null}readAt(t,n){const r=this.buffer,i=Math.min(this.size,t+n);return r?r.subarray(t,i):new Uint8Array(n)}close(){this.buffer&&(this.buffer=null)}throw(t){return this.close(),{done:!0,value:t}}return(t){return this.close(),{done:!0,value:t}}}class $h extends ha{constructor(t,n){super(),this.position=0,this._handle=t,typeof n=="number"?this.size=n:this._pending=_t(this,void 0,void 0,function*(){this.size=(yield t.stat()).size,delete this._pending})}readInt32(t){return _t(this,void 0,void 0,function*(){const{buffer:n,byteOffset:r}=yield this.readAt(t,4);return new DataView(n,r).getInt32(0,!0)})}seek(t){return _t(this,void 0,void 0,function*(){return this._pending&&(yield this._pending),this.position=Math.min(t,this.size),t<this.size})}read(t){return _t(this,void 0,void 0,function*(){this._pending&&(yield this._pending);const{_handle:n,size:r,position:i}=this;if(n&&i<r){typeof t!="number"&&(t=Number.POSITIVE_INFINITY);let s=i,o=0,a=0;const c=Math.min(r,s+Math.min(r-s,t)),u=new Uint8Array(Math.max(0,(this.position=c)-s));for(;(s+=a)<c&&(o+=a)<u.byteLength;)({bytesRead:a}=yield n.read(u,o,u.byteLength-o,s));return u}return null})}readAt(t,n){return _t(this,void 0,void 0,function*(){this._pending&&(yield this._pending);const{_handle:r,size:i}=this;if(r&&t+n<i){const s=Math.min(i,t+n),o=new Uint8Array(s-t);return(yield r.read(o,0,n,t)).buffer}return new Uint8Array(n)})}close(){return _t(this,void 0,void 0,function*(){const t=this._handle;this._handle=null,t&&(yield t.close())})}throw(t){return _t(this,void 0,void 0,function*(){return yield this.close(),{done:!0,value:t}})}return(t){return _t(this,void 0,void 0,function*(){return yield this.close(),{done:!0,value:t}})}}const yq=65536;function da(e){return e<0&&(e=4294967295+e+1),`0x${e.toString(16)}`}const pa=8,dm=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8];class mT{constructor(t){this.buffer=t}high(){return this.buffer[1]}low(){return this.buffer[0]}_times(t){const n=new Uint32Array([this.buffer[1]>>>16,this.buffer[1]&65535,this.buffer[0]>>>16,this.buffer[0]&65535]),r=new Uint32Array([t.buffer[1]>>>16,t.buffer[1]&65535,t.buffer[0]>>>16,t.buffer[0]&65535]);let i=n[3]*r[3];this.buffer[0]=i&65535;let s=i>>>16;return i=n[2]*r[3],s+=i,i=n[3]*r[2]>>>0,s+=i,this.buffer[0]+=s<<16,this.buffer[1]=s>>>0<i?yq:0,this.buffer[1]+=s>>>16,this.buffer[1]+=n[1]*r[3]+n[2]*r[2]+n[3]*r[1],this.buffer[1]+=n[0]*r[3]+n[1]*r[2]+n[2]*r[1]+n[3]*r[0]<<16,this}_plus(t){const n=this.buffer[0]+t.buffer[0]>>>0;this.buffer[1]+=t.buffer[1],n<this.buffer[0]>>>0&&++this.buffer[1],this.buffer[0]=n}lessThan(t){return this.buffer[1]<t.buffer[1]||this.buffer[1]===t.buffer[1]&&this.buffer[0]<t.buffer[0]}equals(t){return this.buffer[1]===t.buffer[1]&&this.buffer[0]==t.buffer[0]}greaterThan(t){return t.lessThan(this)}hex(){return`${da(this.buffer[1])} ${da(this.buffer[0])}`}}class Wt extends mT{times(t){return this._times(t),this}plus(t){return this._plus(t),this}static from(t,n=new Uint32Array(2)){return Wt.fromString(typeof t=="string"?t:t.toString(),n)}static fromNumber(t,n=new Uint32Array(2)){return Wt.fromString(t.toString(),n)}static fromString(t,n=new Uint32Array(2)){const r=t.length,i=new Wt(n);for(let s=0;s<r;){const o=pa<r-s?pa:r-s,a=new Wt(new Uint32Array([Number.parseInt(t.slice(s,s+o),10),0])),c=new Wt(new Uint32Array([dm[o],0]));i.times(c),i.plus(a),s+=o}return i}static convertArray(t){const n=new Uint32Array(t.length*2);for(let r=-1,i=t.length;++r<i;)Wt.from(t[r],new Uint32Array(n.buffer,n.byteOffset+2*r*4,2));return n}static multiply(t,n){return new Wt(new Uint32Array(t.buffer)).times(n)}static add(t,n){return new Wt(new Uint32Array(t.buffer)).plus(n)}}class bn extends mT{negate(){return this.buffer[0]=~this.buffer[0]+1,this.buffer[1]=~this.buffer[1],this.buffer[0]==0&&++this.buffer[1],this}times(t){return this._times(t),this}plus(t){return this._plus(t),this}lessThan(t){const n=this.buffer[1]<<0,r=t.buffer[1]<<0;return n<r||n===r&&this.buffer[0]<t.buffer[0]}static from(t,n=new Uint32Array(2)){return bn.fromString(typeof t=="string"?t:t.toString(),n)}static fromNumber(t,n=new Uint32Array(2)){return bn.fromString(t.toString(),n)}static fromString(t,n=new Uint32Array(2)){const r=t.startsWith("-"),i=t.length,s=new bn(n);for(let o=r?1:0;o<i;){const a=pa<i-o?pa:i-o,c=new bn(new Uint32Array([Number.parseInt(t.slice(o,o+a),10),0])),u=new bn(new Uint32Array([dm[a],0]));s.times(u),s.plus(c),o+=a}return r?s.negate():s}static convertArray(t){const n=new Uint32Array(t.length*2);for(let r=-1,i=t.length;++r<i;)bn.from(t[r],new Uint32Array(n.buffer,n.byteOffset+2*r*4,2));return n}static multiply(t,n){return new bn(new Uint32Array(t.buffer)).times(n)}static add(t,n){return new bn(new Uint32Array(t.buffer)).plus(n)}}class Pr{constructor(t){this.buffer=t}high(){return new bn(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2))}low(){return new bn(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset,2))}negate(){return this.buffer[0]=~this.buffer[0]+1,this.buffer[1]=~this.buffer[1],this.buffer[2]=~this.buffer[2],this.buffer[3]=~this.buffer[3],this.buffer[0]==0&&++this.buffer[1],this.buffer[1]==0&&++this.buffer[2],this.buffer[2]==0&&++this.buffer[3],this}times(t){const n=new Wt(new Uint32Array([this.buffer[3],0])),r=new Wt(new Uint32Array([this.buffer[2],0])),i=new Wt(new Uint32Array([this.buffer[1],0])),s=new Wt(new Uint32Array([this.buffer[0],0])),o=new Wt(new Uint32Array([t.buffer[3],0])),a=new Wt(new Uint32Array([t.buffer[2],0])),c=new Wt(new Uint32Array([t.buffer[1],0])),u=new Wt(new Uint32Array([t.buffer[0],0]));let l=Wt.multiply(s,u);this.buffer[0]=l.low();const h=new Wt(new Uint32Array([l.high(),0]));return l=Wt.multiply(i,u),h.plus(l),l=Wt.multiply(s,c),h.plus(l),this.buffer[1]=h.low(),this.buffer[3]=h.lessThan(l)?1:0,this.buffer[2]=h.high(),new Wt(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2)).plus(Wt.multiply(r,u)).plus(Wt.multiply(i,c)).plus(Wt.multiply(s,a)),this.buffer[3]+=Wt.multiply(n,u).plus(Wt.multiply(r,c)).plus(Wt.multiply(i,a)).plus(Wt.multiply(s,o)).low(),this}plus(t){const n=new Uint32Array(4);return n[3]=this.buffer[3]+t.buffer[3]>>>0,n[2]=this.buffer[2]+t.buffer[2]>>>0,n[1]=this.buffer[1]+t.buffer[1]>>>0,n[0]=this.buffer[0]+t.buffer[0]>>>0,n[0]<this.buffer[0]>>>0&&++n[1],n[1]<this.buffer[1]>>>0&&++n[2],n[2]<this.buffer[2]>>>0&&++n[3],this.buffer[3]=n[3],this.buffer[2]=n[2],this.buffer[1]=n[1],this.buffer[0]=n[0],this}hex(){return`${da(this.buffer[3])} ${da(this.buffer[2])} ${da(this.buffer[1])} ${da(this.buffer[0])}`}static multiply(t,n){return new Pr(new Uint32Array(t.buffer)).times(n)}static add(t,n){return new Pr(new Uint32Array(t.buffer)).plus(n)}static from(t,n=new Uint32Array(4)){return Pr.fromString(typeof t=="string"?t:t.toString(),n)}static fromNumber(t,n=new Uint32Array(4)){return Pr.fromString(t.toString(),n)}static fromString(t,n=new Uint32Array(4)){const r=t.startsWith("-"),i=t.length,s=new Pr(n);for(let o=r?1:0;o<i;){const a=pa<i-o?pa:i-o,c=new Pr(new Uint32Array([Number.parseInt(t.slice(o,o+a),10),0,0,0])),u=new Pr(new Uint32Array([dm[a],0,0,0]));s.times(u),s.plus(c),o+=a}return r?s.negate():s}static convertArray(t){const n=new Uint32Array(t.length*4);for(let r=-1,i=t.length;++r<i;)Pr.from(t[r],new Uint32Array(n.buffer,n.byteOffset+16*r,4));return n}}class gT extends At{constructor(t,n,r,i,s=xe.V5){super(),this.nodesIndex=-1,this.buffersIndex=-1,this.bytes=t,this.nodes=n,this.buffers=r,this.dictionaries=i,this.metadataVersion=s}visit(t){return super.visit(t instanceof se?t.type:t)}visitNull(t,{length:n}=this.nextFieldNode()){return Et({type:t,length:n})}visitBool(t,{length:n,nullCount:r}=this.nextFieldNode()){return Et({type:t,length:n,nullCount:r,nullBitmap:this.readNullBitmap(t,r),data:this.readData(t)})}visitInt(t,{length:n,nullCount:r}=this.nextFieldNode()){return Et({type:t,length:n,nullCount:r,nullBitmap:this.readNullBitmap(t,r),data:this.readData(t)})}visitFloat(t,{length:n,nullCount:r}=this.nextFieldNode()){return Et({type:t,length:n,nullCount:r,nullBitmap:this.readNullBitmap(t,r),data:this.readData(t)})}visitUtf8(t,{length:n,nullCount:r}=this.nextFieldNode()){return Et({type:t,length:n,nullCount:r,nullBitmap:this.readNullBitmap(t,r),valueOffsets:this.readOffsets(t),data:this.readData(t)})}visitLargeUtf8(t,{length:n,nullCount:r}=this.nextFieldNode()){return Et({type:t,length:n,nullCount:r,nullBitmap:this.readNullBitmap(t,r),valueOffsets:this.readOffsets(t),data:this.readData(t)})}visitBinary(t,{length:n,nullCount:r}=this.nextFieldNode()){return Et({type:t,length:n,nullCount:r,nullBitmap:this.readNullBitmap(t,r),valueOffsets:this.readOffsets(t),data:this.readData(t)})}visitLargeBinary(t,{length:n,nullCount:r}=this.nextFieldNode()){return Et({type:t,length:n,nullCount:r,nullBitmap:this.readNullBitmap(t,r),valueOffsets:this.readOffsets(t),data:this.readData(t)})}visitFixedSizeBinary(t,{length:n,nullCount:r}=this.nextFieldNode()){return Et({type:t,length:n,nullCount:r,nullBitmap:this.readNullBitmap(t,r),data:this.readData(t)})}visitDate(t,{length:n,nullCount:r}=this.nextFieldNode()){return Et({type:t,length:n,nullCount:r,nullBitmap:this.readNullBitmap(t,r),data:this.readData(t)})}visitTimestamp(t,{length:n,nullCount:r}=this.nextFieldNode()){return Et({type:t,length:n,nullCount:r,nullBitmap:this.readNullBitmap(t,r),data:this.readData(t)})}visitTime(t,{length:n,nullCount:r}=this.nextFieldNode()){return Et({type:t,length:n,nullCount:r,nullBitmap:this.readNullBitmap(t,r),data:this.readData(t)})}visitDecimal(t,{length:n,nullCount:r}=this.nextFieldNode()){return Et({type:t,length:n,nullCount:r,nullBitmap:this.readNullBitmap(t,r),data:this.readData(t)})}visitList(t,{length:n,nullCount:r}=this.nextFieldNode()){return Et({type:t,length:n,nullCount:r,nullBitmap:this.readNullBitmap(t,r),valueOffsets:this.readOffsets(t),child:this.visit(t.children[0])})}visitStruct(t,{length:n,nullCount:r}=this.nextFieldNode()){return Et({type:t,length:n,nullCount:r,nullBitmap:this.readNullBitmap(t,r),children:this.visitMany(t.children)})}visitUnion(t,{length:n,nullCount:r}=this.nextFieldNode()){return this.metadataVersion<xe.V5&&this.readNullBitmap(t,r),t.mode===Ve.Sparse?this.visitSparseUnion(t,{length:n,nullCount:r}):this.visitDenseUnion(t,{length:n,nullCount:r})}visitDenseUnion(t,{length:n,nullCount:r}=this.nextFieldNode()){return Et({type:t,length:n,nullCount:r,typeIds:this.readTypeIds(t),valueOffsets:this.readOffsets(t),children:this.visitMany(t.children)})}visitSparseUnion(t,{length:n,nullCount:r}=this.nextFieldNode()){return Et({type:t,length:n,nullCount:r,typeIds:this.readTypeIds(t),children:this.visitMany(t.children)})}visitDictionary(t,{length:n,nullCount:r}=this.nextFieldNode()){return Et({type:t,length:n,nullCount:r,nullBitmap:this.readNullBitmap(t,r),data:this.readData(t.indices),dictionary:this.readDictionary(t)})}visitInterval(t,{length:n,nullCount:r}=this.nextFieldNode()){return Et({type:t,length:n,nullCount:r,nullBitmap:this.readNullBitmap(t,r),data:this.readData(t)})}visitDuration(t,{length:n,nullCount:r}=this.nextFieldNode()){return Et({type:t,length:n,nullCount:r,nullBitmap:this.readNullBitmap(t,r),data:this.readData(t)})}visitFixedSizeList(t,{length:n,nullCount:r}=this.nextFieldNode()){return Et({type:t,length:n,nullCount:r,nullBitmap:this.readNullBitmap(t,r),child:this.visit(t.children[0])})}visitMap(t,{length:n,nullCount:r}=this.nextFieldNode()){return Et({type:t,length:n,nullCount:r,nullBitmap:this.readNullBitmap(t,r),valueOffsets:this.readOffsets(t),child:this.visit(t.children[0])})}nextFieldNode(){return this.nodes[++this.nodesIndex]}nextBufferRange(){return this.buffers[++this.buffersIndex]}readNullBitmap(t,n,r=this.nextBufferRange()){return n>0&&this.readData(t,r)||new Uint8Array(0)}readOffsets(t,n){return this.readData(t,n)}readTypeIds(t,n){return this.readData(t,n)}readData(t,{length:n,offset:r}=this.nextBufferRange()){return this.bytes.subarray(r,r+n)}readDictionary(t){return this.dictionaries.get(t.id)}}class mq extends gT{constructor(t,n,r,i,s){super(new Uint8Array(0),n,r,i,s),this.sources=t}readNullBitmap(t,n,{offset:r}=this.nextBufferRange()){return n<=0?new Uint8Array(0):xh(this.sources[r])}readOffsets(t,{offset:n}=this.nextBufferRange()){return Yt(Uint8Array,Yt(t.OffsetArrayType,this.sources[n]))}readTypeIds(t,{offset:n}=this.nextBufferRange()){return Yt(Uint8Array,Yt(t.ArrayType,this.sources[n]))}readData(t,{offset:n}=this.nextBufferRange()){const{sources:r}=this;return Z.isTimestamp(t)||(Z.isInt(t)||Z.isTime(t))&&t.bitWidth===64||Z.isDuration(t)||Z.isDate(t)&&t.unit===jn.MILLISECOND?Yt(Uint8Array,bn.convertArray(r[n])):Z.isDecimal(t)?Yt(Uint8Array,Pr.convertArray(r[n])):Z.isBinary(t)||Z.isLargeBinary(t)||Z.isFixedSizeBinary(t)?gq(r[n]):Z.isBool(t)?xh(r[n]):Z.isUtf8(t)||Z.isLargeUtf8(t)?j0(r[n].join("")):Yt(Uint8Array,Yt(t.ArrayType,r[n].map(i=>+i)))}}function gq(e){const t=e.join(""),n=new Uint8Array(t.length/2);for(let r=0;r<t.length;r+=2)n[r>>1]=Number.parseInt(t.slice(r,r+2),16);return n}class ct extends At{compareSchemas(t,n){return t===n||n instanceof t.constructor&&this.compareManyFields(t.fields,n.fields)}compareManyFields(t,n){return t===n||Array.isArray(t)&&Array.isArray(n)&&t.length===n.length&&t.every((r,i)=>this.compareFields(r,n[i]))}compareFields(t,n){return t===n||n instanceof t.constructor&&t.name===n.name&&t.nullable===n.nullable&&this.visit(t.type,n.type)}}function nn(e,t){return t instanceof e.constructor}function uo(e,t){return e===t||nn(e,t)}function xi(e,t){return e===t||nn(e,t)&&e.bitWidth===t.bitWidth&&e.isSigned===t.isSigned}function Nh(e,t){return e===t||nn(e,t)&&e.precision===t.precision}function bq(e,t){return e===t||nn(e,t)&&e.byteWidth===t.byteWidth}function pm(e,t){return e===t||nn(e,t)&&e.unit===t.unit}function uu(e,t){return e===t||nn(e,t)&&e.unit===t.unit&&e.timezone===t.timezone}function lu(e,t){return e===t||nn(e,t)&&e.unit===t.unit&&e.bitWidth===t.bitWidth}function _q(e,t){return e===t||nn(e,t)&&e.children.length===t.children.length&&ms.compareManyFields(e.children,t.children)}function wq(e,t){return e===t||nn(e,t)&&e.children.length===t.children.length&&ms.compareManyFields(e.children,t.children)}function ym(e,t){return e===t||nn(e,t)&&e.mode===t.mode&&e.typeIds.every((n,r)=>n===t.typeIds[r])&&ms.compareManyFields(e.children,t.children)}function vq(e,t){return e===t||nn(e,t)&&e.id===t.id&&e.isOrdered===t.isOrdered&&ms.visit(e.indices,t.indices)&&ms.visit(e.dictionary,t.dictionary)}function mm(e,t){return e===t||nn(e,t)&&e.unit===t.unit}function fu(e,t){return e===t||nn(e,t)&&e.unit===t.unit}function xq(e,t){return e===t||nn(e,t)&&e.listSize===t.listSize&&e.children.length===t.children.length&&ms.compareManyFields(e.children,t.children)}function Sq(e,t){return e===t||nn(e,t)&&e.keysSorted===t.keysSorted&&e.children.length===t.children.length&&ms.compareManyFields(e.children,t.children)}ct.prototype.visitNull=uo,ct.prototype.visitBool=uo,ct.prototype.visitInt=xi,ct.prototype.visitInt8=xi,ct.prototype.visitInt16=xi,ct.prototype.visitInt32=xi,ct.prototype.visitInt64=xi,ct.prototype.visitUint8=xi,ct.prototype.visitUint16=xi,ct.prototype.visitUint32=xi,ct.prototype.visitUint64=xi,ct.prototype.visitFloat=Nh,ct.prototype.visitFloat16=Nh,ct.prototype.visitFloat32=Nh,ct.prototype.visitFloat64=Nh,ct.prototype.visitUtf8=uo,ct.prototype.visitLargeUtf8=uo,ct.prototype.visitBinary=uo,ct.prototype.visitLargeBinary=uo,ct.prototype.visitFixedSizeBinary=bq,ct.prototype.visitDate=pm,ct.prototype.visitDateDay=pm,ct.prototype.visitDateMillisecond=pm,ct.prototype.visitTimestamp=uu,ct.prototype.visitTimestampSecond=uu,ct.prototype.visitTimestampMillisecond=uu,ct.prototype.visitTimestampMicrosecond=uu,ct.prototype.visitTimestampNanosecond=uu,ct.prototype.visitTime=lu,ct.prototype.visitTimeSecond=lu,ct.prototype.visitTimeMillisecond=lu,ct.prototype.visitTimeMicrosecond=lu,ct.prototype.visitTimeNanosecond=lu,ct.prototype.visitDecimal=uo,ct.prototype.visitList=_q,ct.prototype.visitStruct=wq,ct.prototype.visitUnion=ym,ct.prototype.visitDenseUnion=ym,ct.prototype.visitSparseUnion=ym,ct.prototype.visitDictionary=vq,ct.prototype.visitInterval=mm,ct.prototype.visitIntervalDayTime=mm,ct.prototype.visitIntervalYearMonth=mm,ct.prototype.visitDuration=fu,ct.prototype.visitDurationSecond=fu,ct.prototype.visitDurationMillisecond=fu,ct.prototype.visitDurationMicrosecond=fu,ct.prototype.visitDurationNanosecond=fu,ct.prototype.visitFixedSizeList=xq,ct.prototype.visitMap=Sq;const ms=new ct;function gm(e,t){return ms.compareSchemas(e,t)}function bm(e,t){return Aq(e,t.map(n=>n.data.concat()))}function Aq(e,t){const n=[...e.fields],r=[],i={numBatches:t.reduce((h,f)=>Math.max(h,f.length),0)};let s=0,o=0,a=-1;const c=t.length;let u,l=[];for(;i.numBatches-- >0;){for(o=Number.POSITIVE_INFINITY,a=-1;++a<c;)l[a]=u=t[a].shift(),o=Math.min(o,u?u.length:o);Number.isFinite(o)&&(l=Iq(n,o,l,t,i),o>0&&(r[s++]=Et({type:new en(n),length:o,nullCount:0,children:l.slice()})))}return[e=e.assign(n),r.map(h=>new _n(e,h))]}function Iq(e,t,n,r,i){var s;const o=(t+63&-64)>>3;for(let a=-1,c=r.length;++a<c;){const u=n[a],l=u?.length;if(l>=t)l===t?n[a]=u:(n[a]=u.slice(0,t),i.numBatches=Math.max(i.numBatches,r[a].unshift(u.slice(t,l-t))));else{const h=e[a];e[a]=h.clone({nullable:!0}),n[a]=(s=u?._changeLengthAndBackfillNullBitmap(t))!==null&&s!==void 0?s:Et({type:h.type,length:t,nullCount:t,nullBitmap:new Uint8Array(o)})}}return n}var bT;let gs=class zo{constructor(...t){var n,r;if(t.length===0)return this.batches=[],this.schema=new zt([]),this._offsets=[0],this;let i,s;t[0]instanceof zt&&(i=t.shift()),t.at(-1)instanceof Uint32Array&&(s=t.pop());const o=c=>{if(c){if(c instanceof _n)return[c];if(c instanceof zo)return c.batches;if(c instanceof Vt){if(c.type instanceof en)return[new _n(new zt(c.type.children),c)]}else{if(Array.isArray(c))return c.flatMap(u=>o(u));if(typeof c[Symbol.iterator]=="function")return[...c].flatMap(u=>o(u));if(typeof c=="object"){const u=Object.keys(c),l=u.map(d=>new de([c[d]])),h=i??new zt(u.map((d,p)=>new se(String(d),l[p].type,l[p].nullable))),[,f]=bm(h,l);return f.length===0?[new _n(c)]:f}}}return[]},a=t.flatMap(c=>o(c));if(i=(r=i??((n=a[0])===null||n===void 0?void 0:n.schema))!==null&&r!==void 0?r:new zt([]),!(i instanceof zt))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");for(const c of a){if(!(c instanceof _n))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");if(!gm(i,c.schema))throw new TypeError("Table and inner RecordBatch schemas must be equivalent.")}this.schema=i,this.batches=a,this._offsets=s??oT(this.data)}get data(){return this.batches.map(({data:t})=>t)}get numCols(){return this.schema.fields.length}get numRows(){return this.data.reduce((t,n)=>t+n.length,0)}get nullCount(){return this._nullCount===-1&&(this._nullCount=sT(this.data)),this._nullCount}isValid(t){return!1}get(t){return null}at(t){return this.get(rm(t,this.numRows))}set(t,n){}indexOf(t,n){return-1}[Symbol.iterator](){return this.batches.length>0?um.visit(new de(this.data)):new Array(0)[Symbol.iterator]()}toArray(){return[...this]}toString(){return`[
  ${this.toArray().join(`,
  `)}
]`}concat(...t){const n=this.schema,r=this.data.concat(t.flatMap(({data:i})=>i));return new zo(n,r.map(i=>new _n(n,i)))}slice(t,n){const r=this.schema;[t,n]=tT({length:this.numRows},t,n);const i=aT(this.data,this._offsets,t,n);return new zo(r,i.map(s=>new _n(r,s)))}getChild(t){return this.getChildAt(this.schema.fields.findIndex(n=>n.name===t))}getChildAt(t){if(t>-1&&t<this.schema.fields.length){const n=this.data.map(r=>r.children[t]);if(n.length===0){const{type:r}=this.schema.fields[t],i=Et({type:r,length:0,nullCount:0});n.push(i._changeLengthAndBackfillNullBitmap(this.numRows))}return new de(n)}return null}setChild(t,n){var r;return this.setChildAt((r=this.schema.fields)===null||r===void 0?void 0:r.findIndex(i=>i.name===t),n)}setChildAt(t,n){let r=this.schema,i=[...this.batches];if(t>-1&&t<this.numCols){n||(n=new de([Et({type:new ds,length:this.numRows})]));const s=r.fields.slice(),o=s[t].clone({type:n.type}),a=this.schema.fields.map((c,u)=>this.getChildAt(u));[s[t],a[t]]=[o,n],[r,i]=bm(r,a)}return new zo(r,i)}select(t){const n=this.schema.fields.reduce((r,i,s)=>r.set(i.name,s),new Map);return this.selectAt(t.map(r=>n.get(r)).filter(r=>r>-1))}selectAt(t){const n=this.schema.selectAt(t),r=this.batches.map(i=>i.selectAt(t));return new zo(n,r)}assign(t){const n=this.schema.fields,[r,i]=t.schema.fields.reduce((a,c,u)=>{const[l,h]=a,f=n.findIndex(d=>d.name===c.name);return~f?h[f]=u:l.push(u),a},[[],[]]),s=this.schema.assign(t.schema),o=[...n.map((a,c)=>[c,i[c]]).map(([a,c])=>c===void 0?this.getChildAt(a):t.getChildAt(c)),...r.map(a=>t.getChildAt(a))].filter(Boolean);return new zo(...bm(s,o))}};bT=Symbol.toStringTag,gs[bT]=(e=>(e.schema=null,e.batches=[],e._offsets=new Uint32Array([0]),e._nullCount=-1,e[Symbol.isConcatSpreadable]=!0,e.isValid=Sh(cm),e.get=Sh(gn.getVisitFn(O.Struct)),e.set=cT(Gn.getVisitFn(O.Struct)),e.indexOf=uT(Ah.getVisitFn(O.Struct)),"Table"))(gs.prototype);var _T;let _n=class ff{constructor(...t){switch(t.length){case 2:{if([this.schema]=t,!(this.schema instanceof zt))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");if([,this.data=Et({nullCount:0,type:new en(this.schema.fields),children:this.schema.fields.map(n=>Et({type:n.type,nullCount:0}))})]=t,!(this.data instanceof Vt))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");[this.schema,this.data]=wT(this.schema,this.data.children);break}case 1:{const[n]=t,{fields:r,children:i,length:s}=Object.keys(n).reduce((c,u,l)=>(c.children[l]=n[u],c.length=Math.max(c.length,n[u].length),c.fields[l]=se.new({name:u,type:n[u].type,nullable:!0}),c),{length:0,fields:new Array,children:new Array}),o=new zt(r),a=Et({type:new en(r),length:s,children:i,nullCount:0});[this.schema,this.data]=wT(o,a.children,s);break}default:throw new TypeError("RecordBatch constructor expects an Object mapping names to child Data, or a [Schema, Data] pair.")}}get dictionaries(){return this._dictionaries||(this._dictionaries=vT(this.schema.fields,this.data.children))}get numCols(){return this.schema.fields.length}get numRows(){return this.data.length}get nullCount(){return this.data.nullCount}isValid(t){return this.data.getValid(t)}get(t){return gn.visit(this.data,t)}at(t){return this.get(rm(t,this.numRows))}set(t,n){return Gn.visit(this.data,t,n)}indexOf(t,n){return Ah.visit(this.data,t,n)}[Symbol.iterator](){return um.visit(new de([this.data]))}toArray(){return[...this]}concat(...t){return new gs(this.schema,[this,...t])}slice(t,n){const[r]=new de([this.data]).slice(t,n).data;return new ff(this.schema,r)}getChild(t){var n;return this.getChildAt((n=this.schema.fields)===null||n===void 0?void 0:n.findIndex(r=>r.name===t))}getChildAt(t){return t>-1&&t<this.schema.fields.length?new de([this.data.children[t]]):null}setChild(t,n){var r;return this.setChildAt((r=this.schema.fields)===null||r===void 0?void 0:r.findIndex(i=>i.name===t),n)}setChildAt(t,n){let r=this.schema,i=this.data;if(t>-1&&t<this.numCols){n||(n=new de([Et({type:new ds,length:this.numRows})]));const s=r.fields.slice(),o=i.children.slice(),a=s[t].clone({type:n.type});[s[t],o[t]]=[a,n.data[0]],r=new zt(s,new Map(this.schema.metadata)),i=Et({type:new en(s),children:o})}return new ff(r,i)}select(t){const n=this.schema.select(t),r=new en(n.fields),i=[];for(const s of t){const o=this.schema.fields.findIndex(a=>a.name===s);~o&&(i[o]=this.data.children[o])}return new ff(n,Et({type:r,length:this.numRows,children:i}))}selectAt(t){const n=this.schema.selectAt(t),r=t.map(s=>this.data.children[s]).filter(Boolean),i=Et({type:new en(n.fields),length:this.numRows,children:r});return new ff(n,i)}};_T=Symbol.toStringTag,_n[_T]=(e=>(e._nullCount=-1,e[Symbol.isConcatSpreadable]=!0,"RecordBatch"))(_n.prototype);function wT(e,t,n=t.reduce((r,i)=>Math.max(r,i.length),0)){var r;const i=[...e.fields],s=[...t],o=(n+63&-64)>>3;for(const[a,c]of e.fields.entries()){const u=t[a];(!u||u.length!==n)&&(i[a]=c.clone({nullable:!0}),s[a]=(r=u?._changeLengthAndBackfillNullBitmap(n))!==null&&r!==void 0?r:Et({type:c.type,length:n,nullCount:n,nullBitmap:new Uint8Array(o)}))}return[e.assign(i),Et({type:new en(i),length:n,children:s})]}function vT(e,t,n=new Map){var r,i;if(((r=e?.length)!==null&&r!==void 0?r:0)>0&&e?.length===t?.length)for(let s=-1,o=e.length;++s<o;){const{type:a}=e[s],c=t[s];for(const u of[c,...((i=c?.dictionary)===null||i===void 0?void 0:i.data)||[]])vT(a.children,u?.children,n);if(Z.isDictionary(a)){const{id:u}=a;if(!n.has(u))c?.dictionary&&n.set(u,c.dictionary);else if(n.get(u)!==c.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}}return n}class _m extends _n{constructor(t){const n=t.fields.map(i=>Et({type:i.type})),r=Et({type:new en(t.fields),nullCount:0,children:n});super(t,r)}}let bs=class ui{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsMessage(t,n){return(n||new ui).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsMessage(t,n){return t.setPosition(t.position()+Ut),(n||new ui).__init(t.readInt32(t.position())+t.position(),t)}version(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):xe.V1}headerType(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readUint8(this.bb_pos+t):Ct.NONE}header(t){const n=this.bb.__offset(this.bb_pos,8);return n?this.bb.__union(t,this.bb_pos+n):null}bodyLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt64(this.bb_pos+t):BigInt("0")}customMetadata(t,n){const r=this.bb.__offset(this.bb_pos,12);return r?(n||new $e).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+t*4),this.bb):null}customMetadataLength(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}static startMessage(t){t.startObject(5)}static addVersion(t,n){t.addFieldInt16(0,n,xe.V1)}static addHeaderType(t,n){t.addFieldInt8(1,n,Ct.NONE)}static addHeader(t,n){t.addFieldOffset(2,n,0)}static addBodyLength(t,n){t.addFieldInt64(3,n,BigInt("0"))}static addCustomMetadata(t,n){t.addFieldOffset(4,n,0)}static createCustomMetadataVector(t,n){t.startVector(4,n.length,4);for(let r=n.length-1;r>=0;r--)t.addOffset(n[r]);return t.endVector()}static startCustomMetadataVector(t,n){t.startVector(4,n,4)}static endMessage(t){return t.endObject()}static finishMessageBuffer(t,n){t.finish(n)}static finishSizePrefixedMessageBuffer(t,n){t.finish(n,void 0,!0)}static createMessage(t,n,r,i,s,o){return ui.startMessage(t),ui.addVersion(t,n),ui.addHeaderType(t,r),ui.addHeader(t,i),ui.addBodyLength(t,s),ui.addCustomMetadata(t,o),ui.endMessage(t)}};class Eq extends At{visit(t,n){return t==null||n==null?void 0:super.visit(t,n)}visitNull(t,n){return LM.startNull(n),LM.endNull(n)}visitInt(t,n){return In.startInt(n),In.addBitWidth(n,t.bitWidth),In.addIsSigned(n,t.isSigned),In.endInt(n)}visitFloat(t,n){return Cr.startFloatingPoint(n),Cr.addPrecision(n,t.precision),Cr.endFloatingPoint(n)}visitBinary(t,n){return $M.startBinary(n),$M.endBinary(n)}visitLargeBinary(t,n){return RM.startLargeBinary(n),RM.endLargeBinary(n)}visitBool(t,n){return NM.startBool(n),NM.endBool(n)}visitUtf8(t,n){return FM.startUtf8(n),FM.endUtf8(n)}visitLargeUtf8(t,n){return OM.startLargeUtf8(n),OM.endLargeUtf8(n)}visitDecimal(t,n){return ea.startDecimal(n),ea.addScale(n,t.scale),ea.addPrecision(n,t.precision),ea.addBitWidth(n,t.bitWidth),ea.endDecimal(n)}visitDate(t,n){return Kf.startDate(n),Kf.addUnit(n,t.unit),Kf.endDate(n)}visitTime(t,n){return Yn.startTime(n),Yn.addUnit(n,t.unit),Yn.addBitWidth(n,t.bitWidth),Yn.endTime(n)}visitTimestamp(t,n){const r=t.timezone&&n.createString(t.timezone)||void 0;return Vn.startTimestamp(n),Vn.addUnit(n,t.unit),r!==void 0&&Vn.addTimezone(n,r),Vn.endTimestamp(n)}visitInterval(t,n){return kr.startInterval(n),kr.addUnit(n,t.unit),kr.endInterval(n)}visitDuration(t,n){return Zf.startDuration(n),Zf.addUnit(n,t.unit),Zf.endDuration(n)}visitList(t,n){return DM.startList(n),DM.endList(n)}visitStruct(t,n){return oo.startStruct_(n),oo.endStruct_(n)}visitUnion(t,n){mn.startTypeIdsVector(n,t.typeIds.length);const r=mn.createTypeIdsVector(n,t.typeIds);return mn.startUnion(n),mn.addMode(n,t.mode),mn.addTypeIds(n,r),mn.endUnion(n)}visitDictionary(t,n){const r=this.visit(t.indices,n);return bi.startDictionaryEncoding(n),bi.addId(n,BigInt(t.id)),bi.addIsOrdered(n,t.isOrdered),r!==void 0&&bi.addIndexType(n,r),bi.endDictionaryEncoding(n)}visitFixedSizeBinary(t,n){return th.startFixedSizeBinary(n),th.addByteWidth(n,t.byteWidth),th.endFixedSizeBinary(n)}visitFixedSizeList(t,n){return eh.startFixedSizeList(n),eh.addListSize(n,t.listSize),eh.endFixedSizeList(n)}visitMap(t,n){return nh.startMap(n),nh.addKeysSorted(n,t.keysSorted),nh.endMap(n)}}const wm=new Eq;function Mq(e,t=new Map){return new zt($q(e,t),Rh(e.metadata),t)}function xT(e){return new Mn(e.count,AT(e.columns),IT(e.columns))}function Tq(e){return new Ur(xT(e.data),e.id,e.isDelta)}function $q(e,t){return(e.fields||[]).filter(Boolean).map(n=>se.fromJSON(n,t))}function ST(e,t){return(e.children||[]).filter(Boolean).map(n=>se.fromJSON(n,t))}function AT(e){return(e||[]).reduce((t,n)=>[...t,new _s(n.count,Nq(n.VALIDITY)),...AT(n.children)],[])}function IT(e,t=[]){for(let n=-1,r=(e||[]).length;++n<r;){const i=e[n];i.VALIDITY&&t.push(new zr(t.length,i.VALIDITY.length)),i.TYPE_ID&&t.push(new zr(t.length,i.TYPE_ID.length)),i.OFFSET&&t.push(new zr(t.length,i.OFFSET.length)),i.DATA&&t.push(new zr(t.length,i.DATA.length)),t=IT(i.children,t)}return t}function Nq(e){return(e||[]).reduce((t,n)=>t+ +(n===0),0)}function Rq(e,t){let n,r,i,s,o,a;return!t||!(s=e.dictionary)?(o=MT(e,ST(e,t)),i=new se(e.name,o,e.nullable,Rh(e.metadata))):t.has(n=s.id)?(r=(r=s.indexType)?ET(r):new ou,a=new ia(t.get(n),r,n,s.isOrdered),i=new se(e.name,a,e.nullable,Rh(e.metadata))):(r=(r=s.indexType)?ET(r):new ou,t.set(n,o=MT(e,ST(e,t))),a=new ia(o,r,n,s.isOrdered),i=new se(e.name,a,e.nullable,Rh(e.metadata))),i||null}function Rh(e=[]){return new Map(e.map(({key:t,value:n})=>[t,n]))}function ET(e){return new ao(e.isSigned,e.bitWidth)}function MT(e,t){const n=e.type.name;switch(n){case"NONE":return new ds;case"null":return new ds;case"binary":return new ih;case"largebinary":return new sh;case"utf8":return new oh;case"largeutf8":return new ah;case"bool":return new ch;case"list":return new yh((t||[])[0]);case"struct":return new en(t||[]);case"struct_":return new en(t||[])}switch(n){case"int":{const r=e.type;return new ao(r.isSigned,r.bitWidth)}case"floatingpoint":{const r=e.type;return new rh(We[r.precision])}case"decimal":{const r=e.type;return new uh(r.scale,r.precision,r.bitWidth)}case"date":{const r=e.type;return new lh(jn[r.unit])}case"time":{const r=e.type;return new fh(lt[r.unit],r.bitWidth)}case"timestamp":{const r=e.type;return new hh(lt[r.unit],r.timezone)}case"interval":{const r=e.type;return new dh(Lr[r.unit])}case"duration":{const r=e.type;return new ph(lt[r.unit])}case"union":{const r=e.type,[i,...s]=(r.mode+"").toLowerCase(),o=i.toUpperCase()+s.join("");return new mh(Ve[o],r.typeIds||[],t||[])}case"fixedsizebinary":{const r=e.type;return new gh(r.byteWidth)}case"fixedsizelist":{const r=e.type;return new bh(r.listSize,(t||[])[0])}case"map":{const r=e.type;return new _h((t||[])[0],r.keysSorted)}}throw new Error(`Unrecognized type: "${n}"`)}var Oq=EM,Dq=Ko;class rn{static fromJSON(t,n){const r=new rn(0,xe.V5,n);return r._createHeader=Lq(t,n),r}static decode(t){t=new Dq(Rt(t));const n=bs.getRootAsMessage(t),r=n.bodyLength(),i=n.version(),s=n.headerType(),o=new rn(r,i,s);return o._createHeader=Fq(n,s),o}static encode(t){const n=new Oq;let r=-1;return t.isSchema()?r=zt.encode(n,t.header()):t.isRecordBatch()?r=Mn.encode(n,t.header()):t.isDictionaryBatch()&&(r=Ur.encode(n,t.header())),bs.startMessage(n),bs.addVersion(n,xe.V5),bs.addHeader(n,r),bs.addHeaderType(n,t.headerType),bs.addBodyLength(n,BigInt(t.bodyLength)),bs.finishMessageBuffer(n,bs.endMessage(n)),n.asUint8Array()}static from(t,n=0){if(t instanceof zt)return new rn(0,xe.V5,Ct.Schema,t);if(t instanceof Mn)return new rn(n,xe.V5,Ct.RecordBatch,t);if(t instanceof Ur)return new rn(n,xe.V5,Ct.DictionaryBatch,t);throw new Error(`Unrecognized Message header: ${t}`)}get type(){return this.headerType}get version(){return this._version}get headerType(){return this._headerType}get bodyLength(){return this._bodyLength}header(){return this._createHeader()}isSchema(){return this.headerType===Ct.Schema}isRecordBatch(){return this.headerType===Ct.RecordBatch}isDictionaryBatch(){return this.headerType===Ct.DictionaryBatch}constructor(t,n,r,i){this._version=n,this._headerType=r,this.body=new Uint8Array(0),i&&(this._createHeader=()=>i),this._bodyLength=Qt(t)}}class Mn{get nodes(){return this._nodes}get length(){return this._length}get buffers(){return this._buffers}constructor(t,n,r){this._nodes=n,this._buffers=r,this._length=Qt(t)}}class Ur{get id(){return this._id}get data(){return this._data}get isDelta(){return this._isDelta}get length(){return this.data.length}get nodes(){return this.data.nodes}get buffers(){return this.data.buffers}constructor(t,n,r=!1){this._data=t,this._isDelta=r,this._id=Qt(n)}}class zr{constructor(t,n){this.offset=Qt(t),this.length=Qt(n)}}class _s{constructor(t,n){this.length=Qt(t),this.nullCount=Qt(n)}}function Lq(e,t){return(()=>{switch(t){case Ct.Schema:return zt.fromJSON(e);case Ct.RecordBatch:return Mn.fromJSON(e);case Ct.DictionaryBatch:return Ur.fromJSON(e)}throw new Error(`Unrecognized Message type: { name: ${Ct[t]}, type: ${t} }`)})}function Fq(e,t){return(()=>{switch(t){case Ct.Schema:return zt.decode(e.header(new Br),new Map,e.version());case Ct.RecordBatch:return Mn.decode(e.header(new gi),e.version());case Ct.DictionaryBatch:return Ur.decode(e.header(new Zo),e.version())}throw new Error(`Unrecognized Message type: { name: ${Ct[t]}, type: ${t} }`)})}se.encode=Wq,se.decode=Yq,se.fromJSON=Rq,zt.encode=Vq,zt.decode=Cq,zt.fromJSON=Mq,Mn.encode=Gq,Mn.decode=kq,Mn.fromJSON=xT,Ur.encode=Xq,Ur.decode=Bq,Ur.fromJSON=Tq,_s.encode=Hq,_s.decode=Uq,zr.encode=Qq,zr.decode=Pq;function Cq(e,t=new Map,n=xe.V5){const r=jq(e,t);return new zt(r,Oh(e),t,n)}function kq(e,t=xe.V5){if(e.compression()!==null)throw new Error("Record batch compression not implemented");return new Mn(e.length(),zq(e),qq(e,t))}function Bq(e,t=xe.V5){return new Ur(Mn.decode(e.data(),t),e.id(),e.isDelta())}function Pq(e){return new zr(e.offset(),e.length())}function Uq(e){return new _s(e.length(),e.nullCount())}function zq(e){const t=[];for(let n,r=-1,i=-1,s=e.nodesLength();++r<s;)(n=e.nodes(r))&&(t[++i]=_s.decode(n));return t}function qq(e,t){const n=[];for(let r,i=-1,s=-1,o=e.buffersLength();++i<o;)(r=e.buffers(i))&&(t<xe.V4&&(r.bb_pos+=8*(i+1)),n[++s]=zr.decode(r));return n}function jq(e,t){const n=[];for(let r,i=-1,s=-1,o=e.fieldsLength();++i<o;)(r=e.fields(i))&&(n[++s]=se.decode(r,t));return n}function TT(e,t){const n=[];for(let r,i=-1,s=-1,o=e.childrenLength();++i<o;)(r=e.children(i))&&(n[++s]=se.decode(r,t));return n}function Yq(e,t){let n,r,i,s,o,a;return!t||!(a=e.dictionary())?(i=NT(e,TT(e,t)),r=new se(e.name(),i,e.nullable(),Oh(e))):t.has(n=Qt(a.id()))?(s=(s=a.indexType())?$T(s):new ou,o=new ia(t.get(n),s,n,a.isOrdered()),r=new se(e.name(),o,e.nullable(),Oh(e))):(s=(s=a.indexType())?$T(s):new ou,t.set(n,i=NT(e,TT(e,t))),o=new ia(i,s,n,a.isOrdered()),r=new se(e.name(),o,e.nullable(),Oh(e))),r||null}function Oh(e){const t=new Map;if(e)for(let n,r,i=-1,s=Math.trunc(e.customMetadataLength());++i<s;)(n=e.customMetadata(i))&&(r=n.key())!=null&&t.set(r,n.value());return t}function $T(e){return new ao(e.isSigned(),e.bitWidth())}function NT(e,t){const n=e.typeType();switch(n){case re.NONE:return new ds;case re.Null:return new ds;case re.Binary:return new ih;case re.LargeBinary:return new sh;case re.Utf8:return new oh;case re.LargeUtf8:return new ah;case re.Bool:return new ch;case re.List:return new yh((t||[])[0]);case re.Struct_:return new en(t||[])}switch(n){case re.Int:{const r=e.type(new In);return new ao(r.isSigned(),r.bitWidth())}case re.FloatingPoint:{const r=e.type(new Cr);return new rh(r.precision())}case re.Decimal:{const r=e.type(new ea);return new uh(r.scale(),r.precision(),r.bitWidth())}case re.Date:{const r=e.type(new Kf);return new lh(r.unit())}case re.Time:{const r=e.type(new Yn);return new fh(r.unit(),r.bitWidth())}case re.Timestamp:{const r=e.type(new Vn);return new hh(r.unit(),r.timezone())}case re.Interval:{const r=e.type(new kr);return new dh(r.unit())}case re.Duration:{const r=e.type(new Zf);return new ph(r.unit())}case re.Union:{const r=e.type(new mn);return new mh(r.mode(),r.typeIdsArray()||[],t||[])}case re.FixedSizeBinary:{const r=e.type(new th);return new gh(r.byteWidth())}case re.FixedSizeList:{const r=e.type(new eh);return new bh(r.listSize(),(t||[])[0])}case re.Map:{const r=e.type(new nh);return new _h((t||[])[0],r.keysSorted())}}throw new Error(`Unrecognized type: "${re[n]}" (${n})`)}function Vq(e,t){const n=t.fields.map(s=>se.encode(e,s));Br.startFieldsVector(e,n.length);const r=Br.createFieldsVector(e,n),i=t.metadata&&t.metadata.size>0?Br.createCustomMetadataVector(e,[...t.metadata].map(([s,o])=>{const a=e.createString(`${s}`),c=e.createString(`${o}`);return $e.startKeyValue(e),$e.addKey(e,a),$e.addValue(e,c),$e.endKeyValue(e)})):-1;return Br.startSchema(e),Br.addFields(e,r),Br.addEndianness(e,Jq?ta.Little:ta.Big),i!==-1&&Br.addCustomMetadata(e,i),Br.endSchema(e)}function Wq(e,t){let n=-1,r=-1,i=-1;const s=t.type;let o=t.typeId;Z.isDictionary(s)?(o=s.dictionary.typeId,i=wm.visit(s,e),r=wm.visit(s.dictionary,e)):r=wm.visit(s,e);const a=(s.children||[]).map(l=>se.encode(e,l)),c=Wn.createChildrenVector(e,a),u=t.metadata&&t.metadata.size>0?Wn.createCustomMetadataVector(e,[...t.metadata].map(([l,h])=>{const f=e.createString(`${l}`),d=e.createString(`${h}`);return $e.startKeyValue(e),$e.addKey(e,f),$e.addValue(e,d),$e.endKeyValue(e)})):-1;return t.name&&(n=e.createString(t.name)),Wn.startField(e),Wn.addType(e,r),Wn.addTypeType(e,o),Wn.addChildren(e,c),Wn.addNullable(e,!!t.nullable),n!==-1&&Wn.addName(e,n),i!==-1&&Wn.addDictionary(e,i),u!==-1&&Wn.addCustomMetadata(e,u),Wn.endField(e)}function Gq(e,t){const n=t.nodes||[],r=t.buffers||[];gi.startNodesVector(e,n.length);for(const o of n.slice().reverse())_s.encode(e,o);const i=e.endVector();gi.startBuffersVector(e,r.length);for(const o of r.slice().reverse())zr.encode(e,o);const s=e.endVector();return gi.startRecordBatch(e),gi.addLength(e,BigInt(t.length)),gi.addNodes(e,i),gi.addBuffers(e,s),gi.endRecordBatch(e)}function Xq(e,t){const n=Mn.encode(e,t.data);return Zo.startDictionaryBatch(e),Zo.addId(e,BigInt(t.id)),Zo.addIsDelta(e,t.isDelta),Zo.addData(e,n),Zo.endDictionaryBatch(e)}function Hq(e,t){return TM.createFieldNode(e,BigInt(t.length),BigInt(t.nullCount))}function Qq(e,t){return MM.createBuffer(e,BigInt(t.offset),BigInt(t.length))}const Jq=(()=>{const e=new ArrayBuffer(2);return new DataView(e).setInt16(0,256,!0),new Int16Array(e)[0]===256})(),vm=e=>`Expected ${Ct[e]} Message in stream, but was null or length 0.`,xm=e=>`Header pointer of flatbuffer-encoded ${Ct[e]} Message is null or length 0.`,RT=(e,t)=>`Expected to read ${e} metadata bytes, but only read ${t}.`,OT=(e,t)=>`Expected to read ${e} bytes for message body, but only read ${t}.`;class DT{constructor(t){this.source=t instanceof Th?t:new Th(t)}[Symbol.iterator](){return this}next(){let t;return(t=this.readMetadataLength()).done||t.value===-1&&(t=this.readMetadataLength()).done||(t=this.readMetadata(t.value)).done?pe:t}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}readMessage(t){let n;if((n=this.next()).done)return null;if(t!=null&&n.value.headerType!==t)throw new Error(vm(t));return n.value}readMessageBody(t){if(t<=0)return new Uint8Array(0);const n=Rt(this.source.read(t));if(n.byteLength<t)throw new Error(OT(t,n.byteLength));return n.byteOffset%8===0&&n.byteOffset+n.byteLength<=n.buffer.byteLength?n:n.slice()}readSchema(t=!1){const n=Ct.Schema,r=this.readMessage(n),i=r?.header();if(t&&!i)throw new Error(xm(n));return i}readMetadataLength(){const t=this.source.read(Dh),n=t&&new Ko(t),r=n?.readInt32(0)||0;return{done:r===0,value:r}}readMetadata(t){const n=this.source.read(t);if(!n)return pe;if(n.byteLength<t)throw new Error(RT(t,n.byteLength));return{done:!1,value:rn.decode(n)}}}class Kq{constructor(t,n){this.source=t instanceof ha?t:gM(t)?new $h(t,n):new ha(t)}[Symbol.asyncIterator](){return this}next(){return _t(this,void 0,void 0,function*(){let t;return(t=yield this.readMetadataLength()).done||t.value===-1&&(t=yield this.readMetadataLength()).done||(t=yield this.readMetadata(t.value)).done?pe:t})}throw(t){return _t(this,void 0,void 0,function*(){return yield this.source.throw(t)})}return(t){return _t(this,void 0,void 0,function*(){return yield this.source.return(t)})}readMessage(t){return _t(this,void 0,void 0,function*(){let n;if((n=yield this.next()).done)return null;if(t!=null&&n.value.headerType!==t)throw new Error(vm(t));return n.value})}readMessageBody(t){return _t(this,void 0,void 0,function*(){if(t<=0)return new Uint8Array(0);const n=Rt(yield this.source.read(t));if(n.byteLength<t)throw new Error(OT(t,n.byteLength));return n.byteOffset%8===0&&n.byteOffset+n.byteLength<=n.buffer.byteLength?n:n.slice()})}readSchema(){return _t(this,arguments,void 0,function*(t=!1){const n=Ct.Schema,r=yield this.readMessage(n),i=r?.header();if(t&&!i)throw new Error(xm(n));return i})}readMetadataLength(){return _t(this,void 0,void 0,function*(){const t=yield this.source.read(Dh),n=t&&new Ko(t),r=n?.readInt32(0)||0;return{done:r===0,value:r}})}readMetadata(t){return _t(this,void 0,void 0,function*(){const n=yield this.source.read(t);if(!n)return pe;if(n.byteLength<t)throw new Error(RT(t,n.byteLength));return{done:!1,value:rn.decode(n)}})}}class Zq extends DT{constructor(t){super(new Uint8Array(0)),this._schema=!1,this._body=[],this._batchIndex=0,this._dictionaryIndex=0,this._json=t instanceof pT?t:new pT(t)}next(){const{_json:t}=this;if(!this._schema)return this._schema=!0,{done:!1,value:rn.fromJSON(t.schema,Ct.Schema)};if(this._dictionaryIndex<t.dictionaries.length){const n=t.dictionaries[this._dictionaryIndex++];return this._body=n.data.columns,{done:!1,value:rn.fromJSON(n,Ct.DictionaryBatch)}}if(this._batchIndex<t.batches.length){const n=t.batches[this._batchIndex++];return this._body=n.columns,{done:!1,value:rn.fromJSON(n,Ct.RecordBatch)}}return this._body=[],pe}readMessageBody(t){return n(this._body);function n(r){return(r||[]).reduce((i,s)=>[...i,...s.VALIDITY&&[s.VALIDITY]||[],...s.TYPE_ID&&[s.TYPE_ID]||[],...s.OFFSET&&[s.OFFSET]||[],...s.DATA&&[s.DATA]||[],...n(s.children)],[])}}readMessage(t){let n;if((n=this.next()).done)return null;if(t!=null&&n.value.headerType!==t)throw new Error(vm(t));return n.value}readSchema(){const t=Ct.Schema,n=this.readMessage(t),r=n?.header();if(!n||!r)throw new Error(xm(t));return r}}const Dh=4,Sm="ARROW1",hu=new Uint8Array(Sm.length);for(let e=0;e<Sm.length;e+=1)hu[e]=Sm.codePointAt(e);function Am(e,t=0){for(let n=-1,r=hu.length;++n<r;)if(hu[n]!==e[t+n])return!1;return!0}const du=hu.length,LT=du+Dh,tj=du*2+Dh;class Xn extends hm{constructor(t){super(),this._impl=t}get closed(){return this._impl.closed}get schema(){return this._impl.schema}get autoDestroy(){return this._impl.autoDestroy}get dictionaries(){return this._impl.dictionaries}get numDictionaries(){return this._impl.numDictionaries}get numRecordBatches(){return this._impl.numRecordBatches}get footer(){return this._impl.isFile()?this._impl.footer:null}isSync(){return this._impl.isSync()}isAsync(){return this._impl.isAsync()}isFile(){return this._impl.isFile()}isStream(){return this._impl.isStream()}next(){return this._impl.next()}throw(t){return this._impl.throw(t)}return(t){return this._impl.return(t)}cancel(){return this._impl.cancel()}reset(t){return this._impl.reset(t),this._DOMStream=void 0,this._nodeStream=void 0,this}open(t){const n=this._impl.open(t);return so(n)?n.then(()=>this):this}readRecordBatch(t){return this._impl.isFile()?this._impl.readRecordBatch(t):null}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}toDOMStream(){return qn.toDOMStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this})}toNodeStream(){return qn.toNodeStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this},{objectMode:!0})}static throughNode(t){throw new Error('"throughNode" not available in this environment')}static throughDOM(t,n){throw new Error('"throughDOM" not available in this environment')}static from(t){return t instanceof Xn?t:Y0(t)?ij(t):gM(t)?aj(t):so(t)?_t(this,void 0,void 0,function*(){return yield Xn.from(yield t)}):bM(t)||V0(t)||_M(t)||Jo(t)?oj(new ha(t)):sj(new Th(t))}static readAll(t){return t instanceof Xn?t.isSync()?PT(t):UT(t):Y0(t)||ArrayBuffer.isView(t)||eu(t)||mM(t)?PT(t):UT(t)}}class Lh extends Xn{constructor(t){super(t),this._impl=t}readAll(){return[...this]}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return Or(this,arguments,function*(){yield xt(yield*Vf(io(this[Symbol.iterator]())))})}}class Fh extends Xn{constructor(t){super(t),this._impl=t}readAll(){return _t(this,void 0,void 0,function*(){var t,n,r,i;const s=new Array;try{for(var o=!0,a=io(this),c;c=yield a.next(),t=c.done,!t;o=!0){i=c.value,o=!1;const u=i;s.push(u)}}catch(u){n={error:u}}finally{try{!o&&!t&&(r=a.return)&&(yield r.call(a))}finally{if(n)throw n.error}}return s})}[Symbol.iterator](){throw new Error("AsyncRecordBatchStreamReader is not Iterable")}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}}class FT extends Lh{constructor(t){super(t),this._impl=t}}class ej extends Fh{constructor(t){super(t),this._impl=t}}class CT{get numDictionaries(){return this._dictionaryIndex}get numRecordBatches(){return this._recordBatchIndex}constructor(t=new Map){this.closed=!1,this.autoDestroy=!0,this._dictionaryIndex=0,this._recordBatchIndex=0,this.dictionaries=t}isSync(){return!1}isAsync(){return!1}isFile(){return!1}isStream(){return!1}reset(t){return this._dictionaryIndex=0,this._recordBatchIndex=0,this.schema=t,this.dictionaries=new Map,this}_loadRecordBatch(t,n){const r=this._loadVectors(t,n,this.schema.fields),i=Et({type:new en(this.schema.fields),length:t.length,children:r});return new _n(this.schema,i)}_loadDictionaryBatch(t,n){const{id:r,isDelta:i}=t,{dictionaries:s,schema:o}=this,a=s.get(r),c=o.dictionaries.get(r),u=this._loadVectors(t.data,n,[c]);return(a&&i?a.concat(new de(u)):new de(u)).memoize()}_loadVectors(t,n,r){return new gT(n,t.nodes,t.buffers,this.dictionaries,this.schema.metadataVersion).visitMany(r)}}class Ch extends CT{constructor(t,n){super(n),this._reader=Y0(t)?new Zq(this._handle=t):new DT(this._handle=t)}isSync(){return!0}isStream(){return!0}[Symbol.iterator](){return this}cancel(){!this.closed&&(this.closed=!0)&&(this.reset()._reader.return(),this._reader=null,this.dictionaries=null)}open(t){return this.closed||(this.autoDestroy=BT(this,t),this.schema||(this.schema=this._reader.readSchema())||this.cancel()),this}throw(t){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.throw(t):pe}return(t){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.return(t):pe}next(){if(this.closed)return pe;let t;const{_reader:n}=this;for(;t=this._readNextMessageAndValidate();)if(t.isSchema())this.reset(t.header());else if(t.isRecordBatch()){this._recordBatchIndex++;const r=t.header(),i=n.readMessageBody(t.bodyLength);return{done:!1,value:this._loadRecordBatch(r,i)}}else if(t.isDictionaryBatch()){this._dictionaryIndex++;const r=t.header(),i=n.readMessageBody(t.bodyLength),s=this._loadDictionaryBatch(r,i);this.dictionaries.set(r.id,s)}return this.schema&&this._recordBatchIndex===0?(this._recordBatchIndex++,{done:!1,value:new _m(this.schema)}):this.return()}_readNextMessageAndValidate(t){return this._reader.readMessage(t)}}class kh extends CT{constructor(t,n){super(n),this._reader=new Kq(this._handle=t)}isAsync(){return!0}isStream(){return!0}[Symbol.asyncIterator](){return this}cancel(){return _t(this,void 0,void 0,function*(){!this.closed&&(this.closed=!0)&&(yield this.reset()._reader.return(),this._reader=null,this.dictionaries=null)})}open(t){return _t(this,void 0,void 0,function*(){return this.closed||(this.autoDestroy=BT(this,t),this.schema||(this.schema=yield this._reader.readSchema())||(yield this.cancel())),this})}throw(t){return _t(this,void 0,void 0,function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.throw(t):pe})}return(t){return _t(this,void 0,void 0,function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.return(t):pe})}next(){return _t(this,void 0,void 0,function*(){if(this.closed)return pe;let t;const{_reader:n}=this;for(;t=yield this._readNextMessageAndValidate();)if(t.isSchema())yield this.reset(t.header());else if(t.isRecordBatch()){this._recordBatchIndex++;const r=t.header(),i=yield n.readMessageBody(t.bodyLength);return{done:!1,value:this._loadRecordBatch(r,i)}}else if(t.isDictionaryBatch()){this._dictionaryIndex++;const r=t.header(),i=yield n.readMessageBody(t.bodyLength),s=this._loadDictionaryBatch(r,i);this.dictionaries.set(r.id,s)}return this.schema&&this._recordBatchIndex===0?(this._recordBatchIndex++,{done:!1,value:new _m(this.schema)}):yield this.return()})}_readNextMessageAndValidate(t){return _t(this,void 0,void 0,function*(){return yield this._reader.readMessage(t)})}}class kT extends Ch{get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}constructor(t,n){super(t instanceof yT?t:new yT(t),n)}isSync(){return!0}isFile(){return!0}open(t){if(!this.closed&&!this._footer){this.schema=(this._footer=this._readFooter()).schema;for(const n of this._footer.dictionaryBatches())n&&this._readDictionaryBatch(this._dictionaryIndex++)}return super.open(t)}readRecordBatch(t){var n;if(this.closed)return null;this._footer||this.open();const r=(n=this._footer)===null||n===void 0?void 0:n.getRecordBatch(t);if(r&&this._handle.seek(r.offset)){const i=this._reader.readMessage(Ct.RecordBatch);if(i?.isRecordBatch()){const s=i.header(),o=this._reader.readMessageBody(i.bodyLength);return this._loadRecordBatch(s,o)}}return null}_readDictionaryBatch(t){var n;const r=(n=this._footer)===null||n===void 0?void 0:n.getDictionaryBatch(t);if(r&&this._handle.seek(r.offset)){const i=this._reader.readMessage(Ct.DictionaryBatch);if(i?.isDictionaryBatch()){const s=i.header(),o=this._reader.readMessageBody(i.bodyLength),a=this._loadDictionaryBatch(s,o);this.dictionaries.set(s.id,a)}}}_readFooter(){const{_handle:t}=this,n=t.size-LT,r=t.readInt32(n),i=t.readAt(n-r,r);return cu.decode(i)}_readNextMessageAndValidate(t){var n;if(this._footer||this.open(),this._footer&&this._recordBatchIndex<this.numRecordBatches){const r=(n=this._footer)===null||n===void 0?void 0:n.getRecordBatch(this._recordBatchIndex);if(r&&this._handle.seek(r.offset))return this._reader.readMessage(t)}return null}}class nj extends kh{get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}constructor(t,...n){const r=typeof n[0]!="number"?n.shift():void 0,i=n[0]instanceof Map?n.shift():void 0;super(t instanceof $h?t:new $h(t,r),i)}isFile(){return!0}isAsync(){return!0}open(t){const n=Object.create(null,{open:{get:()=>super.open}});return _t(this,void 0,void 0,function*(){if(!this.closed&&!this._footer){this.schema=(this._footer=yield this._readFooter()).schema;for(const r of this._footer.dictionaryBatches())r&&(yield this._readDictionaryBatch(this._dictionaryIndex++))}return yield n.open.call(this,t)})}readRecordBatch(t){return _t(this,void 0,void 0,function*(){var n;if(this.closed)return null;this._footer||(yield this.open());const r=(n=this._footer)===null||n===void 0?void 0:n.getRecordBatch(t);if(r&&(yield this._handle.seek(r.offset))){const i=yield this._reader.readMessage(Ct.RecordBatch);if(i?.isRecordBatch()){const s=i.header(),o=yield this._reader.readMessageBody(i.bodyLength);return this._loadRecordBatch(s,o)}}return null})}_readDictionaryBatch(t){return _t(this,void 0,void 0,function*(){var n;const r=(n=this._footer)===null||n===void 0?void 0:n.getDictionaryBatch(t);if(r&&(yield this._handle.seek(r.offset))){const i=yield this._reader.readMessage(Ct.DictionaryBatch);if(i?.isDictionaryBatch()){const s=i.header(),o=yield this._reader.readMessageBody(i.bodyLength),a=this._loadDictionaryBatch(s,o);this.dictionaries.set(s.id,a)}}})}_readFooter(){return _t(this,void 0,void 0,function*(){const{_handle:t}=this;t._pending&&(yield t._pending);const n=t.size-LT,r=yield t.readInt32(n),i=yield t.readAt(n-r,r);return cu.decode(i)})}_readNextMessageAndValidate(t){return _t(this,void 0,void 0,function*(){if(this._footer||(yield this.open()),this._footer&&this._recordBatchIndex<this.numRecordBatches){const n=this._footer.getRecordBatch(this._recordBatchIndex);if(n&&(yield this._handle.seek(n.offset)))return yield this._reader.readMessage(t)}return null})}}class rj extends Ch{constructor(t,n){super(t,n)}_loadVectors(t,n,r){return new mq(n,t.nodes,t.buffers,this.dictionaries,this.schema.metadataVersion).visitMany(r)}}function BT(e,t){return t&&typeof t.autoDestroy=="boolean"?t.autoDestroy:e.autoDestroy}function*PT(e){const t=Xn.from(e);try{if(!t.open({autoDestroy:!1}).closed)do yield t;while(!t.reset().open().closed)}finally{t.cancel()}}function UT(e){return Or(this,arguments,function*(){const n=yield xt(Xn.from(e));try{if(!(yield xt(n.open({autoDestroy:!1}))).closed)do yield yield xt(n);while(!(yield xt(n.reset().open())).closed)}finally{yield xt(n.cancel())}})}function ij(e){return new Lh(new rj(e))}function sj(e){const t=e.peek(du+7&-8);return t&&t.byteLength>=4?Am(t)?new FT(new kT(e.read())):new Lh(new Ch(e)):new Lh(new Ch((function*(){})()))}function oj(e){return _t(this,void 0,void 0,function*(){const t=yield e.peek(du+7&-8);return t&&t.byteLength>=4?Am(t)?new FT(new kT(yield e.read())):new Fh(new kh(e)):new Fh(new kh((function(){return Or(this,arguments,function*(){})})()))})}function aj(e){return _t(this,void 0,void 0,function*(){const{size:t}=yield e.stat(),n=new $h(e,t);return t>=tj&&Am(yield n.readAt(0,du+7&-8))?new ej(new nj(n)):new Fh(new kh(n))})}class ye extends At{static assemble(...t){const n=i=>i.flatMap(s=>Array.isArray(s)?n(s):s instanceof _n?s.data.children:s.data),r=new ye;return r.visitMany(n(t)),r}constructor(){super(),this._byteLength=0,this._nodes=[],this._buffers=[],this._bufferRegions=[]}visit(t){if(t instanceof de)return this.visitMany(t.data),this;const{type:n}=t;if(!Z.isDictionary(n)){const{length:r}=t;if(r>2147483647)throw new RangeError("Cannot write arrays larger than 2^31 - 1 in length");if(Z.isUnion(n))this.nodes.push(new _s(r,0));else{const{nullCount:i}=t;Z.isNull(n)||fr.call(this,i<=0?new Uint8Array(0):vh(t.offset,r,t.nullBitmap)),this.nodes.push(new _s(r,i))}}return super.visit(t)}visitNull(t){return this}visitDictionary(t){return this.visit(t.clone(t.type.indices))}get nodes(){return this._nodes}get buffers(){return this._buffers}get byteLength(){return this._byteLength}get bufferRegions(){return this._bufferRegions}}function fr(e){const t=e.byteLength+7&-8;return this.buffers.push(e),this.bufferRegions.push(new zr(this._byteLength,t)),this._byteLength+=t,this}function cj(e){var t;const{type:n,length:r,typeIds:i,valueOffsets:s}=e;if(fr.call(this,i),n.mode===Ve.Sparse)return Em.call(this,e);if(n.mode===Ve.Dense){if(e.offset<=0)return fr.call(this,s),Em.call(this,e);{const o=new Int32Array(r),a=Object.create(null),c=Object.create(null);for(let u,l,h=-1;++h<r;)(u=i[h])!==void 0&&((l=a[u])===void 0&&(l=a[u]=s[h]),o[h]=s[h]-l,c[u]=((t=c[u])!==null&&t!==void 0?t:0)+1);fr.call(this,o),this.visitMany(e.children.map((u,l)=>{const h=n.typeIds[l],f=a[h],d=c[h];return u.slice(f,Math.min(r,d))}))}}return this}function uj(e){let t;return e.nullCount>=e.length?fr.call(this,new Uint8Array(0)):(t=e.values)instanceof Uint8Array?fr.call(this,vh(e.offset,e.length,t)):fr.call(this,xh(e.values))}function Si(e){return fr.call(this,e.values.subarray(0,e.length*e.stride))}function Bh(e){const{length:t,values:n,valueOffsets:r}=e,i=Qt(r[0]),s=Qt(r[t]),o=Math.min(s-i,n.byteLength-i);return fr.call(this,SM(-i,t+1,r)),fr.call(this,n.subarray(i,i+o)),this}function Im(e){const{length:t,valueOffsets:n}=e;if(n){const{[0]:r,[t]:i}=n;return fr.call(this,SM(-r,t+1,n)),this.visit(e.children[0].slice(r,i-r))}return this.visit(e.children[0])}function Em(e){return this.visitMany(e.type.children.map((t,n)=>e.children[n]).filter(Boolean))[0]}ye.prototype.visitBool=uj,ye.prototype.visitInt=Si,ye.prototype.visitFloat=Si,ye.prototype.visitUtf8=Bh,ye.prototype.visitLargeUtf8=Bh,ye.prototype.visitBinary=Bh,ye.prototype.visitLargeBinary=Bh,ye.prototype.visitFixedSizeBinary=Si,ye.prototype.visitDate=Si,ye.prototype.visitTimestamp=Si,ye.prototype.visitTime=Si,ye.prototype.visitDecimal=Si,ye.prototype.visitList=Im,ye.prototype.visitStruct=Em,ye.prototype.visitUnion=cj,ye.prototype.visitInterval=Si,ye.prototype.visitDuration=Si,ye.prototype.visitFixedSizeList=Im,ye.prototype.visitMap=Im;class zT extends hm{static throughNode(t){throw new Error('"throughNode" not available in this environment')}static throughDOM(t,n){throw new Error('"throughDOM" not available in this environment')}constructor(t){super(),this._position=0,this._started=!1,this._sink=new Mh,this._schema=null,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._seenDictionaries=new Map,this._dictionaryDeltaOffsets=new Map,yn(t)||(t={autoDestroy:!0,writeLegacyIpcFormat:!1}),this._autoDestroy=typeof t.autoDestroy=="boolean"?t.autoDestroy:!0,this._writeLegacyIpcFormat=typeof t.writeLegacyIpcFormat=="boolean"?t.writeLegacyIpcFormat:!1}toString(t=!1){return this._sink.toString(t)}toUint8Array(t=!1){return this._sink.toUint8Array(t)}writeAll(t){return so(t)?t.then(n=>this.writeAll(n)):Jo(t)?Nm(this,t):$m(this,t)}get closed(){return this._sink.closed}[Symbol.asyncIterator](){return this._sink[Symbol.asyncIterator]()}toDOMStream(t){return this._sink.toDOMStream(t)}toNodeStream(t){return this._sink.toNodeStream(t)}close(){return this.reset()._sink.close()}abort(t){return this.reset()._sink.abort(t)}finish(){return this._autoDestroy?this.close():this.reset(this._sink,this._schema),this}reset(t=this._sink,n=null){return t===this._sink||t instanceof Mh?this._sink=t:(this._sink=new Mh,t&&zU(t)?this.toDOMStream({type:"bytes"}).pipeTo(t):t&&qU(t)&&this.toNodeStream({objectMode:!1}).pipe(t)),this._started&&this._schema&&this._writeFooter(this._schema),this._started=!1,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._seenDictionaries=new Map,this._dictionaryDeltaOffsets=new Map,(!n||!gm(n,this._schema))&&(n==null?(this._position=0,this._schema=null):(this._started=!0,this._schema=n,this._writeSchema(n))),this}write(t){let n=null;if(this._sink){if(t==null)return this.finish()&&void 0;if(t instanceof gs&&!(n=t.schema))return this.finish()&&void 0;if(t instanceof _n&&!(n=t.schema))return this.finish()&&void 0}else throw new Error("RecordBatchWriter is closed");if(n&&!gm(n,this._schema)){if(this._started&&this._autoDestroy)return this.close();this.reset(this._sink,n)}t instanceof _n?t instanceof _m||this._writeRecordBatch(t):t instanceof gs?this.writeAll(t.batches):eu(t)&&this.writeAll(t)}_writeMessage(t,n=8){const r=n-1,i=rn.encode(t),s=i.byteLength,o=this._writeLegacyIpcFormat?4:8,a=s+o+r&~r,c=a-s-o;return t.headerType===Ct.RecordBatch?this._recordBatchBlocks.push(new ys(a,t.bodyLength,this._position)):t.headerType===Ct.DictionaryBatch&&this._dictionaryBlocks.push(new ys(a,t.bodyLength,this._position)),this._writeLegacyIpcFormat||this._write(Int32Array.of(-1)),this._write(Int32Array.of(a-o)),s>0&&this._write(i),this._writePadding(c)}_write(t){if(this._started){const n=Rt(t);n&&n.byteLength>0&&(this._sink.write(n),this._position+=n.byteLength)}return this}_writeSchema(t){return this._writeMessage(rn.from(t))}_writeFooter(t){return this._writeLegacyIpcFormat?this._write(Int32Array.of(0)):this._write(Int32Array.of(-1,0))}_writeMagic(){return this._write(hu)}_writePadding(t){return t>0?this._write(new Uint8Array(t)):this}_writeRecordBatch(t){const{byteLength:n,nodes:r,bufferRegions:i,buffers:s}=ye.assemble(t),o=new Mn(t.numRows,r,i),a=rn.from(o,n);return this._writeDictionaries(t)._writeMessage(a)._writeBodyBuffers(s)}_writeDictionaryBatch(t,n,r=!1){const{byteLength:i,nodes:s,bufferRegions:o,buffers:a}=ye.assemble(new de([t])),c=new Mn(t.length,s,o),u=new Ur(c,n,r),l=rn.from(u,i);return this._writeMessage(l)._writeBodyBuffers(a)}_writeBodyBuffers(t){let n,r,i;for(let s=-1,o=t.length;++s<o;)(n=t[s])&&(r=n.byteLength)>0&&(this._write(n),(i=(r+7&-8)-r)>0&&this._writePadding(i));return this}_writeDictionaries(t){var n,r;for(const[i,s]of t.dictionaries){const o=(n=s?.data)!==null&&n!==void 0?n:[],a=this._seenDictionaries.get(i),c=(r=this._dictionaryDeltaOffsets.get(i))!==null&&r!==void 0?r:0;if(!a||a.data[0]!==o[0])for(const[u,l]of o.entries())this._writeDictionaryBatch(l,i,u>0);else if(c<o.length)for(const u of o.slice(c))this._writeDictionaryBatch(u,i,!0);this._seenDictionaries.set(i,s),this._dictionaryDeltaOffsets.set(i,o.length)}return this}}class Mm extends zT{static writeAll(t,n){const r=new Mm(n);return so(t)?t.then(i=>r.writeAll(i)):Jo(t)?Nm(r,t):$m(r,t)}}class Tm extends zT{static writeAll(t){const n=new Tm;return so(t)?t.then(r=>n.writeAll(r)):Jo(t)?Nm(n,t):$m(n,t)}constructor(){super(),this._autoDestroy=!0}_writeSchema(t){return this._writeMagic()._writePadding(2)}_writeDictionaryBatch(t,n,r=!1){if(!r&&this._seenDictionaries.has(n))throw new Error("The Arrow File format does not support replacement dictionaries. ");return super._writeDictionaryBatch(t,n,r)}_writeFooter(t){const n=cu.encode(new cu(t,xe.V5,this._recordBatchBlocks,this._dictionaryBlocks));return super._writeFooter(t)._write(n)._write(Int32Array.of(n.byteLength))._writeMagic()}}function $m(e,t){let n=t;t instanceof gs&&(n=t.batches,e.reset(void 0,t.schema));for(const r of n)e.write(r);return e.finish()}function Nm(e,t){return _t(this,void 0,void 0,function*(){var n,r,i,s,o,a,c;try{for(n=!0,r=io(t);i=yield r.next(),s=i.done,!s;n=!0){c=i.value,n=!1;const u=c;e.write(u)}}catch(u){o={error:u}}finally{try{!n&&!s&&(a=r.return)&&(yield a.call(r))}finally{if(o)throw o.error}}return e.finish()})}function lj(e,t="stream"){return(t==="stream"?Mm:Tm).writeAll(e).toUint8Array(!0)}var fj=Object.create,qT=Object.defineProperty,hj=Object.getOwnPropertyDescriptor,dj=Object.getOwnPropertyNames,pj=Object.getPrototypeOf,yj=Object.prototype.hasOwnProperty,mj=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),gj=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of dj(t))!yj.call(e,i)&&i!==n&&qT(e,i,{get:()=>t[i],enumerable:!(r=hj(t,i))||r.enumerable});return e},bj=(e,t,n)=>(n=e!=null?fj(pj(e)):{},gj(!e||!e.__esModule?qT(n,"default",{value:e,enumerable:!0}):n,e)),_j=mj((e,t)=>{t.exports=Worker}),wj=(e=>(e[e.UNDEFINED=0]="UNDEFINED",e[e.AUTOMATIC=1]="AUTOMATIC",e[e.READ_ONLY=2]="READ_ONLY",e[e.READ_WRITE=3]="READ_WRITE",e))(wj||{}),vj=(e=>(e[e.IDENTIFIER=0]="IDENTIFIER",e[e.NUMERIC_CONSTANT=1]="NUMERIC_CONSTANT",e[e.STRING_CONSTANT=2]="STRING_CONSTANT",e[e.OPERATOR=3]="OPERATOR",e[e.KEYWORD=4]="KEYWORD",e[e.COMMENT=5]="COMMENT",e))(vj||{}),xj=(e=>(e[e.NONE=0]="NONE",e[e.DEBUG=1]="DEBUG",e[e.INFO=2]="INFO",e[e.WARNING=3]="WARNING",e[e.ERROR=4]="ERROR",e))(xj||{}),Sj=(e=>(e[e.NONE=0]="NONE",e[e.CONNECT=1]="CONNECT",e[e.DISCONNECT=2]="DISCONNECT",e[e.OPEN=3]="OPEN",e[e.QUERY=4]="QUERY",e[e.INSTANTIATE=5]="INSTANTIATE",e))(Sj||{}),Aj=(e=>(e[e.NONE=0]="NONE",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR",e[e.START=3]="START",e[e.RUN=4]="RUN",e[e.CAPTURE=5]="CAPTURE",e))(Aj||{}),Ij=(e=>(e[e.NONE=0]="NONE",e[e.WEB_WORKER=1]="WEB_WORKER",e[e.NODE_WORKER=2]="NODE_WORKER",e[e.BINDINGS=3]="BINDINGS",e[e.ASYNC_DUCKDB=4]="ASYNC_DUCKDB",e))(Ij||{}),Ej=class{log(t){}},Mj=class{constructor(e=2){this.level=e}log(e){e.level>=this.level&&console.log(e)}},Tj=(e=>(e[e.SUCCESS=0]="SUCCESS",e[e.MAX_ARROW_ERROR=255]="MAX_ARROW_ERROR",e[e.DUCKDB_WASM_RETRY=256]="DUCKDB_WASM_RETRY",e))(Tj||{}),$j=class{constructor(t,n){this._bindings=t,this._conn=n}get bindings(){return this._bindings}async close(){return this._bindings.disconnect(this._conn)}useUnsafe(t){return t(this._bindings,this._conn)}async query(t){this._bindings.logger.log({timestamp:new Date,level:2,origin:4,topic:4,event:4,value:t});let n=await this._bindings.runQuery(this._conn,t),r=Xn.from(n);return console.assert(r.isSync(),"Reader is not sync"),console.assert(r.isFile(),"Reader is not file"),new gs(r)}async send(t,n=!1){this._bindings.logger.log({timestamp:new Date,level:2,origin:4,topic:4,event:4,value:t});let r=await this._bindings.startPendingQuery(this._conn,t,n);for(;r==null;)r=await this._bindings.pollPendingQuery(this._conn);let i=new jT(this._bindings,this._conn,r),s=await Xn.from(i);return console.assert(s.isAsync()),console.assert(s.isStream()),s}async cancelSent(){return await this._bindings.cancelPendingQuery(this._conn)}async getTableNames(t){return await this._bindings.getTableNames(this._conn,t)}async prepare(t){let n=await this._bindings.createPrepared(this._conn,t);return new Nj(this._bindings,this._conn,n)}async insertArrowTable(t,n){let r=lj(t,"stream");await this.insertArrowFromIPCStream(r,n)}async insertArrowFromIPCStream(t,n){await this._bindings.insertArrowFromIPCStream(this._conn,t,n)}async insertCSVFromPath(t,n){await this._bindings.insertCSVFromPath(this._conn,t,n)}async insertJSONFromPath(t,n){await this._bindings.insertJSONFromPath(this._conn,t,n)}},jT=class{constructor(e,t,n){this.db=e,this.conn=t,this.header=n,this._first=!0,this._depleted=!1,this._inFlight=null}async next(){if(this._first)return this._first=!1,{done:!1,value:this.header};if(this._depleted)return{done:!0,value:null};let e=null;for(this._inFlight!=null&&(e=await this._inFlight,this._inFlight=null);e==null;)e=await this.db.fetchQueryResults(this.conn);return this._depleted=e.length==0,this._depleted||(this._inFlight=this.db.fetchQueryResults(this.conn)),{done:this._depleted,value:e}}[Symbol.asyncIterator](){return this}},Nj=class{constructor(e,t,n){this.bindings=e,this.connectionId=t,this.statementId=n}async close(){await this.bindings.closePrepared(this.connectionId,this.statementId)}async query(...e){let t=await this.bindings.runPrepared(this.connectionId,this.statementId,e),n=Xn.from(t);return console.assert(n.isSync()),console.assert(n.isFile()),new gs(n)}async send(...e){let t=await this.bindings.sendPrepared(this.connectionId,this.statementId,e),n=new jT(this.bindings,this.connectionId,t),r=await Xn.from(n);return console.assert(r.isAsync()),console.assert(r.isStream()),r}},Rj=(e=>(e.CANCEL_PENDING_QUERY="CANCEL_PENDING_QUERY",e.CLOSE_PREPARED="CLOSE_PREPARED",e.COLLECT_FILE_STATISTICS="COLLECT_FILE_STATISTICS",e.REGISTER_OPFS_FILE_NAME="REGISTER_OPFS_FILE_NAME",e.CONNECT="CONNECT",e.COPY_FILE_TO_BUFFER="COPY_FILE_TO_BUFFER",e.COPY_FILE_TO_PATH="COPY_FILE_TO_PATH",e.CREATE_PREPARED="CREATE_PREPARED",e.DISCONNECT="DISCONNECT",e.DROP_FILE="DROP_FILE",e.DROP_FILES="DROP_FILES",e.EXPORT_FILE_STATISTICS="EXPORT_FILE_STATISTICS",e.FETCH_QUERY_RESULTS="FETCH_QUERY_RESULTS",e.FLUSH_FILES="FLUSH_FILES",e.GET_FEATURE_FLAGS="GET_FEATURE_FLAGS",e.GET_TABLE_NAMES="GET_TABLE_NAMES",e.GET_VERSION="GET_VERSION",e.GLOB_FILE_INFOS="GLOB_FILE_INFOS",e.INSERT_ARROW_FROM_IPC_STREAM="INSERT_ARROW_FROM_IPC_STREAM",e.INSERT_CSV_FROM_PATH="IMPORT_CSV_FROM_PATH",e.INSERT_JSON_FROM_PATH="IMPORT_JSON_FROM_PATH",e.INSTANTIATE="INSTANTIATE",e.OPEN="OPEN",e.PING="PING",e.POLL_PENDING_QUERY="POLL_PENDING_QUERY",e.REGISTER_FILE_BUFFER="REGISTER_FILE_BUFFER",e.REGISTER_FILE_HANDLE="REGISTER_FILE_HANDLE",e.REGISTER_FILE_URL="REGISTER_FILE_URL",e.RESET="RESET",e.RUN_PREPARED="RUN_PREPARED",e.RUN_QUERY="RUN_QUERY",e.SEND_PREPARED="SEND_PREPARED",e.START_PENDING_QUERY="START_PENDING_QUERY",e.TOKENIZE="TOKENIZE",e))(Rj||{}),Oj=(e=>(e.CONNECTION_INFO="CONNECTION_INFO",e.ERROR="ERROR",e.FEATURE_FLAGS="FEATURE_FLAGS",e.FILE_BUFFER="FILE_BUFFER",e.FILE_INFOS="FILE_INFOS",e.FILE_SIZE="FILE_SIZE",e.FILE_STATISTICS="FILE_STATISTICS",e.INSTANTIATE_PROGRESS="INSTANTIATE_PROGRESS",e.LOG="LOG",e.PROGRESS_UPDATE="PROGRESS_UPDATE",e.OK="OK",e.PREPARED_STATEMENT_ID="PREPARED_STATEMENT_ID",e.QUERY_PLAN="QUERY_PLAN",e.QUERY_RESULT="QUERY_RESULT",e.QUERY_RESULT_CHUNK="QUERY_RESULT_CHUNK",e.QUERY_RESULT_HEADER="QUERY_RESULT_HEADER",e.QUERY_RESULT_HEADER_OR_NULL="QUERY_RESULT_HEADER_OR_NULL",e.REGISTERED_FILE="REGISTERED_FILE",e.SCRIPT_TOKENS="SCRIPT_TOKENS",e.SUCCESS="SUCCESS",e.TABLE_NAMES="TABLE_NAMES",e.VERSION_STRING="VERSION_STRING",e))(Oj||{}),Lt=class{constructor(e,t){this.promiseResolver=()=>{},this.promiseRejecter=()=>{},this.type=e,this.data=t,this.promise=new Promise((n,r)=>{this.promiseResolver=n,this.promiseRejecter=r})}};function Ph(e){switch(e.typeId){case O.Binary:return{sqlType:"binary"};case O.Bool:return{sqlType:"bool"};case O.Date:return{sqlType:"date"};case O.DateDay:return{sqlType:"date32[d]"};case O.DateMillisecond:return{sqlType:"date64[ms]"};case O.Decimal:{let t=e;return{sqlType:"decimal",precision:t.precision,scale:t.scale}}case O.Float:return{sqlType:"float"};case O.Float16:return{sqlType:"float16"};case O.Float32:return{sqlType:"float32"};case O.Float64:return{sqlType:"float64"};case O.Int:return{sqlType:"int32"};case O.Int16:return{sqlType:"int16"};case O.Int32:return{sqlType:"int32"};case O.Int64:return{sqlType:"int64"};case O.Uint16:return{sqlType:"uint16"};case O.Uint32:return{sqlType:"uint32"};case O.Uint64:return{sqlType:"uint64"};case O.Uint8:return{sqlType:"uint8"};case O.IntervalDayTime:return{sqlType:"interval[dt]"};case O.IntervalYearMonth:return{sqlType:"interval[m]"};case O.List:return{sqlType:"list",valueType:Ph(e.valueType)};case O.FixedSizeBinary:return{sqlType:"fixedsizebinary",byteWidth:e.byteWidth};case O.Null:return{sqlType:"null"};case O.Utf8:return{sqlType:"utf8"};case O.Struct:return{sqlType:"struct",fields:e.children.map(t=>Rm(t.name,t.type))};case O.Map:{let t=e;return{sqlType:"map",keyType:Ph(t.keyType),valueType:Ph(t.valueType)}}case O.Time:return{sqlType:"time[s]"};case O.TimeMicrosecond:return{sqlType:"time[us]"};case O.TimeMillisecond:return{sqlType:"time[ms]"};case O.TimeNanosecond:return{sqlType:"time[ns]"};case O.TimeSecond:return{sqlType:"time[s]"};case O.Timestamp:return{sqlType:"timestamp",timezone:e.timezone||void 0};case O.TimestampSecond:return{sqlType:"timestamp[s]",timezone:e.timezone||void 0};case O.TimestampMicrosecond:return{sqlType:"timestamp[us]",timezone:e.timezone||void 0};case O.TimestampNanosecond:return{sqlType:"timestamp[ns]",timezone:e.timezone||void 0};case O.TimestampMillisecond:return{sqlType:"timestamp[ms]",timezone:e.timezone||void 0}}throw new Error("unsupported arrow type: ".concat(e.toString()))}function Rm(e,t){let n=Ph(t);return n.name=e,n}var Dj=new TextEncoder,Lj=class{constructor(e,t=null){this._onInstantiationProgress=[],this._onExecutionProgress=[],this._worker=null,this._workerShutdownPromise=null,this._workerShutdownResolver=()=>{},this._nextMessageId=0,this._pendingRequests=new Map,this._logger=e,this._onMessageHandler=this.onMessage.bind(this),this._onErrorHandler=this.onError.bind(this),this._onCloseHandler=this.onClose.bind(this),t!=null&&this.attach(t)}get logger(){return this._logger}attach(e){this._worker=e,this._worker.addEventListener("message",this._onMessageHandler),this._worker.addEventListener("error",this._onErrorHandler),this._worker.addEventListener("close",this._onCloseHandler),this._workerShutdownPromise=new Promise((t,n)=>{this._workerShutdownResolver=t})}detach(){this._worker&&(this._worker.removeEventListener("message",this._onMessageHandler),this._worker.removeEventListener("error",this._onErrorHandler),this._worker.removeEventListener("close",this._onCloseHandler),this._worker=null,this._workerShutdownResolver(null),this._workerShutdownPromise=null,this._workerShutdownResolver=()=>{})}async terminate(){this._worker&&(this._worker.terminate(),this._worker=null,this._workerShutdownPromise=null,this._workerShutdownResolver=()=>{})}async postTask(e,t=[]){if(!this._worker){console.error("cannot send a message since the worker is not set!");return}let n=this._nextMessageId++;return this._pendingRequests.set(n,e),this._worker.postMessage({messageId:n,type:e.type,data:e.data},t),await e.promise}onMessage(e){var t;let n=e.data;switch(n.type){case"PROGRESS_UPDATE":{for(let i of this._onExecutionProgress)i(n.data);return}case"LOG":{this._logger.log(n.data);return}case"INSTANTIATE_PROGRESS":{for(let i of this._onInstantiationProgress)i(n.data);return}}let r=this._pendingRequests.get(n.requestId);if(!r){console.warn("unassociated response: [".concat(n.requestId,", ").concat(n.type.toString(),"]"));return}if(this._pendingRequests.delete(n.requestId),n.type=="ERROR"){let i=new Error(n.data.message);i.name=n.data.name,(t=Object.getOwnPropertyDescriptor(i,"stack"))!=null&&t.writable&&(i.stack=n.data.stack),r.promiseRejecter(i);return}switch(r.type){case"CLOSE_PREPARED":case"COLLECT_FILE_STATISTICS":case"REGISTER_OPFS_FILE_NAME":case"COPY_FILE_TO_PATH":case"DISCONNECT":case"DROP_FILE":case"DROP_FILES":case"FLUSH_FILES":case"INSERT_ARROW_FROM_IPC_STREAM":case"IMPORT_CSV_FROM_PATH":case"IMPORT_JSON_FROM_PATH":case"OPEN":case"PING":case"REGISTER_FILE_BUFFER":case"REGISTER_FILE_HANDLE":case"REGISTER_FILE_URL":case"RESET":if(n.type=="OK"){r.promiseResolver(n.data);return}break;case"INSTANTIATE":if(this._onInstantiationProgress=[],n.type=="OK"){r.promiseResolver(n.data);return}break;case"GLOB_FILE_INFOS":if(n.type=="FILE_INFOS"){r.promiseResolver(n.data);return}break;case"GET_VERSION":if(n.type=="VERSION_STRING"){r.promiseResolver(n.data);return}break;case"GET_FEATURE_FLAGS":if(n.type=="FEATURE_FLAGS"){r.promiseResolver(n.data);return}break;case"GET_TABLE_NAMES":if(n.type=="TABLE_NAMES"){r.promiseResolver(n.data);return}break;case"TOKENIZE":if(n.type=="SCRIPT_TOKENS"){r.promiseResolver(n.data);return}break;case"COPY_FILE_TO_BUFFER":if(n.type=="FILE_BUFFER"){r.promiseResolver(n.data);return}break;case"EXPORT_FILE_STATISTICS":if(n.type=="FILE_STATISTICS"){r.promiseResolver(n.data);return}break;case"CONNECT":if(n.type=="CONNECTION_INFO"){r.promiseResolver(n.data);return}break;case"RUN_PREPARED":case"RUN_QUERY":if(n.type=="QUERY_RESULT"){r.promiseResolver(n.data);return}break;case"SEND_PREPARED":if(n.type=="QUERY_RESULT_HEADER"){r.promiseResolver(n.data);return}break;case"START_PENDING_QUERY":if(n.type=="QUERY_RESULT_HEADER_OR_NULL"){r.promiseResolver(n.data);return}break;case"POLL_PENDING_QUERY":if(n.type=="QUERY_RESULT_HEADER_OR_NULL"){r.promiseResolver(n.data);return}break;case"CANCEL_PENDING_QUERY":if(this._onInstantiationProgress=[],n.type=="SUCCESS"){r.promiseResolver(n.data);return}break;case"FETCH_QUERY_RESULTS":if(n.type=="QUERY_RESULT_CHUNK"){r.promiseResolver(n.data);return}break;case"CREATE_PREPARED":if(n.type=="PREPARED_STATEMENT_ID"){r.promiseResolver(n.data);return}break}r.promiseRejecter(new Error("unexpected response type: ".concat(n.type.toString())))}onError(e){console.error(e),console.error("error in duckdb worker: ".concat(e.message)),this._pendingRequests.clear()}onClose(){if(this._workerShutdownResolver(null),this._pendingRequests.size!=0){console.warn("worker terminated with ".concat(this._pendingRequests.size," pending requests"));return}this._pendingRequests.clear()}async reset(){let e=new Lt("RESET",null);return await this.postTask(e)}async ping(){let e=new Lt("PING",null);await this.postTask(e)}async dropFile(e){let t=new Lt("DROP_FILE",e);return await this.postTask(t)}async dropFiles(){let e=new Lt("DROP_FILES",null);return await this.postTask(e)}async flushFiles(){let e=new Lt("FLUSH_FILES",null);return await this.postTask(e)}async instantiate(e,t=null,n=r=>{}){this._onInstantiationProgress.push(n);let r=new Lt("INSTANTIATE",[e,t]);return await this.postTask(r)}async getVersion(){let e=new Lt("GET_VERSION",null);return await this.postTask(e)}async getFeatureFlags(){let e=new Lt("GET_FEATURE_FLAGS",null);return await this.postTask(e)}async open(e){let t=new Lt("OPEN",e);await this.postTask(t)}async tokenize(e){let t=new Lt("TOKENIZE",e);return await this.postTask(t)}async connectInternal(){let e=new Lt("CONNECT",null);return await this.postTask(e)}async connect(){let e=await this.connectInternal();return new $j(this,e)}async disconnect(e){let t=new Lt("DISCONNECT",e);await this.postTask(t)}async runQuery(e,t){let n=new Lt("RUN_QUERY",[e,t]);return await this.postTask(n)}async startPendingQuery(e,t,n=!1){let r=new Lt("START_PENDING_QUERY",[e,t,n]);return await this.postTask(r)}async pollPendingQuery(e){let t=new Lt("POLL_PENDING_QUERY",e);return await this.postTask(t)}async cancelPendingQuery(e){let t=new Lt("CANCEL_PENDING_QUERY",e);return await this.postTask(t)}async fetchQueryResults(e){let t=new Lt("FETCH_QUERY_RESULTS",e);return await this.postTask(t)}async getTableNames(e,t){let n=new Lt("GET_TABLE_NAMES",[e,t]);return await this.postTask(n)}async createPrepared(e,t){let n=new Lt("CREATE_PREPARED",[e,t]);return await this.postTask(n)}async closePrepared(e,t){let n=new Lt("CLOSE_PREPARED",[e,t]);await this.postTask(n)}async runPrepared(e,t,n){let r=new Lt("RUN_PREPARED",[e,t,n]);return await this.postTask(r)}async sendPrepared(e,t,n){let r=new Lt("SEND_PREPARED",[e,t,n]);return await this.postTask(r)}async globFiles(e){let t=new Lt("GLOB_FILE_INFOS",e);return await this.postTask(t)}async registerFileText(e,t){let n=Dj.encode(t);await this.registerFileBuffer(e,n)}async registerFileURL(e,t,n,r){t===void 0&&(t=e);let i=new Lt("REGISTER_FILE_URL",[e,t,n,r]);await this.postTask(i)}async registerEmptyFileBuffer(e){}async registerFileBuffer(e,t){let n=new Lt("REGISTER_FILE_BUFFER",[e,t]);await this.postTask(n,[t.buffer])}async registerFileHandle(e,t,n,r){let i=new Lt("REGISTER_FILE_HANDLE",[e,t,n,r]);await this.postTask(i,[])}async registerOPFSFileName(e){let t=new Lt("REGISTER_OPFS_FILE_NAME",[e]);await this.postTask(t,[])}async collectFileStatistics(e,t){let n=new Lt("COLLECT_FILE_STATISTICS",[e,t]);await this.postTask(n,[])}async exportFileStatistics(e){let t=new Lt("EXPORT_FILE_STATISTICS",e);return await this.postTask(t,[])}async copyFileToBuffer(e){let t=new Lt("COPY_FILE_TO_BUFFER",e);return await this.postTask(t)}async copyFileToPath(e,t){let n=new Lt("COPY_FILE_TO_PATH",[e,t]);await this.postTask(n)}async insertArrowFromIPCStream(e,t,n){if(t.length==0)return;let r=new Lt("INSERT_ARROW_FROM_IPC_STREAM",[e,t,n]);await this.postTask(r,[t.buffer])}async insertCSVFromPath(e,t,n){if(n.columns!==void 0){let i=[];for(let s in n.columns){let o=n.columns[s];i.push(Rm(s,o))}n.columnsFlat=i,delete n.columns}let r=new Lt("IMPORT_CSV_FROM_PATH",[e,t,n]);await this.postTask(r)}async insertJSONFromPath(e,t,n){if(n.columns!==void 0){let i=[];for(let s in n.columns){let o=n.columns[s];i.push(Rm(s,o))}n.columnsFlat=i,delete n.columns}let r=new Lt("IMPORT_JSON_FROM_PATH",[e,t,n]);await this.postTask(r)}};function Fj(){let e=new TextDecoder;return t=>(typeof SharedArrayBuffer<"u"&&t.buffer instanceof SharedArrayBuffer&&(t=new Uint8Array(t)),e.decode(t))}Fj();var Cj=(e=>(e[e.BUFFER=0]="BUFFER",e[e.NODE_FS=1]="NODE_FS",e[e.BROWSER_FILEREADER=2]="BROWSER_FILEREADER",e[e.BROWSER_FSACCESS=3]="BROWSER_FSACCESS",e[e.HTTP=4]="HTTP",e[e.S3=5]="S3",e))(Cj||{}),kj=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,3,1,0,1,10,14,1,12,0,65,0,65,0,65,0,252,10,0,0,11])),Bj=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,8,1,6,0,6,64,25,11,11])),Pj=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11])),Uj=()=>(async e=>{try{return typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(e)}catch{return!1}})(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11])),Om={name:"@duckdb/duckdb-wasm",version:"1.30.0"},zj=Om.name,qj=Om.version,Dm=Om.version.split(".");Dm[0],Dm[1],Dm[2];var jj=()=>typeof navigator>"u";function Yj(){let e="https://cdn.jsdelivr.net/npm/".concat(zj,"@").concat(qj,"/dist/");return{mvp:{mainModule:"".concat(e,"duckdb-mvp.wasm"),mainWorker:"".concat(e,"duckdb-browser-mvp.worker.js")},eh:{mainModule:"".concat(e,"duckdb-eh.wasm"),mainWorker:"".concat(e,"duckdb-browser-eh.worker.js")}}}var Lm=null,Fm=null,Cm=null,km=null,Bm=null;async function Vj(){return Lm==null&&(Lm=typeof BigInt64Array<"u"),Fm==null&&(Fm=await Bj()),Cm==null&&(Cm=await Uj()),km==null&&(km=await Pj()),Bm==null&&(Bm=await kj()),{bigInt64Array:Lm,crossOriginIsolated:jj()||globalThis.crossOriginIsolated||!1,wasmExceptions:Fm,wasmSIMD:km,wasmThreads:Cm,wasmBulkMemory:Bm}}async function Wj(e){let t=await Vj();if(t.wasmExceptions){if(t.wasmSIMD&&t.wasmThreads&&t.crossOriginIsolated&&e.coi)return{mainModule:e.coi.mainModule,mainWorker:e.coi.mainWorker,pthreadWorker:e.coi.pthreadWorker};if(e.eh)return{mainModule:e.eh.mainModule,mainWorker:e.eh.mainWorker,pthreadWorker:null}}return{mainModule:e.mvp.mainModule,mainWorker:e.mvp.mainWorker,pthreadWorker:null}}bj(_j());function YT(e={}){return new Pm(e)}class Pm{_ipc;_options;_db;_con;_config;_loadPromise;constructor(t={}){const{ipc:n,duckdb:r,connection:i,config:s,...o}=t;this._ipc=n,this._options=o,this._db=r,this._con=i,this._config=s}async getDuckDB(){return this._db||await VT(this),this._db}async getConnection(){return this._con||await VT(this),this._con}async query(t){const{type:n,sql:r}=t,i=await this.getConnection(),s=await Gj(i,r);return n==="exec"?void 0:n==="arrow"?Fc(s,this._ipc):Fc(s).toArray()}}function Gj(e,t){return new Promise((n,r)=>{e.useUnsafe(async(i,s)=>{try{const o=await i.runQuery(s,t);n(o)}catch(o){r(o)}})})}function VT(e){return e._loadPromise||(e._loadPromise=(e._db?Promise.resolve(e._db):Xj(e._options).then(t=>e._db=t)).then(t=>e._config!=null?t.open(e._config).then(()=>t):t).then(t=>t.connect()).then(t=>e._con=t)),e._loadPromise}async function Xj({log:e=!1}={}){const t=Yj(),n=await Wj(t),r=URL.createObjectURL(new Blob([`importScripts("${n.mainWorker}");`],{type:"text/javascript"})),i=new Worker(r),s=e?new Mj:new Ej,o=new Lj(s,i);return await o.instantiate(n.mainModule,n.pthreadWorker),URL.revokeObjectURL(r),o}function pu(e,t,{source:n,clients:r=Rc(n)?new Set([n]):void 0}){const i=t!==void 0?IE(e,[hn(t)]):null;return{meta:{type:"point"},source:n,clients:r,value:t,predicate:i}}function yu(e,t,{source:n,clients:r=Rc(n)?new Set([n]):void 0}){let i=null;if(t?.length){const s=t.length&&e.length===1?[IE(e[0],t.map(o=>hn(o[0])))]:t.map(o=>fi(o.map((a,c)=>E0(e[c],hn(a)))));i=t.length===0?hn(!1):s.length>1?hi(s):s[0]}return{meta:{type:"point"},source:n,clients:r,value:t,predicate:i}}function Uh(e,t,{source:n,clients:r=Rc(n)?new Set([n]):void 0,bin:i,scale:s,pixelSize:o=1}){const a=t!=null?cr(e,t):null;return{meta:{type:"interval",scales:s&&[s],bin:i,pixelSize:o},source:n,clients:r,value:t,predicate:a}}function WT(e,t,{source:n,clients:r=Rc(n)?new Set([n]):void 0,bin:i,scales:s=[],pixelSize:o=1}){const a=t!=null?fi(e.map((u,l)=>cr(u,t[l]))):null;return{meta:{type:"interval",scales:s,bin:i,pixelSize:o},source:n,clients:r,value:t,predicate:a}}const GT=e=>e,XT={contains:wP,prefix:vP,suffix:xP,regexp:_P};function HT(e,t,{source:n,clients:r=void 0,method:i="contains",caseSensitive:s=!1}){const o=XT[i],a=s?GT:TE,c=t?o(a(e),a(hn(t))):null;return{meta:{type:"match",method:i},source:n,clients:r,value:t,predicate:c}}function Hj(e,t,{source:n,clients:r=void 0,method:i="contains",caseSensitive:s=!1}){t=t||null;const o=XT[i],a=s?GT:TE,c=a(hn(t)),u=t?hi(e.flatMap(h=>t?o(a(h),c):[])):null;return{meta:{type:"match",method:i},source:n,clients:r,value:t,predicate:u}}function QT(e,t,{source:n,clients:r=Rc(n)?new Set([n]):void 0,listMatch:i="any"}){const o=t!==void 0?(i==="all"?cP:uP)(e,hn(t)):null;return{source:n,clients:r,value:t,predicate:o}}function JT(e){return typeof e?.getChild=="function"}class KT{_set;_done;_promise;constructor(){this._set=new Set,this._done=()=>{},this._promise=new Promise(t=>this._done=t)}pending(t){this._set.add(t)}ready(t){return this._set.delete(t),this._set.size===0}resolve(){this._promise=new Promise(t=>{this._done(),this._done=t})}get promise(){return this._promise}}function ws(e){if(JT(e))return Qj(e);if(Array.isArray(e))return Jj(e);throw new Error("Unrecognized data format.")}function Qj(e){const{numRows:t}=e;return{numRows:t,columns:e.toColumns()}}function Jj(e){const t=e.length;if(typeof e[0]=="object"){const n=t?Object.keys(e[0]):[],r={};return n.length>0&&n.forEach(i=>{r[i]=e.map(s=>s[i])}),{numRows:t,columns:r}}else return{numRows:t,values:e}}function Um(e){switch(e){case"BIGINT":case"HUGEINT":case"INTEGER":case"SMALLINT":case"TINYINT":case"UBIGINT":case"UINTEGER":case"USMALLINT":case"UTINYINT":case"DOUBLE":case"FLOAT":case"REAL":return"number";case"DATE":case"TIMESTAMP":case"TIMESTAMPTZ":case"TIMESTAMP WITH TIME ZONE":case"TIME":case"TIMESTAMP_NS":return"date";case"BOOLEAN":return"boolean";case"VARCHAR":case"UUID":case"JSON":return"string";case"ARRAY":case"LIST":return"array";case"BLOB":case"STRUCT":case"MAP":case"GEOMETRY":return"object";default:if(e.startsWith("ENUM"))return"string";if(e.startsWith("DECIMAL"))return"number";if(e.startsWith("STRUCT")||e.startsWith("MAP"))return"object";if(e.endsWith("]"))return"array";throw new Error(`Unsupported type: ${e}`)}}const Kj="count",Zj="nulls",tY="max",eY="min",nY="distinct",rY={[Kj]:ar,[nY]:e=>ar(e).distinct(),[tY]:Nr,[eY]:os,[Zj]:e=>ar().where(Of(e))};function iY({table:e,column:t,stats:n}){return gt.from(e).select(Array.from(n,r=>({[r]:rY[r](t)})))}async function zm(e,t){return t.length===1&&t[0].column==="*"?oY(e,t[0].table):(await Promise.all(t.map(n=>sY(e,n)))).filter(n=>n!==void 0)}async function sY(e,{table:t,column:n,stats:r}){const i=gt.from({source:t}).select({column:n}).groupby(Tr(n)&&us(n)?tn`ALL`:[]),[s]=Array.from(await e.query(gt.describe(i))),o={table:t,column:`${n}`,sqlType:s.column_type,type:Um(s.column_type),nullable:s.null==="YES"};if(!r?.length)return o;const[a]=await e.query(iY({table:t,column:n,stats:r}),{persist:!0});return Object.assign(o,a)}async function oY(e,t){return Array.from(await e.query(`DESCRIBE ${TI(t)}`)).map(r=>({table:t,column:r.column_name,sqlType:r.column_type,type:Um(r.column_type),nullable:r.null==="YES"}))}function aY(e){return typeof e?.activate=="function"&&e.activate.length===0}const cY=Object.freeze(Object.defineProperty({__proto__:null,Coordinator:P0,DuckDBWASMConnector:Pm,MosaicClient:qo,Param:yi,Priority:no,RestConnector:z0,Selection:ro,SocketConnector:_f,Synchronizer:KT,clauseInterval:Uh,clauseIntervals:WT,clauseList:QT,clauseMatch:HT,clauseMatchAny:Hj,clausePoint:pu,clausePoints:yu,coordinator:ls,decodeIPC:Fc,distinct:U0,isActivatable:aY,isArrowTable:JT,isParam:Sn,isSelection:An,jsType:Um,makeClient:DU,queryFieldInfo:zm,restConnector:dM,socketConnector:Q3,throttle:Ky,toDataColumns:ws,wasmConnector:YT},Symbol.toStringTag,{value:"Module"})),ya=Symbol("Fixed"),hr=Symbol("Transient"),ZT=Symbol("Transform");function qt(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function lo(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function zh(e){let t,n,r;e.length!==2?(t=qt,n=(a,c)=>qt(e(a),c),r=(a,c)=>e(a)-c):(t=e===qt||e===lo?e:uY,n=e,r=e);function i(a,c,u=0,l=a.length){if(u<l){if(t(c,c)!==0)return l;do{const h=u+l>>>1;n(a[h],c)<0?u=h+1:l=h}while(u<l)}return u}function s(a,c,u=0,l=a.length){if(u<l){if(t(c,c)!==0)return l;do{const h=u+l>>>1;n(a[h],c)<=0?u=h+1:l=h}while(u<l)}return u}function o(a,c,u=0,l=a.length){const h=i(a,c,u,l-1);return h>u&&r(a[h-1],c)>-r(a[h],c)?h-1:h}return{left:i,center:o,right:s}}function uY(){return 0}function t4(e){return e===null?NaN:+e}function*lY(e,t){if(t===void 0)for(let n of e)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)(r=t(r,++n,e))!=null&&(r=+r)>=r&&(yield r)}}const qh=zh(qt).right;zh(t4).center;const e4=n4(r4),fY=n4(hY);function n4(e){return function(t,n,r=n){if(!((n=+n)>=0))throw new RangeError("invalid rx");if(!((r=+r)>=0))throw new RangeError("invalid ry");let{data:i,width:s,height:o}=t;if(!((s=Math.floor(s))>=0))throw new RangeError("invalid width");if(!((o=Math.floor(o!==void 0?o:i.length/s))>=0))throw new RangeError("invalid height");if(!s||!o||!n&&!r)return t;const a=n&&e(n),c=r&&e(r),u=i.slice();return a&&c?(ma(a,u,i,s,o),ma(a,i,u,s,o),ma(a,u,i,s,o),ga(c,i,u,s,o),ga(c,u,i,s,o),ga(c,i,u,s,o)):a?(ma(a,i,u,s,o),ma(a,u,i,s,o),ma(a,i,u,s,o)):c&&(ga(c,i,u,s,o),ga(c,u,i,s,o),ga(c,i,u,s,o)),t}}function ma(e,t,n,r,i){for(let s=0,o=r*i;s<o;)e(t,n,s,s+=r,1)}function ga(e,t,n,r,i){for(let s=0,o=r*i;s<r;++s)e(t,n,s,s+o,r)}function hY(e){const t=r4(e);return(n,r,i,s,o)=>{i<<=2,s<<=2,o<<=2,t(n,r,i+0,s+0,o),t(n,r,i+1,s+1,o),t(n,r,i+2,s+2,o),t(n,r,i+3,s+3,o)}}function r4(e){const t=Math.floor(e);if(t===e)return dY(e);const n=e-t,r=2*e+1;return(i,s,o,a,c)=>{if(!((a-=c)>=o))return;let u=t*s[o];const l=c*t,h=l+c;for(let f=o,d=o+l;f<d;f+=c)u+=s[Math.min(a,f)];for(let f=o,d=a;f<=d;f+=c)u+=s[Math.min(a,f+l)],i[f]=(u+n*(s[Math.max(o,f-h)]+s[Math.min(a,f+h)]))/r,u-=s[Math.max(o,f-l)]}}function dY(e){const t=2*e+1;return(n,r,i,s,o)=>{if(!((s-=o)>=i))return;let a=e*r[i];const c=o*e;for(let u=i,l=i+c;u<l;u+=o)a+=r[Math.min(s,u)];for(let u=i,l=s;u<=l;u+=o)a+=r[Math.min(s,u+c)],n[u]=a/t,a-=r[Math.max(i,u-c)]}}function jh(e,t){let n=0;if(t===void 0)for(let r of e)r!=null&&(r=+r)>=r&&++n;else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(i=+i)>=i&&++n}return n}function pY(e){return e.length|0}function yY(e){return!(e>0)}function mY(e){return typeof e!="object"||"length"in e?e:Array.from(e)}function gY(e){return t=>e(...t)}function bY(...e){const t=typeof e[e.length-1]=="function"&&gY(e.pop());e=e.map(mY);const n=e.map(pY),r=e.length-1,i=new Array(r+1).fill(0),s=[];if(r<0||n.some(yY))return s;for(;;){s.push(i.map((a,c)=>e[c][a]));let o=r;for(;++i[o]===n[o];){if(o===0)return t?s.map(t):s;i[o--]=0}}}function _Y(e,t){var n=0;return Float64Array.from(e,r=>n+=+r||0)}function qm(e,t){let n=0,r,i=0,s=0;if(t===void 0)for(let o of e)o!=null&&(o=+o)>=o&&(r=o-i,i+=r/++n,s+=r*(o-i));else{let o=-1;for(let a of e)(a=t(a,++o,e))!=null&&(a=+a)>=a&&(r=a-i,i+=r/++n,s+=r*(a-i))}if(n>1)return s/(n-1)}function mu(e,t){const n=qm(e,t);return n&&Math.sqrt(n)}function Ie(e,t){let n,r;if(t===void 0)for(const i of e)i!=null&&(n===void 0?i>=i&&(n=r=i):(n>i&&(n=i),r<i&&(r=i)));else{let i=-1;for(let s of e)(s=t(s,++i,e))!=null&&(n===void 0?s>=s&&(n=r=s):(n>s&&(n=s),r<s&&(r=s)))}return[n,r]}class qr{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const s=n[i],o=t+s,a=Math.abs(t)<Math.abs(s)?t-(o-s):s-(o-t);a&&(n[r++]=a),t=o}return n[r]=t,this._n=r+1,this}valueOf(){const t=this._partials;let n=this._n,r,i,s,o=0;if(n>0){for(o=t[--n];n>0&&(r=o,i=t[--n],o=r+i,s=i-(o-r),!s););n>0&&(s<0&&t[n-1]<0||s>0&&t[n-1]>0)&&(i=s*2,r=o+i,i==r-o&&(o=r))}return o}}class fo extends Map{constructor(t,n=o4){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[r,i]of t)this.set(r,i)}get(t){return super.get(jm(this,t))}has(t){return super.has(jm(this,t))}set(t,n){return super.set(i4(this,t),n)}delete(t){return super.delete(s4(this,t))}}class ba extends Set{constructor(t,n=o4){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const r of t)this.add(r)}has(t){return super.has(jm(this,t))}add(t){return super.add(i4(this,t))}delete(t){return super.delete(s4(this,t))}}function jm({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):n}function i4({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function s4({_intern:e,_key:t},n){const r=t(n);return e.has(r)&&(n=e.get(r),e.delete(r)),n}function o4(e){return e!==null&&typeof e=="object"?e.valueOf():e}function Ym(e){return e}function vs(e,...t){return Vm(e,Ym,Ym,t)}function _a(e,t,...n){return Vm(e,Ym,t,n)}function wY(e,t,...n){return Vm(e,Array.from,t,n)}function Vm(e,t,n,r){return(function i(s,o){if(o>=r.length)return n(s);const a=new fo,c=r[o++];let u=-1;for(const l of s){const h=c(l,++u,s),f=a.get(h);f?f.push(l):a.set(h,[l])}for(const[l,h]of a)a.set(l,i(h,o));return t(a)})(e,0)}function vY(e,t){return Array.from(t,n=>e[n])}function Yh(e,...t){if(typeof e[Symbol.iterator]!="function")throw new TypeError("values is not iterable");e=Array.from(e);let[n]=t;if(n&&n.length!==2||t.length>1){const r=Uint32Array.from(e,(i,s)=>s);return t.length>1?(t=t.map(i=>e.map(i)),r.sort((i,s)=>{for(const o of t){const a=gu(o[i],o[s]);if(a)return a}})):(n=e.map(n),r.sort((i,s)=>gu(n[i],n[s]))),vY(e,r)}return e.sort(Wm(n))}function Wm(e=qt){if(e===qt)return gu;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{const r=e(t,n);return r||r===0?r:(e(n,n)===0)-(e(t,t)===0)}}function gu(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}function Gm(e,t,n){return(t.length!==2?Yh(_a(e,t,n),(([r,i],[s,o])=>qt(i,o)||qt(r,s))):Yh(vs(e,n),(([r,i],[s,o])=>t(i,o)||qt(r,s)))).map(([r])=>r)}const xY=Math.sqrt(50),SY=Math.sqrt(10),AY=Math.sqrt(2);function Vh(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),s=r/Math.pow(10,i),o=s>=xY?10:s>=SY?5:s>=AY?2:1;let a,c,u;return i<0?(u=Math.pow(10,-i)/o,a=Math.round(e*u),c=Math.round(t*u),a/u<e&&++a,c/u>t&&--c,u=-u):(u=Math.pow(10,i)*o,a=Math.round(e/u),c=Math.round(t/u),a*u<e&&++a,c*u>t&&--c),c<a&&.5<=n&&n<2?Vh(e,t,n*2):[a,c,u]}function xs(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const r=t<e,[i,s,o]=r?Vh(t,e,n):Vh(e,t,n);if(!(s>=i))return[];const a=s-i+1,c=new Array(a);if(r)if(o<0)for(let u=0;u<a;++u)c[u]=(s-u)/-o;else for(let u=0;u<a;++u)c[u]=(s-u)*o;else if(o<0)for(let u=0;u<a;++u)c[u]=(i+u)/-o;else for(let u=0;u<a;++u)c[u]=(i+u)*o;return c}function bu(e,t,n){return t=+t,e=+e,n=+n,Vh(e,t,n)[2]}function Xm(e,t,n){t=+t,e=+e,n=+n;const r=t<e,i=r?bu(t,e,n):bu(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}function a4(e,t,n){let r;for(;;){const i=bu(e,t,n);if(i===r||i===0||!isFinite(i))return[e,t];i>0?(e=Math.floor(e/i)*i,t=Math.ceil(t/i)*i):i<0&&(e=Math.ceil(e*i)/i,t=Math.floor(t*i)/i),r=i}}function Hm(e){return Math.max(1,Math.ceil(Math.log(jh(e))/Math.LN2)+1)}function me(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function IY(e,t){let n,r=-1,i=-1;if(t===void 0)for(const s of e)++i,s!=null&&(n<s||n===void 0&&s>=s)&&(n=s,r=i);else for(let s of e)(s=t(s,++i,e))!=null&&(n<s||n===void 0&&s>=s)&&(n=s,r=i);return r}function fe(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}return n}function EY(e,t){let n,r=-1,i=-1;if(t===void 0)for(const s of e)++i,s!=null&&(n>s||n===void 0&&s>=s)&&(n=s,r=i);else for(let s of e)(s=t(s,++i,e))!=null&&(n>s||n===void 0&&s>=s)&&(n=s,r=i);return r}function c4(e,t,n=0,r=1/0,i){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(e.length-1,r)),!(n<=t&&t<=r))return e;for(i=i===void 0?gu:Wm(i);r>n;){if(r-n>600){const c=r-n+1,u=t-n+1,l=Math.log(c),h=.5*Math.exp(2*l/3),f=.5*Math.sqrt(l*h*(c-h)/c)*(u-c/2<0?-1:1),d=Math.max(n,Math.floor(t-u*h/c+f)),p=Math.min(r,Math.floor(t+(c-u)*h/c+f));c4(e,t,d,p,i)}const s=e[t];let o=n,a=r;for(_u(e,n,t),i(e[r],s)>0&&_u(e,n,r);o<a;){for(_u(e,o,a),++o,--a;i(e[o],s)<0;)++o;for(;i(e[a],s)>0;)--a}i(e[n],s)===0?_u(e,n,a):(++a,_u(e,a,r)),a<=t&&(n=a+1),t<=a&&(r=a-1)}return e}function _u(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function Qm(e,t=qt){let n,r=!1;if(t.length===1){let i;for(const s of e){const o=t(s);(r?qt(o,i)>0:qt(o,o)===0)&&(n=s,i=o,r=!0)}}else for(const i of e)(r?t(i,n)>0:t(i,i)===0)&&(n=i,r=!0);return n}function Ss(e,t,n){if(e=Float64Array.from(lY(e,n)),!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return fe(e);if(t>=1)return me(e);var r,i=(r-1)*t,s=Math.floor(i),o=me(c4(e,s).subarray(0,s+1)),a=fe(e.subarray(s+1));return o+(a-o)*(i-s)}}function MY(e,t,n=t4){if(!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,s=Math.floor(i),o=+n(e[s],s,e),a=+n(e[s+1],s+1,e);return o+(a-o)*(i-s)}}function TY(e,t,n){const r=jh(e),i=Ss(e,.75)-Ss(e,.25);return r&&i?Math.ceil((n-t)/(2*i*Math.pow(r,-.3333333333333333))):1}function u4(e,t,n){const r=jh(e),i=mu(e);return r&&i?Math.ceil((n-t)*Math.cbrt(r)/(3.49*i)):1}function Wh(e,t){let n=0,r=0;if(t===void 0)for(let i of e)i!=null&&(i=+i)>=i&&(++n,r+=i);else{let i=-1;for(let s of e)(s=t(s,++i,e))!=null&&(s=+s)>=s&&(++n,r+=s)}if(n)return r/n}function wu(e,t){return Ss(e,.5,t)}function*$Y(e){for(const t of e)yield*t}function l4(e){return Array.from($Y(e))}function f4(e,t){const n=new fo;if(t===void 0)for(let s of e)s!=null&&s>=s&&n.set(s,(n.get(s)||0)+1);else{let s=-1;for(let o of e)(o=t(o,++s,e))!=null&&o>=o&&n.set(o,(n.get(o)||0)+1)}let r,i=0;for(const[s,o]of n)o>i&&(i=o,r=s);return r}function NY(e,t=RY){const n=[];let r,i=!1;for(const s of e)i&&n.push(t(r,s)),r=s,i=!0;return n}function RY(e,t){return[e,t]}function Tn(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,s=new Array(i);++r<i;)s[r]=e+r*n;return s}function h4(e,t=qt){if(typeof e[Symbol.iterator]!="function")throw new TypeError("values is not iterable");let n=Array.from(e);const r=new Float64Array(n.length);t.length!==2&&(n=n.map(t),t=qt);const i=(a,c)=>t(n[a],n[c]);let s,o;return e=Uint32Array.from(n,(a,c)=>c),e.sort(t===qt?(a,c)=>gu(n[a],n[c]):Wm(i)),e.forEach((a,c)=>{const u=i(a,s===void 0?a:s);u>=0?((s===void 0||u>0)&&(s=a,o=c),r[a]=o):r[a]=NaN}),r}function OY(e,t=qt){let n,r=!1;if(t.length===1){let i;for(const s of e){const o=t(s);(r?qt(o,i)<0:qt(o,o)===0)&&(n=s,i=o,r=!0)}}else for(const i of e)(r?t(i,n)<0:t(i,i)===0)&&(n=i,r=!0);return n}function dr(e,t){let n=0;if(t===void 0)for(let r of e)(r=+r)&&(n+=r);else{let r=-1;for(let i of e)(i=+t(i,++r,e))&&(n+=i)}return n}function Gh(e){if(typeof e[Symbol.iterator]!="function")throw new TypeError("values is not iterable");return Array.from(e).reverse()}function DY(e){return e}var LY=3,d4=1e-6;function FY(e){return"translate("+e+",0)"}function CY(e){return t=>+e(t)}function kY(e,t){return t=Math.max(0,e.bandwidth()-t*2)/2,e.round()&&(t=Math.round(t)),n=>+e(n)+t}function BY(){return!this.__axis}function PY(e,t){var n=[],r=null,i=null,s=6,o=6,a=3,c=typeof window<"u"&&window.devicePixelRatio>1?0:.5,u=1,l="y",h=FY;function f(d){var p=r??(t.ticks?t.ticks.apply(t,n):t.domain()),y=i??(t.tickFormat?t.tickFormat.apply(t,n):DY),g=Math.max(s,0)+a,m=t.range(),b=+m[0]+c,w=+m[m.length-1]+c,_=(t.bandwidth?kY:CY)(t.copy(),c),x=d.selection?d.selection():d,v=x.selectAll(".domain").data([null]),S=x.selectAll(".tick").data(p,t).order(),A=S.exit(),M=S.enter().append("g").attr("class","tick"),T=S.select("line"),I=S.select("text");v=v.merge(v.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),S=S.merge(M),T=T.merge(M.append("line").attr("stroke","currentColor").attr(l+"2",u*s)),I=I.merge(M.append("text").attr("fill","currentColor").attr(l,u*g).attr("dy","0.71em")),d!==x&&(v=v.transition(d),S=S.transition(d),T=T.transition(d),I=I.transition(d),A=A.transition(d).attr("opacity",d4).attr("transform",function(R){return isFinite(R=_(R))?h(R+c):this.getAttribute("transform")}),M.attr("opacity",d4).attr("transform",function(R){var L=this.parentNode.__axis;return h((L&&isFinite(L=L(R))?L:_(R))+c)})),A.remove(),v.attr("d",o?"M"+b+","+u*o+"V"+c+"H"+w+"V"+u*o:"M"+b+","+c+"H"+w),S.attr("opacity",1).attr("transform",function(R){return h(_(R)+c)}),T.attr(l+"2",u*s),I.attr(l,u*g).text(y),x.filter(BY).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor","middle"),x.each(function(){this.__axis=_})}return f.scale=function(d){return arguments.length?(t=d,f):t},f.ticks=function(){return n=Array.from(arguments),f},f.tickArguments=function(d){return arguments.length?(n=d==null?[]:Array.from(d),f):n.slice()},f.tickValues=function(d){return arguments.length?(r=d==null?null:Array.from(d),f):r&&r.slice()},f.tickFormat=function(d){return arguments.length?(i=d,f):i},f.tickSize=function(d){return arguments.length?(s=o=+d,f):s},f.tickSizeInner=function(d){return arguments.length?(s=+d,f):s},f.tickSizeOuter=function(d){return arguments.length?(o=+d,f):o},f.tickPadding=function(d){return arguments.length?(a=+d,f):a},f.offset=function(d){return arguments.length?(c=+d,f):c},f}function UY(e){return PY(LY,e)}var zY={value:()=>{}};function Xh(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Hh(n)}function Hh(e){this._=e}function qY(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Hh.prototype=Xh.prototype={constructor:Hh,on:function(e,t){var n=this._,r=qY(e+"",n),i,s=-1,o=r.length;if(arguments.length<2){for(;++s<o;)if((i=(e=r[s]).type)&&(i=jY(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<o;)if(i=(e=r[s]).type)n[i]=p4(n[i],e.name,t);else if(t==null)for(i in n)n[i]=p4(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Hh(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,s;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],r=0,i=s.length;r<i;++r)s[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,s=r.length;i<s;++i)r[i].value.apply(t,n)}};function jY(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function p4(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=zY,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Jm="http://www.w3.org/1999/xhtml";const Ai={svg:"http://www.w3.org/2000/svg",xhtml:Jm,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Qh(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),Ai.hasOwnProperty(t)?{space:Ai[t],local:e}:e}function YY(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Jm&&t.documentElement.namespaceURI===Jm?t.createElement(e):t.createElementNS(n,e)}}function VY(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Jh(e){var t=Qh(e);return(t.local?VY:YY)(t)}function WY(){}function Km(e){return e==null?WY:function(){return this.querySelector(e)}}function GY(e){typeof e!="function"&&(e=Km(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],o=s.length,a=r[i]=new Array(o),c,u,l=0;l<o;++l)(c=s[l])&&(u=e.call(c,c.__data__,l,s))&&("__data__"in c&&(u.__data__=c.__data__),a[l]=u);return new $n(r,this._parents)}function XY(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function HY(){return[]}function y4(e){return e==null?HY:function(){return this.querySelectorAll(e)}}function QY(e){return function(){return XY(e.apply(this,arguments))}}function JY(e){typeof e=="function"?e=QY(e):e=y4(e);for(var t=this._groups,n=t.length,r=[],i=[],s=0;s<n;++s)for(var o=t[s],a=o.length,c,u=0;u<a;++u)(c=o[u])&&(r.push(e.call(c,c.__data__,u,o)),i.push(c));return new $n(r,i)}function m4(e){return function(){return this.matches(e)}}function g4(e){return function(t){return t.matches(e)}}var KY=Array.prototype.find;function ZY(e){return function(){return KY.call(this.children,e)}}function tV(){return this.firstElementChild}function eV(e){return this.select(e==null?tV:ZY(typeof e=="function"?e:g4(e)))}var nV=Array.prototype.filter;function rV(){return Array.from(this.children)}function iV(e){return function(){return nV.call(this.children,e)}}function sV(e){return this.selectAll(e==null?rV:iV(typeof e=="function"?e:g4(e)))}function oV(e){typeof e!="function"&&(e=m4(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],o=s.length,a=r[i]=[],c,u=0;u<o;++u)(c=s[u])&&e.call(c,c.__data__,u,s)&&a.push(c);return new $n(r,this._parents)}function b4(e){return new Array(e.length)}function aV(){return new $n(this._enter||this._groups.map(b4),this._parents)}function Kh(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Kh.prototype={constructor:Kh,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function cV(e){return function(){return e}}function uV(e,t,n,r,i,s){for(var o=0,a,c=t.length,u=s.length;o<u;++o)(a=t[o])?(a.__data__=s[o],r[o]=a):n[o]=new Kh(e,s[o]);for(;o<c;++o)(a=t[o])&&(i[o]=a)}function lV(e,t,n,r,i,s,o){var a,c,u=new Map,l=t.length,h=s.length,f=new Array(l),d;for(a=0;a<l;++a)(c=t[a])&&(f[a]=d=o.call(c,c.__data__,a,t)+"",u.has(d)?i[a]=c:u.set(d,c));for(a=0;a<h;++a)d=o.call(e,s[a],a,s)+"",(c=u.get(d))?(r[a]=c,c.__data__=s[a],u.delete(d)):n[a]=new Kh(e,s[a]);for(a=0;a<l;++a)(c=t[a])&&u.get(f[a])===c&&(i[a]=c)}function fV(e){return e.__data__}function hV(e,t){if(!arguments.length)return Array.from(this,fV);var n=t?lV:uV,r=this._parents,i=this._groups;typeof e!="function"&&(e=cV(e));for(var s=i.length,o=new Array(s),a=new Array(s),c=new Array(s),u=0;u<s;++u){var l=r[u],h=i[u],f=h.length,d=dV(e.call(l,l&&l.__data__,u,r)),p=d.length,y=a[u]=new Array(p),g=o[u]=new Array(p),m=c[u]=new Array(f);n(l,h,y,g,m,d,t);for(var b=0,w=0,_,x;b<p;++b)if(_=y[b]){for(b>=w&&(w=b+1);!(x=g[w])&&++w<p;);_._next=x||null}}return o=new $n(o,r),o._enter=a,o._exit=c,o}function dV(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function pV(){return new $n(this._exit||this._groups.map(b4),this._parents)}function yV(e,t,n){var r=this.enter(),i=this,s=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(i=t(i),i&&(i=i.selection())),n==null?s.remove():n(s),r&&i?r.merge(i).order():i}function mV(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,s=r.length,o=Math.min(i,s),a=new Array(i),c=0;c<o;++c)for(var u=n[c],l=r[c],h=u.length,f=a[c]=new Array(h),d,p=0;p<h;++p)(d=u[p]||l[p])&&(f[p]=d);for(;c<i;++c)a[c]=n[c];return new $n(a,this._parents)}function gV(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,s=r[i],o;--i>=0;)(o=r[i])&&(s&&o.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(o,s),s=o);return this}function bV(e){e||(e=_V);function t(h,f){return h&&f?e(h.__data__,f.__data__):!h-!f}for(var n=this._groups,r=n.length,i=new Array(r),s=0;s<r;++s){for(var o=n[s],a=o.length,c=i[s]=new Array(a),u,l=0;l<a;++l)(u=o[l])&&(c[l]=u);c.sort(t)}return new $n(i,this._parents).order()}function _V(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function wV(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function vV(){return Array.from(this)}function xV(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,s=r.length;i<s;++i){var o=r[i];if(o)return o}return null}function SV(){let e=0;for(const t of this)++e;return e}function AV(){return!this.node()}function IV(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],s=0,o=i.length,a;s<o;++s)(a=i[s])&&e.call(a,a.__data__,s,i);return this}function EV(e){return function(){this.removeAttribute(e)}}function MV(e){return function(){this.removeAttributeNS(e.space,e.local)}}function TV(e,t){return function(){this.setAttribute(e,t)}}function $V(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function NV(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function RV(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function OV(e,t){var n=Qh(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?MV:EV:typeof t=="function"?n.local?RV:NV:n.local?$V:TV)(n,t))}function _4(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function DV(e){return function(){this.style.removeProperty(e)}}function LV(e,t,n){return function(){this.style.setProperty(e,t,n)}}function FV(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function CV(e,t,n){return arguments.length>1?this.each((t==null?DV:typeof t=="function"?FV:LV)(e,t,n??"")):wa(this.node(),e)}function wa(e,t){return e.style.getPropertyValue(t)||_4(e).getComputedStyle(e,null).getPropertyValue(t)}function kV(e){return function(){delete this[e]}}function BV(e,t){return function(){this[e]=t}}function PV(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function UV(e,t){return arguments.length>1?this.each((t==null?kV:typeof t=="function"?PV:BV)(e,t)):this.node()[e]}function w4(e){return e.trim().split(/^|\s+/)}function Zm(e){return e.classList||new v4(e)}function v4(e){this._node=e,this._names=w4(e.getAttribute("class")||"")}v4.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function x4(e,t){for(var n=Zm(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function S4(e,t){for(var n=Zm(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function zV(e){return function(){x4(this,e)}}function qV(e){return function(){S4(this,e)}}function jV(e,t){return function(){(t.apply(this,arguments)?x4:S4)(this,e)}}function YV(e,t){var n=w4(e+"");if(arguments.length<2){for(var r=Zm(this.node()),i=-1,s=n.length;++i<s;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?jV:t?zV:qV)(n,t))}function VV(){this.textContent=""}function WV(e){return function(){this.textContent=e}}function GV(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function XV(e){return arguments.length?this.each(e==null?VV:(typeof e=="function"?GV:WV)(e)):this.node().textContent}function HV(){this.innerHTML=""}function QV(e){return function(){this.innerHTML=e}}function JV(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function KV(e){return arguments.length?this.each(e==null?HV:(typeof e=="function"?JV:QV)(e)):this.node().innerHTML}function ZV(){this.nextSibling&&this.parentNode.appendChild(this)}function tW(){return this.each(ZV)}function eW(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function nW(){return this.each(eW)}function rW(e){var t=typeof e=="function"?e:Jh(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function iW(){return null}function sW(e,t){var n=typeof e=="function"?e:Jh(e),r=t==null?iW:typeof t=="function"?t:Km(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function oW(){var e=this.parentNode;e&&e.removeChild(this)}function aW(){return this.each(oW)}function cW(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function uW(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function lW(e){return this.select(e?uW:cW)}function fW(e){return arguments.length?this.property("__data__",e):this.node().__data__}function hW(e){return function(t){e.call(this,t,this.__data__)}}function dW(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function pW(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,i=t.length,s;n<i;++n)s=t[n],(!e.type||s.type===e.type)&&s.name===e.name?this.removeEventListener(s.type,s.listener,s.options):t[++r]=s;++r?t.length=r:delete this.__on}}}function yW(e,t,n){return function(){var r=this.__on,i,s=hW(t);if(r){for(var o=0,a=r.length;o<a;++o)if((i=r[o]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=n),i.value=t;return}}this.addEventListener(e.type,s,n),i={type:e.type,name:e.name,value:t,listener:s,options:n},r?r.push(i):this.__on=[i]}}function mW(e,t,n){var r=dW(e+""),i,s=r.length,o;if(arguments.length<2){var a=this.node().__on;if(a){for(var c=0,u=a.length,l;c<u;++c)for(i=0,l=a[c];i<s;++i)if((o=r[i]).type===l.type&&o.name===l.name)return l.value}return}for(a=t?yW:pW,i=0;i<s;++i)this.each(a(r[i],t,n));return this}function A4(e,t,n){var r=_4(e),i=r.CustomEvent;typeof i=="function"?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function gW(e,t){return function(){return A4(this,e,t)}}function bW(e,t){return function(){return A4(this,e,t.apply(this,arguments))}}function _W(e,t){return this.each((typeof t=="function"?bW:gW)(e,t))}function*wW(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,s=r.length,o;i<s;++i)(o=r[i])&&(yield o)}var I4=[null];function $n(e,t){this._groups=e,this._parents=t}function vu(){return new $n([[document.documentElement]],I4)}function vW(){return this}$n.prototype=vu.prototype={constructor:$n,select:GY,selectAll:JY,selectChild:eV,selectChildren:sV,filter:oV,data:hV,enter:aV,exit:pV,join:yV,merge:mV,selection:vW,order:gV,sort:bV,call:wV,nodes:vV,node:xV,size:SV,empty:AV,each:IV,attr:OV,style:CV,property:UV,classed:YV,text:XV,html:KV,raise:tW,lower:nW,append:rW,insert:sW,remove:aW,clone:lW,datum:fW,on:mW,dispatch:_W,[Symbol.iterator]:wW};function oe(e){return typeof e=="string"?new $n([[document.querySelector(e)]],[document.documentElement]):new $n([[e]],I4)}function xW(e){let t;for(;t=e.sourceEvent;)e=t;return e}function pr(e,t){if(e=xW(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}}return[e.pageX,e.pageY]}const tg={capture:!0,passive:!1};function eg(e){e.preventDefault(),e.stopImmediatePropagation()}function E4(e){var t=e.document.documentElement,n=oe(e).on("dragstart.drag",eg,tg);"onselectstart"in t?n.on("selectstart.drag",eg,tg):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function M4(e,t){var n=e.document.documentElement,r=oe(e).on("dragstart.drag",null);t&&(r.on("click.drag",eg,tg),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}function va(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function xu(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function As(){}var ho=.7,xa=1/ho,Sa="\\s*([+-]?\\d+)\\s*",Su="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",jr="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",SW=/^#([0-9a-f]{3,8})$/,AW=new RegExp(`^rgb\\(${Sa},${Sa},${Sa}\\)$`),IW=new RegExp(`^rgb\\(${jr},${jr},${jr}\\)$`),EW=new RegExp(`^rgba\\(${Sa},${Sa},${Sa},${Su}\\)$`),MW=new RegExp(`^rgba\\(${jr},${jr},${jr},${Su}\\)$`),TW=new RegExp(`^hsl\\(${Su},${jr},${jr}\\)$`),$W=new RegExp(`^hsla\\(${Su},${jr},${jr},${Su}\\)$`),T4={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};va(As,Is,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:$4,formatHex:$4,formatHex8:NW,formatHsl:RW,formatRgb:N4,toString:N4});function $4(){return this.rgb().formatHex()}function NW(){return this.rgb().formatHex8()}function RW(){return F4(this).formatHsl()}function N4(){return this.rgb().formatRgb()}function Is(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=SW.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?R4(t):n===3?new De(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Zh(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Zh(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=AW.exec(e))?new De(t[1],t[2],t[3],1):(t=IW.exec(e))?new De(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=EW.exec(e))?Zh(t[1],t[2],t[3],t[4]):(t=MW.exec(e))?Zh(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=TW.exec(e))?L4(t[1],t[2]/100,t[3]/100,1):(t=$W.exec(e))?L4(t[1],t[2]/100,t[3]/100,t[4]):T4.hasOwnProperty(e)?R4(T4[e]):e==="transparent"?new De(NaN,NaN,NaN,0):null}function R4(e){return new De(e>>16&255,e>>8&255,e&255,1)}function Zh(e,t,n,r){return r<=0&&(e=t=n=NaN),new De(e,t,n,r)}function ng(e){return e instanceof As||(e=Is(e)),e?(e=e.rgb(),new De(e.r,e.g,e.b,e.opacity)):new De}function Nn(e,t,n,r){return arguments.length===1?ng(e):new De(e,t,n,r??1)}function De(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}va(De,Nn,xu(As,{brighter(e){return e=e==null?xa:Math.pow(xa,e),new De(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?ho:Math.pow(ho,e),new De(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new De(po(this.r),po(this.g),po(this.b),td(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:O4,formatHex:O4,formatHex8:OW,formatRgb:D4,toString:D4}));function O4(){return`#${yo(this.r)}${yo(this.g)}${yo(this.b)}`}function OW(){return`#${yo(this.r)}${yo(this.g)}${yo(this.b)}${yo((isNaN(this.opacity)?1:this.opacity)*255)}`}function D4(){const e=td(this.opacity);return`${e===1?"rgb(":"rgba("}${po(this.r)}, ${po(this.g)}, ${po(this.b)}${e===1?")":`, ${e})`}`}function td(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function po(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function yo(e){return e=po(e),(e<16?"0":"")+e.toString(16)}function L4(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new yr(e,t,n,r)}function F4(e){if(e instanceof yr)return new yr(e.h,e.s,e.l,e.opacity);if(e instanceof As||(e=Is(e)),!e)return new yr;if(e instanceof yr)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),s=Math.max(t,n,r),o=NaN,a=s-i,c=(s+i)/2;return a?(t===s?o=(n-r)/a+(n<r)*6:n===s?o=(r-t)/a+2:o=(t-n)/a+4,a/=c<.5?s+i:2-s-i,o*=60):a=c>0&&c<1?0:o,new yr(o,a,c,e.opacity)}function rg(e,t,n,r){return arguments.length===1?F4(e):new yr(e,t,n,r??1)}function yr(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}va(yr,rg,xu(As,{brighter(e){return e=e==null?xa:Math.pow(xa,e),new yr(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?ho:Math.pow(ho,e),new yr(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new De(ig(e>=240?e-240:e+120,i,r),ig(e,i,r),ig(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new yr(C4(this.h),ed(this.s),ed(this.l),td(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=td(this.opacity);return`${e===1?"hsl(":"hsla("}${C4(this.h)}, ${ed(this.s)*100}%, ${ed(this.l)*100}%${e===1?")":`, ${e})`}`}}));function C4(e){return e=(e||0)%360,e<0?e+360:e}function ed(e){return Math.max(0,Math.min(1,e||0))}function ig(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const k4=Math.PI/180,B4=180/Math.PI,nd=18,P4=.96422,U4=1,z4=.82521,q4=4/29,Aa=6/29,j4=3*Aa*Aa,DW=Aa*Aa*Aa;function Y4(e){if(e instanceof Yr)return new Yr(e.l,e.a,e.b,e.opacity);if(e instanceof Ii)return V4(e);e instanceof De||(e=ng(e));var t=ug(e.r),n=ug(e.g),r=ug(e.b),i=og((.2225045*t+.7168786*n+.0606169*r)/U4),s,o;return t===n&&n===r?s=o=i:(s=og((.4360747*t+.3850649*n+.1430804*r)/P4),o=og((.0139322*t+.0971045*n+.7141733*r)/z4)),new Yr(116*i-16,500*(s-i),200*(i-o),e.opacity)}function sg(e,t,n,r){return arguments.length===1?Y4(e):new Yr(e,t,n,r??1)}function Yr(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}va(Yr,sg,xu(As,{brighter(e){return new Yr(this.l+nd*(e??1),this.a,this.b,this.opacity)},darker(e){return new Yr(this.l-nd*(e??1),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=P4*ag(t),e=U4*ag(e),n=z4*ag(n),new De(cg(3.1338561*t-1.6168667*e-.4906146*n),cg(-.9787684*t+1.9161415*e+.033454*n),cg(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function og(e){return e>DW?Math.pow(e,.3333333333333333):e/j4+q4}function ag(e){return e>Aa?e*e*e:j4*(e-q4)}function cg(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,.4166666666666667)-.055)}function ug(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function LW(e){if(e instanceof Ii)return new Ii(e.h,e.c,e.l,e.opacity);if(e instanceof Yr||(e=Y4(e)),e.a===0&&e.b===0)return new Ii(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*B4;return new Ii(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function lg(e,t,n,r){return arguments.length===1?LW(e):new Ii(e,t,n,r??1)}function Ii(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function V4(e){if(isNaN(e.h))return new Yr(e.l,0,0,e.opacity);var t=e.h*k4;return new Yr(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}va(Ii,lg,xu(As,{brighter(e){return new Ii(this.h,this.c,this.l+nd*(e??1),this.opacity)},darker(e){return new Ii(this.h,this.c,this.l-nd*(e??1),this.opacity)},rgb(){return V4(this).rgb()}}));var W4=-.14861,fg=1.78277,hg=-.29227,rd=-.90649,Au=1.97294,G4=Au*rd,X4=Au*fg,H4=fg*hg-rd*W4;function FW(e){if(e instanceof mo)return new mo(e.h,e.s,e.l,e.opacity);e instanceof De||(e=ng(e));var t=e.r/255,n=e.g/255,r=e.b/255,i=(H4*r+G4*t-X4*n)/(H4+G4-X4),s=r-i,o=(Au*(n-i)-hg*s)/rd,a=Math.sqrt(o*o+s*s)/(Au*i*(1-i)),c=a?Math.atan2(o,s)*B4-120:NaN;return new mo(c<0?c+360:c,a,i,e.opacity)}function Vr(e,t,n,r){return arguments.length===1?FW(e):new mo(e,t,n,r??1)}function mo(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}va(mo,Vr,xu(As,{brighter(e){return e=e==null?xa:Math.pow(xa,e),new mo(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?ho:Math.pow(ho,e),new mo(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*k4,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new De(255*(t+n*(W4*r+fg*i)),255*(t+n*(hg*r+rd*i)),255*(t+n*(Au*r)),this.opacity)}}));function CW(e,t,n,r,i){var s=e*e,o=s*e;return((1-3*e+3*s-o)*t+(4-6*s+3*o)*n+(1+3*e+3*s-3*o)*r+o*i)/6}function kW(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],s=e[r+1],o=r>0?e[r-1]:2*i-s,a=r<t-1?e[r+2]:2*s-i;return CW((n-r/t)*t,o,i,s,a)}}const id=e=>()=>e;function Q4(e,t){return function(n){return e+n*t}}function BW(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function dg(e,t){var n=t-e;return n?Q4(e,n>180||n<-180?n-360*Math.round(n/360):n):id(isNaN(e)?t:e)}function PW(e){return(e=+e)==1?Ge:function(t,n){return n-t?BW(t,n,e):id(isNaN(t)?n:t)}}function Ge(e,t){var n=t-e;return n?Q4(e,n):id(isNaN(e)?t:e)}const go=(function e(t){var n=PW(t);function r(i,s){var o=n((i=Nn(i)).r,(s=Nn(s)).r),a=n(i.g,s.g),c=n(i.b,s.b),u=Ge(i.opacity,s.opacity);return function(l){return i.r=o(l),i.g=a(l),i.b=c(l),i.opacity=u(l),i+""}}return r.gamma=e,r})(1);function UW(e){return function(t){var n=t.length,r=new Array(n),i=new Array(n),s=new Array(n),o,a;for(o=0;o<n;++o)a=Nn(t[o]),r[o]=a.r||0,i[o]=a.g||0,s[o]=a.b||0;return r=e(r),i=e(i),s=e(s),a.opacity=1,function(c){return a.r=r(c),a.g=i(c),a.b=s(c),a+""}}}var zW=UW(kW);function qW(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),i;return function(s){for(i=0;i<n;++i)r[i]=e[i]*(1-s)+t[i]*s;return r}}function jW(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function YW(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),s=new Array(n),o;for(o=0;o<r;++o)i[o]=Ia(e[o],t[o]);for(;o<n;++o)s[o]=t[o];return function(a){for(o=0;o<r;++o)s[o]=i[o](a);return s}}function VW(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function Xe(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function WW(e,t){var n={},r={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?n[i]=Ia(e[i],t[i]):r[i]=t[i];return function(s){for(i in n)r[i]=n[i](s);return r}}var pg=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,yg=new RegExp(pg.source,"g");function GW(e){return function(){return e}}function XW(e){return function(t){return e(t)+""}}function J4(e,t){var n=pg.lastIndex=yg.lastIndex=0,r,i,s,o=-1,a=[],c=[];for(e=e+"",t=t+"";(r=pg.exec(e))&&(i=yg.exec(t));)(s=i.index)>n&&(s=t.slice(n,s),a[o]?a[o]+=s:a[++o]=s),(r=r[0])===(i=i[0])?a[o]?a[o]+=i:a[++o]=i:(a[++o]=null,c.push({i:o,x:Xe(r,i)})),n=yg.lastIndex;return n<t.length&&(s=t.slice(n),a[o]?a[o]+=s:a[++o]=s),a.length<2?c[0]?XW(c[0].x):GW(t):(t=c.length,function(u){for(var l=0,h;l<t;++l)a[(h=c[l]).i]=h.x(u);return a.join("")})}function Ia(e,t){var n=typeof t,r;return t==null||n==="boolean"?id(t):(n==="number"?Xe:n==="string"?(r=Is(t))?(t=r,go):J4:t instanceof Is?go:t instanceof Date?VW:jW(t)?qW:Array.isArray(t)?YW:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?WW:Xe)(e,t)}function mg(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var K4=180/Math.PI,gg={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Z4(e,t,n,r,i,s){var o,a,c;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,c/=a),e*r<t*n&&(e=-e,t=-t,c=-c,o=-o),{translateX:i,translateY:s,rotate:Math.atan2(t,e)*K4,skewX:Math.atan(c)*K4,scaleX:o,scaleY:a}}var sd;function HW(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?gg:Z4(t.a,t.b,t.c,t.d,t.e,t.f)}function QW(e){return e==null||(sd||(sd=document.createElementNS("http://www.w3.org/2000/svg","g")),sd.setAttribute("transform",e),!(e=sd.transform.baseVal.consolidate()))?gg:(e=e.matrix,Z4(e.a,e.b,e.c,e.d,e.e,e.f))}function t8(e,t,n,r){function i(u){return u.length?u.pop()+" ":""}function s(u,l,h,f,d,p){if(u!==h||l!==f){var y=d.push("translate(",null,t,null,n);p.push({i:y-4,x:Xe(u,h)},{i:y-2,x:Xe(l,f)})}else(h||f)&&d.push("translate("+h+t+f+n)}function o(u,l,h,f){u!==l?(u-l>180?l+=360:l-u>180&&(u+=360),f.push({i:h.push(i(h)+"rotate(",null,r)-2,x:Xe(u,l)})):l&&h.push(i(h)+"rotate("+l+r)}function a(u,l,h,f){u!==l?f.push({i:h.push(i(h)+"skewX(",null,r)-2,x:Xe(u,l)}):l&&h.push(i(h)+"skewX("+l+r)}function c(u,l,h,f,d,p){if(u!==h||l!==f){var y=d.push(i(d)+"scale(",null,",",null,")");p.push({i:y-4,x:Xe(u,h)},{i:y-2,x:Xe(l,f)})}else(h!==1||f!==1)&&d.push(i(d)+"scale("+h+","+f+")")}return function(u,l){var h=[],f=[];return u=e(u),l=e(l),s(u.translateX,u.translateY,l.translateX,l.translateY,h,f),o(u.rotate,l.rotate,h,f),a(u.skewX,l.skewX,h,f),c(u.scaleX,u.scaleY,l.scaleX,l.scaleY,h,f),u=l=null,function(d){for(var p=-1,y=f.length,g;++p<y;)h[(g=f[p]).i]=g.x(d);return h.join("")}}}var JW=t8(HW,"px, ","px)","deg)"),KW=t8(QW,", ",")",")"),ZW=1e-12;function e8(e){return((e=Math.exp(e))+1/e)/2}function tG(e){return((e=Math.exp(e))-1/e)/2}function eG(e){return((e=Math.exp(2*e))-1)/(e+1)}const nG=(function e(t,n,r){function i(s,o){var a=s[0],c=s[1],u=s[2],l=o[0],h=o[1],f=o[2],d=l-a,p=h-c,y=d*d+p*p,g,m;if(y<ZW)m=Math.log(f/u)/t,g=function(S){return[a+S*d,c+S*p,u*Math.exp(t*S*m)]};else{var b=Math.sqrt(y),w=(f*f-u*u+r*y)/(2*u*n*b),_=(f*f-u*u-r*y)/(2*f*n*b),x=Math.log(Math.sqrt(w*w+1)-w),v=Math.log(Math.sqrt(_*_+1)-_);m=(v-x)/t,g=function(S){var A=S*m,M=e8(x),T=u/(n*b)*(M*eG(t*A+x)-tG(x));return[a+T*d,c+T*p,u*M/e8(t*A+x)]}}return g.duration=m*1e3*t/Math.SQRT2,g}return i.rho=function(s){var o=Math.max(.001,+s),a=o*o,c=a*a;return e(o,a,c)},i})(Math.SQRT2,2,4);function rG(e){return function(t,n){var r=e((t=rg(t)).h,(n=rg(n)).h),i=Ge(t.s,n.s),s=Ge(t.l,n.l),o=Ge(t.opacity,n.opacity);return function(a){return t.h=r(a),t.s=i(a),t.l=s(a),t.opacity=o(a),t+""}}}const iG=rG(dg);function sG(e,t){var n=Ge((e=sg(e)).l,(t=sg(t)).l),r=Ge(e.a,t.a),i=Ge(e.b,t.b),s=Ge(e.opacity,t.opacity);return function(o){return e.l=n(o),e.a=r(o),e.b=i(o),e.opacity=s(o),e+""}}function oG(e){return function(t,n){var r=e((t=lg(t)).h,(n=lg(n)).h),i=Ge(t.c,n.c),s=Ge(t.l,n.l),o=Ge(t.opacity,n.opacity);return function(a){return t.h=r(a),t.c=i(a),t.l=s(a),t.opacity=o(a),t+""}}}const aG=oG(dg);function n8(e){return(function t(n){n=+n;function r(i,s){var o=e((i=Vr(i)).h,(s=Vr(s)).h),a=Ge(i.s,s.s),c=Ge(i.l,s.l),u=Ge(i.opacity,s.opacity);return function(l){return i.h=o(l),i.s=a(l),i.l=c(Math.pow(l,n)),i.opacity=u(l),i+""}}return r.gamma=t,r})(1)}n8(dg);var bg=n8(Ge);function od(e,t){t===void 0&&(t=e,e=Ia);for(var n=0,r=t.length-1,i=t[0],s=new Array(r<0?0:r);n<r;)s[n]=e(i,i=t[++n]);return function(o){var a=Math.max(0,Math.min(r-1,Math.floor(o*=r)));return s[a](o-a)}}function mr(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}var Ea=0,Iu=0,Eu=0,r8=1e3,ad,Mu,cd=0,bo=0,ud=0,Tu=typeof performance=="object"&&performance.now?performance:Date,i8=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function _g(){return bo||(i8(cG),bo=Tu.now()+ud)}function cG(){bo=0}function ld(){this._call=this._time=this._next=null}ld.prototype=s8.prototype={constructor:ld,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?_g():+n)+(t==null?0:+t),!this._next&&Mu!==this&&(Mu?Mu._next=this:ad=this,Mu=this),this._call=e,this._time=n,wg()},stop:function(){this._call&&(this._call=null,this._time=1/0,wg())}};function s8(e,t,n){var r=new ld;return r.restart(e,t,n),r}function uG(){_g(),++Ea;for(var e=ad,t;e;)(t=bo-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Ea}function o8(){bo=(cd=Tu.now())+ud,Ea=Iu=0;try{uG()}finally{Ea=0,fG(),bo=0}}function lG(){var e=Tu.now(),t=e-cd;t>r8&&(ud-=t,cd=e)}function fG(){for(var e,t=ad,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:ad=n);Mu=e,wg(r)}function wg(e){if(!Ea){Iu&&(Iu=clearTimeout(Iu));var t=e-bo;t>24?(e<1/0&&(Iu=setTimeout(o8,e-Tu.now()-ud)),Eu&&(Eu=clearInterval(Eu))):(Eu||(cd=Tu.now(),Eu=setInterval(lG,r8)),Ea=1,i8(o8))}}function a8(e,t,n){var r=new ld;return t=t==null?0:+t,r.restart(i=>{r.stop(),e(i+t)},t,n),r}var hG=Xh("start","end","cancel","interrupt"),dG=[],c8=0,u8=1,vg=2,fd=3,l8=4,xg=5,hd=6;function dd(e,t,n,r,i,s){var o=e.__transition;if(!o)e.__transition={};else if(n in o)return;pG(e,n,{name:t,index:r,group:i,on:hG,tween:dG,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:c8})}function Sg(e,t){var n=gr(e,t);if(n.state>c8)throw new Error("too late; already scheduled");return n}function Wr(e,t){var n=gr(e,t);if(n.state>fd)throw new Error("too late; already running");return n}function gr(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function pG(e,t,n){var r=e.__transition,i;r[t]=n,n.timer=s8(s,0,n.time);function s(u){n.state=u8,n.timer.restart(o,n.delay,n.time),n.delay<=u&&o(u-n.delay)}function o(u){var l,h,f,d;if(n.state!==u8)return c();for(l in r)if(d=r[l],d.name===n.name){if(d.state===fd)return a8(o);d.state===l8?(d.state=hd,d.timer.stop(),d.on.call("interrupt",e,e.__data__,d.index,d.group),delete r[l]):+l<t&&(d.state=hd,d.timer.stop(),d.on.call("cancel",e,e.__data__,d.index,d.group),delete r[l])}if(a8(function(){n.state===fd&&(n.state=l8,n.timer.restart(a,n.delay,n.time),a(u))}),n.state=vg,n.on.call("start",e,e.__data__,n.index,n.group),n.state===vg){for(n.state=fd,i=new Array(f=n.tween.length),l=0,h=-1;l<f;++l)(d=n.tween[l].value.call(e,e.__data__,n.index,n.group))&&(i[++h]=d);i.length=h+1}}function a(u){for(var l=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(c),n.state=xg,1),h=-1,f=i.length;++h<f;)i[h].call(e,l);n.state===xg&&(n.on.call("end",e,e.__data__,n.index,n.group),c())}function c(){n.state=hd,n.timer.stop(),delete r[t];for(var u in r)return;delete e.__transition}}function Ma(e,t){var n=e.__transition,r,i,s=!0,o;if(n){t=t==null?null:t+"";for(o in n){if((r=n[o]).name!==t){s=!1;continue}i=r.state>vg&&r.state<xg,r.state=hd,r.timer.stop(),r.on.call(i?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[o]}s&&delete e.__transition}}function yG(e){return this.each(function(){Ma(this,e)})}function mG(e,t){var n,r;return function(){var i=Wr(this,e),s=i.tween;if(s!==n){r=n=s;for(var o=0,a=r.length;o<a;++o)if(r[o].name===t){r=r.slice(),r.splice(o,1);break}}i.tween=r}}function gG(e,t,n){var r,i;if(typeof n!="function")throw new Error;return function(){var s=Wr(this,e),o=s.tween;if(o!==r){i=(r=o).slice();for(var a={name:t,value:n},c=0,u=i.length;c<u;++c)if(i[c].name===t){i[c]=a;break}c===u&&i.push(a)}s.tween=i}}function bG(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=gr(this.node(),n).tween,i=0,s=r.length,o;i<s;++i)if((o=r[i]).name===e)return o.value;return null}return this.each((t==null?mG:gG)(n,e,t))}function Ag(e,t,n){var r=e._id;return e.each(function(){var i=Wr(this,r);(i.value||(i.value={}))[t]=n.apply(this,arguments)}),function(i){return gr(i,r).value[t]}}function f8(e,t){var n;return(typeof t=="number"?Xe:t instanceof Is?go:(n=Is(t))?(t=n,go):J4)(e,t)}function _G(e){return function(){this.removeAttribute(e)}}function wG(e){return function(){this.removeAttributeNS(e.space,e.local)}}function vG(e,t,n){var r,i=n+"",s;return function(){var o=this.getAttribute(e);return o===i?null:o===r?s:s=t(r=o,n)}}function xG(e,t,n){var r,i=n+"",s;return function(){var o=this.getAttributeNS(e.space,e.local);return o===i?null:o===r?s:s=t(r=o,n)}}function SG(e,t,n){var r,i,s;return function(){var o,a=n(this),c;return a==null?void this.removeAttribute(e):(o=this.getAttribute(e),c=a+"",o===c?null:o===r&&c===i?s:(i=c,s=t(r=o,a)))}}function AG(e,t,n){var r,i,s;return function(){var o,a=n(this),c;return a==null?void this.removeAttributeNS(e.space,e.local):(o=this.getAttributeNS(e.space,e.local),c=a+"",o===c?null:o===r&&c===i?s:(i=c,s=t(r=o,a)))}}function IG(e,t){var n=Qh(e),r=n==="transform"?KW:f8;return this.attrTween(e,typeof t=="function"?(n.local?AG:SG)(n,r,Ag(this,"attr."+e,t)):t==null?(n.local?wG:_G)(n):(n.local?xG:vG)(n,r,t))}function EG(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function MG(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function TG(e,t){var n,r;function i(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&MG(e,s)),n}return i._value=t,i}function $G(e,t){var n,r;function i(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&EG(e,s)),n}return i._value=t,i}function NG(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=Qh(e);return this.tween(n,(r.local?TG:$G)(r,t))}function RG(e,t){return function(){Sg(this,e).delay=+t.apply(this,arguments)}}function OG(e,t){return t=+t,function(){Sg(this,e).delay=t}}function DG(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?RG:OG)(t,e)):gr(this.node(),t).delay}function LG(e,t){return function(){Wr(this,e).duration=+t.apply(this,arguments)}}function FG(e,t){return t=+t,function(){Wr(this,e).duration=t}}function CG(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?LG:FG)(t,e)):gr(this.node(),t).duration}function kG(e,t){if(typeof t!="function")throw new Error;return function(){Wr(this,e).ease=t}}function BG(e){var t=this._id;return arguments.length?this.each(kG(t,e)):gr(this.node(),t).ease}function PG(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;Wr(this,e).ease=n}}function UG(e){if(typeof e!="function")throw new Error;return this.each(PG(this._id,e))}function zG(e){typeof e!="function"&&(e=m4(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],o=s.length,a=r[i]=[],c,u=0;u<o;++u)(c=s[u])&&e.call(c,c.__data__,u,s)&&a.push(c);return new Ei(r,this._parents,this._name,this._id)}function qG(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,s=Math.min(r,i),o=new Array(r),a=0;a<s;++a)for(var c=t[a],u=n[a],l=c.length,h=o[a]=new Array(l),f,d=0;d<l;++d)(f=c[d]||u[d])&&(h[d]=f);for(;a<r;++a)o[a]=t[a];return new Ei(o,this._parents,this._name,this._id)}function jG(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function YG(e,t,n){var r,i,s=jG(t)?Sg:Wr;return function(){var o=s(this,e),a=o.on;a!==r&&(i=(r=a).copy()).on(t,n),o.on=i}}function VG(e,t){var n=this._id;return arguments.length<2?gr(this.node(),n).on.on(e):this.each(YG(n,e,t))}function WG(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function GG(){return this.on("end.remove",WG(this._id))}function XG(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Km(e));for(var r=this._groups,i=r.length,s=new Array(i),o=0;o<i;++o)for(var a=r[o],c=a.length,u=s[o]=new Array(c),l,h,f=0;f<c;++f)(l=a[f])&&(h=e.call(l,l.__data__,f,a))&&("__data__"in l&&(h.__data__=l.__data__),u[f]=h,dd(u[f],t,n,f,u,gr(l,n)));return new Ei(s,this._parents,t,n)}function HG(e){var t=this._name,n=this._id;typeof e!="function"&&(e=y4(e));for(var r=this._groups,i=r.length,s=[],o=[],a=0;a<i;++a)for(var c=r[a],u=c.length,l,h=0;h<u;++h)if(l=c[h]){for(var f=e.call(l,l.__data__,h,c),d,p=gr(l,n),y=0,g=f.length;y<g;++y)(d=f[y])&&dd(d,t,n,y,f,p);s.push(f),o.push(l)}return new Ei(s,o,t,n)}var QG=vu.prototype.constructor;function JG(){return new QG(this._groups,this._parents)}function KG(e,t){var n,r,i;return function(){var s=wa(this,e),o=(this.style.removeProperty(e),wa(this,e));return s===o?null:s===n&&o===r?i:i=t(n=s,r=o)}}function h8(e){return function(){this.style.removeProperty(e)}}function ZG(e,t,n){var r,i=n+"",s;return function(){var o=wa(this,e);return o===i?null:o===r?s:s=t(r=o,n)}}function tX(e,t,n){var r,i,s;return function(){var o=wa(this,e),a=n(this),c=a+"";return a==null&&(c=a=(this.style.removeProperty(e),wa(this,e))),o===c?null:o===r&&c===i?s:(i=c,s=t(r=o,a))}}function eX(e,t){var n,r,i,s="style."+t,o="end."+s,a;return function(){var c=Wr(this,e),u=c.on,l=c.value[s]==null?a||(a=h8(t)):void 0;(u!==n||i!==l)&&(r=(n=u).copy()).on(o,i=l),c.on=r}}function nX(e,t,n){var r=(e+="")=="transform"?JW:f8;return t==null?this.styleTween(e,KG(e,r)).on("end.style."+e,h8(e)):typeof t=="function"?this.styleTween(e,tX(e,r,Ag(this,"style."+e,t))).each(eX(this._id,e)):this.styleTween(e,ZG(e,r,t),n).on("end.style."+e,null)}function rX(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function iX(e,t,n){var r,i;function s(){var o=t.apply(this,arguments);return o!==i&&(r=(i=o)&&rX(e,o,n)),r}return s._value=t,s}function sX(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,iX(e,t,n??""))}function oX(e){return function(){this.textContent=e}}function aX(e){return function(){var t=e(this);this.textContent=t??""}}function cX(e){return this.tween("text",typeof e=="function"?aX(Ag(this,"text",e)):oX(e==null?"":e+""))}function uX(e){return function(t){this.textContent=e.call(this,t)}}function lX(e){var t,n;function r(){var i=e.apply(this,arguments);return i!==n&&(t=(n=i)&&uX(i)),t}return r._value=e,r}function fX(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,lX(e))}function hX(){for(var e=this._name,t=this._id,n=d8(),r=this._groups,i=r.length,s=0;s<i;++s)for(var o=r[s],a=o.length,c,u=0;u<a;++u)if(c=o[u]){var l=gr(c,t);dd(c,e,n,u,o,{time:l.time+l.delay+l.duration,delay:0,duration:l.duration,ease:l.ease})}return new Ei(r,this._parents,e,n)}function dX(){var e,t,n=this,r=n._id,i=n.size();return new Promise(function(s,o){var a={value:o},c={value:function(){--i===0&&s()}};n.each(function(){var u=Wr(this,r),l=u.on;l!==e&&(t=(e=l).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(c)),u.on=t}),i===0&&s()})}var pX=0;function Ei(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function d8(){return++pX}var Mi=vu.prototype;Ei.prototype={constructor:Ei,select:XG,selectAll:HG,selectChild:Mi.selectChild,selectChildren:Mi.selectChildren,filter:zG,merge:qG,selection:JG,transition:hX,call:Mi.call,nodes:Mi.nodes,node:Mi.node,size:Mi.size,empty:Mi.empty,each:Mi.each,on:VG,attr:IG,attrTween:NG,style:nX,styleTween:sX,text:cX,textTween:fX,remove:GG,tween:bG,delay:DG,duration:CG,ease:BG,easeVarying:UG,end:dX,[Symbol.iterator]:Mi[Symbol.iterator]};function yX(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var mX={time:null,delay:0,duration:250,ease:yX};function gX(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function bX(e){var t,n;e instanceof Ei?(t=e._id,e=e._name):(t=d8(),(n=mX).time=_g(),e=e==null?null:e+"");for(var r=this._groups,i=r.length,s=0;s<i;++s)for(var o=r[s],a=o.length,c,u=0;u<a;++u)(c=o[u])&&dd(c,e,t,u,o,n||gX(c,t));return new Ei(r,this._parents,e,t)}vu.prototype.interrupt=yG,vu.prototype.transition=bX;const Ig=e=>()=>e;function _X(e,{sourceEvent:t,target:n,selection:r,mode:i,dispatch:s}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},selection:{value:r,enumerable:!0,configurable:!0},mode:{value:i,enumerable:!0,configurable:!0},_:{value:s}})}function wX(e){e.stopImmediatePropagation()}function Eg(e){e.preventDefault(),e.stopImmediatePropagation()}var p8={name:"drag"},Mg={name:"space"},Ta={name:"handle"},$a={name:"center"};const{abs:y8,max:He,min:Qe}=Math;function m8(e){return[+e[0],+e[1]]}function Tg(e){return[m8(e[0]),m8(e[1])]}var pd={name:"x",handles:["w","e"].map($u),input:function(e,t){return e==null?null:[[+e[0],t[0][1]],[+e[1],t[1][1]]]},output:function(e){return e&&[e[0][0],e[1][0]]}},yd={name:"y",handles:["n","s"].map($u),input:function(e,t){return e==null?null:[[t[0][0],+e[0]],[t[1][0],+e[1]]]},output:function(e){return e&&[e[0][1],e[1][1]]}},vX={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map($u),input:function(e){return e==null?null:Tg(e)},output:function(e){return e}},Ti={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},g8={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},b8={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},xX={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},SX={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function $u(e){return{type:e}}function AX(e){return!e.ctrlKey&&!e.button}function IX(){var e=this.ownerSVGElement||this;return e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]}function EX(){return navigator.maxTouchPoints||"ontouchstart"in this}function $g(e){for(;!e.__brush;)if(!(e=e.parentNode))return;return e.__brush}function MX(e){return e[0][0]===e[1][0]||e[0][1]===e[1][1]}function TX(){return Ng(pd)}function $X(){return Ng(yd)}function NX(){return Ng(vX)}function Ng(e){var t=IX,n=AX,r=EX,i=!0,s=Xh("start","brush","end"),o=6,a;function c(g){var m=g.property("__brush",y).selectAll(".overlay").data([$u("overlay")]);m.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",Ti.overlay).merge(m).each(function(){var w=$g(this).extent;oe(this).attr("x",w[0][0]).attr("y",w[0][1]).attr("width",w[1][0]-w[0][0]).attr("height",w[1][1]-w[0][1])}),g.selectAll(".selection").data([$u("selection")]).enter().append("rect").attr("class","selection").attr("cursor",Ti.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var b=g.selectAll(".handle").data(e.handles,function(w){return w.type});b.exit().remove(),b.enter().append("rect").attr("class",function(w){return"handle handle--"+w.type}).attr("cursor",function(w){return Ti[w.type]}),g.each(u).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",f).filter(r).on("touchstart.brush",f).on("touchmove.brush",d).on("touchend.brush touchcancel.brush",p).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}c.move=function(g,m,b){g.tween?g.on("start.brush",function(w){l(this,arguments).beforestart().start(w)}).on("interrupt.brush end.brush",function(w){l(this,arguments).end(w)}).tween("brush",function(){var w=this,_=w.__brush,x=l(w,arguments),v=_.selection,S=e.input(typeof m=="function"?m.apply(this,arguments):m,_.extent),A=Ia(v,S);function M(T){_.selection=T===1&&S===null?null:A(T),u.call(w),x.brush()}return v!==null&&S!==null?M:M(1)}):g.each(function(){var w=this,_=arguments,x=w.__brush,v=e.input(typeof m=="function"?m.apply(w,_):m,x.extent),S=l(w,_).beforestart();Ma(w),x.selection=v===null?null:v,u.call(w),S.start(b).brush(b).end(b)})},c.clear=function(g,m){c.move(g,null,m)};function u(){var g=oe(this),m=$g(this).selection;m?(g.selectAll(".selection").style("display",null).attr("x",m[0][0]).attr("y",m[0][1]).attr("width",m[1][0]-m[0][0]).attr("height",m[1][1]-m[0][1]),g.selectAll(".handle").style("display",null).attr("x",function(b){return b.type[b.type.length-1]==="e"?m[1][0]-o/2:m[0][0]-o/2}).attr("y",function(b){return b.type[0]==="s"?m[1][1]-o/2:m[0][1]-o/2}).attr("width",function(b){return b.type==="n"||b.type==="s"?m[1][0]-m[0][0]+o:o}).attr("height",function(b){return b.type==="e"||b.type==="w"?m[1][1]-m[0][1]+o:o})):g.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function l(g,m,b){var w=g.__brush.emitter;return w&&(!b||!w.clean)?w:new h(g,m,b)}function h(g,m,b){this.that=g,this.args=m,this.state=g.__brush,this.active=0,this.clean=b}h.prototype={beforestart:function(){return++this.active===1&&(this.state.emitter=this,this.starting=!0),this},start:function(g,m){return this.starting?(this.starting=!1,this.emit("start",g,m)):this.emit("brush",g),this},brush:function(g,m){return this.emit("brush",g,m),this},end:function(g,m){return--this.active===0&&(delete this.state.emitter,this.emit("end",g,m)),this},emit:function(g,m,b){var w=oe(this.that).datum();s.call(g,this.that,new _X(g,{sourceEvent:m,target:c,selection:e.output(this.state.selection),mode:b,dispatch:s}),w)}};function f(g){if(a&&!g.touches||!n.apply(this,arguments))return;var m=this,b=g.target.__data__.type,w=(i&&g.metaKey?b="overlay":b)==="selection"?p8:i&&g.altKey?$a:Ta,_=e===yd?null:xX[b],x=e===pd?null:SX[b],v=$g(m),S=v.extent,A=v.selection,M=S[0][0],T,I,R=S[0][1],L,E,$=S[1][0],N,D,k=S[1][1],C,B,P=0,q=0,V,G=_&&x&&i&&g.shiftKey,Q,K,Y=Array.from(g.touches||[g],X=>{const jt=X.identifier;return X=pr(X,m),X.point0=X.slice(),X.identifier=jt,X});Ma(m);var J=l(m,arguments,!0).beforestart();if(b==="overlay"){A&&(V=!0);const X=[Y[0],Y[1]||Y[0]];v.selection=A=[[T=e===yd?M:Qe(X[0][0],X[1][0]),L=e===pd?R:Qe(X[0][1],X[1][1])],[N=e===yd?$:He(X[0][0],X[1][0]),C=e===pd?k:He(X[0][1],X[1][1])]],Y.length>1&&wt(g)}else T=A[0][0],L=A[0][1],N=A[1][0],C=A[1][1];I=T,E=L,D=N,B=C;var z=oe(m).attr("pointer-events","none"),W=z.selectAll(".overlay").attr("cursor",Ti[b]);if(g.touches)J.moved=U,J.ended=tt;else{var H=oe(g.view).on("mousemove.brush",U,!0).on("mouseup.brush",tt,!0);i&&H.on("keydown.brush",$t,!0).on("keyup.brush",Ot,!0),E4(g.view)}u.call(m),J.start(g,w.name);function U(X){for(const jt of X.changedTouches||[X])for(const Cn of Y)Cn.identifier===jt.identifier&&(Cn.cur=pr(jt,m));if(G&&!Q&&!K&&Y.length===1){const jt=Y[0];y8(jt.cur[0]-jt[0])>y8(jt.cur[1]-jt[1])?K=!0:Q=!0}for(const jt of Y)jt.cur&&(jt[0]=jt.cur[0],jt[1]=jt.cur[1]);V=!0,Eg(X),wt(X)}function wt(X){const jt=Y[0],Cn=jt.point0;var ai;switch(P=jt[0]-Cn[0],q=jt[1]-Cn[1],w){case Mg:case p8:{_&&(P=He(M-T,Qe($-N,P)),I=T+P,D=N+P),x&&(q=He(R-L,Qe(k-C,q)),E=L+q,B=C+q);break}case Ta:{Y[1]?(_&&(I=He(M,Qe($,Y[0][0])),D=He(M,Qe($,Y[1][0])),_=1),x&&(E=He(R,Qe(k,Y[0][1])),B=He(R,Qe(k,Y[1][1])),x=1)):(_<0?(P=He(M-T,Qe($-T,P)),I=T+P,D=N):_>0&&(P=He(M-N,Qe($-N,P)),I=T,D=N+P),x<0?(q=He(R-L,Qe(k-L,q)),E=L+q,B=C):x>0&&(q=He(R-C,Qe(k-C,q)),E=L,B=C+q));break}case $a:{_&&(I=He(M,Qe($,T-P*_)),D=He(M,Qe($,N+P*_))),x&&(E=He(R,Qe(k,L-q*x)),B=He(R,Qe(k,C+q*x)));break}}D<I&&(_*=-1,ai=T,T=N,N=ai,ai=I,I=D,D=ai,b in g8&&W.attr("cursor",Ti[b=g8[b]])),B<E&&(x*=-1,ai=L,L=C,C=ai,ai=E,E=B,B=ai,b in b8&&W.attr("cursor",Ti[b=b8[b]])),v.selection&&(A=v.selection),Q&&(I=A[0][0],D=A[1][0]),K&&(E=A[0][1],B=A[1][1]),(A[0][0]!==I||A[0][1]!==E||A[1][0]!==D||A[1][1]!==B)&&(v.selection=[[I,E],[D,B]],u.call(m),J.brush(X,w.name))}function tt(X){if(wX(X),X.touches){if(X.touches.length)return;a&&clearTimeout(a),a=setTimeout(function(){a=null},500)}else M4(X.view,V),H.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);z.attr("pointer-events","all"),W.attr("cursor",Ti.overlay),v.selection&&(A=v.selection),MX(A)&&(v.selection=null,u.call(m)),J.end(X,w.name)}function $t(X){switch(X.keyCode){case 16:{G=_&&x;break}case 18:{w===Ta&&(_&&(N=D-P*_,T=I+P*_),x&&(C=B-q*x,L=E+q*x),w=$a,wt(X));break}case 32:{(w===Ta||w===$a)&&(_<0?N=D-P:_>0&&(T=I-P),x<0?C=B-q:x>0&&(L=E-q),w=Mg,W.attr("cursor",Ti.selection),wt(X));break}default:return}Eg(X)}function Ot(X){switch(X.keyCode){case 16:{G&&(Q=K=G=!1,wt(X));break}case 18:{w===$a&&(_<0?N=D:_>0&&(T=I),x<0?C=B:x>0&&(L=E),w=Ta,wt(X));break}case 32:{w===Mg&&(X.altKey?(_&&(N=D-P*_,T=I+P*_),x&&(C=B-q*x,L=E+q*x),w=$a):(_<0?N=D:_>0&&(T=I),x<0?C=B:x>0&&(L=E),w=Ta),W.attr("cursor",Ti[b]),wt(X));break}default:return}Eg(X)}}function d(g){l(this,arguments).moved(g)}function p(g){l(this,arguments).ended(g)}function y(){var g=this.__brush||{selection:null};return g.extent=Tg(t.apply(this,arguments)),g.dim=e,g}return c.extent=function(g){return arguments.length?(t=typeof g=="function"?g:Ig(Tg(g)),c):t},c.filter=function(g){return arguments.length?(n=typeof g=="function"?g:Ig(!!g),c):n},c.touchable=function(g){return arguments.length?(r=typeof g=="function"?g:Ig(!!g),c):r},c.handleSize=function(g){return arguments.length?(o=+g,c):o},c.keyModifiers=function(g){return arguments.length?(i=!!g,c):i},c.on=function(){var g=s.on.apply(s,arguments);return g===s?c:g},c}const Rg=Math.PI,Og=2*Rg,_o=1e-6,RX=Og-_o;function _8(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function OX(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return _8;const n=10**t;return function(r){this._+=r[0];for(let i=1,s=r.length;i<s;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}let w8=class{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?_8:OX(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,r,i){this._append`Q${+t},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(t,n,r,i,s,o){this._append`C${+t},${+n},${+r},${+i},${this._x1=+s},${this._y1=+o}`}arcTo(t,n,r,i,s){if(t=+t,n=+n,r=+r,i=+i,s=+s,s<0)throw new Error(`negative radius: ${s}`);let o=this._x1,a=this._y1,c=r-t,u=i-n,l=o-t,h=a-n,f=l*l+h*h;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(f>_o)if(!(Math.abs(h*c-u*l)>_o)||!s)this._append`L${this._x1=t},${this._y1=n}`;else{let d=r-o,p=i-a,y=c*c+u*u,g=d*d+p*p,m=Math.sqrt(y),b=Math.sqrt(f),w=s*Math.tan((Rg-Math.acos((y+f-g)/(2*m*b)))/2),_=w/b,x=w/m;Math.abs(_-1)>_o&&this._append`L${t+_*l},${n+_*h}`,this._append`A${s},${s},0,0,${+(h*d>l*p)},${this._x1=t+x*c},${this._y1=n+x*u}`}}arc(t,n,r,i,s,o){if(t=+t,n=+n,r=+r,o=!!o,r<0)throw new Error(`negative radius: ${r}`);let a=r*Math.cos(i),c=r*Math.sin(i),u=t+a,l=n+c,h=1^o,f=o?i-s:s-i;this._x1===null?this._append`M${u},${l}`:(Math.abs(this._x1-u)>_o||Math.abs(this._y1-l)>_o)&&this._append`L${u},${l}`,r&&(f<0&&(f=f%Og+Og),f>RX?this._append`A${r},${r},0,1,${h},${t-a},${n-c}A${r},${r},0,1,${h},${this._x1=u},${this._y1=l}`:f>_o&&this._append`A${r},${r},0,${+(f>=Rg)},${h},${this._x1=t+r*Math.cos(s)},${this._y1=n+r*Math.sin(s)}`)}rect(t,n,r,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}};function $i(e=3){return new w8(+e)}var DX=Array.prototype,v8=DX.slice;function LX(e,t){return e-t}function FX(e){for(var t=0,n=e.length,r=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];++t<n;)r+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return r}const Es=e=>()=>e;function CX(e,t){for(var n=-1,r=t.length,i;++n<r;)if(i=kX(e,t[n]))return i;return 0}function kX(e,t){for(var n=t[0],r=t[1],i=-1,s=0,o=e.length,a=o-1;s<o;a=s++){var c=e[s],u=c[0],l=c[1],h=e[a],f=h[0],d=h[1];if(BX(c,h,t))return 0;l>r!=d>r&&n<(f-u)*(r-l)/(d-l)+u&&(i=-i)}return i}function BX(e,t,n){var r;return PX(e,t,n)&&UX(e[r=+(e[0]===t[0])],n[r],t[r])}function PX(e,t,n){return(t[0]-e[0])*(n[1]-e[1])===(n[0]-e[0])*(t[1]-e[1])}function UX(e,t,n){return e<=t&&t<=n||n<=t&&t<=e}function zX(){}var Ni=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function md(){var e=1,t=1,n=Hm,r=c;function i(u){var l=n(u);if(Array.isArray(l))l=l.slice().sort(LX);else{const h=Ie(u,qX);for(l=xs(...a4(h[0],h[1],l),l);l[l.length-1]>=h[1];)l.pop();for(;l[1]<h[0];)l.shift()}return l.map(h=>s(u,h))}function s(u,l){const h=l==null?NaN:+l;if(isNaN(h))throw new Error(`invalid value: ${l}`);var f=[],d=[];return o(u,h,function(p){r(p,u,h),FX(p)>0?f.push([p]):d.push(p)}),d.forEach(function(p){for(var y=0,g=f.length,m;y<g;++y)if(CX((m=f[y])[0],p)!==-1){m.push(p);return}}),{type:"MultiPolygon",value:l,coordinates:f}}function o(u,l,h){var f=new Array,d=new Array,p,y,g,m,b,w;for(p=y=-1,m=wo(u[0],l),Ni[m<<1].forEach(_);++p<e-1;)g=m,m=wo(u[p+1],l),Ni[g|m<<1].forEach(_);for(Ni[m<<0].forEach(_);++y<t-1;){for(p=-1,m=wo(u[y*e+e],l),b=wo(u[y*e],l),Ni[m<<1|b<<2].forEach(_);++p<e-1;)g=m,m=wo(u[y*e+e+p+1],l),w=b,b=wo(u[y*e+p+1],l),Ni[g|m<<1|b<<2|w<<3].forEach(_);Ni[m|b<<3].forEach(_)}for(p=-1,b=u[y*e]>=l,Ni[b<<2].forEach(_);++p<e-1;)w=b,b=wo(u[y*e+p+1],l),Ni[b<<2|w<<3].forEach(_);Ni[b<<3].forEach(_);function _(x){var v=[x[0][0]+p,x[0][1]+y],S=[x[1][0]+p,x[1][1]+y],A=a(v),M=a(S),T,I;(T=d[A])?(I=f[M])?(delete d[T.end],delete f[I.start],T===I?(T.ring.push(S),h(T.ring)):f[T.start]=d[I.end]={start:T.start,end:I.end,ring:T.ring.concat(I.ring)}):(delete d[T.end],T.ring.push(S),d[T.end=M]=T):(T=f[M])?(I=d[A])?(delete f[T.start],delete d[I.end],T===I?(T.ring.push(S),h(T.ring)):f[I.start]=d[T.end]={start:I.start,end:T.end,ring:I.ring.concat(T.ring)}):(delete f[T.start],T.ring.unshift(v),f[T.start=A]=T):f[A]=d[M]={start:A,end:M,ring:[v,S]}}}function a(u){return u[0]*2+u[1]*(e+1)*4}function c(u,l,h){u.forEach(function(f){var d=f[0],p=f[1],y=d|0,g=p|0,m=Dg(l[g*e+y]);d>0&&d<e&&y===d&&(f[0]=x8(d,Dg(l[g*e+y-1]),m,h)),p>0&&p<t&&g===p&&(f[1]=x8(p,Dg(l[(g-1)*e+y]),m,h))})}return i.contour=s,i.size=function(u){if(!arguments.length)return[e,t];var l=Math.floor(u[0]),h=Math.floor(u[1]);if(!(l>=0&&h>=0))throw new Error("invalid size");return e=l,t=h,i},i.thresholds=function(u){return arguments.length?(n=typeof u=="function"?u:Array.isArray(u)?Es(v8.call(u)):Es(u),i):n},i.smooth=function(u){return arguments.length?(r=u?c:zX,i):r===c},i}function qX(e){return isFinite(e)?e:NaN}function wo(e,t){return e==null?!1:+e>=t}function Dg(e){return e==null||isNaN(e=+e)?-1/0:e}function x8(e,t,n,r){const i=r-t,s=n-t,o=isFinite(i)||isFinite(s)?i/s:Math.sign(i)/Math.sign(s);return isNaN(o)?e:e+o-.5}function jX(e){return e[0]}function YX(e){return e[1]}function VX(){return 1}function WX(){var e=jX,t=YX,n=VX,r=960,i=500,s=20,o=2,a=s*3,c=r+a*2>>o,u=i+a*2>>o,l=Es(20);function h(b){var w=new Float32Array(c*u),_=Math.pow(2,-o),x=-1;for(const L of b){var v=(e(L,++x,b)+a)*_,S=(t(L,x,b)+a)*_,A=+n(L,x,b);if(A&&v>=0&&v<c&&S>=0&&S<u){var M=Math.floor(v),T=Math.floor(S),I=v-M-.5,R=S-T-.5;w[M+T*c]+=(1-I)*(1-R)*A,w[M+1+T*c]+=I*(1-R)*A,w[M+1+(T+1)*c]+=I*R*A,w[M+(T+1)*c]+=(1-I)*R*A}}return e4({data:w,width:c,height:u},s*_),w}function f(b){var w=h(b),_=l(w),x=Math.pow(2,2*o);return Array.isArray(_)||(_=xs(Number.MIN_VALUE,me(w)/x,_)),md().size([c,u]).thresholds(_.map(v=>v*x))(w).map((v,S)=>(v.value=+_[S],d(v)))}f.contours=function(b){var w=h(b),_=md().size([c,u]),x=Math.pow(2,2*o),v=S=>{S=+S;var A=d(_.contour(w,S*x));return A.value=S,A};return Object.defineProperty(v,"max",{get:()=>me(w)/x}),v};function d(b){return b.coordinates.forEach(p),b}function p(b){b.forEach(y)}function y(b){b.forEach(g)}function g(b){b[0]=b[0]*Math.pow(2,o)-a,b[1]=b[1]*Math.pow(2,o)-a}function m(){return a=s*3,c=r+a*2>>o,u=i+a*2>>o,f}return f.x=function(b){return arguments.length?(e=typeof b=="function"?b:Es(+b),f):e},f.y=function(b){return arguments.length?(t=typeof b=="function"?b:Es(+b),f):t},f.weight=function(b){return arguments.length?(n=typeof b=="function"?b:Es(+b),f):n},f.size=function(b){if(!arguments.length)return[r,i];var w=+b[0],_=+b[1];if(!(w>=0&&_>=0))throw new Error("invalid size");return r=w,i=_,m()},f.cellSize=function(b){if(!arguments.length)return 1<<o;if(!((b=+b)>=1))throw new Error("invalid cell size");return o=Math.floor(Math.log(b)/Math.LN2),m()},f.thresholds=function(b){return arguments.length?(l=typeof b=="function"?b:Array.isArray(b)?Es(v8.call(b)):Es(b),f):l},f.bandwidth=function(b){if(!arguments.length)return Math.sqrt(s*(s+1));if(!((b=+b)>=0))throw new Error("invalid bandwidth");return s=(Math.sqrt(4*b*b+1)-1)/2,m()},f}const Ri=11102230246251565e-32,Je=134217729,GX=(3+8*Ri)*Ri;function Lg(e,t,n,r,i){let s,o,a,c,u=t[0],l=r[0],h=0,f=0;l>u==l>-u?(s=u,u=t[++h]):(s=l,l=r[++f]);let d=0;if(h<e&&f<n)for(l>u==l>-u?(o=u+s,a=s-(o-u),u=t[++h]):(o=l+s,a=s-(o-l),l=r[++f]),s=o,a!==0&&(i[d++]=a);h<e&&f<n;)l>u==l>-u?(o=s+u,c=o-s,a=s-(o-c)+(u-c),u=t[++h]):(o=s+l,c=o-s,a=s-(o-c)+(l-c),l=r[++f]),s=o,a!==0&&(i[d++]=a);for(;h<e;)o=s+u,c=o-s,a=s-(o-c)+(u-c),u=t[++h],s=o,a!==0&&(i[d++]=a);for(;f<n;)o=s+l,c=o-s,a=s-(o-c)+(l-c),l=r[++f],s=o,a!==0&&(i[d++]=a);return(s!==0||d===0)&&(i[d++]=s),d}function XX(e,t){let n=t[0];for(let r=1;r<e;r++)n+=t[r];return n}function Nu(e){return new Float64Array(e)}const HX=(3+16*Ri)*Ri,QX=(2+12*Ri)*Ri,JX=(9+64*Ri)*Ri*Ri,Na=Nu(4),S8=Nu(8),A8=Nu(12),I8=Nu(16),sn=Nu(4);function KX(e,t,n,r,i,s,o){let a,c,u,l,h,f,d,p,y,g,m,b,w,_,x,v,S,A;const M=e-i,T=n-i,I=t-s,R=r-s;_=M*R,f=Je*M,d=f-(f-M),p=M-d,f=Je*R,y=f-(f-R),g=R-y,x=p*g-(_-d*y-p*y-d*g),v=I*T,f=Je*I,d=f-(f-I),p=I-d,f=Je*T,y=f-(f-T),g=T-y,S=p*g-(v-d*y-p*y-d*g),m=x-S,h=x-m,Na[0]=x-(m+h)+(h-S),b=_+m,h=b-_,w=_-(b-h)+(m-h),m=w-v,h=w-m,Na[1]=w-(m+h)+(h-v),A=b+m,h=A-b,Na[2]=b-(A-h)+(m-h),Na[3]=A;let L=XX(4,Na),E=QX*o;if(L>=E||-L>=E||(h=e-M,a=e-(M+h)+(h-i),h=n-T,u=n-(T+h)+(h-i),h=t-I,c=t-(I+h)+(h-s),h=r-R,l=r-(R+h)+(h-s),a===0&&c===0&&u===0&&l===0)||(E=JX*o+GX*Math.abs(L),L+=M*l+R*a-(I*u+T*c),L>=E||-L>=E))return L;_=a*R,f=Je*a,d=f-(f-a),p=a-d,f=Je*R,y=f-(f-R),g=R-y,x=p*g-(_-d*y-p*y-d*g),v=c*T,f=Je*c,d=f-(f-c),p=c-d,f=Je*T,y=f-(f-T),g=T-y,S=p*g-(v-d*y-p*y-d*g),m=x-S,h=x-m,sn[0]=x-(m+h)+(h-S),b=_+m,h=b-_,w=_-(b-h)+(m-h),m=w-v,h=w-m,sn[1]=w-(m+h)+(h-v),A=b+m,h=A-b,sn[2]=b-(A-h)+(m-h),sn[3]=A;const $=Lg(4,Na,4,sn,S8);_=M*l,f=Je*M,d=f-(f-M),p=M-d,f=Je*l,y=f-(f-l),g=l-y,x=p*g-(_-d*y-p*y-d*g),v=I*u,f=Je*I,d=f-(f-I),p=I-d,f=Je*u,y=f-(f-u),g=u-y,S=p*g-(v-d*y-p*y-d*g),m=x-S,h=x-m,sn[0]=x-(m+h)+(h-S),b=_+m,h=b-_,w=_-(b-h)+(m-h),m=w-v,h=w-m,sn[1]=w-(m+h)+(h-v),A=b+m,h=A-b,sn[2]=b-(A-h)+(m-h),sn[3]=A;const N=Lg($,S8,4,sn,A8);_=a*l,f=Je*a,d=f-(f-a),p=a-d,f=Je*l,y=f-(f-l),g=l-y,x=p*g-(_-d*y-p*y-d*g),v=c*u,f=Je*c,d=f-(f-c),p=c-d,f=Je*u,y=f-(f-u),g=u-y,S=p*g-(v-d*y-p*y-d*g),m=x-S,h=x-m,sn[0]=x-(m+h)+(h-S),b=_+m,h=b-_,w=_-(b-h)+(m-h),m=w-v,h=w-m,sn[1]=w-(m+h)+(h-v),A=b+m,h=A-b,sn[2]=b-(A-h)+(m-h),sn[3]=A;const D=Lg(N,A8,4,sn,I8);return I8[D-1]}function gd(e,t,n,r,i,s){const o=(t-s)*(n-i),a=(e-i)*(r-s),c=o-a,u=Math.abs(o+a);return Math.abs(c)>=HX*u?c:-KX(e,t,n,r,i,s,u)}const E8=Math.pow(2,-52),bd=new Uint32Array(512);class _d{static from(t,n=rH,r=iH){const i=t.length,s=new Float64Array(i*2);for(let o=0;o<i;o++){const a=t[o];s[2*o]=n(a),s[2*o+1]=r(a)}return new _d(s)}constructor(t){const n=t.length>>1;if(n>0&&typeof t[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=t;const r=Math.max(2*n-5,0);this._triangles=new Uint32Array(r*3),this._halfedges=new Int32Array(r*3),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){const{coords:t,_hullPrev:n,_hullNext:r,_hullTri:i,_hullHash:s}=this,o=t.length>>1;let a=1/0,c=1/0,u=-1/0,l=-1/0;for(let M=0;M<o;M++){const T=t[2*M],I=t[2*M+1];T<a&&(a=T),I<c&&(c=I),T>u&&(u=T),I>l&&(l=I),this._ids[M]=M}const h=(a+u)/2,f=(c+l)/2;let d,p,y;for(let M=0,T=1/0;M<o;M++){const I=Fg(h,f,t[2*M],t[2*M+1]);I<T&&(d=M,T=I)}const g=t[2*d],m=t[2*d+1];for(let M=0,T=1/0;M<o;M++){if(M===d)continue;const I=Fg(g,m,t[2*M],t[2*M+1]);I<T&&I>0&&(p=M,T=I)}let b=t[2*p],w=t[2*p+1],_=1/0;for(let M=0;M<o;M++){if(M===d||M===p)continue;const T=eH(g,m,b,w,t[2*M],t[2*M+1]);T<_&&(y=M,_=T)}let x=t[2*y],v=t[2*y+1];if(_===1/0){for(let I=0;I<o;I++)this._dists[I]=t[2*I]-t[0]||t[2*I+1]-t[1];Ra(this._ids,this._dists,0,o-1);const M=new Uint32Array(o);let T=0;for(let I=0,R=-1/0;I<o;I++){const L=this._ids[I],E=this._dists[L];E>R&&(M[T++]=L,R=E)}this.hull=M.subarray(0,T),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(gd(g,m,b,w,x,v)<0){const M=p,T=b,I=w;p=y,b=x,w=v,y=M,x=T,v=I}const S=nH(g,m,b,w,x,v);this._cx=S.x,this._cy=S.y;for(let M=0;M<o;M++)this._dists[M]=Fg(t[2*M],t[2*M+1],S.x,S.y);Ra(this._ids,this._dists,0,o-1),this._hullStart=d;let A=3;r[d]=n[y]=p,r[p]=n[d]=y,r[y]=n[p]=d,i[d]=0,i[p]=1,i[y]=2,s.fill(-1),s[this._hashKey(g,m)]=d,s[this._hashKey(b,w)]=p,s[this._hashKey(x,v)]=y,this.trianglesLen=0,this._addTriangle(d,p,y,-1,-1,-1);for(let M=0,T,I;M<this._ids.length;M++){const R=this._ids[M],L=t[2*R],E=t[2*R+1];if(M>0&&Math.abs(L-T)<=E8&&Math.abs(E-I)<=E8||(T=L,I=E,R===d||R===p||R===y))continue;let $=0;for(let B=0,P=this._hashKey(L,E);B<this._hashSize&&($=s[(P+B)%this._hashSize],!($!==-1&&$!==r[$]));B++);$=n[$];let N=$,D;for(;D=r[N],gd(L,E,t[2*N],t[2*N+1],t[2*D],t[2*D+1])>=0;)if(N=D,N===$){N=-1;break}if(N===-1)continue;let k=this._addTriangle(N,R,r[N],-1,-1,i[N]);i[R]=this._legalize(k+2),i[N]=k,A++;let C=r[N];for(;D=r[C],gd(L,E,t[2*C],t[2*C+1],t[2*D],t[2*D+1])<0;)k=this._addTriangle(C,R,D,i[R],-1,i[C]),i[R]=this._legalize(k+2),r[C]=C,A--,C=D;if(N===$)for(;D=n[N],gd(L,E,t[2*D],t[2*D+1],t[2*N],t[2*N+1])<0;)k=this._addTriangle(D,R,N,-1,i[N],i[D]),this._legalize(k+2),i[D]=k,r[N]=N,A--,N=D;this._hullStart=n[R]=N,r[N]=n[C]=R,r[R]=C,s[this._hashKey(L,E)]=R,s[this._hashKey(t[2*N],t[2*N+1])]=N}this.hull=new Uint32Array(A);for(let M=0,T=this._hullStart;M<A;M++)this.hull[M]=T,T=r[T];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,n){return Math.floor(ZX(t-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:n,_halfedges:r,coords:i}=this;let s=0,o=0;for(;;){const a=r[t],c=t-t%3;if(o=c+(t+2)%3,a===-1){if(s===0)break;t=bd[--s];continue}const u=a-a%3,l=c+(t+1)%3,h=u+(a+2)%3,f=n[o],d=n[t],p=n[l],y=n[h];if(tH(i[2*f],i[2*f+1],i[2*d],i[2*d+1],i[2*p],i[2*p+1],i[2*y],i[2*y+1])){n[t]=y,n[a]=f;const m=r[h];if(m===-1){let w=this._hullStart;do{if(this._hullTri[w]===h){this._hullTri[w]=t;break}w=this._hullPrev[w]}while(w!==this._hullStart)}this._link(t,m),this._link(a,r[o]),this._link(o,h);const b=u+(a+1)%3;s<bd.length&&(bd[s++]=b)}else{if(s===0)break;t=bd[--s]}}return o}_link(t,n){this._halfedges[t]=n,n!==-1&&(this._halfedges[n]=t)}_addTriangle(t,n,r,i,s,o){const a=this.trianglesLen;return this._triangles[a]=t,this._triangles[a+1]=n,this._triangles[a+2]=r,this._link(a,i),this._link(a+1,s),this._link(a+2,o),this.trianglesLen+=3,a}}function ZX(e,t){const n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}function Fg(e,t,n,r){const i=e-n,s=t-r;return i*i+s*s}function tH(e,t,n,r,i,s,o,a){const c=e-o,u=t-a,l=n-o,h=r-a,f=i-o,d=s-a,p=c*c+u*u,y=l*l+h*h,g=f*f+d*d;return c*(h*g-y*d)-u*(l*g-y*f)+p*(l*d-h*f)<0}function eH(e,t,n,r,i,s){const o=n-e,a=r-t,c=i-e,u=s-t,l=o*o+a*a,h=c*c+u*u,f=.5/(o*u-a*c),d=(u*l-a*h)*f,p=(o*h-c*l)*f;return d*d+p*p}function nH(e,t,n,r,i,s){const o=n-e,a=r-t,c=i-e,u=s-t,l=o*o+a*a,h=c*c+u*u,f=.5/(o*u-a*c),d=e+(u*l-a*h)*f,p=t+(o*h-c*l)*f;return{x:d,y:p}}function Ra(e,t,n,r){if(r-n<=20)for(let i=n+1;i<=r;i++){const s=e[i],o=t[s];let a=i-1;for(;a>=n&&t[e[a]]>o;)e[a+1]=e[a--];e[a+1]=s}else{const i=n+r>>1;let s=n+1,o=r;Ru(e,i,s),t[e[n]]>t[e[r]]&&Ru(e,n,r),t[e[s]]>t[e[r]]&&Ru(e,s,r),t[e[n]]>t[e[s]]&&Ru(e,n,s);const a=e[s],c=t[a];for(;;){do s++;while(t[e[s]]<c);do o--;while(t[e[o]]>c);if(o<s)break;Ru(e,s,o)}e[n+1]=e[o],e[o]=a,r-s+1>=o-n?(Ra(e,t,s,r),Ra(e,t,n,o-1)):(Ra(e,t,n,o-1),Ra(e,t,s,r))}}function Ru(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function rH(e){return e[0]}function iH(e){return e[1]}const M8=1e-6;class vo{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,n){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,n){this._+=`L${this._x1=+t},${this._y1=+n}`}arc(t,n,r){t=+t,n=+n,r=+r;const i=t+r,s=n;if(r<0)throw new Error("negative radius");this._x1===null?this._+=`M${i},${s}`:(Math.abs(this._x1-i)>M8||Math.abs(this._y1-s)>M8)&&(this._+="L"+i+","+s),r&&(this._+=`A${r},${r},0,1,1,${t-r},${n}A${r},${r},0,1,1,${this._x1=i},${this._y1=s}`)}rect(t,n,r,i){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${+r}v${+i}h${-r}Z`}value(){return this._||null}}class Cg{constructor(){this._=[]}moveTo(t,n){this._.push([t,n])}closePath(){this._.push(this._[0].slice())}lineTo(t,n){this._.push([t,n])}value(){return this._.length?this._:null}}let sH=class{constructor(t,[n,r,i,s]=[0,0,960,500]){if(!((i=+i)>=(n=+n))||!((s=+s)>=(r=+r)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(t.points.length*2),this.vectors=new Float64Array(t.points.length*2),this.xmax=i,this.xmin=n,this.ymax=s,this.ymin=r,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:n,triangles:r},vectors:i}=this;let s,o;const a=this.circumcenters=this._circumcenters.subarray(0,r.length/3*2);for(let y=0,g=0,m=r.length,b,w;y<m;y+=3,g+=2){const _=r[y]*2,x=r[y+1]*2,v=r[y+2]*2,S=t[_],A=t[_+1],M=t[x],T=t[x+1],I=t[v],R=t[v+1],L=M-S,E=T-A,$=I-S,N=R-A,D=(L*N-E*$)*2;if(Math.abs(D)<1e-9){if(s===void 0){s=o=0;for(const C of n)s+=t[C*2],o+=t[C*2+1];s/=n.length,o/=n.length}const k=1e9*Math.sign((s-S)*N-(o-A)*$);b=(S+I)/2-k*N,w=(A+R)/2+k*$}else{const k=1/D,C=L*L+E*E,B=$*$+N*N;b=S+(N*C-E*B)*k,w=A+(L*B-$*C)*k}a[g]=b,a[g+1]=w}let c=n[n.length-1],u,l=c*4,h,f=t[2*c],d,p=t[2*c+1];i.fill(0);for(let y=0;y<n.length;++y)c=n[y],u=l,h=f,d=p,l=c*4,f=t[2*c],p=t[2*c+1],i[u+2]=i[l]=d-p,i[u+3]=i[l+1]=f-h}render(t){const n=t==null?t=new vo:void 0,{delaunay:{halfedges:r,inedges:i,hull:s},circumcenters:o,vectors:a}=this;if(s.length<=1)return null;for(let l=0,h=r.length;l<h;++l){const f=r[l];if(f<l)continue;const d=Math.floor(l/3)*2,p=Math.floor(f/3)*2,y=o[d],g=o[d+1],m=o[p],b=o[p+1];this._renderSegment(y,g,m,b,t)}let c,u=s[s.length-1];for(let l=0;l<s.length;++l){c=u,u=s[l];const h=Math.floor(i[u]/3)*2,f=o[h],d=o[h+1],p=c*4,y=this._project(f,d,a[p+2],a[p+3]);y&&this._renderSegment(f,d,y[0],y[1],t)}return n&&n.value()}renderBounds(t){const n=t==null?t=new vo:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),n&&n.value()}renderCell(t,n){const r=n==null?n=new vo:void 0,i=this._clip(t);if(i===null||!i.length)return;n.moveTo(i[0],i[1]);let s=i.length;for(;i[0]===i[s-2]&&i[1]===i[s-1]&&s>1;)s-=2;for(let o=2;o<s;o+=2)(i[o]!==i[o-2]||i[o+1]!==i[o-1])&&n.lineTo(i[o],i[o+1]);return n.closePath(),r&&r.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let n=0,r=t.length/2;n<r;++n){const i=this.cellPolygon(n);i&&(i.index=n,yield i)}}cellPolygon(t){const n=new Cg;return this.renderCell(t,n),n.value()}_renderSegment(t,n,r,i,s){let o;const a=this._regioncode(t,n),c=this._regioncode(r,i);a===0&&c===0?(s.moveTo(t,n),s.lineTo(r,i)):(o=this._clipSegment(t,n,r,i,a,c))&&(s.moveTo(o[0],o[1]),s.lineTo(o[2],o[3]))}contains(t,n,r){return n=+n,n!==n||(r=+r,r!==r)?!1:this.delaunay._step(t,n,r)===t}*neighbors(t){const n=this._clip(t);if(n)for(const r of this.delaunay.neighbors(t)){const i=this._clip(r);if(i){t:for(let s=0,o=n.length;s<o;s+=2)for(let a=0,c=i.length;a<c;a+=2)if(n[s]===i[a]&&n[s+1]===i[a+1]&&n[(s+2)%o]===i[(a+c-2)%c]&&n[(s+3)%o]===i[(a+c-1)%c]){yield r;break t}}}}_cell(t){const{circumcenters:n,delaunay:{inedges:r,halfedges:i,triangles:s}}=this,o=r[t];if(o===-1)return null;const a=[];let c=o;do{const u=Math.floor(c/3);if(a.push(n[u*2],n[u*2+1]),c=c%3===2?c-2:c+1,s[c]!==t)break;c=i[c]}while(c!==o&&c!==-1);return a}_clip(t){if(t===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const n=this._cell(t);if(n===null)return null;const{vectors:r}=this,i=t*4;return this._simplify(r[i]||r[i+1]?this._clipInfinite(t,n,r[i],r[i+1],r[i+2],r[i+3]):this._clipFinite(t,n))}_clipFinite(t,n){const r=n.length;let i=null,s,o,a=n[r-2],c=n[r-1],u,l=this._regioncode(a,c),h,f=0;for(let d=0;d<r;d+=2)if(s=a,o=c,a=n[d],c=n[d+1],u=l,l=this._regioncode(a,c),u===0&&l===0)h=f,f=0,i?i.push(a,c):i=[a,c];else{let p,y,g,m,b;if(u===0){if((p=this._clipSegment(s,o,a,c,u,l))===null)continue;[y,g,m,b]=p}else{if((p=this._clipSegment(a,c,s,o,l,u))===null)continue;[m,b,y,g]=p,h=f,f=this._edgecode(y,g),h&&f&&this._edge(t,h,f,i,i.length),i?i.push(y,g):i=[y,g]}h=f,f=this._edgecode(m,b),h&&f&&this._edge(t,h,f,i,i.length),i?i.push(m,b):i=[m,b]}if(i)h=f,f=this._edgecode(i[0],i[1]),h&&f&&this._edge(t,h,f,i,i.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return i}_clipSegment(t,n,r,i,s,o){const a=s<o;for(a&&([t,n,r,i,s,o]=[r,i,t,n,o,s]);;){if(s===0&&o===0)return a?[r,i,t,n]:[t,n,r,i];if(s&o)return null;let c,u,l=s||o;l&8?(c=t+(r-t)*(this.ymax-n)/(i-n),u=this.ymax):l&4?(c=t+(r-t)*(this.ymin-n)/(i-n),u=this.ymin):l&2?(u=n+(i-n)*(this.xmax-t)/(r-t),c=this.xmax):(u=n+(i-n)*(this.xmin-t)/(r-t),c=this.xmin),s?(t=c,n=u,s=this._regioncode(t,n)):(r=c,i=u,o=this._regioncode(r,i))}}_clipInfinite(t,n,r,i,s,o){let a=Array.from(n),c;if((c=this._project(a[0],a[1],r,i))&&a.unshift(c[0],c[1]),(c=this._project(a[a.length-2],a[a.length-1],s,o))&&a.push(c[0],c[1]),a=this._clipFinite(t,a))for(let u=0,l=a.length,h,f=this._edgecode(a[l-2],a[l-1]);u<l;u+=2)h=f,f=this._edgecode(a[u],a[u+1]),h&&f&&(u=this._edge(t,h,f,a,u),l=a.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(a=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return a}_edge(t,n,r,i,s){for(;n!==r;){let o,a;switch(n){case 5:n=4;continue;case 4:n=6,o=this.xmax,a=this.ymin;break;case 6:n=2;continue;case 2:n=10,o=this.xmax,a=this.ymax;break;case 10:n=8;continue;case 8:n=9,o=this.xmin,a=this.ymax;break;case 9:n=1;continue;case 1:n=5,o=this.xmin,a=this.ymin;break}(i[s]!==o||i[s+1]!==a)&&this.contains(t,o,a)&&(i.splice(s,0,o,a),s+=2)}return s}_project(t,n,r,i){let s=1/0,o,a,c;if(i<0){if(n<=this.ymin)return null;(o=(this.ymin-n)/i)<s&&(c=this.ymin,a=t+(s=o)*r)}else if(i>0){if(n>=this.ymax)return null;(o=(this.ymax-n)/i)<s&&(c=this.ymax,a=t+(s=o)*r)}if(r>0){if(t>=this.xmax)return null;(o=(this.xmax-t)/r)<s&&(a=this.xmax,c=n+(s=o)*i)}else if(r<0){if(t<=this.xmin)return null;(o=(this.xmin-t)/r)<s&&(a=this.xmin,c=n+(s=o)*i)}return[a,c]}_edgecode(t,n){return(t===this.xmin?1:t===this.xmax?2:0)|(n===this.ymin?4:n===this.ymax?8:0)}_regioncode(t,n){return(t<this.xmin?1:t>this.xmax?2:0)|(n<this.ymin?4:n>this.ymax?8:0)}_simplify(t){if(t&&t.length>4){for(let n=0;n<t.length;n+=2){const r=(n+2)%t.length,i=(n+4)%t.length;(t[n]===t[r]&&t[r]===t[i]||t[n+1]===t[r+1]&&t[r+1]===t[i+1])&&(t.splice(r,2),n-=2)}t.length||(t=null)}return t}};const oH=2*Math.PI,Oa=Math.pow;function aH(e){return e[0]}function cH(e){return e[1]}function uH(e){const{triangles:t,coords:n}=e;for(let r=0;r<t.length;r+=3){const i=2*t[r],s=2*t[r+1],o=2*t[r+2];if((n[o]-n[i])*(n[s+1]-n[i+1])-(n[s]-n[i])*(n[o+1]-n[i+1])>1e-10)return!1}return!0}function lH(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}class Ms{static from(t,n=aH,r=cH,i){return new Ms("length"in t?fH(t,n,r,i):Float64Array.from(hH(t,n,r,i)))}constructor(t){this._delaunator=new _d(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,n=this.points;if(t.hull&&t.hull.length>2&&uH(t)){this.collinear=Int32Array.from({length:n.length/2},(f,d)=>d).sort((f,d)=>n[2*f]-n[2*d]||n[2*f+1]-n[2*d+1]);const c=this.collinear[0],u=this.collinear[this.collinear.length-1],l=[n[2*c],n[2*c+1],n[2*u],n[2*u+1]],h=1e-8*Math.hypot(l[3]-l[1],l[2]-l[0]);for(let f=0,d=n.length/2;f<d;++f){const p=lH(n[2*f],n[2*f+1],h);n[2*f]=p[0],n[2*f+1]=p[1]}this._delaunator=new _d(n)}else delete this.collinear;const r=this.halfedges=this._delaunator.halfedges,i=this.hull=this._delaunator.hull,s=this.triangles=this._delaunator.triangles,o=this.inedges.fill(-1),a=this._hullIndex.fill(-1);for(let c=0,u=r.length;c<u;++c){const l=s[c%3===2?c-2:c+1];(r[c]===-1||o[l]===-1)&&(o[l]=c)}for(let c=0,u=i.length;c<u;++c)a[i[c]]=c;i.length<=2&&i.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=i[0],o[i[0]]=1,i.length===2&&(o[i[1]]=0,this.triangles[1]=i[1],this.triangles[2]=i[1]))}voronoi(t){return new sH(this,t)}*neighbors(t){const{inedges:n,hull:r,_hullIndex:i,halfedges:s,triangles:o,collinear:a}=this;if(a){const h=a.indexOf(t);h>0&&(yield a[h-1]),h<a.length-1&&(yield a[h+1]);return}const c=n[t];if(c===-1)return;let u=c,l=-1;do{if(yield l=o[u],u=u%3===2?u-2:u+1,o[u]!==t)return;if(u=s[u],u===-1){const h=r[(i[t]+1)%r.length];h!==l&&(yield h);return}}while(u!==c)}find(t,n,r=0){if(t=+t,t!==t||(n=+n,n!==n))return-1;const i=r;let s;for(;(s=this._step(r,t,n))>=0&&s!==r&&s!==i;)r=s;return s}_step(t,n,r){const{inedges:i,hull:s,_hullIndex:o,halfedges:a,triangles:c,points:u}=this;if(i[t]===-1||!u.length)return(t+1)%(u.length>>1);let l=t,h=Oa(n-u[t*2],2)+Oa(r-u[t*2+1],2);const f=i[t];let d=f;do{let p=c[d];const y=Oa(n-u[p*2],2)+Oa(r-u[p*2+1],2);if(y<h&&(h=y,l=p),d=d%3===2?d-2:d+1,c[d]!==t)break;if(d=a[d],d===-1){if(d=s[(o[t]+1)%s.length],d!==p&&Oa(n-u[d*2],2)+Oa(r-u[d*2+1],2)<h)return d;break}}while(d!==f);return l}render(t){const n=t==null?t=new vo:void 0,{points:r,halfedges:i,triangles:s}=this;for(let o=0,a=i.length;o<a;++o){const c=i[o];if(c<o)continue;const u=s[o]*2,l=s[c]*2;t.moveTo(r[u],r[u+1]),t.lineTo(r[l],r[l+1])}return this.renderHull(t),n&&n.value()}renderPoints(t,n){n===void 0&&(!t||typeof t.moveTo!="function")&&(n=t,t=null),n=n==null?2:+n;const r=t==null?t=new vo:void 0,{points:i}=this;for(let s=0,o=i.length;s<o;s+=2){const a=i[s],c=i[s+1];t.moveTo(a+n,c),t.arc(a,c,n,0,oH)}return r&&r.value()}renderHull(t){const n=t==null?t=new vo:void 0,{hull:r,points:i}=this,s=r[0]*2,o=r.length;t.moveTo(i[s],i[s+1]);for(let a=1;a<o;++a){const c=2*r[a];t.lineTo(i[c],i[c+1])}return t.closePath(),n&&n.value()}hullPolygon(){const t=new Cg;return this.renderHull(t),t.value()}renderTriangle(t,n){const r=n==null?n=new vo:void 0,{points:i,triangles:s}=this,o=s[t*=3]*2,a=s[t+1]*2,c=s[t+2]*2;return n.moveTo(i[o],i[o+1]),n.lineTo(i[a],i[a+1]),n.lineTo(i[c],i[c+1]),n.closePath(),r&&r.value()}*trianglePolygons(){const{triangles:t}=this;for(let n=0,r=t.length/3;n<r;++n)yield this.trianglePolygon(n)}trianglePolygon(t){const n=new Cg;return this.renderTriangle(t,n),n.value()}}function fH(e,t,n,r){const i=e.length,s=new Float64Array(i*2);for(let o=0;o<i;++o){const a=e[o];s[o*2]=t.call(r,a,o,e),s[o*2+1]=n.call(r,a,o,e)}return s}function*hH(e,t,n,r){let i=0;for(const s of e)yield t.call(r,s,i,e),yield n.call(r,s,i,e),++i}function dH(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function wd(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function Da(e){return e=wd(Math.abs(e)),e?e[1]:NaN}function pH(e,t){return function(n,r){for(var i=n.length,s=[],o=0,a=e[0],c=0;i>0&&a>0&&(c+a+1>r&&(a=Math.max(1,r-c)),s.push(n.substring(i-=a,i+a)),!((c+=a+1)>r));)a=e[o=(o+1)%e.length];return s.reverse().join(t)}}function yH(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var mH=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Ou(e){if(!(t=mH.exec(e)))throw new Error("invalid format: "+e);var t;return new kg({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Ou.prototype=kg.prototype;function kg(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}kg.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function gH(e){t:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+e[n])break t;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(i+1):e}var T8;function bH(e,t){var n=wd(e,t);if(!n)return e+"";var r=n[0],i=n[1],s=i-(T8=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=r.length;return s===o?r:s>o?r+new Array(s-o+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+wd(e,Math.max(0,t+s-1))[0]}function $8(e,t){var n=wd(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const N8={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:dH,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>$8(e*100,t),r:$8,s:bH,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function R8(e){return e}var O8=Array.prototype.map,D8=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function _H(e){var t=e.grouping===void 0||e.thousands===void 0?R8:pH(O8.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",s=e.numerals===void 0?R8:yH(O8.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",a=e.minus===void 0?"−":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function u(h){h=Ou(h);var f=h.fill,d=h.align,p=h.sign,y=h.symbol,g=h.zero,m=h.width,b=h.comma,w=h.precision,_=h.trim,x=h.type;x==="n"?(b=!0,x="g"):N8[x]||(w===void 0&&(w=12),_=!0,x="g"),(g||f==="0"&&d==="=")&&(g=!0,f="0",d="=");var v=y==="$"?n:y==="#"&&/[boxX]/.test(x)?"0"+x.toLowerCase():"",S=y==="$"?r:/[%p]/.test(x)?o:"",A=N8[x],M=/[defgprs%]/.test(x);w=w===void 0?6:/[gprs]/.test(x)?Math.max(1,Math.min(21,w)):Math.max(0,Math.min(20,w));function T(I){var R=v,L=S,E,$,N;if(x==="c")L=A(I)+L,I="";else{I=+I;var D=I<0||1/I<0;if(I=isNaN(I)?c:A(Math.abs(I),w),_&&(I=gH(I)),D&&+I==0&&p!=="+"&&(D=!1),R=(D?p==="("?p:a:p==="-"||p==="("?"":p)+R,L=(x==="s"?D8[8+T8/3]:"")+L+(D&&p==="("?")":""),M){for(E=-1,$=I.length;++E<$;)if(N=I.charCodeAt(E),48>N||N>57){L=(N===46?i+I.slice(E+1):I.slice(E))+L,I=I.slice(0,E);break}}}b&&!g&&(I=t(I,1/0));var k=R.length+I.length+L.length,C=k<m?new Array(m-k+1).join(f):"";switch(b&&g&&(I=t(C+I,C.length?m-L.length:1/0),C=""),d){case"<":I=R+I+L+C;break;case"=":I=R+C+I+L;break;case"^":I=C.slice(0,k=C.length>>1)+R+I+L+C.slice(k);break;default:I=C+R+I+L;break}return s(I)}return T.toString=function(){return h+""},T}function l(h,f){var d=u((h=Ou(h),h.type="f",h)),p=Math.max(-8,Math.min(8,Math.floor(Da(f)/3)))*3,y=Math.pow(10,-p),g=D8[8+p/3];return function(m){return d(y*m)+g}}return{format:u,formatPrefix:l}}var vd,La,L8;wH({thousands:",",grouping:[3],currency:["$",""]});function wH(e){return vd=_H(e),La=vd.format,L8=vd.formatPrefix,vd}function vH(e){return Math.max(0,-Da(Math.abs(e)))}function xH(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Da(t)/3)))*3-Da(Math.abs(e)))}function SH(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Da(t)-Da(e))+1}var pt=1e-6,xd=1e-12,Mt=Math.PI,_e=Mt/2,F8=Mt/4,Rn=Mt*2,ke=180/Mt,kt=Mt/180,Pt=Math.abs,Fa=Math.atan,br=Math.atan2,mt=Math.cos,Sd=Math.ceil,C8=Math.exp,Bg=Math.hypot,Ad=Math.log,Pg=Math.pow,et=Math.sin,Hn=Math.sign||function(e){return e>0?1:e<0?-1:0},on=Math.sqrt,Ug=Math.tan;function k8(e){return e>1?0:e<-1?Mt:Math.acos(e)}function wn(e){return e>1?_e:e<-1?-_e:Math.asin(e)}function On(){}function Id(e,t){e&&P8.hasOwnProperty(e.type)&&P8[e.type](e,t)}var B8={Feature:function(e,t){Id(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)Id(n[r].geometry,t)}},P8={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){zg(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)zg(n[r],t,0)},Polygon:function(e,t){U8(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)U8(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)Id(n[r],t)}};function zg(e,t,n){var r=-1,i=e.length-n,s;for(t.lineStart();++r<i;)s=e[r],t.point(s[0],s[1],s[2]);t.lineEnd()}function U8(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)zg(e[n],t,1);t.polygonEnd()}function Ts(e,t){e&&B8.hasOwnProperty(e.type)?B8[e.type](e,t):Id(e,t)}function qg(e){return[br(e[1],e[0]),wn(e[2])]}function Ca(e){var t=e[0],n=e[1],r=mt(n);return[r*mt(t),r*et(t),et(n)]}function Ed(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Md(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function jg(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function Td(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function Yg(e){var t=on(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var Du,$d,Nd,Rd,Od,Dd,Ld,Fd,Vg,Wg,Gg,z8,q8,an,cn,un,_r={sphere:On,point:Xg,lineStart:j8,lineEnd:Y8,polygonStart:function(){_r.lineStart=EH,_r.lineEnd=MH},polygonEnd:function(){_r.lineStart=j8,_r.lineEnd=Y8}};function Xg(e,t){e*=kt,t*=kt;var n=mt(t);Lu(n*mt(e),n*et(e),et(t))}function Lu(e,t,n){++Du,Nd+=(e-Nd)/Du,Rd+=(t-Rd)/Du,Od+=(n-Od)/Du}function j8(){_r.point=AH}function AH(e,t){e*=kt,t*=kt;var n=mt(t);an=n*mt(e),cn=n*et(e),un=et(t),_r.point=IH,Lu(an,cn,un)}function IH(e,t){e*=kt,t*=kt;var n=mt(t),r=n*mt(e),i=n*et(e),s=et(t),o=br(on((o=cn*s-un*i)*o+(o=un*r-an*s)*o+(o=an*i-cn*r)*o),an*r+cn*i+un*s);$d+=o,Dd+=o*(an+(an=r)),Ld+=o*(cn+(cn=i)),Fd+=o*(un+(un=s)),Lu(an,cn,un)}function Y8(){_r.point=Xg}function EH(){_r.point=TH}function MH(){V8(z8,q8),_r.point=Xg}function TH(e,t){z8=e,q8=t,e*=kt,t*=kt,_r.point=V8;var n=mt(t);an=n*mt(e),cn=n*et(e),un=et(t),Lu(an,cn,un)}function V8(e,t){e*=kt,t*=kt;var n=mt(t),r=n*mt(e),i=n*et(e),s=et(t),o=cn*s-un*i,a=un*r-an*s,c=an*i-cn*r,u=Bg(o,a,c),l=wn(u),h=u&&-l/u;Vg.add(h*o),Wg.add(h*a),Gg.add(h*c),$d+=l,Dd+=l*(an+(an=r)),Ld+=l*(cn+(cn=i)),Fd+=l*(un+(un=s)),Lu(an,cn,un)}function $H(e){Du=$d=Nd=Rd=Od=Dd=Ld=Fd=0,Vg=new qr,Wg=new qr,Gg=new qr,Ts(e,_r);var t=+Vg,n=+Wg,r=+Gg,i=Bg(t,n,r);return i<xd&&(t=Dd,n=Ld,r=Fd,$d<pt&&(t=Nd,n=Rd,r=Od),i=Bg(t,n,r),i<xd)?[NaN,NaN]:[br(n,t)*ke,wn(r/i)*ke]}function Hg(e,t){function n(r,i){return r=e(r,i),t(r[0],r[1])}return e.invert&&t.invert&&(n.invert=function(r,i){return r=t.invert(r,i),r&&e.invert(r[0],r[1])}),n}function Qg(e,t){return Pt(e)>Mt&&(e-=Math.round(e/Rn)*Rn),[e,t]}Qg.invert=Qg;function W8(e,t,n){return(e%=Rn)?t||n?Hg(X8(e),H8(t,n)):X8(e):t||n?H8(t,n):Qg}function G8(e){return function(t,n){return t+=e,Pt(t)>Mt&&(t-=Math.round(t/Rn)*Rn),[t,n]}}function X8(e){var t=G8(e);return t.invert=G8(-e),t}function H8(e,t){var n=mt(e),r=et(e),i=mt(t),s=et(t);function o(a,c){var u=mt(c),l=mt(a)*u,h=et(a)*u,f=et(c),d=f*n+l*r;return[br(h*i-d*s,l*n-f*r),wn(d*i+h*s)]}return o.invert=function(a,c){var u=mt(c),l=mt(a)*u,h=et(a)*u,f=et(c),d=f*i-h*s;return[br(h*i+f*s,l*n+d*r),wn(d*n-l*r)]},o}function NH(e){e=W8(e[0]*kt,e[1]*kt,e.length>2?e[2]*kt:0);function t(n){return n=e(n[0]*kt,n[1]*kt),n[0]*=ke,n[1]*=ke,n}return t.invert=function(n){return n=e.invert(n[0]*kt,n[1]*kt),n[0]*=ke,n[1]*=ke,n},t}function RH(e,t,n,r,i,s){if(n){var o=mt(t),a=et(t),c=r*n;i==null?(i=t+r*Rn,s=t-c/2):(i=Q8(o,i),s=Q8(o,s),(r>0?i<s:i>s)&&(i+=r*Rn));for(var u,l=i;r>0?l>s:l<s;l-=c)u=qg([o,-a*mt(l),-a*et(l)]),e.point(u[0],u[1])}}function Q8(e,t){t=Ca(t),t[0]-=e,Yg(t);var n=k8(-t[1]);return((-t[2]<0?-n:n)+Rn-pt)%Rn}function J8(){var e=[],t;return{point:function(n,r,i){t.push([n,r,i])},lineStart:function(){e.push(t=[])},lineEnd:On,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function Cd(e,t){return Pt(e[0]-t[0])<pt&&Pt(e[1]-t[1])<pt}function kd(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function K8(e,t,n,r,i){var s=[],o=[],a,c;if(e.forEach(function(p){if(!((y=p.length-1)<=0)){var y,g=p[0],m=p[y],b;if(Cd(g,m)){if(!g[2]&&!m[2]){for(i.lineStart(),a=0;a<y;++a)i.point((g=p[a])[0],g[1]);i.lineEnd();return}m[0]+=2*pt}s.push(b=new kd(g,p,null,!0)),o.push(b.o=new kd(g,null,b,!1)),s.push(b=new kd(m,p,null,!1)),o.push(b.o=new kd(m,null,b,!0))}}),!!s.length){for(o.sort(t),Z8(s),Z8(o),a=0,c=o.length;a<c;++a)o[a].e=n=!n;for(var u=s[0],l,h;;){for(var f=u,d=!0;f.v;)if((f=f.n)===u)return;l=f.z,i.lineStart();do{if(f.v=f.o.v=!0,f.e){if(d)for(a=0,c=l.length;a<c;++a)i.point((h=l[a])[0],h[1]);else r(f.x,f.n.x,1,i);f=f.n}else{if(d)for(l=f.p.z,a=l.length-1;a>=0;--a)i.point((h=l[a])[0],h[1]);else r(f.x,f.p.x,-1,i);f=f.p}f=f.o,l=f.z,d=!d}while(!f.v);i.lineEnd()}}}function Z8(e){if(t=e.length){for(var t,n=0,r=e[0],i;++n<t;)r.n=i=e[n],i.p=r,r=i;r.n=i=e[0],i.p=r}}function Jg(e){return Pt(e[0])<=Mt?e[0]:Hn(e[0])*((Pt(e[0])+Mt)%Rn-Mt)}function OH(e,t){var n=Jg(t),r=t[1],i=et(r),s=[et(n),-mt(n),0],o=0,a=0,c=new qr;i===1?r=_e+pt:i===-1&&(r=-_e-pt);for(var u=0,l=e.length;u<l;++u)if(f=(h=e[u]).length)for(var h,f,d=h[f-1],p=Jg(d),y=d[1]/2+F8,g=et(y),m=mt(y),b=0;b<f;++b,p=_,g=v,m=S,d=w){var w=h[b],_=Jg(w),x=w[1]/2+F8,v=et(x),S=mt(x),A=_-p,M=A>=0?1:-1,T=M*A,I=T>Mt,R=g*v;if(c.add(br(R*M*et(T),m*S+R*mt(T))),o+=I?A+M*Rn:A,I^p>=n^_>=n){var L=Md(Ca(d),Ca(w));Yg(L);var E=Md(s,L);Yg(E);var $=(I^A>=0?-1:1)*wn(E[2]);(r>$||r===$&&(L[0]||L[1]))&&(a+=I^A>=0?1:-1)}}return(o<-pt||o<pt&&c<-xd)^a&1}function t$(e,t,n,r){return function(i){var s=t(i),o=J8(),a=t(o),c=!1,u,l,h,f={point:d,lineStart:y,lineEnd:g,polygonStart:function(){f.point=m,f.lineStart=b,f.lineEnd=w,l=[],u=[]},polygonEnd:function(){f.point=d,f.lineStart=y,f.lineEnd=g,l=l4(l);var _=OH(u,r);l.length?(c||(i.polygonStart(),c=!0),K8(l,LH,_,n,i)):_&&(c||(i.polygonStart(),c=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),c&&(i.polygonEnd(),c=!1),l=u=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function d(_,x){e(_,x)&&i.point(_,x)}function p(_,x){s.point(_,x)}function y(){f.point=p,s.lineStart()}function g(){f.point=d,s.lineEnd()}function m(_,x){h.push([_,x]),a.point(_,x)}function b(){a.lineStart(),h=[]}function w(){m(h[0][0],h[0][1]),a.lineEnd();var _=a.clean(),x=o.result(),v,S=x.length,A,M,T;if(h.pop(),u.push(h),h=null,!!S){if(_&1){if(M=x[0],(A=M.length-1)>0){for(c||(i.polygonStart(),c=!0),i.lineStart(),v=0;v<A;++v)i.point((T=M[v])[0],T[1]);i.lineEnd()}return}S>1&&_&2&&x.push(x.pop().concat(x.shift())),l.push(x.filter(DH))}}return f}}function DH(e){return e.length>1}function LH(e,t){return((e=e.x)[0]<0?e[1]-_e-pt:_e-e[1])-((t=t.x)[0]<0?t[1]-_e-pt:_e-t[1])}const e$=t$(function(){return!0},FH,kH,[-Mt,-_e]);function FH(e){var t=NaN,n=NaN,r=NaN,i;return{lineStart:function(){e.lineStart(),i=1},point:function(s,o){var a=s>0?Mt:-Mt,c=Pt(s-t);Pt(c-Mt)<pt?(e.point(t,n=(n+o)/2>0?_e:-_e),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(a,n),e.point(s,n),i=0):r!==a&&c>=Mt&&(Pt(t-r)<pt&&(t-=r*pt),Pt(s-a)<pt&&(s-=a*pt),n=CH(t,n,s,o),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(a,n),i=0),e.point(t=s,n=o),r=a},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-i}}}function CH(e,t,n,r){var i,s,o=et(e-n);return Pt(o)>pt?Fa((et(t)*(s=mt(r))*et(n)-et(r)*(i=mt(t))*et(e))/(i*s*o)):(t+r)/2}function kH(e,t,n,r){var i;if(e==null)i=n*_e,r.point(-Mt,i),r.point(0,i),r.point(Mt,i),r.point(Mt,0),r.point(Mt,-i),r.point(0,-i),r.point(-Mt,-i),r.point(-Mt,0),r.point(-Mt,i);else if(Pt(e[0]-t[0])>pt){var s=e[0]<t[0]?Mt:-Mt;i=n*s/2,r.point(-s,i),r.point(0,i),r.point(s,i)}else r.point(t[0],t[1])}function BH(e){var t=mt(e),n=2*kt,r=t>0,i=Pt(t)>pt;function s(l,h,f,d){RH(d,e,n,f,l,h)}function o(l,h){return mt(l)*mt(h)>t}function a(l){var h,f,d,p,y;return{lineStart:function(){p=d=!1,y=1},point:function(g,m){var b=[g,m],w,_=o(g,m),x=r?_?0:u(g,m):_?u(g+(g<0?Mt:-Mt),m):0;if(!h&&(p=d=_)&&l.lineStart(),_!==d&&(w=c(h,b),(!w||Cd(h,w)||Cd(b,w))&&(b[2]=1)),_!==d)y=0,_?(l.lineStart(),w=c(b,h),l.point(w[0],w[1])):(w=c(h,b),l.point(w[0],w[1],2),l.lineEnd()),h=w;else if(i&&h&&r^_){var v;!(x&f)&&(v=c(b,h,!0))&&(y=0,r?(l.lineStart(),l.point(v[0][0],v[0][1]),l.point(v[1][0],v[1][1]),l.lineEnd()):(l.point(v[1][0],v[1][1]),l.lineEnd(),l.lineStart(),l.point(v[0][0],v[0][1],3)))}_&&(!h||!Cd(h,b))&&l.point(b[0],b[1]),h=b,d=_,f=x},lineEnd:function(){d&&l.lineEnd(),h=null},clean:function(){return y|(p&&d)<<1}}}function c(l,h,f){var d=Ca(l),p=Ca(h),y=[1,0,0],g=Md(d,p),m=Ed(g,g),b=g[0],w=m-b*b;if(!w)return!f&&l;var _=t*m/w,x=-t*b/w,v=Md(y,g),S=Td(y,_),A=Td(g,x);jg(S,A);var M=v,T=Ed(S,M),I=Ed(M,M),R=T*T-I*(Ed(S,S)-1);if(!(R<0)){var L=on(R),E=Td(M,(-T-L)/I);if(jg(E,S),E=qg(E),!f)return E;var $=l[0],N=h[0],D=l[1],k=h[1],C;N<$&&(C=$,$=N,N=C);var B=N-$,P=Pt(B-Mt)<pt,q=P||B<pt;if(!P&&k<D&&(C=D,D=k,k=C),q?P?D+k>0^E[1]<(Pt(E[0]-$)<pt?D:k):D<=E[1]&&E[1]<=k:B>Mt^($<=E[0]&&E[0]<=N)){var V=Td(M,(-T+L)/I);return jg(V,S),[E,qg(V)]}}}function u(l,h){var f=r?e:Mt-e,d=0;return l<-f?d|=1:l>f&&(d|=2),h<-f?d|=4:h>f&&(d|=8),d}return t$(o,a,s,r?[0,-e]:[-Mt,e-Mt])}function PH(e,t,n,r,i,s){var o=e[0],a=e[1],c=t[0],u=t[1],l=0,h=1,f=c-o,d=u-a,p;if(p=n-o,!(!f&&p>0)){if(p/=f,f<0){if(p<l)return;p<h&&(h=p)}else if(f>0){if(p>h)return;p>l&&(l=p)}if(p=i-o,!(!f&&p<0)){if(p/=f,f<0){if(p>h)return;p>l&&(l=p)}else if(f>0){if(p<l)return;p<h&&(h=p)}if(p=r-a,!(!d&&p>0)){if(p/=d,d<0){if(p<l)return;p<h&&(h=p)}else if(d>0){if(p>h)return;p>l&&(l=p)}if(p=s-a,!(!d&&p<0)){if(p/=d,d<0){if(p>h)return;p>l&&(l=p)}else if(d>0){if(p<l)return;p<h&&(h=p)}return l>0&&(e[0]=o+l*f,e[1]=a+l*d),h<1&&(t[0]=o+h*f,t[1]=a+h*d),!0}}}}}var Fu=1e9,Bd=-Fu;function n$(e,t,n,r){function i(u,l){return e<=u&&u<=n&&t<=l&&l<=r}function s(u,l,h,f){var d=0,p=0;if(u==null||(d=o(u,h))!==(p=o(l,h))||c(u,l)<0^h>0)do f.point(d===0||d===3?e:n,d>1?r:t);while((d=(d+h+4)%4)!==p);else f.point(l[0],l[1])}function o(u,l){return Pt(u[0]-e)<pt?l>0?0:3:Pt(u[0]-n)<pt?l>0?2:1:Pt(u[1]-t)<pt?l>0?1:0:l>0?3:2}function a(u,l){return c(u.x,l.x)}function c(u,l){var h=o(u,1),f=o(l,1);return h!==f?h-f:h===0?l[1]-u[1]:h===1?u[0]-l[0]:h===2?u[1]-l[1]:l[0]-u[0]}return function(u){var l=u,h=J8(),f,d,p,y,g,m,b,w,_,x,v,S={point:A,lineStart:R,lineEnd:L,polygonStart:T,polygonEnd:I};function A($,N){i($,N)&&l.point($,N)}function M(){for(var $=0,N=0,D=d.length;N<D;++N)for(var k=d[N],C=1,B=k.length,P=k[0],q,V,G=P[0],Q=P[1];C<B;++C)q=G,V=Q,P=k[C],G=P[0],Q=P[1],V<=r?Q>r&&(G-q)*(r-V)>(Q-V)*(e-q)&&++$:Q<=r&&(G-q)*(r-V)<(Q-V)*(e-q)&&--$;return $}function T(){l=h,f=[],d=[],v=!0}function I(){var $=M(),N=v&&$,D=(f=l4(f)).length;(N||D)&&(u.polygonStart(),N&&(u.lineStart(),s(null,null,1,u),u.lineEnd()),D&&K8(f,a,$,s,u),u.polygonEnd()),l=u,f=d=p=null}function R(){S.point=E,d&&d.push(p=[]),x=!0,_=!1,b=w=NaN}function L(){f&&(E(y,g),m&&_&&h.rejoin(),f.push(h.result())),S.point=A,_&&l.lineEnd()}function E($,N){var D=i($,N);if(d&&p.push([$,N]),x)y=$,g=N,m=D,x=!1,D&&(l.lineStart(),l.point($,N));else if(D&&_)l.point($,N);else{var k=[b=Math.max(Bd,Math.min(Fu,b)),w=Math.max(Bd,Math.min(Fu,w))],C=[$=Math.max(Bd,Math.min(Fu,$)),N=Math.max(Bd,Math.min(Fu,N))];PH(k,C,e,t,n,r)?(_||(l.lineStart(),l.point(k[0],k[1])),l.point(C[0],C[1]),D||l.lineEnd(),v=!1):D&&(l.lineStart(),l.point($,N),v=!1)}b=$,w=N,_=D}return S}}function r$(e,t,n){var r=Tn(e,t-pt,n).concat(t);return function(i){return r.map(function(s){return[i,s]})}}function i$(e,t,n){var r=Tn(e,t-pt,n).concat(t);return function(i){return r.map(function(s){return[s,i]})}}function UH(){var e,t,n,r,i,s,o,a,c=10,u=c,l=90,h=360,f,d,p,y,g=2.5;function m(){return{type:"MultiLineString",coordinates:b()}}function b(){return Tn(Sd(r/l)*l,n,l).map(p).concat(Tn(Sd(a/h)*h,o,h).map(y)).concat(Tn(Sd(t/c)*c,e,c).filter(function(w){return Pt(w%l)>pt}).map(f)).concat(Tn(Sd(s/u)*u,i,u).filter(function(w){return Pt(w%h)>pt}).map(d))}return m.lines=function(){return b().map(function(w){return{type:"LineString",coordinates:w}})},m.outline=function(){return{type:"Polygon",coordinates:[p(r).concat(y(o).slice(1),p(n).reverse().slice(1),y(a).reverse().slice(1))]}},m.extent=function(w){return arguments.length?m.extentMajor(w).extentMinor(w):m.extentMinor()},m.extentMajor=function(w){return arguments.length?(r=+w[0][0],n=+w[1][0],a=+w[0][1],o=+w[1][1],r>n&&(w=r,r=n,n=w),a>o&&(w=a,a=o,o=w),m.precision(g)):[[r,a],[n,o]]},m.extentMinor=function(w){return arguments.length?(t=+w[0][0],e=+w[1][0],s=+w[0][1],i=+w[1][1],t>e&&(w=t,t=e,e=w),s>i&&(w=s,s=i,i=w),m.precision(g)):[[t,s],[e,i]]},m.step=function(w){return arguments.length?m.stepMajor(w).stepMinor(w):m.stepMinor()},m.stepMajor=function(w){return arguments.length?(l=+w[0],h=+w[1],m):[l,h]},m.stepMinor=function(w){return arguments.length?(c=+w[0],u=+w[1],m):[c,u]},m.precision=function(w){return arguments.length?(g=+w,f=r$(s,i,90),d=i$(t,e,g),p=r$(a,o,90),y=i$(r,n,g),m):g},m.extentMajor([[-180,-90+pt],[180,90-pt]]).extentMinor([[-180,-80-pt],[180,80+pt]])}function zH(){return UH()()}const Kg=e=>e;var Zg=new qr,t1=new qr,s$,o$,e1,n1,Oi={point:On,lineStart:On,lineEnd:On,polygonStart:function(){Oi.lineStart=qH,Oi.lineEnd=YH},polygonEnd:function(){Oi.lineStart=Oi.lineEnd=Oi.point=On,Zg.add(Pt(t1)),t1=new qr},result:function(){var e=Zg/2;return Zg=new qr,e}};function qH(){Oi.point=jH}function jH(e,t){Oi.point=a$,s$=e1=e,o$=n1=t}function a$(e,t){t1.add(n1*e-e1*t),e1=e,n1=t}function YH(){a$(s$,o$)}var ka=1/0,Pd=ka,Cu=-ka,Ud=Cu,zd={point:VH,lineStart:On,lineEnd:On,polygonStart:On,polygonEnd:On,result:function(){var e=[[ka,Pd],[Cu,Ud]];return Cu=Ud=-(Pd=ka=1/0),e}};function VH(e,t){e<ka&&(ka=e),e>Cu&&(Cu=e),t<Pd&&(Pd=t),t>Ud&&(Ud=t)}var r1=0,i1=0,ku=0,qd=0,jd=0,Ba=0,s1=0,o1=0,Bu=0,c$,u$,Gr,Xr,Qn={point:xo,lineStart:l$,lineEnd:f$,polygonStart:function(){Qn.lineStart=XH,Qn.lineEnd=HH},polygonEnd:function(){Qn.point=xo,Qn.lineStart=l$,Qn.lineEnd=f$},result:function(){var e=Bu?[s1/Bu,o1/Bu]:Ba?[qd/Ba,jd/Ba]:ku?[r1/ku,i1/ku]:[NaN,NaN];return r1=i1=ku=qd=jd=Ba=s1=o1=Bu=0,e}};function xo(e,t){r1+=e,i1+=t,++ku}function l$(){Qn.point=WH}function WH(e,t){Qn.point=GH,xo(Gr=e,Xr=t)}function GH(e,t){var n=e-Gr,r=t-Xr,i=on(n*n+r*r);qd+=i*(Gr+e)/2,jd+=i*(Xr+t)/2,Ba+=i,xo(Gr=e,Xr=t)}function f$(){Qn.point=xo}function XH(){Qn.point=QH}function HH(){h$(c$,u$)}function QH(e,t){Qn.point=h$,xo(c$=Gr=e,u$=Xr=t)}function h$(e,t){var n=e-Gr,r=t-Xr,i=on(n*n+r*r);qd+=i*(Gr+e)/2,jd+=i*(Xr+t)/2,Ba+=i,i=Xr*e-Gr*t,s1+=i*(Gr+e),o1+=i*(Xr+t),Bu+=i*3,xo(Gr=e,Xr=t)}function d$(e){this._context=e}d$.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,Rn);break}}},result:On};var a1=new qr,c1,p$,y$,Pu,Uu,zu={point:On,lineStart:function(){zu.point=JH},lineEnd:function(){c1&&m$(p$,y$),zu.point=On},polygonStart:function(){c1=!0},polygonEnd:function(){c1=null},result:function(){var e=+a1;return a1=new qr,e}};function JH(e,t){zu.point=m$,p$=Pu=e,y$=Uu=t}function m$(e,t){Pu-=e,Uu-=t,a1.add(on(Pu*Pu+Uu*Uu)),Pu=e,Uu=t}let g$,Yd,b$,_$;class w${constructor(t){this._append=t==null?v$:KH(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,n){switch(this._point){case 0:{this._append`M${t},${n}`,this._point=1;break}case 1:{this._append`L${t},${n}`;break}default:{if(this._append`M${t},${n}`,this._radius!==b$||this._append!==Yd){const r=this._radius,i=this._;this._="",this._append`m0,${r}a${r},${r} 0 1,1 0,${-2*r}a${r},${r} 0 1,1 0,${2*r}z`,b$=r,Yd=this._append,_$=this._,this._=i}this._+=_$;break}}}result(){const t=this._;return this._="",t.length?t:null}}function v$(e){let t=1;this._+=e[0];for(const n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function KH(e){const t=Math.floor(e);if(!(t>=0))throw new RangeError(`invalid digits: ${e}`);if(t>15)return v$;if(t!==g$){const n=10**t;g$=t,Yd=function(i){let s=1;this._+=i[0];for(const o=i.length;s<o;++s)this._+=Math.round(arguments[s]*n)/n+i[s]}}return Yd}function qu(e,t){let n=3,r=4.5,i,s;function o(a){return a&&(typeof r=="function"&&s.pointRadius(+r.apply(this,arguments)),Ts(a,i(s))),s.result()}return o.area=function(a){return Ts(a,i(Oi)),Oi.result()},o.measure=function(a){return Ts(a,i(zu)),zu.result()},o.bounds=function(a){return Ts(a,i(zd)),zd.result()},o.centroid=function(a){return Ts(a,i(Qn)),Qn.result()},o.projection=function(a){return arguments.length?(i=a==null?(e=null,Kg):(e=a).stream,o):e},o.context=function(a){return arguments.length?(s=a==null?(t=null,new w$(n)):new d$(t=a),typeof r!="function"&&s.pointRadius(r),o):t},o.pointRadius=function(a){return arguments.length?(r=typeof a=="function"?a:(s.pointRadius(+a),+a),o):r},o.digits=function(a){if(!arguments.length)return n;if(a==null)n=null;else{const c=Math.floor(a);if(!(c>=0))throw new RangeError(`invalid digits: ${a}`);n=c}return t===null&&(s=new w$(n)),o},o.projection(e).digits(n).context(t)}function Vd(e){return{stream:Wd(e)}}function Wd(e){return function(t){var n=new u1;for(var r in e)n[r]=e[r];return n.stream=t,n}}function u1(){}u1.prototype={constructor:u1,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function l1(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),r!=null&&e.clipExtent(null),Ts(n,e.stream(zd)),t(zd.result()),r!=null&&e.clipExtent(r),e}function f1(e,t,n){return l1(e,function(r){var i=t[1][0]-t[0][0],s=t[1][1]-t[0][1],o=Math.min(i/(r[1][0]-r[0][0]),s/(r[1][1]-r[0][1])),a=+t[0][0]+(i-o*(r[1][0]+r[0][0]))/2,c=+t[0][1]+(s-o*(r[1][1]+r[0][1]))/2;e.scale(150*o).translate([a,c])},n)}function x$(e,t,n){return f1(e,[[0,0],t],n)}function S$(e,t,n){return l1(e,function(r){var i=+t,s=i/(r[1][0]-r[0][0]),o=(i-s*(r[1][0]+r[0][0]))/2,a=-s*r[0][1];e.scale(150*s).translate([o,a])},n)}function A$(e,t,n){return l1(e,function(r){var i=+t,s=i/(r[1][1]-r[0][1]),o=-s*r[0][0],a=(i-s*(r[1][1]+r[0][1]))/2;e.scale(150*s).translate([o,a])},n)}var I$=16,ZH=mt(30*kt);function E$(e,t){return+t?eQ(e,t):tQ(e)}function tQ(e){return Wd({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function eQ(e,t){function n(r,i,s,o,a,c,u,l,h,f,d,p,y,g){var m=u-r,b=l-i,w=m*m+b*b;if(w>4*t&&y--){var _=o+f,x=a+d,v=c+p,S=on(_*_+x*x+v*v),A=wn(v/=S),M=Pt(Pt(v)-1)<pt||Pt(s-h)<pt?(s+h)/2:br(x,_),T=e(M,A),I=T[0],R=T[1],L=I-r,E=R-i,$=b*L-m*E;($*$/w>t||Pt((m*L+b*E)/w-.5)>.3||o*f+a*d+c*p<ZH)&&(n(r,i,s,o,a,c,I,R,M,_/=S,x/=S,v,y,g),g.point(I,R),n(I,R,M,_,x,v,u,l,h,f,d,p,y,g))}}return function(r){var i,s,o,a,c,u,l,h,f,d,p,y,g={point:m,lineStart:b,lineEnd:_,polygonStart:function(){r.polygonStart(),g.lineStart=x},polygonEnd:function(){r.polygonEnd(),g.lineStart=b}};function m(A,M){A=e(A,M),r.point(A[0],A[1])}function b(){h=NaN,g.point=w,r.lineStart()}function w(A,M){var T=Ca([A,M]),I=e(A,M);n(h,f,l,d,p,y,h=I[0],f=I[1],l=A,d=T[0],p=T[1],y=T[2],I$,r),r.point(h,f)}function _(){g.point=m,r.lineEnd()}function x(){b(),g.point=v,g.lineEnd=S}function v(A,M){w(i=A,M),s=h,o=f,a=d,c=p,u=y,g.point=w}function S(){n(h,f,l,d,p,y,s,o,i,a,c,u,I$,r),g.lineEnd=_,_()}return g}}var nQ=Wd({point:function(e,t){this.stream.point(e*kt,t*kt)}});function rQ(e){return Wd({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}function iQ(e,t,n,r,i){function s(o,a){return o*=r,a*=i,[t+e*o,n-e*a]}return s.invert=function(o,a){return[(o-t)/e*r,(n-a)/e*i]},s}function M$(e,t,n,r,i,s){if(!s)return iQ(e,t,n,r,i);var o=mt(s),a=et(s),c=o*e,u=a*e,l=o/e,h=a/e,f=(a*n-o*t)/e,d=(a*t+o*n)/e;function p(y,g){return y*=r,g*=i,[c*y-u*g+t,n-u*y-c*g]}return p.invert=function(y,g){return[r*(l*y-h*g+f),i*(d-h*y-l*g)]},p}function $s(e){return T$(function(){return e})()}function T$(e){var t,n=150,r=480,i=250,s=0,o=0,a=0,c=0,u=0,l,h=0,f=1,d=1,p=null,y=e$,g=null,m,b,w,_=Kg,x=.5,v,S,A,M,T;function I($){return A($[0]*kt,$[1]*kt)}function R($){return $=A.invert($[0],$[1]),$&&[$[0]*ke,$[1]*ke]}I.stream=function($){return M&&T===$?M:M=nQ(rQ(l)(y(v(_(T=$)))))},I.preclip=function($){return arguments.length?(y=$,p=void 0,E()):y},I.postclip=function($){return arguments.length?(_=$,g=m=b=w=null,E()):_},I.clipAngle=function($){return arguments.length?(y=+$?BH(p=$*kt):(p=null,e$),E()):p*ke},I.clipExtent=function($){return arguments.length?(_=$==null?(g=m=b=w=null,Kg):n$(g=+$[0][0],m=+$[0][1],b=+$[1][0],w=+$[1][1]),E()):g==null?null:[[g,m],[b,w]]},I.scale=function($){return arguments.length?(n=+$,L()):n},I.translate=function($){return arguments.length?(r=+$[0],i=+$[1],L()):[r,i]},I.center=function($){return arguments.length?(s=$[0]%360*kt,o=$[1]%360*kt,L()):[s*ke,o*ke]},I.rotate=function($){return arguments.length?(a=$[0]%360*kt,c=$[1]%360*kt,u=$.length>2?$[2]%360*kt:0,L()):[a*ke,c*ke,u*ke]},I.angle=function($){return arguments.length?(h=$%360*kt,L()):h*ke},I.reflectX=function($){return arguments.length?(f=$?-1:1,L()):f<0},I.reflectY=function($){return arguments.length?(d=$?-1:1,L()):d<0},I.precision=function($){return arguments.length?(v=E$(S,x=$*$),E()):on(x)},I.fitExtent=function($,N){return f1(I,$,N)},I.fitSize=function($,N){return x$(I,$,N)},I.fitWidth=function($,N){return S$(I,$,N)},I.fitHeight=function($,N){return A$(I,$,N)};function L(){var $=M$(n,0,0,f,d,h).apply(null,t(s,o)),N=M$(n,r-$[0],i-$[1],f,d,h);return l=W8(a,c,u),S=Hg(t,N),A=Hg(l,S),v=E$(S,x),E()}function E(){return M=T=null,I}return function(){return t=e.apply(this,arguments),I.invert=t.invert&&R,L()}}function h1(e){var t=0,n=Mt/3,r=T$(e),i=r(t,n);return i.parallels=function(s){return arguments.length?r(t=s[0]*kt,n=s[1]*kt):[t*ke,n*ke]},i}function sQ(e){var t=mt(e);function n(r,i){return[r*t,et(i)/t]}return n.invert=function(r,i){return[r/t,wn(i*t)]},n}function oQ(e,t){var n=et(e),r=(n+et(t))/2;if(Pt(r)<pt)return sQ(e);var i=1+n*(2*r-n),s=on(i)/r;function o(a,c){var u=on(i-2*r*et(c))/r;return[u*et(a*=r),s-u*mt(a)]}return o.invert=function(a,c){var u=s-c,l=br(a,Pt(u))*Hn(u);return u*r<0&&(l-=Mt*Hn(a)*Hn(u)),[l/r,wn((i-(a*a+u*u)*r*r)/(2*r))]},o}function Gd(){return h1(oQ).scale(155.424).center([0,33.6442])}function $$(){return Gd().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function aQ(e){var t=e.length;return{point:function(n,r){for(var i=-1;++i<t;)e[i].point(n,r)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}function cQ(){var e,t,n=$$(),r,i=Gd().rotate([154,0]).center([-2,58.5]).parallels([55,65]),s,o=Gd().rotate([157,0]).center([-3,19.9]).parallels([8,18]),a,c,u={point:function(f,d){c=[f,d]}};function l(f){var d=f[0],p=f[1];return c=null,r.point(d,p),c||(s.point(d,p),c)||(a.point(d,p),c)}l.invert=function(f){var d=n.scale(),p=n.translate(),y=(f[0]-p[0])/d,g=(f[1]-p[1])/d;return(g>=.12&&g<.234&&y>=-.425&&y<-.214?i:g>=.166&&g<.234&&y>=-.214&&y<-.115?o:n).invert(f)},l.stream=function(f){return e&&t===f?e:e=aQ([n.stream(t=f),i.stream(f),o.stream(f)])},l.precision=function(f){return arguments.length?(n.precision(f),i.precision(f),o.precision(f),h()):n.precision()},l.scale=function(f){return arguments.length?(n.scale(f),i.scale(f*.35),o.scale(f),l.translate(n.translate())):n.scale()},l.translate=function(f){if(!arguments.length)return n.translate();var d=n.scale(),p=+f[0],y=+f[1];return r=n.translate(f).clipExtent([[p-.455*d,y-.238*d],[p+.455*d,y+.238*d]]).stream(u),s=i.translate([p-.307*d,y+.201*d]).clipExtent([[p-.425*d+pt,y+.12*d+pt],[p-.214*d-pt,y+.234*d-pt]]).stream(u),a=o.translate([p-.205*d,y+.212*d]).clipExtent([[p-.214*d+pt,y+.166*d+pt],[p-.115*d-pt,y+.234*d-pt]]).stream(u),h()},l.fitExtent=function(f,d){return f1(l,f,d)},l.fitSize=function(f,d){return x$(l,f,d)},l.fitWidth=function(f,d){return S$(l,f,d)},l.fitHeight=function(f,d){return A$(l,f,d)};function h(){return e=t=null,l}return l.scale(1070)}function N$(e){return function(t,n){var r=mt(t),i=mt(n),s=e(r*i);return s===1/0?[2,0]:[s*i*et(t),s*et(n)]}}function ju(e){return function(t,n){var r=on(t*t+n*n),i=e(r),s=et(i),o=mt(i);return[br(t*s,r*o),wn(r&&n*s/r)]}}var R$=N$(function(e){return on(2/(1+e))});R$.invert=ju(function(e){return 2*wn(e/2)});function uQ(){return $s(R$).scale(124.75).clipAngle(179.999)}var O$=N$(function(e){return(e=k8(e))&&e/et(e)});O$.invert=ju(function(e){return e});function lQ(){return $s(O$).scale(79.4188).clipAngle(179.999)}function Xd(e,t){return[e,Ad(Ug((_e+t)/2))]}Xd.invert=function(e,t){return[e,2*Fa(C8(t))-_e]};function fQ(){return D$(Xd).scale(961/Rn)}function D$(e){var t=$s(e),n=t.center,r=t.scale,i=t.translate,s=t.clipExtent,o=null,a,c,u;t.scale=function(h){return arguments.length?(r(h),l()):r()},t.translate=function(h){return arguments.length?(i(h),l()):i()},t.center=function(h){return arguments.length?(n(h),l()):n()},t.clipExtent=function(h){return arguments.length?(h==null?o=a=c=u=null:(o=+h[0][0],a=+h[0][1],c=+h[1][0],u=+h[1][1]),l()):o==null?null:[[o,a],[c,u]]};function l(){var h=Mt*r(),f=t(NH(t.rotate()).invert([0,0]));return s(o==null?[[f[0]-h,f[1]-h],[f[0]+h,f[1]+h]]:e===Xd?[[Math.max(f[0]-h,o),a],[Math.min(f[0]+h,c),u]]:[[o,Math.max(f[1]-h,a)],[c,Math.min(f[1]+h,u)]])}return l()}function Hd(e){return Ug((_e+e)/2)}function hQ(e,t){var n=mt(e),r=e===t?et(e):Ad(n/mt(t))/Ad(Hd(t)/Hd(e)),i=n*Pg(Hd(e),r)/r;if(!r)return Xd;function s(o,a){i>0?a<-_e+pt&&(a=-_e+pt):a>_e-pt&&(a=_e-pt);var c=i/Pg(Hd(a),r);return[c*et(r*o),i-c*mt(r*o)]}return s.invert=function(o,a){var c=i-a,u=Hn(r)*on(o*o+c*c),l=br(o,Pt(c))*Hn(c);return c*r<0&&(l-=Mt*Hn(o)*Hn(c)),[l/r,2*Fa(Pg(i/u,1/r))-_e]},s}function dQ(){return h1(hQ).scale(109.5).parallels([30,30])}function Qd(e,t){return[e,t]}Qd.invert=Qd;function pQ(){return $s(Qd).scale(152.63)}function yQ(e,t){var n=mt(e),r=e===t?et(e):(n-mt(t))/(t-e),i=n/r+e;if(Pt(r)<pt)return Qd;function s(o,a){var c=i-a,u=r*o;return[c*et(u),i-c*mt(u)]}return s.invert=function(o,a){var c=i-a,u=br(o,Pt(c))*Hn(c);return c*r<0&&(u-=Mt*Hn(o)*Hn(c)),[u/r,i-Hn(r)*on(o*o+c*c)]},s}function mQ(){return h1(yQ).scale(131.154).center([0,13.9389])}var Yu=1.340264,Vu=-.081106,Wu=893e-6,Gu=.003796,Jd=on(3)/2,gQ=12;function L$(e,t){var n=wn(Jd*et(t)),r=n*n,i=r*r*r;return[e*mt(n)/(Jd*(Yu+3*Vu*r+i*(7*Wu+9*Gu*r))),n*(Yu+Vu*r+i*(Wu+Gu*r))]}L$.invert=function(e,t){for(var n=t,r=n*n,i=r*r*r,s=0,o,a,c;s<gQ&&(a=n*(Yu+Vu*r+i*(Wu+Gu*r))-t,c=Yu+3*Vu*r+i*(7*Wu+9*Gu*r),n-=o=a/c,r=n*n,i=r*r*r,!(Pt(o)<xd));++s);return[Jd*e*(Yu+3*Vu*r+i*(7*Wu+9*Gu*r))/mt(n),wn(et(n)/Jd)]};function bQ(){return $s(L$).scale(177.158)}function F$(e,t){var n=mt(t),r=mt(e)*n;return[n*et(e)/r,et(t)/r]}F$.invert=ju(Fa);function _Q(){return $s(F$).scale(144.049).clipAngle(60)}function C$(e,t){return[mt(t)*et(e),et(t)]}C$.invert=ju(wn);function wQ(){return $s(C$).scale(249.5).clipAngle(90+pt)}function k$(e,t){var n=mt(t),r=1+mt(e)*n;return[n*et(e)/r,et(t)/r]}k$.invert=ju(function(e){return 2*Fa(e)});function vQ(){return $s(k$).scale(250).clipAngle(142)}function B$(e,t){return[Ad(Ug((_e+t)/2)),-e]}B$.invert=function(e,t){return[-t,2*Fa(C8(e))-_e]};function xQ(){var e=D$(B$),t=e.center,n=e.rotate;return e.center=function(r){return arguments.length?t([-r[1],r[0]]):(r=t(),[r[1],-r[0]])},e.rotate=function(r){return arguments.length?n([r[0],r[1],r.length>2?r[2]+90:90]):(r=n(),[r[0],r[1],r[2]-90])},n([0,0,90]).scale(159.155)}function SQ(e,t){return e.parent===t.parent?1:2}function AQ(e){return e.reduce(IQ,0)/e.length}function IQ(e,t){return e+t.x}function EQ(e){return 1+e.reduce(MQ,0)}function MQ(e,t){return Math.max(e,t.y)}function TQ(e){for(var t;t=e.children;)e=t[0];return e}function $Q(e){for(var t;t=e.children;)e=t[t.length-1];return e}function P$(){var e=SQ,t=1,n=1,r=!1;function i(s){var o,a=0;s.eachAfter(function(f){var d=f.children;d?(f.x=AQ(d),f.y=EQ(d)):(f.x=o?a+=e(f,o):0,f.y=0,o=f)});var c=TQ(s),u=$Q(s),l=c.x-e(c,u)/2,h=u.x+e(u,c)/2;return s.eachAfter(r?function(f){f.x=(f.x-s.x)*t,f.y=(s.y-f.y)*n}:function(f){f.x=(f.x-l)/(h-l)*t,f.y=(1-(s.y?f.y/s.y:1))*n})}return i.separation=function(s){return arguments.length?(e=s,i):e},i.size=function(s){return arguments.length?(r=!1,t=+s[0],n=+s[1],i):r?null:[t,n]},i.nodeSize=function(s){return arguments.length?(r=!0,t=+s[0],n=+s[1],i):r?[t,n]:null},i}function NQ(e){var t=0,n=e.children,r=n&&n.length;if(!r)t=1;else for(;--r>=0;)t+=n[r].value;e.value=t}function RQ(){return this.eachAfter(NQ)}function OQ(e,t){let n=-1;for(const r of this)e.call(t,r,++n,this);return this}function DQ(e,t){for(var n=this,r=[n],i,s,o=-1;n=r.pop();)if(e.call(t,n,++o,this),i=n.children)for(s=i.length-1;s>=0;--s)r.push(i[s]);return this}function LQ(e,t){for(var n=this,r=[n],i=[],s,o,a,c=-1;n=r.pop();)if(i.push(n),s=n.children)for(o=0,a=s.length;o<a;++o)r.push(s[o]);for(;n=i.pop();)e.call(t,n,++c,this);return this}function FQ(e,t){let n=-1;for(const r of this)if(e.call(t,r,++n,this))return r}function CQ(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,r=t.children,i=r&&r.length;--i>=0;)n+=r[i].value;t.value=n})}function kQ(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function BQ(e){for(var t=this,n=PQ(t,e),r=[t];t!==n;)t=t.parent,r.push(t);for(var i=r.length;e!==n;)r.splice(i,0,e),e=e.parent;return r}function PQ(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),i=null;for(e=n.pop(),t=r.pop();e===t;)i=e,e=n.pop(),t=r.pop();return i}function UQ(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function zQ(){return Array.from(this)}function qQ(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function jQ(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t}function*YQ(){var e=this,t,n=[e],r,i,s;do for(t=n.reverse(),n=[];e=t.pop();)if(yield e,r=e.children)for(i=0,s=r.length;i<s;++i)n.push(r[i]);while(n.length)}function U$(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=GQ)):t===void 0&&(t=WQ);for(var n=new Pa(e),r,i=[n],s,o,a,c;r=i.pop();)if((o=t(r.data))&&(c=(o=Array.from(o)).length))for(r.children=o,a=c-1;a>=0;--a)i.push(s=o[a]=new Pa(o[a])),s.parent=r,s.depth=r.depth+1;return n.eachBefore(z$)}function VQ(){return U$(this).eachBefore(XQ)}function WQ(e){return e.children}function GQ(e){return Array.isArray(e)?e[1]:null}function XQ(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function z$(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function Pa(e){this.data=e,this.depth=this.height=0,this.parent=null}Pa.prototype=U$.prototype={constructor:Pa,count:RQ,each:OQ,eachAfter:LQ,eachBefore:DQ,find:FQ,sum:CQ,sort:kQ,path:BQ,ancestors:UQ,descendants:zQ,leaves:qQ,links:jQ,copy:VQ,[Symbol.iterator]:YQ};function d1(e){return e==null?null:HQ(e)}function HQ(e){if(typeof e!="function")throw new Error;return e}var QQ={depth:-1},q$={},p1={};function JQ(e){return e.id}function KQ(e){return e.parentId}function j$(){var e=JQ,t=KQ,n;function r(i){var s=Array.from(i),o=e,a=t,c,u,l,h,f,d,p,y,g=new Map;if(n!=null){const m=s.map((_,x)=>ZQ(n(_,x,i))),b=m.map(Y$),w=new Set(m).add("");for(const _ of b)w.has(_)||(w.add(_),m.push(_),b.push(Y$(_)),s.push(p1));o=(_,x)=>m[x],a=(_,x)=>b[x]}for(l=0,c=s.length;l<c;++l)u=s[l],d=s[l]=new Pa(u),(p=o(u,l,i))!=null&&(p+="")&&(y=d.id=p,g.set(y,g.has(y)?q$:d)),(p=a(u,l,i))!=null&&(p+="")&&(d.parent=p);for(l=0;l<c;++l)if(d=s[l],p=d.parent){if(f=g.get(p),!f)throw new Error("missing: "+p);if(f===q$)throw new Error("ambiguous: "+p);f.children?f.children.push(d):f.children=[d],d.parent=f}else{if(h)throw new Error("multiple roots");h=d}if(!h)throw new Error("no root");if(n!=null){for(;h.data===p1&&h.children.length===1;)h=h.children[0],--c;for(let m=s.length-1;m>=0&&(d=s[m],d.data===p1);--m)d.data=null}if(h.parent=QQ,h.eachBefore(function(m){m.depth=m.parent.depth+1,--c}).eachBefore(z$),h.parent=null,c>0)throw new Error("cycle");return h}return r.id=function(i){return arguments.length?(e=d1(i),r):e},r.parentId=function(i){return arguments.length?(t=d1(i),r):t},r.path=function(i){return arguments.length?(n=d1(i),r):n},r}function ZQ(e){e=`${e}`;let t=e.length;return y1(e,t-1)&&!y1(e,t-2)&&(e=e.slice(0,-1)),e[0]==="/"?e:`/${e}`}function Y$(e){let t=e.length;if(t<2)return"";for(;--t>1&&!y1(e,t););return e.slice(0,t)}function y1(e,t){if(e[t]==="/"){let n=0;for(;t>0&&e[--t]==="\\";)++n;if((n&1)===0)return!0}return!1}function tJ(e,t){return e.parent===t.parent?1:2}function m1(e){var t=e.children;return t?t[0]:e.t}function g1(e){var t=e.children;return t?t[t.length-1]:e.t}function eJ(e,t,n){var r=n/(t.i-e.i);t.c-=r,t.s+=n,e.c+=r,t.z+=n,t.m+=n}function nJ(e){for(var t=0,n=0,r=e.children,i=r.length,s;--i>=0;)s=r[i],s.z+=t,s.m+=t,t+=s.s+(n+=s.c)}function rJ(e,t,n){return e.a.parent===t.parent?e.a:n}function Kd(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}Kd.prototype=Object.create(Pa.prototype);function iJ(e){for(var t=new Kd(e,0),n,r=[t],i,s,o,a;n=r.pop();)if(s=n._.children)for(n.children=new Array(a=s.length),o=a-1;o>=0;--o)r.push(i=n.children[o]=new Kd(s[o],o)),i.parent=n;return(t.parent=new Kd(null,0)).children=[t],t}function Zd(){var e=tJ,t=1,n=1,r=null;function i(u){var l=iJ(u);if(l.eachAfter(s),l.parent.m=-l.z,l.eachBefore(o),r)u.eachBefore(c);else{var h=u,f=u,d=u;u.eachBefore(function(b){b.x<h.x&&(h=b),b.x>f.x&&(f=b),b.depth>d.depth&&(d=b)});var p=h===f?1:e(h,f)/2,y=p-h.x,g=t/(f.x+p+y),m=n/(d.depth||1);u.eachBefore(function(b){b.x=(b.x+y)*g,b.y=b.depth*m})}return u}function s(u){var l=u.children,h=u.parent.children,f=u.i?h[u.i-1]:null;if(l){nJ(u);var d=(l[0].z+l[l.length-1].z)/2;f?(u.z=f.z+e(u._,f._),u.m=u.z-d):u.z=d}else f&&(u.z=f.z+e(u._,f._));u.parent.A=a(u,f,u.parent.A||h[0])}function o(u){u._.x=u.z+u.parent.m,u.m+=u.parent.m}function a(u,l,h){if(l){for(var f=u,d=u,p=l,y=f.parent.children[0],g=f.m,m=d.m,b=p.m,w=y.m,_;p=g1(p),f=m1(f),p&&f;)y=m1(y),d=g1(d),d.a=u,_=p.z+b-f.z-g+e(p._,f._),_>0&&(eJ(rJ(p,u,h),u,_),g+=_,m+=_),b+=p.m,g+=f.m,w+=y.m,m+=d.m;p&&!g1(d)&&(d.t=p,d.m+=b-m),f&&!m1(y)&&(y.t=f,y.m+=g-w,h=u)}return h}function c(u){u.x*=t,u.y=u.depth*n}return i.separation=function(u){return arguments.length?(e=u,i):e},i.size=function(u){return arguments.length?(r=!1,t=+u[0],n=+u[1],i):r?null:[t,n]},i.nodeSize=function(u){return arguments.length?(r=!0,t=+u[0],n=+u[1],i):r?[t,n]:null},i}const sJ=1664525,oJ=1013904223,V$=1/4294967296;function b1(e=Math.random()){let t=(0<=e&&e<1?e/V$:Math.abs(e))|0;return()=>(t=sJ*t+oJ|0,V$*(t>>>0))}function Hr(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function tp(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const _1=Symbol("implicit");function w1(){var e=new fo,t=[],n=[],r=_1;function i(s){let o=e.get(s);if(o===void 0){if(r!==_1)return r;e.set(s,o=t.push(s)-1)}return n[o%n.length]}return i.domain=function(s){if(!arguments.length)return t.slice();t=[],e=new fo;for(const o of s)e.has(o)||e.set(o,t.push(o)-1);return i},i.range=function(s){return arguments.length?(n=Array.from(s),i):n.slice()},i.unknown=function(s){return arguments.length?(r=s,i):r},i.copy=function(){return w1(t,n).unknown(r)},Hr.apply(i,arguments),i}function ep(){var e=w1().unknown(void 0),t=e.domain,n=e.range,r=0,i=1,s,o,a=!1,c=0,u=0,l=.5;delete e.unknown;function h(){var f=t().length,d=i<r,p=d?i:r,y=d?r:i;s=(y-p)/Math.max(1,f-c+u*2),a&&(s=Math.floor(s)),p+=(y-p-s*(f-c))*l,o=s*(1-c),a&&(p=Math.round(p),o=Math.round(o));var g=Tn(f).map(function(m){return p+s*m});return n(d?g.reverse():g)}return e.domain=function(f){return arguments.length?(t(f),h()):t()},e.range=function(f){return arguments.length?([r,i]=f,r=+r,i=+i,h()):[r,i]},e.rangeRound=function(f){return[r,i]=f,r=+r,i=+i,a=!0,h()},e.bandwidth=function(){return o},e.step=function(){return s},e.round=function(f){return arguments.length?(a=!!f,h()):a},e.padding=function(f){return arguments.length?(c=Math.min(1,u=+f),h()):c},e.paddingInner=function(f){return arguments.length?(c=Math.min(1,f),h()):c},e.paddingOuter=function(f){return arguments.length?(u=+f,h()):u},e.align=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),h()):l},e.copy=function(){return ep(t(),[r,i]).round(a).paddingInner(c).paddingOuter(u).align(l)},Hr.apply(h(),arguments)}function W$(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return W$(t())},e}function aJ(){return W$(ep.apply(null,arguments).paddingInner(1))}function cJ(e){return function(){return e}}function v1(e){return+e}var G$=[0,1];function Jn(e){return e}function x1(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:cJ(isNaN(t)?NaN:.5)}function uJ(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function lJ(e,t,n){var r=e[0],i=e[1],s=t[0],o=t[1];return i<r?(r=x1(i,r),s=n(o,s)):(r=x1(r,i),s=n(s,o)),function(a){return s(r(a))}}function fJ(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),s=new Array(r),o=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<r;)i[o]=x1(e[o],e[o+1]),s[o]=n(t[o],t[o+1]);return function(a){var c=qh(e,a,1,r)-1;return s[c](i[c](a))}}function Xu(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function np(){var e=G$,t=G$,n=Ia,r,i,s,o=Jn,a,c,u;function l(){var f=Math.min(e.length,t.length);return o!==Jn&&(o=uJ(e[0],e[f-1])),a=f>2?fJ:lJ,c=u=null,h}function h(f){return f==null||isNaN(f=+f)?s:(c||(c=a(e.map(r),t,n)))(r(o(f)))}return h.invert=function(f){return o(i((u||(u=a(t,e.map(r),Xe)))(f)))},h.domain=function(f){return arguments.length?(e=Array.from(f,v1),l()):e.slice()},h.range=function(f){return arguments.length?(t=Array.from(f),l()):t.slice()},h.rangeRound=function(f){return t=Array.from(f),n=mg,l()},h.clamp=function(f){return arguments.length?(o=f?!0:Jn,l()):o!==Jn},h.interpolate=function(f){return arguments.length?(n=f,l()):n},h.unknown=function(f){return arguments.length?(s=f,h):s},function(f,d){return r=f,i=d,l()}}function X$(){return np()(Jn,Jn)}function hJ(e,t,n,r){var i=Xm(e,t,n),s;switch(r=Ou(r??",f"),r.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(s=xH(i,o))&&(r.precision=s),L8(r,o)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(s=SH(i,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=s-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(s=vH(i))&&(r.precision=s-(r.type==="%")*2);break}}return La(r)}function Hu(e){var t=e.domain;return e.ticks=function(n){var r=t();return xs(r[0],r[r.length-1],n??10)},e.tickFormat=function(n,r){var i=t();return hJ(i[0],i[i.length-1],n??10,r)},e.nice=function(n){n==null&&(n=10);var r=t(),i=0,s=r.length-1,o=r[i],a=r[s],c,u,l=10;for(a<o&&(u=o,o=a,a=u,u=i,i=s,s=u);l-- >0;){if(u=bu(o,a,n),u===c)return r[i]=o,r[s]=a,t(r);if(u>0)o=Math.floor(o/u)*u,a=Math.ceil(a/u)*u;else if(u<0)o=Math.ceil(o*u)/u,a=Math.floor(a*u)/u;else break;c=u}return e},e}function rp(){var e=X$();return e.copy=function(){return Xu(e,rp())},Hr.apply(e,arguments),Hu(e)}function H$(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,v1),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return H$(e).unknown(t)},e=arguments.length?Array.from(e,v1):[0,1],Hu(n)}function Q$(e,t){e=e.slice();var n=0,r=e.length-1,i=e[n],s=e[r],o;return s<i&&(o=n,n=r,r=o,o=i,i=s,s=o),e[n]=t.floor(i),e[r]=t.ceil(s),e}function J$(e){return Math.log(e)}function K$(e){return Math.exp(e)}function dJ(e){return-Math.log(-e)}function pJ(e){return-Math.exp(-e)}function yJ(e){return isFinite(e)?+("1e"+e):e<0?0:e}function mJ(e){return e===10?yJ:e===Math.E?Math.exp:t=>Math.pow(e,t)}function gJ(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function Z$(e){return(t,n)=>-e(-t,n)}function tN(e){const t=e(J$,K$),n=t.domain;let r=10,i,s;function o(){return i=gJ(r),s=mJ(r),n()[0]<0?(i=Z$(i),s=Z$(s),e(dJ,pJ)):e(J$,K$),t}return t.base=function(a){return arguments.length?(r=+a,o()):r},t.domain=function(a){return arguments.length?(n(a),o()):n()},t.ticks=a=>{const c=n();let u=c[0],l=c[c.length-1];const h=l<u;h&&([u,l]=[l,u]);let f=i(u),d=i(l),p,y;const g=a==null?10:+a;let m=[];if(!(r%1)&&d-f<g){if(f=Math.floor(f),d=Math.ceil(d),u>0){for(;f<=d;++f)for(p=1;p<r;++p)if(y=f<0?p/s(-f):p*s(f),!(y<u)){if(y>l)break;m.push(y)}}else for(;f<=d;++f)for(p=r-1;p>=1;--p)if(y=f>0?p/s(-f):p*s(f),!(y<u)){if(y>l)break;m.push(y)}m.length*2<g&&(m=xs(u,l,g))}else m=xs(f,d,Math.min(d-f,g)).map(s);return h?m.reverse():m},t.tickFormat=(a,c)=>{if(a==null&&(a=10),c==null&&(c=r===10?"s":","),typeof c!="function"&&(!(r%1)&&(c=Ou(c)).precision==null&&(c.trim=!0),c=La(c)),a===1/0)return c;const u=Math.max(1,r*a/t.ticks().length);return l=>{let h=l/s(Math.round(i(l)));return h*r<r-.5&&(h*=r),h<=u?c(l):""}},t.nice=()=>n(Q$(n(),{floor:a=>s(Math.floor(i(a))),ceil:a=>s(Math.ceil(i(a)))})),t}function eN(){const e=tN(np()).domain([1,10]);return e.copy=()=>Xu(e,eN()).base(e.base()),Hr.apply(e,arguments),e}function nN(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function rN(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function iN(e){var t=1,n=e(nN(t),rN(t));return n.constant=function(r){return arguments.length?e(nN(t=+r),rN(t)):t},Hu(n)}function sN(){var e=iN(np());return e.copy=function(){return Xu(e,sN()).constant(e.constant())},Hr.apply(e,arguments)}function oN(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function bJ(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function _J(e){return e<0?-e*e:e*e}function aN(e){var t=e(Jn,Jn),n=1;function r(){return n===1?e(Jn,Jn):n===.5?e(bJ,_J):e(oN(n),oN(1/n))}return t.exponent=function(i){return arguments.length?(n=+i,r()):n},Hu(t)}function cN(){var e=aN(np());return e.copy=function(){return Xu(e,cN()).exponent(e.exponent())},Hr.apply(e,arguments),e}function uN(){var e=[],t=[],n=[],r;function i(){var o=0,a=Math.max(1,t.length);for(n=new Array(a-1);++o<a;)n[o-1]=MY(e,o/a);return s}function s(o){return o==null||isNaN(o=+o)?r:t[qh(n,o)]}return s.invertExtent=function(o){var a=t.indexOf(o);return a<0?[NaN,NaN]:[a>0?n[a-1]:e[0],a<n.length?n[a]:e[e.length-1]]},s.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let a of o)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(qt),i()},s.range=function(o){return arguments.length?(t=Array.from(o),i()):t.slice()},s.unknown=function(o){return arguments.length?(r=o,s):r},s.quantiles=function(){return n.slice()},s.copy=function(){return uN().domain(e).range(t).unknown(r)},Hr.apply(s,arguments)}function lN(){var e=[.5],t=[0,1],n,r=1;function i(s){return s!=null&&s<=s?t[qh(e,s,0,r)]:n}return i.domain=function(s){return arguments.length?(e=Array.from(s),r=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(s){return arguments.length?(t=Array.from(s),r=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(s){var o=t.indexOf(s);return[e[o-1],e[o]]},i.unknown=function(s){return arguments.length?(n=s,i):n},i.copy=function(){return lN().domain(e).range(t).unknown(n)},Hr.apply(i,arguments)}const S1=new Date,A1=new Date;function Ne(e,t,n,r){function i(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=s=>(e(s=new Date(+s)),s),i.ceil=s=>(e(s=new Date(s-1)),t(s,1),e(s),s),i.round=s=>{const o=i(s),a=i.ceil(s);return s-o<a-s?o:a},i.offset=(s,o)=>(t(s=new Date(+s),o==null?1:Math.floor(o)),s),i.range=(s,o,a)=>{const c=[];if(s=i.ceil(s),a=a==null?1:Math.floor(a),!(s<o)||!(a>0))return c;let u;do c.push(u=new Date(+s)),t(s,a),e(s);while(u<s&&s<o);return c},i.filter=s=>Ne(o=>{if(o>=o)for(;e(o),!s(o);)o.setTime(o-1)},(o,a)=>{if(o>=o)if(a<0)for(;++a<=0;)for(;t(o,-1),!s(o););else for(;--a>=0;)for(;t(o,1),!s(o););}),n&&(i.count=(s,o)=>(S1.setTime(+s),A1.setTime(+o),e(S1),e(A1),Math.floor(n(S1,A1))),i.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(r?o=>r(o)%s===0:o=>i.count(0,o)%s===0):i)),i}const ip=Ne(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);ip.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Ne(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):ip),ip.range;const Di=1e3,Kn=Di*60,Li=Kn*60,Fi=Li*24,I1=Fi*7,fN=Fi*30,E1=Fi*365,wr=Ne(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Di)},(e,t)=>(t-e)/Di,e=>e.getUTCSeconds());wr.range;const Qu=Ne(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Di)},(e,t)=>{e.setTime(+e+t*Kn)},(e,t)=>(t-e)/Kn,e=>e.getMinutes());Qu.range;const Ju=Ne(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Kn)},(e,t)=>(t-e)/Kn,e=>e.getUTCMinutes());Ju.range;const Ku=Ne(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Di-e.getMinutes()*Kn)},(e,t)=>{e.setTime(+e+t*Li)},(e,t)=>(t-e)/Li,e=>e.getHours());Ku.range;const Zu=Ne(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Li)},(e,t)=>(t-e)/Li,e=>e.getUTCHours());Zu.range;const So=Ne(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Kn)/Fi,e=>e.getDate()-1);So.range;const sp=Ne(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Fi,e=>e.getUTCDate()-1);sp.range;const op=Ne(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Fi,e=>Math.floor(e/Fi));op.range;function Ao(e){return Ne(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Kn)/I1)}const Ua=Ao(0),tl=Ao(1),hN=Ao(2),dN=Ao(3),Io=Ao(4),pN=Ao(5),yN=Ao(6);Ua.range,tl.range,hN.range,dN.range,Io.range,pN.range,yN.range;function Eo(e){return Ne(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/I1)}const za=Eo(0),el=Eo(1),mN=Eo(2),gN=Eo(3),Mo=Eo(4),bN=Eo(5),_N=Eo(6);za.range,el.range,mN.range,gN.range,Mo.range,bN.range,_N.range;const nl=Ne(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());nl.range;const rl=Ne(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());rl.range;const vr=Ne(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());vr.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Ne(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)}),vr.range;const xr=Ne(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());xr.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Ne(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)}),xr.range;function wN(e,t,n,r,i,s){const o=[[wr,1,Di],[wr,5,5*Di],[wr,15,15*Di],[wr,30,30*Di],[s,1,Kn],[s,5,5*Kn],[s,15,15*Kn],[s,30,30*Kn],[i,1,Li],[i,3,3*Li],[i,6,6*Li],[i,12,12*Li],[r,1,Fi],[r,2,2*Fi],[n,1,I1],[t,1,fN],[t,3,3*fN],[e,1,E1]];function a(u,l,h){const f=l<u;f&&([u,l]=[l,u]);const d=h&&typeof h.range=="function"?h:c(u,l,h),p=d?d.range(u,+l+1):[];return f?p.reverse():p}function c(u,l,h){const f=Math.abs(l-u)/h,d=zh(([,,g])=>g).right(o,f);if(d===o.length)return e.every(Xm(u/E1,l/E1,h));if(d===0)return ip.every(Math.max(Xm(u,l,h),1));const[p,y]=o[f/o[d-1][2]<o[d][2]/f?d-1:d];return p.every(y)}return[a,c]}const[wJ,vN]=wN(xr,rl,za,op,Zu,Ju),[vJ,xJ]=wN(vr,nl,Ua,So,Ku,Qu);function M1(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function T1(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function il(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function SJ(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,s=e.days,o=e.shortDays,a=e.months,c=e.shortMonths,u=sl(i),l=ol(i),h=sl(s),f=ol(s),d=sl(o),p=ol(o),y=sl(a),g=ol(a),m=sl(c),b=ol(c),w={a:D,A:k,b:C,B,c:null,d:MN,e:MN,f:WJ,g:nK,G:iK,H:jJ,I:YJ,j:VJ,L:TN,m:GJ,M:XJ,p:P,q,Q:LN,s:FN,S:HJ,u:QJ,U:JJ,V:KJ,w:ZJ,W:tK,x:null,X:null,y:eK,Y:rK,Z:sK,"%":DN},_={a:V,A:G,b:Q,B:K,c:null,d:NN,e:NN,f:uK,g:_K,G:vK,H:oK,I:aK,j:cK,L:RN,m:lK,M:fK,p:Y,q:J,Q:LN,s:FN,S:hK,u:dK,U:pK,V:yK,w:mK,W:gK,x:null,X:null,y:bK,Y:wK,Z:xK,"%":DN},x={a:T,A:I,b:R,B:L,c:E,d:IN,e:IN,f:PJ,g:AN,G:SN,H:EN,I:EN,j:FJ,L:BJ,m:LJ,M:CJ,p:M,q:DJ,Q:zJ,s:qJ,S:kJ,u:TJ,U:$J,V:NJ,w:MJ,W:RJ,x:$,X:N,y:AN,Y:SN,Z:OJ,"%":UJ};w.x=v(n,w),w.X=v(r,w),w.c=v(t,w),_.x=v(n,_),_.X=v(r,_),_.c=v(t,_);function v(z,W){return function(H){var U=[],wt=-1,tt=0,$t=z.length,Ot,X,jt;for(H instanceof Date||(H=new Date(+H));++wt<$t;)z.charCodeAt(wt)===37&&(U.push(z.slice(tt,wt)),(X=xN[Ot=z.charAt(++wt)])!=null?Ot=z.charAt(++wt):X=Ot==="e"?" ":"0",(jt=W[Ot])&&(Ot=jt(H,X)),U.push(Ot),tt=wt+1);return U.push(z.slice(tt,wt)),U.join("")}}function S(z,W){return function(H){var U=il(1900,void 0,1),wt=A(U,z,H+="",0),tt,$t;if(wt!=H.length)return null;if("Q"in U)return new Date(U.Q);if("s"in U)return new Date(U.s*1e3+("L"in U?U.L:0));if(W&&!("Z"in U)&&(U.Z=0),"p"in U&&(U.H=U.H%12+U.p*12),U.m===void 0&&(U.m="q"in U?U.q:0),"V"in U){if(U.V<1||U.V>53)return null;"w"in U||(U.w=1),"Z"in U?(tt=T1(il(U.y,0,1)),$t=tt.getUTCDay(),tt=$t>4||$t===0?el.ceil(tt):el(tt),tt=sp.offset(tt,(U.V-1)*7),U.y=tt.getUTCFullYear(),U.m=tt.getUTCMonth(),U.d=tt.getUTCDate()+(U.w+6)%7):(tt=M1(il(U.y,0,1)),$t=tt.getDay(),tt=$t>4||$t===0?tl.ceil(tt):tl(tt),tt=So.offset(tt,(U.V-1)*7),U.y=tt.getFullYear(),U.m=tt.getMonth(),U.d=tt.getDate()+(U.w+6)%7)}else("W"in U||"U"in U)&&("w"in U||(U.w="u"in U?U.u%7:"W"in U?1:0),$t="Z"in U?T1(il(U.y,0,1)).getUTCDay():M1(il(U.y,0,1)).getDay(),U.m=0,U.d="W"in U?(U.w+6)%7+U.W*7-($t+5)%7:U.w+U.U*7-($t+6)%7);return"Z"in U?(U.H+=U.Z/100|0,U.M+=U.Z%100,T1(U)):M1(U)}}function A(z,W,H,U){for(var wt=0,tt=W.length,$t=H.length,Ot,X;wt<tt;){if(U>=$t)return-1;if(Ot=W.charCodeAt(wt++),Ot===37){if(Ot=W.charAt(wt++),X=x[Ot in xN?W.charAt(wt++):Ot],!X||(U=X(z,H,U))<0)return-1}else if(Ot!=H.charCodeAt(U++))return-1}return U}function M(z,W,H){var U=u.exec(W.slice(H));return U?(z.p=l.get(U[0].toLowerCase()),H+U[0].length):-1}function T(z,W,H){var U=d.exec(W.slice(H));return U?(z.w=p.get(U[0].toLowerCase()),H+U[0].length):-1}function I(z,W,H){var U=h.exec(W.slice(H));return U?(z.w=f.get(U[0].toLowerCase()),H+U[0].length):-1}function R(z,W,H){var U=m.exec(W.slice(H));return U?(z.m=b.get(U[0].toLowerCase()),H+U[0].length):-1}function L(z,W,H){var U=y.exec(W.slice(H));return U?(z.m=g.get(U[0].toLowerCase()),H+U[0].length):-1}function E(z,W,H){return A(z,t,W,H)}function $(z,W,H){return A(z,n,W,H)}function N(z,W,H){return A(z,r,W,H)}function D(z){return o[z.getDay()]}function k(z){return s[z.getDay()]}function C(z){return c[z.getMonth()]}function B(z){return a[z.getMonth()]}function P(z){return i[+(z.getHours()>=12)]}function q(z){return 1+~~(z.getMonth()/3)}function V(z){return o[z.getUTCDay()]}function G(z){return s[z.getUTCDay()]}function Q(z){return c[z.getUTCMonth()]}function K(z){return a[z.getUTCMonth()]}function Y(z){return i[+(z.getUTCHours()>=12)]}function J(z){return 1+~~(z.getUTCMonth()/3)}return{format:function(z){var W=v(z+="",w);return W.toString=function(){return z},W},parse:function(z){var W=S(z+="",!1);return W.toString=function(){return z},W},utcFormat:function(z){var W=v(z+="",_);return W.toString=function(){return z},W},utcParse:function(z){var W=S(z+="",!0);return W.toString=function(){return z},W}}}var xN={"-":"",_:" ",0:"0"},Le=/^\s*\d+/,AJ=/^%/,IJ=/[\\^$*+?|[\]().{}]/g;function Bt(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",s=i.length;return r+(s<n?new Array(n-s+1).join(t)+i:i)}function EJ(e){return e.replace(IJ,"\\$&")}function sl(e){return new RegExp("^(?:"+e.map(EJ).join("|")+")","i")}function ol(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function MJ(e,t,n){var r=Le.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function TJ(e,t,n){var r=Le.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function $J(e,t,n){var r=Le.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function NJ(e,t,n){var r=Le.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function RJ(e,t,n){var r=Le.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function SN(e,t,n){var r=Le.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function AN(e,t,n){var r=Le.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function OJ(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function DJ(e,t,n){var r=Le.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function LJ(e,t,n){var r=Le.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function IN(e,t,n){var r=Le.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function FJ(e,t,n){var r=Le.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function EN(e,t,n){var r=Le.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function CJ(e,t,n){var r=Le.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function kJ(e,t,n){var r=Le.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function BJ(e,t,n){var r=Le.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function PJ(e,t,n){var r=Le.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function UJ(e,t,n){var r=AJ.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function zJ(e,t,n){var r=Le.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function qJ(e,t,n){var r=Le.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function MN(e,t){return Bt(e.getDate(),t,2)}function jJ(e,t){return Bt(e.getHours(),t,2)}function YJ(e,t){return Bt(e.getHours()%12||12,t,2)}function VJ(e,t){return Bt(1+So.count(vr(e),e),t,3)}function TN(e,t){return Bt(e.getMilliseconds(),t,3)}function WJ(e,t){return TN(e,t)+"000"}function GJ(e,t){return Bt(e.getMonth()+1,t,2)}function XJ(e,t){return Bt(e.getMinutes(),t,2)}function HJ(e,t){return Bt(e.getSeconds(),t,2)}function QJ(e){var t=e.getDay();return t===0?7:t}function JJ(e,t){return Bt(Ua.count(vr(e)-1,e),t,2)}function $N(e){var t=e.getDay();return t>=4||t===0?Io(e):Io.ceil(e)}function KJ(e,t){return e=$N(e),Bt(Io.count(vr(e),e)+(vr(e).getDay()===4),t,2)}function ZJ(e){return e.getDay()}function tK(e,t){return Bt(tl.count(vr(e)-1,e),t,2)}function eK(e,t){return Bt(e.getFullYear()%100,t,2)}function nK(e,t){return e=$N(e),Bt(e.getFullYear()%100,t,2)}function rK(e,t){return Bt(e.getFullYear()%1e4,t,4)}function iK(e,t){var n=e.getDay();return e=n>=4||n===0?Io(e):Io.ceil(e),Bt(e.getFullYear()%1e4,t,4)}function sK(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Bt(t/60|0,"0",2)+Bt(t%60,"0",2)}function NN(e,t){return Bt(e.getUTCDate(),t,2)}function oK(e,t){return Bt(e.getUTCHours(),t,2)}function aK(e,t){return Bt(e.getUTCHours()%12||12,t,2)}function cK(e,t){return Bt(1+sp.count(xr(e),e),t,3)}function RN(e,t){return Bt(e.getUTCMilliseconds(),t,3)}function uK(e,t){return RN(e,t)+"000"}function lK(e,t){return Bt(e.getUTCMonth()+1,t,2)}function fK(e,t){return Bt(e.getUTCMinutes(),t,2)}function hK(e,t){return Bt(e.getUTCSeconds(),t,2)}function dK(e){var t=e.getUTCDay();return t===0?7:t}function pK(e,t){return Bt(za.count(xr(e)-1,e),t,2)}function ON(e){var t=e.getUTCDay();return t>=4||t===0?Mo(e):Mo.ceil(e)}function yK(e,t){return e=ON(e),Bt(Mo.count(xr(e),e)+(xr(e).getUTCDay()===4),t,2)}function mK(e){return e.getUTCDay()}function gK(e,t){return Bt(el.count(xr(e)-1,e),t,2)}function bK(e,t){return Bt(e.getUTCFullYear()%100,t,2)}function _K(e,t){return e=ON(e),Bt(e.getUTCFullYear()%100,t,2)}function wK(e,t){return Bt(e.getUTCFullYear()%1e4,t,4)}function vK(e,t){var n=e.getUTCDay();return e=n>=4||n===0?Mo(e):Mo.ceil(e),Bt(e.getUTCFullYear()%1e4,t,4)}function xK(){return"+0000"}function DN(){return"%"}function LN(e){return+e}function FN(e){return Math.floor(+e/1e3)}var qa,$1,al;SK({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function SK(e){return qa=SJ(e),$1=qa.format,qa.parse,al=qa.utcFormat,qa.utcParse,qa}function AK(e){return new Date(e)}function IK(e){return e instanceof Date?+e:+new Date(+e)}function N1(e,t,n,r,i,s,o,a,c,u){var l=X$(),h=l.invert,f=l.domain,d=u(".%L"),p=u(":%S"),y=u("%I:%M"),g=u("%I %p"),m=u("%a %d"),b=u("%b %d"),w=u("%B"),_=u("%Y");function x(v){return(c(v)<v?d:a(v)<v?p:o(v)<v?y:s(v)<v?g:r(v)<v?i(v)<v?m:b:n(v)<v?w:_)(v)}return l.invert=function(v){return new Date(h(v))},l.domain=function(v){return arguments.length?f(Array.from(v,IK)):f().map(AK)},l.ticks=function(v){var S=f();return e(S[0],S[S.length-1],v??10)},l.tickFormat=function(v,S){return S==null?x:u(S)},l.nice=function(v){var S=f();return(!v||typeof v.range!="function")&&(v=t(S[0],S[S.length-1],v??10)),v?f(Q$(S,v)):l},l.copy=function(){return Xu(l,N1(e,t,n,r,i,s,o,a,c,u))},l}function EK(){return Hr.apply(N1(vJ,xJ,vr,nl,Ua,So,Ku,Qu,wr,$1).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function MK(){return Hr.apply(N1(wJ,vN,xr,rl,za,sp,Zu,Ju,wr,al).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function ap(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function cp(){var e=0,t=.5,n=1,r=1,i,s,o,a,c,u=Jn,l,h=!1,f;function d(y){return isNaN(y=+y)?f:(y=.5+((y=+l(y))-s)*(r*y<r*s?a:c),u(h?Math.max(0,Math.min(1,y)):y))}d.domain=function(y){return arguments.length?([e,t,n]=y,i=l(e=+e),s=l(t=+t),o=l(n=+n),a=i===s?0:.5/(s-i),c=s===o?0:.5/(o-s),r=s<i?-1:1,d):[e,t,n]},d.clamp=function(y){return arguments.length?(h=!!y,d):h},d.interpolator=function(y){return arguments.length?(u=y,d):u};function p(y){return function(g){var m,b,w;return arguments.length?([m,b,w]=g,u=od(y,[m,b,w]),d):[u(0),u(.5),u(1)]}}return d.range=p(Ia),d.rangeRound=p(mg),d.unknown=function(y){return arguments.length?(f=y,d):f},function(y){return l=y,i=y(e),s=y(t),o=y(n),a=i===s?0:.5/(s-i),c=s===o?0:.5/(o-s),r=s<i?-1:1,d}}function CN(){var e=Hu(cp()(Jn));return e.copy=function(){return ap(e,CN())},tp.apply(e,arguments)}function kN(){var e=tN(cp()).domain([.1,1,10]);return e.copy=function(){return ap(e,kN()).base(e.base())},tp.apply(e,arguments)}function BN(){var e=iN(cp());return e.copy=function(){return ap(e,BN()).constant(e.constant())},tp.apply(e,arguments)}function PN(){var e=aN(cp());return e.copy=function(){return ap(e,PN()).exponent(e.exponent())},tp.apply(e,arguments)}function vt(e){for(var t=e.length/6|0,n=new Array(t),r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}const TK=vt("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),$K=vt("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),NK=vt("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),RK=vt("4269d0efb118ff725c6cc5b03ca951ff8ab7a463f297bbf59c6b4e9498a0"),OK=vt("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),DK=vt("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),LK=vt("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),FK=vt("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),CK=vt("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),kK=vt("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),BK=vt("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab"),Jt=e=>zW(e[e.length-1]);var UN=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(vt);const zN=Jt(UN);var qN=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(vt);const jN=Jt(qN);var YN=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(vt);const VN=Jt(YN);var WN=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(vt);const GN=Jt(WN);var R1=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(vt);const up=Jt(R1);var XN=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(vt);const HN=Jt(XN);var O1=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(vt);const lp=Jt(O1);var QN=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(vt);const JN=Jt(QN);var KN=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(vt);const ZN=Jt(KN);var t5=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(vt);const e5=Jt(t5);var n5=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(vt);const r5=Jt(n5);var i5=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(vt);const s5=Jt(i5);var o5=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(vt);const a5=Jt(o5);var c5=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(vt);const u5=Jt(c5);var l5=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(vt);const f5=Jt(l5);var h5=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(vt);const d5=Jt(h5);var p5=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(vt);const y5=Jt(p5);var m5=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(vt);const g5=Jt(m5);var b5=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(vt);const _5=Jt(b5);var w5=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(vt);const v5=Jt(w5);var x5=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(vt);const S5=Jt(x5);var A5=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(vt);const I5=Jt(A5);var E5=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(vt);const M5=Jt(E5);var T5=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(vt);const $5=Jt(T5);var N5=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(vt);const R5=Jt(N5);var O5=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(vt);const D5=Jt(O5);var L5=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(vt);const F5=Jt(L5);function C5(e){return e=Math.max(0,Math.min(1,e)),"rgb("+Math.max(0,Math.min(255,Math.round(-4.54-e*(35.34-e*(2381.73-e*(6402.7-e*(7024.72-e*2710.57)))))))+", "+Math.max(0,Math.min(255,Math.round(32.49+e*(170.73+e*(52.82-e*(131.46-e*(176.58-e*67.37)))))))+", "+Math.max(0,Math.min(255,Math.round(81.24+e*(442.36-e*(2482.43-e*(6167.24-e*(6614.94-e*2475.67)))))))+")"}const k5=bg(Vr(300,.5,0),Vr(-240,.5,1));var B5=bg(Vr(-100,.75,.35),Vr(80,1.5,.8)),P5=bg(Vr(260,.75,.35),Vr(80,1.5,.8)),fp=Vr();function U5(e){(e<0||e>1)&&(e-=Math.floor(e));var t=Math.abs(e-.5);return fp.h=360*e-100,fp.s=1.5-1.5*t,fp.l=.8-.9*t,fp+""}var hp=Nn(),PK=Math.PI/3,UK=Math.PI*2/3;function z5(e){var t;return e=(.5-e)*Math.PI,hp.r=255*(t=Math.sin(e))*t,hp.g=255*(t=Math.sin(e+PK))*t,hp.b=255*(t=Math.sin(e+UK))*t,hp+""}function q5(e){return e=Math.max(0,Math.min(1,e)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+e*(1172.33-e*(10793.56-e*(33300.12-e*(38394.49-e*14825.05)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+e*(557.33+e*(1225.33-e*(3574.96-e*(1073.77+e*707.56)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+e*(3211.1-e*(15327.97-e*(27814-e*(22569.18-e*6838.66)))))))+")"}function dp(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}const j5=dp(vt("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));var Y5=dp(vt("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),V5=dp(vt("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),W5=dp(vt("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));function Fe(e){return function(){return e}}const G5=Math.cos,D1=Math.min,pp=Math.sin,Re=Math.sqrt,X5=1e-12,yp=Math.PI,mp=2*yp;function H5(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);t=r}return e},()=>new w8(t)}function Q5(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function J5(e){this._context=e}J5.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function cl(e){return new J5(e)}function K5(e){return e[0]}function Z5(e){return e[1]}function tR(e,t){var n=Fe(!0),r=null,i=cl,s=null,o=H5(a);e=typeof e=="function"?e:e===void 0?K5:Fe(e),t=typeof t=="function"?t:t===void 0?Z5:Fe(t);function a(c){var u,l=(c=Q5(c)).length,h,f=!1,d;for(r==null&&(s=i(d=o())),u=0;u<=l;++u)!(u<l&&n(h=c[u],u,c))===f&&((f=!f)?s.lineStart():s.lineEnd()),f&&s.point(+e(h,u,c),+t(h,u,c));if(d)return s=null,d+""||null}return a.x=function(c){return arguments.length?(e=typeof c=="function"?c:Fe(+c),a):e},a.y=function(c){return arguments.length?(t=typeof c=="function"?c:Fe(+c),a):t},a.defined=function(c){return arguments.length?(n=typeof c=="function"?c:Fe(!!c),a):n},a.curve=function(c){return arguments.length?(i=c,r!=null&&(s=i(r)),a):i},a.context=function(c){return arguments.length?(c==null?r=s=null:s=i(r=c),a):r},a}function L1(e,t,n){var r=null,i=Fe(!0),s=null,o=cl,a=null,c=H5(u);e=typeof e=="function"?e:e===void 0?K5:Fe(+e),t=typeof t=="function"?t:Fe(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?Z5:Fe(+n);function u(h){var f,d,p,y=(h=Q5(h)).length,g,m=!1,b,w=new Array(y),_=new Array(y);for(s==null&&(a=o(b=c())),f=0;f<=y;++f){if(!(f<y&&i(g=h[f],f,h))===m)if(m=!m)d=f,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),p=f-1;p>=d;--p)a.point(w[p],_[p]);a.lineEnd(),a.areaEnd()}m&&(w[f]=+e(g,f,h),_[f]=+t(g,f,h),a.point(r?+r(g,f,h):w[f],n?+n(g,f,h):_[f]))}if(b)return a=null,b+""||null}function l(){return tR().defined(i).curve(o).context(s)}return u.x=function(h){return arguments.length?(e=typeof h=="function"?h:Fe(+h),r=null,u):e},u.x0=function(h){return arguments.length?(e=typeof h=="function"?h:Fe(+h),u):e},u.x1=function(h){return arguments.length?(r=h==null?null:typeof h=="function"?h:Fe(+h),u):r},u.y=function(h){return arguments.length?(t=typeof h=="function"?h:Fe(+h),n=null,u):t},u.y0=function(h){return arguments.length?(t=typeof h=="function"?h:Fe(+h),u):t},u.y1=function(h){return arguments.length?(n=h==null?null:typeof h=="function"?h:Fe(+h),u):n},u.lineX0=u.lineY0=function(){return l().x(e).y(t)},u.lineY1=function(){return l().x(e).y(n)},u.lineX1=function(){return l().x(r).y(t)},u.defined=function(h){return arguments.length?(i=typeof h=="function"?h:Fe(!!h),u):i},u.curve=function(h){return arguments.length?(o=h,s!=null&&(a=o(s)),u):o},u.context=function(h){return arguments.length?(h==null?s=a=null:a=o(s=h),u):s},u}class eR{constructor(t,n){this._context=t,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,n){switch(t=+t,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,n,t,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,t,this._y0,t,n);break}}this._x0=t,this._y0=n}}function zK(e){return new eR(e,!0)}function qK(e){return new eR(e,!1)}const jK=Re(3),nR={draw(e,t){const n=Re(t+D1(t/28,.75))*.59436,r=n/2,i=r*jK;e.moveTo(0,n),e.lineTo(0,-n),e.moveTo(-i,-r),e.lineTo(i,r),e.moveTo(-i,r),e.lineTo(i,-r)}},ul={draw(e,t){const n=Re(t/yp);e.moveTo(n,0),e.arc(0,0,n,0,mp)}},rR={draw(e,t){const n=Re(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},iR=Re(1/3),YK=iR*2,sR={draw(e,t){const n=Re(t/YK),r=n*iR;e.moveTo(0,-n),e.lineTo(r,0),e.lineTo(0,n),e.lineTo(-r,0),e.closePath()}},oR={draw(e,t){const n=Re(t)*.62625;e.moveTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.lineTo(-n,0),e.closePath()}},aR={draw(e,t){const n=Re(t-D1(t/7,2))*.87559;e.moveTo(-n,0),e.lineTo(n,0),e.moveTo(0,n),e.lineTo(0,-n)}},cR={draw(e,t){const n=Re(t),r=-n/2;e.rect(r,r,n,n)}},uR={draw(e,t){const n=Re(t)*.4431;e.moveTo(n,n),e.lineTo(n,-n),e.lineTo(-n,-n),e.lineTo(-n,n),e.closePath()}},VK=.8908130915292852,lR=pp(yp/10)/pp(7*yp/10),WK=pp(mp/10)*lR,GK=-G5(mp/10)*lR,fR={draw(e,t){const n=Re(t*VK),r=WK*n,i=GK*n;e.moveTo(0,-n),e.lineTo(r,i);for(let s=1;s<5;++s){const o=mp*s/5,a=G5(o),c=pp(o);e.lineTo(c*n,-a*n),e.lineTo(a*r-c*i,c*r+a*i)}e.closePath()}},F1=Re(3),hR={draw(e,t){const n=-Re(t/(F1*3));e.moveTo(0,n*2),e.lineTo(-F1*n,-n),e.lineTo(F1*n,-n),e.closePath()}},XK=Re(3),dR={draw(e,t){const n=Re(t)*.6824,r=n/2,i=n*XK/2;e.moveTo(0,-n),e.lineTo(i,r),e.lineTo(-i,r),e.closePath()}},Zn=-.5,tr=Re(3)/2,C1=1/Re(12),HK=(C1/2+1)*3,pR={draw(e,t){const n=Re(t/HK),r=n/2,i=n*C1,s=r,o=n*C1+n,a=-s,c=o;e.moveTo(r,i),e.lineTo(s,o),e.lineTo(a,c),e.lineTo(Zn*r-tr*i,tr*r+Zn*i),e.lineTo(Zn*s-tr*o,tr*s+Zn*o),e.lineTo(Zn*a-tr*c,tr*a+Zn*c),e.lineTo(Zn*r+tr*i,Zn*i-tr*r),e.lineTo(Zn*s+tr*o,Zn*o-tr*s),e.lineTo(Zn*a+tr*c,Zn*c-tr*a),e.closePath()}},yR={draw(e,t){const n=Re(t-D1(t/6,1.7))*.6189;e.moveTo(-n,-n),e.lineTo(n,n),e.moveTo(-n,n),e.lineTo(n,-n)}},QK=[ul,rR,sR,cR,fR,hR,pR],JK=[ul,aR,yR,dR,nR,uR,oR];function Ns(){}function gp(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function bp(e){this._context=e}bp.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:gp(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:gp(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function KK(e){return new bp(e)}function mR(e){this._context=e}mR.prototype={areaStart:Ns,areaEnd:Ns,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:gp(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function ZK(e){return new mR(e)}function gR(e){this._context=e}gR.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:gp(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function tZ(e){return new gR(e)}function bR(e,t){this._basis=new bp(e),this._beta=t}bR.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r=e[0],i=t[0],s=e[n]-r,o=t[n]-i,a=-1,c;++a<=n;)c=a/n,this._basis.point(this._beta*e[a]+(1-this._beta)*(r+c*s),this._beta*t[a]+(1-this._beta)*(i+c*o));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};const eZ=(function e(t){function n(r){return t===1?new bp(r):new bR(r,t)}return n.beta=function(r){return e(+r)},n})(.85);function _p(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function k1(e,t){this._context=e,this._k=(1-t)/6}k1.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:_p(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:_p(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const nZ=(function e(t){function n(r){return new k1(r,t)}return n.tension=function(r){return e(+r)},n})(0);function B1(e,t){this._context=e,this._k=(1-t)/6}B1.prototype={areaStart:Ns,areaEnd:Ns,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:_p(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const rZ=(function e(t){function n(r){return new B1(r,t)}return n.tension=function(r){return e(+r)},n})(0);function P1(e,t){this._context=e,this._k=(1-t)/6}P1.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:_p(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const iZ=(function e(t){function n(r){return new P1(r,t)}return n.tension=function(r){return e(+r)},n})(0);function U1(e,t,n){var r=e._x1,i=e._y1,s=e._x2,o=e._y2;if(e._l01_a>X5){var a=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,c=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*a-e._x0*e._l12_2a+e._x2*e._l01_2a)/c,i=(i*a-e._y0*e._l12_2a+e._y2*e._l01_2a)/c}if(e._l23_a>X5){var u=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,l=3*e._l23_a*(e._l23_a+e._l12_a);s=(s*u+e._x1*e._l23_2a-t*e._l12_2a)/l,o=(o*u+e._y1*e._l23_2a-n*e._l12_2a)/l}e._context.bezierCurveTo(r,i,s,o,e._x2,e._y2)}function _R(e,t){this._context=e,this._alpha=t}_R.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:U1(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const sZ=(function e(t){function n(r){return t?new _R(r,t):new k1(r,0)}return n.alpha=function(r){return e(+r)},n})(.5);function wR(e,t){this._context=e,this._alpha=t}wR.prototype={areaStart:Ns,areaEnd:Ns,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:U1(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const oZ=(function e(t){function n(r){return t?new wR(r,t):new B1(r,0)}return n.alpha=function(r){return e(+r)},n})(.5);function vR(e,t){this._context=e,this._alpha=t}vR.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:U1(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const aZ=(function e(t){function n(r){return t?new vR(r,t):new P1(r,0)}return n.alpha=function(r){return e(+r)},n})(.5);function xR(e){this._context=e}xR.prototype={areaStart:Ns,areaEnd:Ns,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function cZ(e){return new xR(e)}function SR(e){return e<0?-1:1}function AR(e,t,n){var r=e._x1-e._x0,i=t-e._x1,s=(e._y1-e._y0)/(r||i<0&&-0),o=(n-e._y1)/(i||r<0&&-0),a=(s*i+o*r)/(r+i);return(SR(s)+SR(o))*Math.min(Math.abs(s),Math.abs(o),.5*Math.abs(a))||0}function IR(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function z1(e,t,n){var r=e._x0,i=e._y0,s=e._x1,o=e._y1,a=(s-r)/3;e._context.bezierCurveTo(r+a,i+a*t,s-a,o-a*n,s,o)}function wp(e){this._context=e}wp.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:z1(this,this._t0,IR(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,z1(this,IR(this,n=AR(this,e,t)),n);break;default:z1(this,this._t0,n=AR(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function ER(e){this._context=new MR(e)}(ER.prototype=Object.create(wp.prototype)).point=function(e,t){wp.prototype.point.call(this,t,e)};function MR(e){this._context=e}MR.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,s){this._context.bezierCurveTo(t,e,r,n,s,i)}};function uZ(e){return new wp(e)}function lZ(e){return new ER(e)}function TR(e){this._context=e}TR.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=$R(e),i=$R(t),s=0,o=1;o<n;++s,++o)this._context.bezierCurveTo(r[0][s],i[0][s],r[1][s],i[1][s],e[o],t[o]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function $R(e){var t,n=e.length-1,r,i=new Array(n),s=new Array(n),o=new Array(n);for(i[0]=0,s[0]=2,o[0]=e[0]+2*e[1],t=1;t<n-1;++t)i[t]=1,s[t]=4,o[t]=4*e[t]+2*e[t+1];for(i[n-1]=2,s[n-1]=7,o[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=i[t]/s[t-1],s[t]-=r,o[t]-=r*o[t-1];for(i[n-1]=o[n-1]/s[n-1],t=n-2;t>=0;--t)i[t]=(o[t]-i[t+1])/s[t];for(s[n-1]=(e[n]+i[n-1])/2,t=0;t<n-1;++t)s[t]=2*e[t+1]-i[t+1];return[i,s]}function fZ(e){return new TR(e)}function vp(e,t){this._context=e,this._t=t}vp.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function hZ(e){return new vp(e,.5)}function dZ(e){return new vp(e,0)}function pZ(e){return new vp(e,1)}const xp=e=>()=>e;function yZ(e,{sourceEvent:t,target:n,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function Qr(e,t,n){this.k=e,this.x=t,this.y=n}Qr.prototype={constructor:Qr,scale:function(e){return e===1?this:new Qr(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Qr(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var NR=new Qr(1,0,0);Qr.prototype;function q1(e){e.stopImmediatePropagation()}function ll(e){e.preventDefault(),e.stopImmediatePropagation()}function mZ(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function gZ(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function RR(){return this.__zoom||NR}function bZ(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function _Z(){return navigator.maxTouchPoints||"ontouchstart"in this}function wZ(e,t,n){var r=e.invertX(t[0][0])-n[0][0],i=e.invertX(t[1][0])-n[1][0],s=e.invertY(t[0][1])-n[0][1],o=e.invertY(t[1][1])-n[1][1];return e.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),o>s?(s+o)/2:Math.min(0,s)||Math.max(0,o))}function vZ(){var e=mZ,t=gZ,n=wZ,r=bZ,i=_Z,s=[0,1/0],o=[[-1/0,-1/0],[1/0,1/0]],a=250,c=nG,u=Xh("start","zoom","end"),l,h,f,d=500,p=150,y=0,g=10;function m(E){E.property("__zoom",RR).on("wheel.zoom",A,{passive:!1}).on("mousedown.zoom",M).on("dblclick.zoom",T).filter(i).on("touchstart.zoom",I).on("touchmove.zoom",R).on("touchend.zoom touchcancel.zoom",L).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}m.transform=function(E,$,N,D){var k=E.selection?E.selection():E;k.property("__zoom",RR),E!==k?x(E,$,N,D):k.interrupt().each(function(){v(this,arguments).event(D).start().zoom(null,typeof $=="function"?$.apply(this,arguments):$).end()})},m.scaleBy=function(E,$,N,D){m.scaleTo(E,function(){var k=this.__zoom.k,C=typeof $=="function"?$.apply(this,arguments):$;return k*C},N,D)},m.scaleTo=function(E,$,N,D){m.transform(E,function(){var k=t.apply(this,arguments),C=this.__zoom,B=N==null?_(k):typeof N=="function"?N.apply(this,arguments):N,P=C.invert(B),q=typeof $=="function"?$.apply(this,arguments):$;return n(w(b(C,q),B,P),k,o)},N,D)},m.translateBy=function(E,$,N,D){m.transform(E,function(){return n(this.__zoom.translate(typeof $=="function"?$.apply(this,arguments):$,typeof N=="function"?N.apply(this,arguments):N),t.apply(this,arguments),o)},null,D)},m.translateTo=function(E,$,N,D,k){m.transform(E,function(){var C=t.apply(this,arguments),B=this.__zoom,P=D==null?_(C):typeof D=="function"?D.apply(this,arguments):D;return n(NR.translate(P[0],P[1]).scale(B.k).translate(typeof $=="function"?-$.apply(this,arguments):-$,typeof N=="function"?-N.apply(this,arguments):-N),C,o)},D,k)};function b(E,$){return $=Math.max(s[0],Math.min(s[1],$)),$===E.k?E:new Qr($,E.x,E.y)}function w(E,$,N){var D=$[0]-N[0]*E.k,k=$[1]-N[1]*E.k;return D===E.x&&k===E.y?E:new Qr(E.k,D,k)}function _(E){return[(+E[0][0]+ +E[1][0])/2,(+E[0][1]+ +E[1][1])/2]}function x(E,$,N,D){E.on("start.zoom",function(){v(this,arguments).event(D).start()}).on("interrupt.zoom end.zoom",function(){v(this,arguments).event(D).end()}).tween("zoom",function(){var k=this,C=arguments,B=v(k,C).event(D),P=t.apply(k,C),q=N==null?_(P):typeof N=="function"?N.apply(k,C):N,V=Math.max(P[1][0]-P[0][0],P[1][1]-P[0][1]),G=k.__zoom,Q=typeof $=="function"?$.apply(k,C):$,K=c(G.invert(q).concat(V/G.k),Q.invert(q).concat(V/Q.k));return function(Y){if(Y===1)Y=Q;else{var J=K(Y),z=V/J[2];Y=new Qr(z,q[0]-J[0]*z,q[1]-J[1]*z)}B.zoom(null,Y)}})}function v(E,$,N){return!N&&E.__zooming||new S(E,$)}function S(E,$){this.that=E,this.args=$,this.active=0,this.sourceEvent=null,this.extent=t.apply(E,$),this.taps=0}S.prototype={event:function(E){return E&&(this.sourceEvent=E),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(E,$){return this.mouse&&E!=="mouse"&&(this.mouse[1]=$.invert(this.mouse[0])),this.touch0&&E!=="touch"&&(this.touch0[1]=$.invert(this.touch0[0])),this.touch1&&E!=="touch"&&(this.touch1[1]=$.invert(this.touch1[0])),this.that.__zoom=$,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(E){var $=oe(this.that).datum();u.call(E,this.that,new yZ(E,{sourceEvent:this.sourceEvent,target:m,transform:this.that.__zoom,dispatch:u}),$)}};function A(E,...$){if(!e.apply(this,arguments))return;var N=v(this,$).event(E),D=this.__zoom,k=Math.max(s[0],Math.min(s[1],D.k*Math.pow(2,r.apply(this,arguments)))),C=pr(E);if(N.wheel)(N.mouse[0][0]!==C[0]||N.mouse[0][1]!==C[1])&&(N.mouse[1]=D.invert(N.mouse[0]=C)),clearTimeout(N.wheel);else{if(D.k===k)return;N.mouse=[C,D.invert(C)],Ma(this),N.start()}ll(E),N.wheel=setTimeout(B,p),N.zoom("mouse",n(w(b(D,k),N.mouse[0],N.mouse[1]),N.extent,o));function B(){N.wheel=null,N.end()}}function M(E,...$){if(f||!e.apply(this,arguments))return;var N=E.currentTarget,D=v(this,$,!0).event(E),k=oe(E.view).on("mousemove.zoom",q,!0).on("mouseup.zoom",V,!0),C=pr(E,N),B=E.clientX,P=E.clientY;E4(E.view),q1(E),D.mouse=[C,this.__zoom.invert(C)],Ma(this),D.start();function q(G){if(ll(G),!D.moved){var Q=G.clientX-B,K=G.clientY-P;D.moved=Q*Q+K*K>y}D.event(G).zoom("mouse",n(w(D.that.__zoom,D.mouse[0]=pr(G,N),D.mouse[1]),D.extent,o))}function V(G){k.on("mousemove.zoom mouseup.zoom",null),M4(G.view,D.moved),ll(G),D.event(G).end()}}function T(E,...$){if(e.apply(this,arguments)){var N=this.__zoom,D=pr(E.changedTouches?E.changedTouches[0]:E,this),k=N.invert(D),C=N.k*(E.shiftKey?.5:2),B=n(w(b(N,C),D,k),t.apply(this,$),o);ll(E),a>0?oe(this).transition().duration(a).call(x,B,D,E):oe(this).call(m.transform,B,D,E)}}function I(E,...$){if(e.apply(this,arguments)){var N=E.touches,D=N.length,k=v(this,$,E.changedTouches.length===D).event(E),C,B,P,q;for(q1(E),B=0;B<D;++B)P=N[B],q=pr(P,this),q=[q,this.__zoom.invert(q),P.identifier],k.touch0?!k.touch1&&k.touch0[2]!==q[2]&&(k.touch1=q,k.taps=0):(k.touch0=q,C=!0,k.taps=1+!!l);l&&(l=clearTimeout(l)),C&&(k.taps<2&&(h=q[0],l=setTimeout(function(){l=null},d)),Ma(this),k.start())}}function R(E,...$){if(this.__zooming){var N=v(this,$).event(E),D=E.changedTouches,k=D.length,C,B,P,q;for(ll(E),C=0;C<k;++C)B=D[C],P=pr(B,this),N.touch0&&N.touch0[2]===B.identifier?N.touch0[0]=P:N.touch1&&N.touch1[2]===B.identifier&&(N.touch1[0]=P);if(B=N.that.__zoom,N.touch1){var V=N.touch0[0],G=N.touch0[1],Q=N.touch1[0],K=N.touch1[1],Y=(Y=Q[0]-V[0])*Y+(Y=Q[1]-V[1])*Y,J=(J=K[0]-G[0])*J+(J=K[1]-G[1])*J;B=b(B,Math.sqrt(Y/J)),P=[(V[0]+Q[0])/2,(V[1]+Q[1])/2],q=[(G[0]+K[0])/2,(G[1]+K[1])/2]}else if(N.touch0)P=N.touch0[0],q=N.touch0[1];else return;N.zoom("touch",n(w(B,P,q),N.extent,o))}}function L(E,...$){if(this.__zooming){var N=v(this,$).event(E),D=E.changedTouches,k=D.length,C,B;for(q1(E),f&&clearTimeout(f),f=setTimeout(function(){f=null},d),C=0;C<k;++C)B=D[C],N.touch0&&N.touch0[2]===B.identifier?delete N.touch0:N.touch1&&N.touch1[2]===B.identifier&&delete N.touch1;if(N.touch1&&!N.touch0&&(N.touch0=N.touch1,delete N.touch1),N.touch0)N.touch0[1]=this.__zoom.invert(N.touch0[0]);else if(N.end(),N.taps===2&&(B=pr(B,this),Math.hypot(h[0]-B[0],h[1]-B[1])<g)){var P=oe(this).on("dblclick.zoom");P&&P.apply(this,arguments)}}}return m.wheelDelta=function(E){return arguments.length?(r=typeof E=="function"?E:xp(+E),m):r},m.filter=function(E){return arguments.length?(e=typeof E=="function"?E:xp(!!E),m):e},m.touchable=function(E){return arguments.length?(i=typeof E=="function"?E:xp(!!E),m):i},m.extent=function(E){return arguments.length?(t=typeof E=="function"?E:xp([[+E[0][0],+E[0][1]],[+E[1][0],+E[1][1]]]),m):t},m.scaleExtent=function(E){return arguments.length?(s[0]=+E[0],s[1]=+E[1],m):[s[0],s[1]]},m.translateExtent=function(E){return arguments.length?(o[0][0]=+E[0][0],o[1][0]=+E[1][0],o[0][1]=+E[0][1],o[1][1]=+E[1][1],m):[[o[0][0],o[0][1]],[o[1][0],o[1][1]]]},m.constrain=function(E){return arguments.length?(n=E,m):n},m.duration=function(E){return arguments.length?(a=+E,m):a},m.interpolate=function(E){return arguments.length?(c=E,m):c},m.on=function(){var E=u.on.apply(u,arguments);return E===u?m:E},m.clickDistance=function(E){return arguments.length?(y=(E=+E)*E,m):Math.sqrt(y)},m.tapDistance=function(E){return arguments.length?(g=+E,m):g},m}function Be(e){return e!=null&&!Number.isNaN(e)}function er(e,t){return+Be(t)-+Be(e)||qt(e,t)}function Sp(e,t){return+Be(t)-+Be(e)||lo(e,t)}function j1(e){return e!=null&&`${e}`!=""}function Ap(e){return isFinite(e)?e:NaN}function Ci(e){return e>0&&isFinite(e)?e:NaN}function Ip(e){return e<0&&isFinite(e)?e:NaN}function xZ(e,t){if(e instanceof Date||(e=new Date(+e)),isNaN(e))return typeof t=="function"?t(e):t;const n=e.getUTCHours(),r=e.getUTCMinutes(),i=e.getUTCSeconds(),s=e.getUTCMilliseconds();return`${SZ(e.getUTCFullYear())}-${ki(e.getUTCMonth()+1,2)}-${ki(e.getUTCDate(),2)}${n||r||i||s?`T${ki(n,2)}:${ki(r,2)}${i||s?`:${ki(i,2)}${s?`.${ki(s,3)}`:""}`:""}Z`:""}`}function SZ(e){return e<0?`-${ki(-e,6)}`:e>9999?`+${ki(e,6)}`:ki(e,4)}function ki(e,t){return`${e}`.padStart(t,"0")}const AZ=/^(?:[-+]\d{2})?\d{4}(?:-\d{2}(?:-\d{2})?)?(?:T\d{2}:\d{2}(?::\d{2}(?:\.\d{3})?)?(?:Z|[-+]\d{2}:?\d{2})?)?$/;function OR(e,t){return AZ.test(e+="")?new Date(e):typeof t=="function"?t(e):t}function ja(e){if(e==null)return;const t=e[0],n=e[e.length-1];return lo(t,n)}const Ya=1e3,Rs=Ya*60,Os=Rs*60,Jr=Os*24,Kr=Jr*7,To=Jr*30,Ds=Jr*365,Y1=[["millisecond",1],["2 milliseconds",2],["5 milliseconds",5],["10 milliseconds",10],["20 milliseconds",20],["50 milliseconds",50],["100 milliseconds",100],["200 milliseconds",200],["500 milliseconds",500],["second",Ya],["5 seconds",5*Ya],["15 seconds",15*Ya],["30 seconds",30*Ya],["minute",Rs],["5 minutes",5*Rs],["15 minutes",15*Rs],["30 minutes",30*Rs],["hour",Os],["3 hours",3*Os],["6 hours",6*Os],["12 hours",12*Os],["day",Jr],["2 days",2*Jr],["week",Kr],["2 weeks",2*Kr],["month",To],["3 months",3*To],["6 months",6*To],["year",Ds],["2 years",2*Ds],["5 years",5*Ds],["10 years",10*Ds],["20 years",20*Ds],["50 years",50*Ds],["100 years",100*Ds]],V1=new Map([["second",Ya],["minute",Rs],["hour",Os],["day",Jr],["monday",Kr],["tuesday",Kr],["wednesday",Kr],["thursday",Kr],["friday",Kr],["saturday",Kr],["sunday",Kr],["week",Kr],["month",To],["year",Ds]]),DR=new Map([["second",wr],["minute",Qu],["hour",Ku],["day",So],["monday",tl],["tuesday",hN],["wednesday",dN],["thursday",Io],["friday",pN],["saturday",yN],["sunday",Ua],["week",Ua],["month",nl],["year",vr]]),W1=new Map([["second",wr],["minute",Ju],["hour",Zu],["day",op],["monday",el],["tuesday",mN],["wednesday",gN],["thursday",Mo],["friday",bN],["saturday",_N],["sunday",za],["week",za],["month",rl],["year",xr]]),fl=Symbol("intervalDuration"),Ep=Symbol("intervalType");for(const[e,t]of DR)t[fl]=V1.get(e),t[Ep]="time";for(const[e,t]of W1)t[fl]=V1.get(e),t[Ep]="utc";const hl=[["year",xr,"utc"],["month",rl,"utc"],["day",op,"utc",6*To],["hour",Zu,"utc",3*Jr],["minute",Ju,"utc",6*Os],["second",wr,"utc",30*Rs]],Mp=[["year",vr,"time"],["month",nl,"time"],["day",So,"time",6*To],["hour",Ku,"time",3*Jr],["minute",Qu,"time",6*Os],["second",wr,"time",30*Rs]],IZ=[hl[0],Mp[0],hl[1],Mp[1],hl[2],Mp[2],...hl.slice(3)];function G1(e){let t=`${e}`.toLowerCase();t.endsWith("s")&&(t=t.slice(0,-1));let n=1;const r=/^(?:(\d+)\s+)/.exec(t);switch(r&&(t=t.slice(r[0].length),n=+r[1]),t){case"quarter":t="month",n*=3;break;case"half":t="month",n*=6;break}let i=W1.get(t);if(!i)throw new Error(`unknown interval: ${e}`);if(n>1&&!i.every)throw new Error(`non-periodic interval: ${t}`);return[t,n]}function X1(e){return LR(G1(e),"time")}function Tp(e){return LR(G1(e),"utc")}function LR([e,t],n){let r=(n==="time"?DR:W1).get(e);return t>1&&(r=r.every(t),r[fl]=V1.get(e)*t,r[Ep]=n),r}function FR(e,t){if(!(t>1))return;const n=e[fl];if(!Y1.some(([,i])=>i===n)||n%Jr===0&&Jr<n&&n<To)return;const[r]=Y1[zh(([,i])=>Math.log(i)).center(Y1,Math.log(n*t))];return(e[Ep]==="time"?X1:Tp)(r)}function CR(e,t,n){const r=t==="time"?$1:al;if(n==null)return r(e==="year"?"%Y":e==="month"?"%Y-%m":e==="day"?"%Y-%m-%d":e==="hour"||e==="minute"?"%Y-%m-%dT%H:%M":e==="second"?"%Y-%m-%dT%H:%M:%S":"%Y-%m-%dT%H:%M:%S.%L");const i=EZ(n);switch(e){case"millisecond":return Va(r(".%L"),r(":%M:%S"),i);case"second":return Va(r(":%S"),r("%-I:%M"),i);case"minute":return Va(r("%-I:%M"),r("%p"),i);case"hour":return Va(r("%-I %p"),r("%b %-d"),i);case"day":return Va(r("%-d"),r("%b"),i);case"month":return Va(r("%b"),r("%Y"),i);case"year":return r("%Y")}throw new Error("unable to format time ticks")}function EZ(e){return e==="left"||e==="right"?(t,n)=>`
${t}
${n}`:e==="top"?(t,n)=>`${n}
${t}`:(t,n)=>`${t}
${n}`}function MZ(e){return e==="time"?Mp:e==="utc"?hl:IZ}function TZ(e,t,n){const r=me(NY(t,(i,s)=>Math.abs(s-i)));if(r<1e3)return CR("millisecond","utc",n);for(const[i,s,o,a]of MZ(e)){if(r>a||i==="hour"&&!r)break;if(t.every(c=>s.floor(c)>=c))return CR(i,o,n)}}function Va(e,t,n){return(r,i,s)=>{const o=e(r,i),a=t(r,i),c=i-ja(s);return i!==c&&s[c]!==void 0&&a===t(s[c],c)?o:n(o,a)}}const $p=Object.getPrototypeOf(Uint8Array),$Z=Object.prototype.toString;function Bi(e){return e instanceof Array||e instanceof $p}function kR(e){return e instanceof $p&&!NZ(e)}function BR(e){return e?.prototype instanceof $p&&!RZ(e)}function NZ(e){return e instanceof BigInt64Array||e instanceof BigUint64Array}function RZ(e){return e===BigInt64Array||e===BigUint64Array}const PR=Symbol("reindex");function Tt(e,t,n){const r=typeof t;return r==="string"?eO(e)?Q1(e.getChild(t),n):UR(e,qR(t),n):r==="function"?UR(e,t,n):r==="number"||t instanceof Date||r==="boolean"?Kt(e,Ue(t),n):typeof t?.transform=="function"?H1(t.transform(e),n):OZ(H1(t,n),e?.[PR])}function OZ(e,t){return e!=null&&t?Rp(e,t):e}function UR(e,t,n){return Kt(e,BR(n)?(r,i)=>Z1(t(r,i)):t,n)}function H1(e,t){return t===void 0?Ls(e):nO(e)?Q1(e,t):e instanceof t?e:t.from(e,BR(t)&&!kR(e)?Z1:void 0)}function Q1(e,t){return e==null?e:(t===void 0||t===Array)&&WZ(e.type)?jR(zR(e)):H1(zR(e),t)}function zR(e){return e.nullCount?e.toJSON():e.toArray()}const dl=[null],qR=e=>t=>{const n=t[e];return n===void 0&&t.type==="Feature"?t.properties?.[e]:n},Ee={transform:Pi},nt={transform:e=>e},J1=()=>1,DZ=()=>!0,Pe=e=>e==null?e:`${e}`,ae=e=>e==null?e:+e,Np=e=>e?e[0]:void 0,pl=e=>e?e[1]:void 0,LZ=e=>e?e[2]:void 0,Ue=e=>()=>e;function K1(e){const t=+`${e}`.slice(1)/100;return(n,r)=>Ss(n,t,r)}function vn(e){return kR(e)?e:Kt(e,Z1,Float64Array)}function Z1(e){return e==null?NaN:Number(e)}function jR(e){return Kt(e,YR)}function YR(e){return e instanceof Date&&!isNaN(e)?e:typeof e=="string"?OR(e):e==null||isNaN(e=Number(e))?void 0:new Date(e)}function ln(e,t){return e===void 0&&(e=t),e===null?[void 0,"none"]:gl(e)?[void 0,e]:[e,void 0]}function Se(e,t){return e===void 0&&(e=t),e===null||typeof e=="number"?[void 0,e]:[e,void 0]}function VR(e,t,n){if(e!=null)return Dn(e,t,n)}function Dn(e,t,n){const r=`${e}`.toLowerCase();if(!n.includes(r))throw new Error(`invalid ${t}: ${e}`);return r}function Wa(e){return eO(e)?e:Ls(e)}function Ls(e){if(e==null||Bi(e))return e;if(nO(e))return Q1(e);if(WR(e))switch(e.type){case"FeatureCollection":return e.features;case"GeometryCollection":return e.geometries;default:return[e]}return Array.from(e)}function WR(e){switch(e?.type){case"FeatureCollection":case"GeometryCollection":case"Feature":case"LineString":case"MultiLineString":case"MultiPoint":case"MultiPolygon":case"Point":case"Polygon":case"Sphere":return!0;default:return!1}}function Kt(e,t,n=Array){return e==null?e:e instanceof n?e.map(t):n.from(e,t)}function yl(e,t=Array){return e instanceof t?e.slice():t.from(e)}function GR({x:e,x1:t,x2:n}){return e!==void 0||t!==void 0||n!==void 0}function XR({y:e,y1:t,y2:n}){return e!==void 0||t!==void 0||n!==void 0}function Ga(e){return GR(e)||XR(e)||e.interval!==void 0}function Ln(e){return e?.toString===$Z}function $o(e){return Ln(e)&&(e.type!==void 0||e.domain!==void 0)}function Zr(e){return Ln(e)&&typeof e.transform!="function"}function Fs(e){return Zr(e)&&e.value===void 0&&e.channel===void 0}function HR(e,t,n,r=nt){return t===void 0&&n===void 0?(t=0,n=e===void 0?r:e):t===void 0?t=e===void 0?0:e:n===void 0&&(n=e===void 0?0:e),[t,n]}function Sr(e,t){return e===void 0&&t===void 0?[Np,pl]:[e,t]}function Cs({z:e,fill:t,stroke:n}={}){return e===void 0&&([e]=ln(t)),e===void 0&&([e]=ln(n)),e}function ml(e){return Bi(e)?e.length:e?.numRows}function Pi(e){const t=ml(e),n=new Uint32Array(t);for(let r=0;r<t;++r)n[r]=r;return n}function Rp(e,t){return Bi(e)?Kt(t,n=>e[n],e.constructor):Kt(t,n=>e.at(n))}function tb(e){return e.length===1?(t,n)=>e(Rp(n,t)):e}function No(e,t,n){return e.subarray?e.subarray(t,n):e.slice(t,n)}function Ui(e){return e!==null&&typeof e=="object"?e.valueOf():e}function QR(e,t){if(t[e]!==void 0)return t[e];switch(e){case"x1":case"x2":e="x";break;case"y1":case"y2":e="y";break}return t[e]}function Fn(e){let t;return[{transform:()=>t,label:ti(e)},n=>t=n]}function xn(e){return e==null?[e]:Fn(e)}function ti(e,t){return typeof e=="string"?e:e&&e.label!==void 0?e.label:t}function Op(e,t){return{transform(n){const r=e.transform(n),i=t.transform(n);return fn(r)||fn(i)?Kt(r,(s,o)=>new Date((+r[o]+ +i[o])/2)):Kt(r,(s,o)=>(+r[o]+ +i[o])/2,Float64Array)},label:e.label}}function Dp(e,t){const n=JR(t?.interval,t?.type);return n?Kt(e,n):e}function JR(e,t){const n=Lp(e,t);return n&&(r=>Be(r)?n.floor(r):r)}function Lp(e,t){if(e!=null){if(typeof e=="number")return KR(e);if(typeof e=="string")return(t==="time"?X1:Tp)(e);if(typeof e.floor!="function")throw new Error("invalid interval; missing floor method");if(typeof e.offset!="function")throw new Error("invalid interval; missing offset method");return e}}function KR(e){e=+e,0<e&&e<1&&Number.isInteger(1/e)&&(e=-1/e);const t=Math.abs(e);return e<0?{floor:n=>Math.floor(n*t)/t,offset:(n,r=1)=>(n*t+Math.floor(r))/t,range:(n,r)=>Tn(Math.ceil(n*t),r*t).map(i=>i/t)}:{floor:n=>Math.floor(n/t)*t,offset:(n,r=1)=>n+t*Math.floor(r),range:(n,r)=>Tn(Math.ceil(n/t),r/t).map(i=>i*t)}}function Xa(e,t){if(e=Lp(e,t),e&&typeof e.range!="function")throw new Error("invalid interval: missing range method");return e}function FZ(e,t){if(e=Xa(e,t),e&&typeof e.ceil!="function")throw new Error("invalid interval: missing ceil method");return e}function CZ(e){return Ha(e)&&typeof e?.floor=="function"&&e.floor()instanceof Date}function Ha(e){return typeof e?.range=="function"}function Qa(e){return e===void 0||Zr(e)?e:{value:e}}function kZ(e){return e==null?null:{transform:t=>Tt(t,e,Float64Array),label:ti(e)}}function BZ(e){if(!zi(e))return!1;for(const t of e)if(t!=null)return typeof t=="object"&&"0"in t&&"1"in t}function zi(e){return e&&typeof e[Symbol.iterator]=="function"}function ZR(e){for(const t of e)if(t!=null)return typeof t!="object"||t instanceof Date}function we(e){for(const t of e){if(t==null)continue;const n=typeof t;return n==="string"||n==="boolean"}}function fn(e){for(const t of e)if(t!=null)return t instanceof Date}function PZ(e){for(const t of e)if(t!=null)return typeof t=="string"&&isNaN(t)&&OR(t)}function UZ(e){for(const t of e)if(t!=null){if(typeof t!="string")return!1;if(t.trim())return!isNaN(t)}}function Ja(e){for(const t of e)if(t!=null)return typeof t=="number"}function eb(e,t){let n;for(const r of e)if(r!=null){if(!t(r))return!1;n=!0}return n}const zZ=new Set("none,currentcolor,transparent,aliceblue,antiquewhite,aqua,aquamarine,azure,beige,bisque,black,blanchedalmond,blue,blueviolet,brown,burlywood,cadetblue,chartreuse,chocolate,coral,cornflowerblue,cornsilk,crimson,cyan,darkblue,darkcyan,darkgoldenrod,darkgray,darkgreen,darkgrey,darkkhaki,darkmagenta,darkolivegreen,darkorange,darkorchid,darkred,darksalmon,darkseagreen,darkslateblue,darkslategray,darkslategrey,darkturquoise,darkviolet,deeppink,deepskyblue,dimgray,dimgrey,dodgerblue,firebrick,floralwhite,forestgreen,fuchsia,gainsboro,ghostwhite,gold,goldenrod,gray,green,greenyellow,grey,honeydew,hotpink,indianred,indigo,ivory,khaki,lavender,lavenderblush,lawngreen,lemonchiffon,lightblue,lightcoral,lightcyan,lightgoldenrodyellow,lightgray,lightgreen,lightgrey,lightpink,lightsalmon,lightseagreen,lightskyblue,lightslategray,lightslategrey,lightsteelblue,lightyellow,lime,limegreen,linen,magenta,maroon,mediumaquamarine,mediumblue,mediumorchid,mediumpurple,mediumseagreen,mediumslateblue,mediumspringgreen,mediumturquoise,mediumvioletred,midnightblue,mintcream,mistyrose,moccasin,navajowhite,navy,oldlace,olive,olivedrab,orange,orangered,orchid,palegoldenrod,palegreen,paleturquoise,palevioletred,papayawhip,peachpuff,peru,pink,plum,powderblue,purple,rebeccapurple,red,rosybrown,royalblue,saddlebrown,salmon,sandybrown,seagreen,seashell,sienna,silver,skyblue,slateblue,slategray,slategrey,snow,springgreen,steelblue,tan,teal,thistle,tomato,turquoise,violet,wheat,white,whitesmoke,yellow".split(","));function gl(e){return typeof e!="string"?!1:(e=e.toLowerCase().trim(),/^#[0-9a-f]{3,8}$/.test(e)||/^(?:url|var|rgb|rgba|hsl|hsla|hwb|lab|lch|oklab|oklch|color|color-mix)\(.*\)$/.test(e)||zZ.has(e))}function qZ(e){return typeof e=="number"&&(0<=e&&e<=1||isNaN(e))}function he(e){return e==null||Ka(e)}function Ka(e){return/^\s*none\s*$/i.test(e)}function jZ(e){return/^\s*round\s*$/i.test(e)}function nb(e,t){return VR(e,t,["middle","top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"])}function bl(e="middle"){return nb(e,"frameAnchor")}function YZ(e={},...t){let n=e;for(const r of t)for(const i in r)if(n[i]===void 0){const s=r[i];n===e?n={...n,[i]:s}:n[i]=s}return n}function VZ(e){console.warn("named iterables are deprecated; please use an object instead");const t=new Set;return Object.fromEntries(Array.from(e,n=>{const{name:r}=n;if(r==null)throw new Error("missing name");const i=`${r}`;if(i==="__proto__")throw new Error(`illegal name: ${i}`);if(t.has(i))throw new Error(`duplicate name: ${i}`);return t.add(i),[r,n]}))}function rb(e){return zi(e)?VZ(e):e}function tO(e){return e===!0?e="frame":e===!1?e=null:!WR(e)&&e!=null&&(e=Dn(e,"clip",["frame","sphere"]),e==="sphere"&&(e={type:"Sphere"})),e}function eO(e){return e&&typeof e.getChild=="function"&&typeof e.toArray=="function"&&e.schema&&Array.isArray(e.schema.fields)}function nO(e){return e&&typeof e.toArray=="function"&&e.type}function WZ(e){return e&&(e.typeId===8||e.typeId===10)&&e.unit===1}const ei=Symbol("position"),qi=Symbol("color"),_l=Symbol("radius"),wl=Symbol("length"),vl=Symbol("opacity"),Fp=Symbol("symbol"),rO=Symbol("projection"),ge=new Map([["x",ei],["y",ei],["fx",ei],["fy",ei],["r",_l],["color",qi],["opacity",vl],["symbol",Fp],["length",wl],["projection",rO]]);function GZ(e){return e===ei||e===rO}function XZ(e){return e===ei||e===_l||e===wl||e===vl}const iO=Math.sqrt(3),sO=2/iO,HZ={draw(e,t){const n=Math.sqrt(t/Math.PI),r=n*sO,i=r/2;e.moveTo(0,r),e.lineTo(n,i),e.lineTo(n,-i),e.lineTo(0,-r),e.lineTo(-n,-i),e.lineTo(-n,i),e.closePath()}},ib=new Map([["asterisk",nR],["circle",ul],["cross",rR],["diamond",sR],["diamond2",oR],["hexagon",HZ],["plus",aR],["square",cR],["square2",uR],["star",fR],["times",yR],["triangle",hR],["triangle2",dR],["wye",pR]]);function sb(e){return e&&typeof e.draw=="function"}function QZ(e){return sb(e)?!0:typeof e!="string"?!1:ib.has(e.toLowerCase())}function ob(e){if(e==null||sb(e))return e;const t=ib.get(`${e}`.toLowerCase());if(t)return t;throw new Error(`invalid symbol: ${e}`)}function JZ(e){if(e==null||sb(e))return[void 0,e];if(typeof e=="string"){const t=ib.get(`${e}`.toLowerCase());if(t)return[void 0,t]}return[e,void 0]}function Ar({filter:e,sort:t,reverse:n,transform:r,initializer:i,...s}={},o){if(r===void 0&&(e!=null&&(r=ub(e)),t!=null&&!Fs(t)&&(r=ab(r,fb(t))),n&&(r=ab(r,lb))),o!=null&&i!=null)throw new Error("transforms cannot be applied after initializers");return{...s,...(t===null||Fs(t))&&{sort:t},transform:ab(r,o)}}function Ke({filter:e,sort:t,reverse:n,initializer:r,...i}={},s){return r===void 0&&(e!=null&&(r=ub(e)),t!=null&&!Fs(t)&&(r=cb(r,fb(t))),n&&(r=cb(r,lb))),{...i,...(t===null||Fs(t))&&{sort:t},initializer:cb(r,s)}}function ab(e,t){return e==null?t===null?void 0:t:t==null?e===null?void 0:e:function(n,r,i){return{data:n,facets:r}=e.call(this,n,r,i),t.call(this,Wa(n),r,i)}}function cb(e,t){return e==null?t===null?void 0:t:t==null?e===null?void 0:e:function(n,r,i,...s){let o,a,c,u,l,h;return{data:a=n,facets:c=r,channels:o}=e.call(this,n,r,i,...s),{data:l=a,facets:h=c,channels:u}=t.call(this,a,c,{...i,...o},...s),{data:l,facets:h,channels:{...o,...u}}}}function Cp(e,t){return(e.initializer!=null?Ke:Ar)(e,t)}function KZ(e,t){return Cp(t,ub(e))}function ub(e){return(t,n)=>{const r=Tt(t,e);return{data:t,facets:n.map(i=>i.filter(s=>r[s]))}}}function ZZ({sort:e,...t}={}){return{...Cp(t,lb),sort:Fs(e)?e:null}}function lb(e,t){return{data:e,facets:t.map(n=>n.slice().reverse())}}function ttt({seed:e,sort:t,...n}={}){return{...Cp(n,aO(e==null?Math.random:b1(e))),sort:Fs(t)?t:null}}function oO(e,{sort:t,...n}={}){return{...(Zr(e)&&e.channel!==void 0?Ke:Cp)(n,fb(e)),sort:Fs(t)?t:null}}function fb(e){return(typeof e=="function"&&e.length!==1?ett:aO)(e)}function ett(e){return(t,n)=>{const r=Bi(t)?(i,s)=>e(t[i],t[s]):(i,s)=>e(t.get(i),t.get(s));return{data:t,facets:n.map(i=>i.slice().sort(r))}}}function aO(e){let t,n;({channel:t,value:e,order:n}={...Qa(e)});const r=t?.startsWith("-");if(r&&(t=t.slice(1)),n===void 0&&(n=r?Sp:er),typeof n!="function")switch(`${n}`.toLowerCase()){case"ascending":n=er;break;case"descending":n=Sp;break;default:throw new Error(`invalid order: ${n}`)}return(i,s,o)=>{let a;if(t===void 0)a=Tt(i,e);else{if(o===void 0)throw new Error("channel sort requires an initializer");if(a=o[t],!a)return{};a=a.value}const c=(u,l)=>n(a[u],a[l]);return{data:i,facets:s.map(u=>u.slice().sort(c))}}}function hb(e,t){return kp(null,null,e,t)}function xl(e={y:"count"},t={}){const{x:n=nt}=t;if(n==null)throw new Error("missing channel: x");return kp(n,null,e,t)}function Sl(e={x:"count"},t={}){const{y:n=nt}=t;if(n==null)throw new Error("missing channel: y");return kp(null,n,e,t)}function db(e={fill:"count"},t={}){let{x:n,y:r}=t;if([n,r]=Sr(n,r),n==null)throw new Error("missing channel: x");if(r==null)throw new Error("missing channel: y");return kp(n,r,e,t)}function kp(e,t,{data:n=gb,filter:r,sort:i,reverse:s,...o}={},a={}){o=uO(o,a),n=hO(n,nt),i=i==null?void 0:lO("sort",i,a),r=r==null?void 0:fO("filter",r,a);const[c,u]=xn(e),[l,h]=xn(t),{z:f,fill:d,stroke:p,x1:y,x2:g,y1:m,y2:b,...w}=a,[_,x]=xn(f),[v]=ln(d),[S]=ln(p),[A,M]=xn(v),[T,I]=xn(S);return{..."z"in a&&{z:_||f},..."fill"in a&&{fill:A||d},..."stroke"in a&&{stroke:T||p},...Ar(w,(R,L,E)=>{const $=Dp(Tt(R,e),E?.x),N=Dp(Tt(R,t),E?.y),D=Tt(R,f),k=Tt(R,v),C=Tt(R,S),B=mb(o,{z:D,fill:k,stroke:C}),P=[],q=[],V=$&&u([]),G=N&&h([]),Q=D&&x([]),K=k&&M([]),Y=C&&I([]);let J=0;for(const z of o)z.initialize(R);i&&i.initialize(R),r&&r.initialize(R);for(const z of L){const W=[];for(const H of o)H.scope("facet",z);i&&i.scope("facet",z),r&&r.scope("facet",z);for(const[H,U]of Ro(z,B))for(const[wt,tt]of Ro(U,N))for(const[$t,Ot]of Ro(tt,$)){const X={data:R};if($&&(X.x=$t),N&&(X.y=wt),B&&(X.z=H),!(r&&!r.reduce(Ot,X))){W.push(J++),q.push(n.reduceIndex(Ot,R,X)),$&&V.push($t),N&&G.push(wt),D&&Q.push(B===D?H:D[Ot[0]]),k&&K.push(B===k?H:k[Ot[0]]),C&&Y.push(B===C?H:C[Ot[0]]);for(const jt of o)jt.reduce(Ot,X);i&&i.reduce(Ot,X)}}P.push(W)}return dO(P,i,s),{data:q,facets:P}}),...!ks(o,"x")&&(c?{x:c}:{x1:y,x2:g}),...!ks(o,"y")&&(l?{y:l}:{y1:m,y2:b}),...Object.fromEntries(o.map(({name:R,output:L})=>[R,L]))}}function ks(e,...t){for(const{name:n}of e)if(t.includes(n))return!0;return!1}function cO(e,t,n=pb){const r=Object.entries(e);return t.title!=null&&e.title===void 0&&r.push(["title",att]),t.href!=null&&e.href===void 0&&r.push(["href",bb]),r.filter(([,i])=>i!==void 0).map(([i,s])=>s===null?ntt(i):n(i,s,t))}function pb(e,t,n,r=yb){let i;Ln(t)&&"reduce"in t&&(i=t.scale,t=t.reduce);const s=r(e,t,n),[o,a]=Fn(s.label);let c;return{name:e,output:i===void 0?o:{value:o,scale:i},initialize(u){s.initialize(u),c=a([])},scope(u,l){s.scope(u,l)},reduce(u,l){c.push(s.reduce(u,l))}}}function ntt(e){return{name:e,initialize(){},scope(){},reduce(){}}}function yb(e,t,n,r=Bp){const i=QR(e,n),s=r(t,i);let o,a;return{label:ti(s===Pp?null:i,s.label),initialize(c){o=i===void 0?c:Tt(c,i),s.scope==="data"&&(a=s.reduceIndex(Pi(c),o))},scope(c,u){s.scope===c&&(a=s.reduceIndex(u,o))},reduce(c,u){return s.scope==null?s.reduceIndex(c,o,u):s.reduceIndex(c,o,a,u)}}}function Ro(e,t){return t?vs(e,n=>t[n]):[[,e]]}function Bp(e,t,n=rtt){if(e==null)return n(e);if(typeof e.reduceIndex=="function")return e;if(typeof e.reduce=="function"&&Ln(e))return stt(e);if(typeof e=="function")return ott(e);if(/^p\d{2}$/i.test(e))return ji(K1(e));switch(`${e}`.toLowerCase()){case"first":return bb;case"last":return ctt;case"identity":return gb;case"count":return Pp;case"distinct":return utt;case"sum":return t==null?Pp:ltt;case"proportion":return yO(t,"data");case"proportion-facet":return yO(t,"facet");case"deviation":return ji(mu);case"min":return ji(fe);case"min-index":return ji(EY);case"max":return ji(me);case"max-index":return ji(IY);case"mean":return pO(Wh);case"median":return pO(wu);case"variance":return ji(qm);case"mode":return ji(f4)}return n(e)}function rtt(e){throw new Error(`invalid reduce: ${e}`)}function uO(e,t){return cO(e,t,lO)}function lO(e,t,n){return pb(e,t,n,fO)}function fO(e,t,n){return yb(e,t,n,hO)}function hO(e,t){return Bp(e,t,itt)}function itt(e){switch(`${e}`.toLowerCase()){case"x":return ftt;case"y":return htt;case"z":return mO}throw new Error(`invalid group reduce: ${e}`)}function mb(e,t){for(const n in t){const r=t[n];if(r!==void 0&&!e.some(i=>i.name===n))return r}}function dO(e,t,n){if(t){const r=t.output.transform(),i=(s,o)=>er(r[s],r[o]);e.forEach(s=>s.sort(i))}n&&e.forEach(r=>r.reverse())}function stt(e){return console.warn("deprecated reduce interface; implement reduceIndex instead."),{...e,reduceIndex:e.reduce.bind(e)}}function ott(e){return{reduceIndex(t,n,r){return e(Rp(n,t),r)}}}function ji(e){return{reduceIndex(t,n){return e(t,r=>n[r])}}}function pO(e){return{reduceIndex(t,n){const r=e(t,i=>n[i]);return fn(n)?new Date(r):r}}}const gb={reduceIndex(e,t){return Rp(t,e)}},bb={reduceIndex(e,t){return t[e[0]]}},att={reduceIndex(e,t){const r=Yh(_a(e,s=>s.length,s=>t[s]),pl),i=r.slice(-5).reverse();if(i.length<r.length){const s=r.slice(0,-4);i[4]=[`… ${s.length.toLocaleString("en-US")} more`,dr(s,pl)]}return i.map(([s,o])=>`${s} (${o.toLocaleString("en-US")})`).join(`
`)}},ctt={reduceIndex(e,t){return t[e[e.length-1]]}},Pp={label:"Frequency",reduceIndex(e){return e.length}},utt={label:"Distinct",reduceIndex(e,t){const n=new ba;for(const r of e)n.add(t[r]);return n.size}},ltt=ji(dr);function yO(e,t){return e==null?{scope:t,label:"Frequency",reduceIndex:(n,r,i=1)=>n.length/i}:{scope:t,reduceIndex:(n,r,i=1)=>dr(n,s=>r[s])/i}}const ftt={reduceIndex(e,t,{x:n}){return n}},htt={reduceIndex(e,t,{y:n}){return n}},mO={reduceIndex(e,t,{z:n}){return n}};function dtt(e){if(typeof e!="function")throw new Error(`invalid test function: ${e}`);return{reduceIndex(t,n,{data:r}){return n[t.find(Bi(r)?i=>e(r[i],i,r):i=>e(r.get(i),i,r))]}}}function Al(e,{scale:t,type:n,value:r,filter:i,hint:s,label:o=ti(r)},a){return s===void 0&&typeof r?.transform=="function"&&(s=r.hint),bO(a,{scale:t,type:n,value:Tt(e,r),label:o,filter:i,hint:s})}function gO(e,t){return Object.fromEntries(Object.entries(e).map(([n,r])=>[n,Al(t,r,n)]))}function Up(e,t){const n=Object.fromEntries(Object.entries(e).map(([r,{scale:i,value:s}])=>{const o=i==null?null:t[i];return[r,o==null?s:Kt(s,o)]}));return n.channels=e,n}function bO(e,t){const{scale:n,value:r}=t;if(n===!0||n==="auto")switch(e){case"fill":case"stroke":case"color":t.scale=n!==!0&&eb(r,gl)?null:"color",t.defaultScale="color";break;case"fillOpacity":case"strokeOpacity":case"opacity":t.scale=n!==!0&&eb(r,qZ)?null:"opacity",t.defaultScale="opacity";break;case"symbol":n!==!0&&eb(r,QZ)?(t.scale=null,t.value=Kt(r,ob)):t.scale="symbol",t.defaultScale="symbol";break;default:t.scale=ge.has(e)?e:null;break}else if(n===!1)t.scale=null;else if(n!=null&&!ge.has(n))throw new Error(`unknown scale: ${n}`);return t}function ptt(e,t,n,r,i){const{order:s,reverse:o,reduce:a=!0,limit:c}=i;for(const u in i){if(!ge.has(u))continue;let{value:l,order:h=s,reverse:f=o,reduce:d=a,limit:p=c}=Qa(i[u]);const y=l?.startsWith("-");if(y&&(l=l.slice(1)),h=h===void 0?y!==(l==="width"||l==="height")?vO:wO:gtt(h),d==null||d===!1)continue;const g=u==="fx"||u==="fy"?mtt(t,r[u]):ytt(n,u);if(!g)throw new Error(`missing channel for scale: ${u}`);const m=g.value,[b=0,w=1/0]=zi(p)?p:p<0?[p]:[0,p];if(l==null)g.domain=()=>{let _=Array.from(new ba(m));return f&&(_=_.reverse()),(b!==0||w!==1/0)&&(_=_.slice(b,w)),_};else{const _=l==="data"?e:l==="height"?_O(n,"y1","y2"):l==="width"?_O(n,"x1","x2"):_b(n,l,l==="y"?"y2":l==="x"?"x2":void 0),x=Bp(d===!0?"max":d,_);g.domain=()=>{let v=wY(Pi(m),S=>x.reduceIndex(S,_),S=>m[S]);return h&&v.sort(h),f&&v.reverse(),(b!==0||w!==1/0)&&(v=v.slice(b,w)),v.map(Np)}}}}function ytt(e,t){for(const n in e){const r=e[n];if(r.scale===t)return r}}function mtt(e,t){const n=e.original;if(n===e)return t;const r=t.value,i=t.value=[];for(let s=0;s<n.length;++s){const o=r[n[s][0]];for(const a of e[s])i[a]=o}return t}function _O(e,t,n){const r=_b(e,t),i=_b(e,n);return Kt(i,(s,o)=>Math.abs(s-r[o]),Float64Array)}function _b(e,t,n){let r=e[t];if(!r&&n!==void 0&&(r=e[n]),r)return r.value;throw new Error(`missing channel: ${t}`)}function gtt(e){if(e==null||typeof e=="function")return e;switch(`${e}`.toLowerCase()){case"ascending":return wO;case"descending":return vO}throw new Error(`invalid order: ${e}`)}function wO([e,t],[n,r]){return er(t,r)||er(e,n)}function vO([e,t],[n,r]){return Sp(t,r)||er(e,n)}function wb(e,t){let n=e[t];if(n){for(;n.source;)n=n.source;return n.source===null?null:n}}const xO=new Map([["accent",$K],["category10",TK],["dark2",NK],["observable10",RK],["paired",OK],["pastel1",DK],["pastel2",LK],["set1",FK],["set2",CK],["set3",kK],["tableau10",BK]]);function btt(e){return e!=null&&xO.has(`${e}`.toLowerCase())}const SO=new Map([...xO,["brbg",Yi(UN,zN)],["prgn",Yi(qN,jN)],["piyg",Yi(YN,VN)],["puor",Yi(WN,GN)],["rdbu",Yi(R1,up)],["rdgy",Yi(XN,HN)],["rdylbu",Yi(O1,lp)],["rdylgn",Yi(QN,JN)],["spectral",Yi(KN,ZN)],["burd",AO(R1,up)],["buylrd",AO(O1,lp)],["blues",Ce(A5,I5)],["greens",Ce(E5,M5)],["greys",Ce(T5,$5)],["oranges",Ce(L5,F5)],["purples",Ce(N5,R5)],["reds",Ce(O5,D5)],["turbo",Vi(q5)],["viridis",Vi(j5)],["magma",Vi(Y5)],["inferno",Vi(V5)],["plasma",Vi(W5)],["cividis",Vi(C5)],["cubehelix",Vi(k5)],["warm",Vi(B5)],["cool",Vi(P5)],["bugn",Ce(t5,e5)],["bupu",Ce(n5,r5)],["gnbu",Ce(i5,s5)],["orrd",Ce(o5,a5)],["pubu",Ce(l5,f5)],["pubugn",Ce(c5,u5)],["purd",Ce(h5,d5)],["rdpu",Ce(p5,y5)],["ylgn",Ce(b5,_5)],["ylgnbu",Ce(m5,g5)],["ylorbr",Ce(w5,v5)],["ylorrd",Ce(x5,S5)],["rainbow",IO(U5)],["sinebow",IO(z5)]]);function Ce(e,t){return({length:n})=>n===1?[e[3][1]]:n===2?[e[3][1],e[3][2]]:(n=Math.max(3,Math.floor(n)),n>9?mr(t,n):e[n])}function Yi(e,t){return({length:n})=>n===2?[e[3][0],e[3][2]]:(n=Math.max(3,Math.floor(n)),n>11?mr(t,n):e[n])}function AO(e,t){return({length:n})=>n===2?[e[3][2],e[3][0]]:(n=Math.max(3,Math.floor(n)),n>11?mr(r=>t(1-r),n):e[n].slice().reverse())}function Vi(e){return({length:t})=>mr(e,Math.max(2,Math.floor(t)))}function IO(e){return({length:t})=>mr(e,Math.floor(t)+1).slice(0,-1)}function EO(e){const t=`${e}`.toLowerCase();if(!SO.has(t))throw new Error(`unknown ordinal scheme: ${t}`);return SO.get(t)}function zp(e,t){const n=EO(e),r=typeof n=="function"?n({length:t}):n;return r.length!==t?r.slice(0,t):r}function _tt(e,t="greys"){const n=new Set,[r,i]=zp(t,2);for(const s of e)if(s!=null)if(s===!0)n.add(i);else if(s===!1)n.add(r);else return;return[...n]}const MO=new Map([["brbg",zN],["prgn",jN],["piyg",VN],["puor",GN],["rdbu",up],["rdgy",HN],["rdylbu",lp],["rdylgn",JN],["spectral",ZN],["burd",e=>up(1-e)],["buylrd",e=>lp(1-e)],["blues",I5],["greens",M5],["greys",$5],["purples",R5],["reds",D5],["oranges",F5],["turbo",q5],["viridis",j5],["magma",Y5],["inferno",V5],["plasma",W5],["cividis",C5],["cubehelix",k5],["warm",B5],["cool",P5],["bugn",e5],["bupu",r5],["gnbu",s5],["orrd",a5],["pubugn",u5],["pubu",f5],["purd",d5],["rdpu",y5],["ylgnbu",g5],["ylgn",_5],["ylorbr",v5],["ylorrd",S5],["rainbow",U5],["sinebow",z5]]);function vb(e){const t=`${e}`.toLowerCase();if(!MO.has(t))throw new Error(`unknown quantitative scheme: ${t}`);return MO.get(t)}const wtt=new Set(["brbg","prgn","piyg","puor","rdbu","rdgy","rdylbu","rdylgn","spectral","burd","buylrd"]);function vtt(e){return e!=null&&wtt.has(`${e}`.toLowerCase())}const TO=e=>t=>e(1-t),xb=[0,1],$O=new Map([["number",Xe],["rgb",go],["hsl",iG],["hcl",aG],["lab",sG]]);function NO(e){const t=`${e}`.toLowerCase();if(!$O.has(t))throw new Error(`unknown interpolator: ${t}`);return $O.get(t)}function Il(e,t,n,{type:r,nice:i,clamp:s,zero:o,domain:a=DO(e,n),unknown:c,round:u,scheme:l,interval:h,range:f=ge.get(e)===_l?Ott(n,a):ge.get(e)===wl?Dtt(n,a):ge.get(e)===vl?xb:void 0,interpolate:d=ge.get(e)===qi?l==null&&f!==void 0?go:vb(l!==void 0?l:r==="cyclical"?"rainbow":"turbo"):u?mg:Xe,reverse:p}){if(a=RO(a),h=Xa(h,r),(r==="cyclical"||r==="sequential")&&(r="linear"),typeof d!="function"&&(d=NO(d)),p=!!p,f!==void 0){const y=a.length,g=(f=RO(f)).length;if(y!==g){if(d.length===1)throw new Error("invalid piecewise interpolator");d=od(d,f),f=void 0}}if(d.length===1?(p&&(d=TO(d),p=!1),f===void 0&&(f=Float64Array.from(a,(y,g)=>g/(a.length-1)),f.length===2&&(f=xb)),t.interpolate((f===xb?Ue:Ab)(d))):t.interpolate(d),o){const[y,g]=Ie(a);(y>0||g<0)&&(a=yl(a),(ja(a)||1)===Math.sign(y)?a[0]=0:a[a.length-1]=0)}return p&&(a=Gh(a)),t.domain(a).unknown(c),i&&(t.nice(xtt(i,r)),a=t.domain()),f!==void 0&&t.range(f),s&&t.clamp(s),{type:r,domain:a,range:f,scale:t,interpolate:d,interval:h}}function RO(e){return e=Ls(e),e.length>=2?e:[e[0],e[0]]}function xtt(e,t){return e===!0?void 0:typeof e=="number"?e:FZ(e,t)}function Stt(e,t,n){return Il(e,rp(),t,n)}function Att(e,t,n){return OO(e,t,{...n,exponent:.5})}function OO(e,t,{exponent:n=1,...r}){return Il(e,cN().exponent(n),t,{...r,type:"pow"})}function Itt(e,t,{base:n=10,domain:r=Ltt(t),...i}){return Il(e,eN().base(n),t,{...i,domain:r})}function Ett(e,t,{constant:n=1,...r}){return Il(e,sN().constant(n),t,r)}function Mtt(e,t,{range:n,quantiles:r=n===void 0?5:(n=[...n]).length,n:i=r,scheme:s="rdylbu",domain:o=Ftt(t),unknown:a,interpolate:c,reverse:u}){return n===void 0&&(n=c!==void 0?mr(c,i):ge.get(e)===qi?zp(s,i):void 0),o.length>0&&(o=uN(o,n===void 0?{length:i}:n).quantiles()),Sb(e,t,{domain:o,range:n,reverse:u,unknown:a})}function Ttt(e,t,{range:n,n:r=n===void 0?5:(n=[...n]).length,scheme:i="rdylbu",domain:s=DO(e,t),unknown:o,interpolate:a,reverse:c}){const[u,l]=Ie(s);let h;return n===void 0?(h=xs(u,l,r),h[0]<=u&&h.splice(0,1),h[h.length-1]>=l&&h.pop(),r=h.length+1,n=a!==void 0?mr(a,r):ge.get(e)===qi?zp(i,r):void 0):(h=mr(Xe(u,l),r+1).slice(1,-1),u instanceof Date&&(h=h.map(f=>new Date(f)))),ja(Ls(s))<0&&h.reverse(),Sb(e,t,{domain:h,range:n,reverse:c,unknown:o})}function Sb(e,t,{domain:n=[0],unknown:r,scheme:i="rdylbu",interpolate:s,range:o=s!==void 0?mr(s,n.length+1):ge.get(e)===qi?zp(i,n.length+1):void 0,reverse:a}){n=Ls(n);const c=ja(n);if(!isNaN(c)&&!$tt(n,c))throw new Error(`the ${e} scale has a non-monotonic domain`);return a&&(o=Gh(o)),{type:"threshold",scale:lN(c<0?Gh(n):n,o===void 0?[]:o).unknown(r),domain:n,range:o}}function $tt(e,t){for(let n=1,r=e.length,i=e[0];n<r;++n){const s=lo(i,i=e[n]);if(s!==0&&s!==t)return!1}return!0}function Ntt(e){return{type:"identity",scale:XZ(ge.get(e))?H$():t=>t}}function El(e,t=Ap){return e.length?[fe(e,({value:n})=>n===void 0?n:fe(n,t)),me(e,({value:n})=>n===void 0?n:me(n,t))]:[0,1]}function DO(e,t){const n=ge.get(e);return(n===_l||n===vl||n===wl?Rtt:El)(t)}function Rtt(e){return[0,e.length?me(e,({value:t})=>t===void 0?t:me(t,Ap)):1]}function Ott(e,t){const n=e.find(({radius:o})=>o!==void 0);if(n!==void 0)return[0,n.radius];const r=Ss(e,.5,({value:o})=>o===void 0?NaN:Ss(o,.25,Ci)),i=t.map(o=>3*Math.sqrt(o/r)),s=30/me(i);return s<1?i.map(o=>o*s):i}function Dtt(e,t){const n=wu(e,({value:s})=>s===void 0?NaN:wu(s,Math.abs)),r=t.map(s=>12*s/n),i=60/me(r);return i<1?r.map(s=>s*i):r}function Ltt(e){for(const{value:t}of e)if(t!==void 0)for(let n of t){if(n>0)return El(e,Ci);if(n<0)return El(e,Ip)}return[1,10]}function Ftt(e){const t=[];for(const{value:n}of e)if(n!==void 0)for(const r of n)t.push(r);return t}function Ab(e){return(t,n)=>r=>e(t+r*(n-t))}let Ib=0,Eb;function Ctt(){const e=Ib;return Ib=0,Eb=void 0,e}function Wi(e){e!==Eb&&(Eb=e,console.warn(e),++Ib)}function qp(e,t,n,r,{type:i,nice:s,clamp:o,domain:a=El(r),unknown:c,pivot:u=0,scheme:l,range:h,symmetric:f=!0,interpolate:d=ge.get(e)===qi?l==null&&h!==void 0?go:vb(l!==void 0?l:"rdbu"):Xe,reverse:p}){u=+u,a=Ls(a);let[y,g]=a;if(a.length>2&&Wi(`Warning: the diverging ${e} scale domain contains extra elements.`),lo(y,g)<0&&([y,g]=[g,y],p=!p),y=Math.min(y,u),g=Math.max(g,u),typeof d!="function"&&(d=NO(d)),h!==void 0&&(d=d.length===1?Ab(d)(...h):od(d,h)),p&&(d=TO(d)),f){const m=n.apply(u),b=m-n.apply(y),w=n.apply(g)-m;b<w?y=n.invert(m-w):b>w&&(g=n.invert(m+b))}return t.domain([y,u,g]).unknown(c).interpolator(d),o&&t.clamp(o),s&&t.nice(s),{type:i,domain:[y,g],pivot:u,interpolate:d,scale:t}}function ktt(e,t,n){return qp(e,CN(),ztt,t,n)}function Btt(e,t,n){return LO(e,t,{...n,exponent:.5})}function LO(e,t,{exponent:n=1,...r}){return qp(e,PN().exponent(n=+n),Ytt(n),t,{...r,type:"diverging-pow"})}function Ptt(e,t,{base:n=10,pivot:r=1,domain:i=El(t,r<0?Ip:Ci),...s}){return qp(e,kN().base(n=+n),qtt,t,{domain:i,pivot:r,...s})}function Utt(e,t,{constant:n=1,...r}){return qp(e,BN().constant(n=+n),Vtt(n),t,r)}const ztt={apply(e){return e},invert(e){return e}},qtt={apply:Math.log,invert:Math.exp},jtt={apply(e){return Math.sign(e)*Math.sqrt(Math.abs(e))},invert(e){return Math.sign(e)*(e*e)}};function Ytt(e){return e===.5?jtt:{apply(t){return Math.sign(t)*Math.pow(Math.abs(t),e)},invert(t){return Math.sign(t)*Math.pow(Math.abs(t),1/e)}}}function Vtt(e){return{apply(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))},invert(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}}function FO(e,t,n,r){return Il(e,t,n,r)}function Wtt(e,t,n){return FO(e,EK(),t,n)}function Gtt(e,t,n){return FO(e,MK(),t,n)}const Ml=Symbol("ordinal");function CO(e,t,n,{type:r,interval:i,domain:s,range:o,reverse:a,hint:c}){return i=Xa(i,r),s===void 0&&(s=BO(n,i,e)),(r==="categorical"||r===Ml)&&(r="ordinal"),a&&(s=Gh(s)),s=t.domain(s).domain(),o!==void 0&&(typeof o=="function"&&(o=o(s)),t.range(o)),{type:r,domain:s,range:o,scale:t,hint:c,interval:i}}function Xtt(e,t,{type:n,interval:r,domain:i,range:s,scheme:o,unknown:a,...c}){r=Xa(r,n),i===void 0&&(i=BO(t,r,e));let u;if(ge.get(e)===Fp)u=Jtt(t),s=s===void 0?Ktt(u):Kt(s,ob);else if(ge.get(e)===qi&&(s===void 0&&(n==="ordinal"||n===Ml)&&(s=_tt(i,o),s!==void 0&&(o=void 0)),o===void 0&&s===void 0&&(o=n==="ordinal"?"turbo":"observable10"),o!==void 0))if(s!==void 0){const l=vb(o),h=s[0],f=s[1]-s[0];s=({length:d})=>mr(p=>l(h+f*p),d)}else s=EO(o);if(a===_1)throw new Error(`implicit unknown on ${e} scale is not supported`);return CO(e,w1().unknown(a),t,{...c,type:n,domain:i,range:s,hint:u})}function Htt(e,t,{align:n=.5,padding:r=.5,...i}){return kO(aJ().align(n).padding(r),t,i,e)}function Qtt(e,t,{align:n=.5,padding:r=.1,paddingInner:i=r,paddingOuter:s=e==="fx"||e==="fy"?0:r,...o}){return kO(ep().align(n).paddingInner(i).paddingOuter(s),t,o,e)}function kO(e,t,n,r){let{round:i}=n;return i!==void 0&&e.round(i=!!i),e=CO(r,e,t,n),e.round=i,e}function BO(e,t,n){const r=new ba;for(const{value:i,domain:s}of e){if(s!==void 0)return s();if(i!==void 0)for(const o of i)r.add(o)}if(t!==void 0){const[i,s]=Ie(r).map(t.floor,t);return t.range(i,t.offset(s))}if(r.size>1e4&&ge.get(n)===ei)throw new Error(`implicit ordinal domain of ${n} scale has more than 10,000 values`);return Yh(r,er)}function PO(e,t){let n;for(const{hint:r}of e){const i=r?.[t];if(i!==void 0){if(n===void 0)n=i;else if(n!==i)return}}return n}function Jtt(e){return{fill:PO(e,"fill"),stroke:PO(e,"stroke")}}function Ktt(e){return he(e.fill)?JK:QK}function Mb(e,{label:t,inset:n=0,insetTop:r=n,insetRight:i=n,insetBottom:s=n,insetLeft:o=n,round:a,nice:c,clamp:u,zero:l,align:h,padding:f,projection:d,facet:{label:p=t}={},...y}={}){const g={};for(const[m,b]of e){const w=y[m],_=GO(m,b,{round:ge.get(m)===ei?a:void 0,nice:c,clamp:u,zero:l,align:h,padding:f,projection:d,...w});if(_){let{label:x=m==="fx"||m==="fy"?p:t,percent:v,transform:S,inset:A,insetTop:M=A!==void 0?A:m==="y"?r:0,insetRight:T=A!==void 0?A:m==="x"?i:0,insetBottom:I=A!==void 0?A:m==="y"?s:0,insetLeft:R=A!==void 0?A:m==="x"?o:0}=w||{};if(S==null)S=void 0;else if(typeof S!="function")throw new Error("invalid scale transform; not a function");_.percent=!!v,_.label=x===void 0?tet(b,_):x,_.transform=S,m==="x"||m==="fx"?(_.insetLeft=+R,_.insetRight=+T):(m==="y"||m==="fy")&&(_.insetTop=+M,_.insetBottom=+I),g[m]=_}}return g}function UO(e){const t={},n={scales:t};for(const[r,i]of Object.entries(e)){const{scale:s,type:o,interval:a,label:c}=i;t[r]=JO(i),n[r]=s,s.type=o,a!=null&&(s.interval=a),c!=null&&(s.label=c)}return n}function Ztt(e,t){const{x:n,y:r,fx:i,fy:s}=e,o=i||s?Tb(t):t;i&&jO(i,o),s&&YO(s,o);const a=i||s?qO(e,t):t;n&&jO(n,a),r&&YO(r,a)}function tet(e=[],t){let n;for(const{label:r}of e)if(r!==void 0){if(n===void 0)n=r;else if(n!==r)return}if(n!==void 0)return!Oo(t)&&t.percent&&(n=`${n} (%)`),{inferred:!0,toString:()=>n}}function zO(e){return Math.sign(ja(e.domain()))*Math.sign(ja(e.range()))}function Tb(e){const{marginTop:t,marginRight:n,marginBottom:r,marginLeft:i,width:s,height:o,facet:{marginTop:a,marginRight:c,marginBottom:u,marginLeft:l}}=e;return{marginTop:Math.max(t,a),marginRight:Math.max(n,c),marginBottom:Math.max(r,u),marginLeft:Math.max(i,l),width:s,height:o}}function qO({fx:e,fy:t},n){const{marginTop:r,marginRight:i,marginBottom:s,marginLeft:o,width:a,height:c}=Tb(n);return{marginTop:r,marginRight:i,marginBottom:s,marginLeft:o,width:e?e.scale.bandwidth()+o+i:a,height:t?t.scale.bandwidth()+r+s:c,facet:{width:a,height:c}}}function jO(e,t){if(e.range===void 0){const{insetLeft:n,insetRight:r}=e,{width:i,marginLeft:s=0,marginRight:o=0}=t,a=s+n,c=i-o-r;e.range=[a,Math.max(a,c)],Oo(e)||(e.range=WO(e)),e.scale.range(e.range)}VO(e)}function YO(e,t){if(e.range===void 0){const{insetTop:n,insetBottom:r}=e,{height:i,marginTop:s=0,marginBottom:o=0}=t,a=s+n,c=i-o-r;e.range=[Math.max(a,c),a],Oo(e)?e.range.reverse():e.range=WO(e),e.scale.range(e.range)}VO(e)}function VO(e){e.round===void 0&&ret(e)&&eet(e)<=30&&e.scale.round(!0)}function eet({scale:e}){const t=e.domain().length,[n,r]=e.range(),i=e.paddingInner?e.paddingInner():1,s=e.paddingOuter?e.paddingOuter():e.padding(),o=t-i,a=Math.abs(r-n)/Math.max(1,o+s*2);return(a-Math.floor(a))*o}function WO(e){const t=e.scale.domain().length+QO(e);if(!(t>2))return e.range;const[n,r]=e.range;return Array.from({length:t},(i,s)=>n+s/(t-1)*(r-n))}function $b(e,t,n){return GO(e,n===void 0?void 0:[{hint:n}],{...t})}function GO(e,t=[],n={}){const r=net(e,t,n);if(n.type===void 0&&n.domain===void 0&&n.range===void 0&&n.interval==null&&e!=="fx"&&e!=="fy"&&Oo({type:r})){const i=t.map(({value:s})=>s).filter(s=>s!==void 0);i.some(fn)?Wi(`Warning: some data associated with the ${e} scale are dates. Dates are typically associated with a "utc" or "time" scale rather than a "${Za(r)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can specify the interval of the ${e} scale (e.g., d3.utcDay), or you can suppress this warning by setting the type of the ${e} scale to "${Za(r)}".`):i.some(PZ)?Wi(`Warning: some data associated with the ${e} scale are strings that appear to be dates (e.g., YYYY-MM-DD). If these strings represent dates, you should parse them to Date objects. Dates are typically associated with a "utc" or "time" scale rather than a "${Za(r)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can suppress this warning by setting the type of the ${e} scale to "${Za(r)}".`):i.some(UZ)&&Wi(`Warning: some data associated with the ${e} scale are strings that appear to be numbers. If these strings represent numbers, you should parse or coerce them to numbers. Numbers are typically associated with a "linear" scale rather than a "${Za(r)}" scale. If you want to treat this data as ordinal, you can specify the interval of the ${e} scale (e.g., 1 for integers), or you can suppress this warning by setting the type of the ${e} scale to "${Za(r)}".`)}switch(n.type=r,r){case"diverging":case"diverging-sqrt":case"diverging-pow":case"diverging-log":case"diverging-symlog":case"cyclical":case"sequential":case"linear":case"sqrt":case"threshold":case"quantile":case"pow":case"log":case"symlog":n=jp(t,n,vn);break;case"identity":switch(ge.get(e)){case ei:n=jp(t,n,vn);break;case Fp:n=jp(t,n,iet);break}break;case"utc":case"time":n=jp(t,n,jR);break}switch(r){case"diverging":return ktt(e,t,n);case"diverging-sqrt":return Btt(e,t,n);case"diverging-pow":return LO(e,t,n);case"diverging-log":return Ptt(e,t,n);case"diverging-symlog":return Utt(e,t,n);case"categorical":case"ordinal":case Ml:return Xtt(e,t,n);case"cyclical":case"sequential":case"linear":return Stt(e,t,n);case"sqrt":return Att(e,t,n);case"threshold":return Sb(e,t,n);case"quantile":return Mtt(e,t,n);case"quantize":return Ttt(e,t,n);case"pow":return OO(e,t,n);case"log":return Itt(e,t,n);case"symlog":return Ett(e,t,n);case"utc":return Gtt(e,t,n);case"time":return Wtt(e,t,n);case"point":return Htt(e,t,n);case"band":return Qtt(e,t,n);case"identity":return Ntt(e);case void 0:return;default:throw new Error(`unknown scale type: ${r}`)}}function Za(e){return typeof e=="symbol"?e.description:e}function XO(e){return typeof e=="string"?`${e}`.toLowerCase():e}const HO={toString:()=>"projection"};function net(e,t,{type:n,domain:r,range:i,scheme:s,pivot:o,projection:a}){if(n=XO(n),e==="fx"||e==="fy")return"band";(e==="x"||e==="y")&&a!=null&&(n=HO);for(const l of t){const h=XO(l.type);if(h!==void 0){if(n===void 0)n=h;else if(n!==h)throw new Error(`scale incompatible with channel: ${n} !== ${h}`)}}if(n===HO)return;if(n!==void 0)return n;if(r===void 0&&!t.some(({value:l})=>l!==void 0))return;const c=ge.get(e);if(c===_l)return"sqrt";if(c===vl||c===wl)return"linear";if(c===Fp)return"ordinal";const u=(r??i)?.length;if(u<2||u>2)return Nb(c);if(r!==void 0){if(we(r))return Nb(c);if(fn(r))return"utc"}else{const l=t.map(({value:h})=>h).filter(h=>h!==void 0);if(l.some(we))return Nb(c);if(l.some(fn))return"utc"}if(c===qi){if(o!=null||vtt(s))return"diverging";if(btt(s))return"categorical"}return"linear"}function Nb(e){switch(e){case ei:return"point";case qi:return Ml;default:return"ordinal"}}function Oo({type:e}){return e==="ordinal"||e==="point"||e==="band"||e===Ml}function QO({type:e}){return e==="threshold"}function ret({type:e}){return e==="point"||e==="band"}function ni(e){if(e===void 0)return!0;const t=e.domain(),n=e(t[0]);for(let r=1,i=t.length;r<i;++r)if(e(t[r])-n)return!1;return!0}function jp(e,{domain:t,...n},r){for(const i of e)i.value!==void 0&&(t===void 0&&(t=i.value?.domain),i.value=r(i.value));return{domain:t===void 0?t:r(t),...n}}function iet(e){return Kt(e,ob)}function Tl(e={}){let t;for(const n in e)if(ge.has(n)&&$o(e[n])){if(t!==void 0)throw new Error("ambiguous scale definition; multiple scales found");t=JO($b(n,e[n]))}if(t===void 0)throw new Error("invalid scale definition; no scale found");return t}function set(e){return t=>{if(!ge.has(t=`${t}`))throw new Error(`unknown scale: ${t}`);return e[t]}}function JO({scale:e,type:t,domain:n,range:r,interpolate:i,interval:s,transform:o,percent:a,pivot:c}){if(t==="identity")return{type:"identity",apply:l=>l,invert:l=>l};const u=e.unknown?e.unknown():void 0;return{type:t,domain:yl(n),...r!==void 0&&{range:yl(r)},...o!==void 0&&{transform:o},...a&&{percent:a},...u!==void 0&&{unknown:u},...s!==void 0&&{interval:s},...i!==void 0&&{interpolate:i},...e.clamp&&{clamp:e.clamp()},...c!==void 0&&{pivot:c,symmetric:!1},...e.base&&{base:e.base()},...e.exponent&&{exponent:e.exponent()},...e.constant&&{constant:e.constant()},...e.align&&{align:e.align(),round:e.round()},...e.padding&&(e.paddingInner?{paddingInner:e.paddingInner(),paddingOuter:e.paddingOuter()}:{padding:e.padding()}),...e.bandwidth&&{bandwidth:e.bandwidth(),step:e.step()},apply:l=>e(l),...e.invert&&{invert:l=>e.invert(l)}}}function oet(e,t){const{fx:n,fy:r}=Mb(e,t),i=n?.scale.domain(),s=r?.scale.domain();return i&&s?bY(i,s).map(([o,a],c)=>({x:o,y:a,i:c})):i?i.map((o,a)=>({x:o,i:a})):s?s.map((o,a)=>({y:o,i:a})):void 0}function aet(e,{x:t,y:n}){return t&&=Ob(t),n&&=Ob(n),e.filter(t&&n?r=>t.has(r.x)&&n.has(r.y):t?r=>t.has(r.x):r=>n.has(r.y)).sort(t&&n?(r,i)=>t.get(r.x)-t.get(i.x)||n.get(r.y)-n.get(i.y):t?(r,i)=>t.get(r.x)-t.get(i.x):(r,i)=>n.get(r.y)-n.get(i.y))}function Rb(e,{fx:t,fy:n}){const r=Pi(e),i=t?.value,s=n?.value;return t&&n?_a(r,o=>(o.fx=i[o[0]],o.fy=s[o[0]],o),o=>i[o],o=>s[o]):t?_a(r,o=>(o.fx=i[o[0]],o),o=>i[o]):_a(r,o=>(o.fy=s[o[0]],o),o=>s[o])}function cet(e,t,{marginTop:n,marginLeft:r}){const i=e?({x:o})=>e(o)-r:()=>0,s=t?({y:o})=>t(o)-n:()=>0;return function(o){this.tagName==="svg"?(this.setAttribute("x",i(o)),this.setAttribute("y",s(o))):this.setAttribute("transform",`translate(${i(o)},${s(o)})`)}}function uet(e){const t=[],n=new Uint32Array(dr(e,r=>r.length));for(const r of e){let i=0;for(const s of e)r!==s&&(n.set(s,i),i+=s.length);t.push(n.slice(0,i))}return t}const fet=new Map([["top",Db],["right",Cb],["bottom",Lb],["left",Fb],["top-left",Vp(Db,Fb)],["top-right",Vp(Db,Cb)],["bottom-left",Vp(Lb,Fb)],["bottom-right",Vp(Lb,Cb)],["top-empty",pet],["right-empty",get],["bottom-empty",yet],["left-empty",met],["empty",bet]]);function het(e){if(e==null)return null;const t=fet.get(`${e}`.toLowerCase());if(t)return t;throw new Error(`invalid facet anchor: ${e}`)}const KO=new WeakMap;function Ob(e){let t=KO.get(e);return t||KO.set(e,t=new fo(Kt(e,(n,r)=>[n,r]))),t}function Bs(e,t){return Ob(e).get(t)}function det(e,t,n){return t=Ui(t),n=Ui(n),e.find(r=>Object.is(Ui(r.x),t)&&Object.is(Ui(r.y),n))}function Yp(e,t,n){return det(e,t,n)?.empty}function Db(e,{y:t},{y:n}){return t?Bs(t,n)===0:!0}function Lb(e,{y:t},{y:n}){return t?Bs(t,n)===t.length-1:!0}function Fb(e,{x:t},{x:n}){return t?Bs(t,n)===0:!0}function Cb(e,{x:t},{x:n}){return t?Bs(t,n)===t.length-1:!0}function pet(e,{y:t},{x:n,y:r,empty:i}){if(i)return!1;if(!t)return;const s=Bs(t,r);if(s>0)return Yp(e,n,t[s-1])}function yet(e,{y:t},{x:n,y:r,empty:i}){if(i)return!1;if(!t)return;const s=Bs(t,r);if(s<t.length-1)return Yp(e,n,t[s+1])}function met(e,{x:t},{x:n,y:r,empty:i}){if(i)return!1;if(!t)return;const s=Bs(t,n);if(s>0)return Yp(e,t[s-1],r)}function get(e,{x:t},{x:n,y:r,empty:i}){if(i)return!1;if(!t)return;const s=Bs(t,n);if(s<t.length-1)return Yp(e,t[s+1],r)}function bet(e,t,{empty:n}){return n}function Vp(e,t){return function(){return e.apply(null,arguments)&&t.apply(null,arguments)}}function kb(e,{channels:{fx:t,fy:n},groups:r}){return t&&n?e.map(({x:i,y:s})=>r.get(i)?.get(s)??[]):t?e.map(({x:i})=>r.get(i)??[]):e.map(({y:i})=>r.get(i)??[])}const ZO=Math.PI,Gi=2*ZO,Bb=.618;function _et({projection:e,inset:t=0,insetTop:n=t,insetRight:r=t,insetBottom:i=t,insetLeft:s=t}={},o){if(e==null)return;if(typeof e.stream=="function")return e;let a,c,u="frame";if(Ln(e)){let x;if({type:e,domain:c,inset:x,insetTop:n=x!==void 0?x:n,insetRight:r=x!==void 0?x:r,insetBottom:i=x!==void 0?x:i,insetLeft:s=x!==void 0?x:s,clip:u=u,...a}=e,e==null)return}typeof e!="function"&&({type:e}=Pb(e));const{width:l,height:h,marginLeft:f,marginRight:d,marginTop:p,marginBottom:y}=o,g=l-f-d-s-r,m=h-p-y-n-i;if(e=e?.({width:g,height:m,clip:u,...a}),e==null)return;u=wet(u,f,p,l-d,h-y);let b=f+s,w=p+n,_;if(c!=null){const[[x,v],[S,A]]=qu(e).bounds(c),M=Math.min(g/(S-x),m/(A-v));M>0?(b-=(M*(x+S)-g)/2,w-=(M*(v+A)-m)/2,_=Vd({point(T,I){this.stream.point(T*M+b,I*M+w)}})):Wi("Warning: the projection could not be fit to the specified domain; using the default scale.")}return _??=b===0&&w===0?tD():Vd({point(x,v){this.stream.point(x+b,v+w)}}),{stream:x=>e.stream(_.stream(u(x)))}}function Pb(e){switch(`${e}`.toLowerCase()){case"albers-usa":return Ir(cQ,.7463,.4673);case"albers":return Wp($$,.7463,.4673);case"azimuthal-equal-area":return Ir(uQ,4,4);case"azimuthal-equidistant":return Ir(lQ,Gi,Gi);case"conic-conformal":return Wp(dQ,Gi,Gi);case"conic-equal-area":return Wp(Gd,6.1702,2.9781);case"conic-equidistant":return Wp(mQ,7.312,3.6282);case"equal-earth":return Ir(bQ,5.4133,2.6347);case"equirectangular":return Ir(pQ,Gi,ZO);case"gnomonic":return Ir(_Q,3.4641,3.4641);case"identity":return{type:tD};case"reflect-y":return{type:vet};case"mercator":return Ir(fQ,Gi,Gi);case"orthographic":return Ir(wQ,2,2);case"stereographic":return Ir(vQ,2,2);case"transverse-mercator":return Ir(xQ,Gi,Gi);default:throw new Error(`unknown projection type: ${e}`)}}function wet(e,t,n,r,i){if(e===!1||e==null||typeof e=="number")return s=>s;switch(e===!0&&(e="frame"),`${e}`.toLowerCase()){case"frame":return n$(t,n,r,i);default:throw new Error(`unknown projection clip type: ${e}`)}}function Ir(e,t,n){return{type:({width:r,height:i,rotate:s,precision:o=.15,clip:a})=>{const c=e();return o!=null&&c.precision?.(o),s!=null&&c.rotate?.(s),typeof a=="number"&&c.clipAngle?.(a),r!=null&&(c.scale(Math.min(r/t,i/n)),c.translate([r/2,i/2])),c},aspectRatio:n/t}}function Wp(e,t,n){const{type:r,aspectRatio:i}=Ir(e,t,n);return{type:s=>{const{parallels:o,domain:a,width:c,height:u}=s,l=r(s);return o!=null&&(l.parallels(o),a===void 0&&c!=null&&l.fitSize([c,u],{type:"Sphere"})),l},aspectRatio:i}}const tD=Ue({stream:e=>e}),vet=Ue(Vd({point(e,t){this.stream.point(e,-t)}}));function eD(e,t,n,r){const i=n[e],s=n[t],o=i.length,a=n[e]=new Float64Array(o).fill(NaN),c=n[t]=new Float64Array(o).fill(NaN);let u;const l=r.stream({point(h,f){a[u]=h,c[u]=f}});for(u=0;u<o;++u)l.point(i[u],s[u])}function xet({projection:e}={}){return e==null?!1:typeof e.stream=="function"?!0:(Ln(e)&&(e=e.type),e!=null)}function Aet(e){if(typeof e?.stream=="function")return Bb;if(Ln(e)){let t,n;if({domain:t,type:e,...n}=e,t!=null&&e!=null){const r=typeof e=="string"?Pb(e).type:e,[[i,s],[o,a]]=qu(r({...n,width:100,height:100})).bounds(t),c=(a-s)/(o-i);return c&&isFinite(c)?c<.2?.2:c>5?5:c:Bb}}if(e!=null){if(typeof e!="function"){const{aspectRatio:t}=Pb(e);if(t)return t}return Bb}}function $l(e,t,{projection:n}){const{x:r,y:i}=e;let s={};return r&&(s.x=r),i&&(s.y=i),s=Up(s,t),n&&r?.scale==="x"&&i?.scale==="y"&&eD("x","y",s,n),r&&(s.x=vn(s.x)),i&&(s.y=vn(s.y)),s}function Iet(e){const t=[],n=[],r={scale:"x",value:t},i={scale:"y",value:n},s={point(o,a){t.push(o),n.push(a)},lineStart(){},lineEnd(){},polygonStart(){},polygonEnd(){},sphere(){}};for(const o of e.value)Ts(o,s);return[r,i]}function Eet({x:e,y:t}){if(e||t)return e??=n=>n,t??=n=>n,Vd({point(n,r){this.stream.point(e(n),t(r))}})}function Gp(e={}){const{document:t=typeof window<"u"?window.document:void 0,clip:n}=e;return{document:t,clip:tO(n)}}function Ft(e,{document:t}){return oe(Jh(e).call(t.documentElement))}const Ub=Symbol("unset");function tc(e){return(e.length===1?Met:Tet)(e)}function Met(e){let t,n=Ub;return r=>(Object.is(n,r)||(n=r,t=e(r)),t)}function Tet(e){let t,n;return(...r)=>((n?.length!==r.length||n.some((i,s)=>!Object.is(i,r[s])))&&(n=r,t=e(...r)),t)}const $et=tc(e=>new Intl.NumberFormat(e)),Net=tc((e,t)=>new Intl.DateTimeFormat(e,{timeZone:"UTC",...t&&{month:t}})),Ret=tc((e,t)=>new Intl.DateTimeFormat(e,{timeZone:"UTC",...t&&{weekday:t}}));function nD(e="en-US"){const t=$et(e);return n=>n!=null&&!isNaN(n)?t.format(n):void 0}function Oet(e="en-US",t="short"){const n=Net(e,t);return r=>r!=null&&!isNaN(r=+new Date(Date.UTC(2e3,+r)))?n.format(r):void 0}function Det(e="en-US",t="short"){const n=Ret(e,t);return r=>r!=null&&!isNaN(r=+new Date(Date.UTC(2001,0,+r)))?n.format(r):void 0}function rD(e){return xZ(e,"Invalid Date")}function Let(e="en-US"){const t=nD(e);return n=>(n instanceof Date?rD:typeof n=="number"?t:Pe)(n)}const ec=Let(),ze=(typeof window<"u"?window.devicePixelRatio>1:typeof it>"u")?0:.5;let Fet=0,Cet=0;function zb(){return`plot-clip-${++Fet}`}function ket(){return`plot-pattern-${++Cet}`}function iD(e,{title:t,href:n,ariaLabel:r,ariaDescription:i,ariaHidden:s,target:o,fill:a,fillOpacity:c,stroke:u,strokeWidth:l,strokeOpacity:h,strokeLinejoin:f,strokeLinecap:d,strokeMiterlimit:p,strokeDasharray:y,strokeDashoffset:g,opacity:m,mixBlendMode:b,imageFilter:w,paintOrder:_,pointerEvents:x,shapeRendering:v,channels:S},{ariaLabel:A,fill:M="currentColor",fillOpacity:T,stroke:I="none",strokeOpacity:R,strokeWidth:L,strokeLinecap:E,strokeLinejoin:$,strokeMiterlimit:N,paintOrder:D}){M===null&&(a=null,c=null),I===null&&(u=null,h=null),he(M)?!he(I)&&(!he(a)||S?.fill)&&(I="none"):he(I)&&(!he(u)||S?.stroke)&&(M="none");const[k,C]=ln(a,M),[B,P]=Se(c,T),[q,V]=ln(u,I),[G,Q]=Se(h,R),[K,Y]=Se(m);Ka(V)||(l===void 0&&(l=L),d===void 0&&(d=E),f===void 0&&(f=$),p===void 0&&!jZ(f)&&(p=N),!Ka(C)&&_===void 0&&(_=D));const[J,z]=Se(l);return M!==null&&(e.fill=Me(C,"currentColor"),e.fillOpacity=Nl(P,1)),I!==null&&(e.stroke=Me(V,"none"),e.strokeWidth=Nl(z,1),e.strokeOpacity=Nl(Q,1),e.strokeLinejoin=Me(f,"miter"),e.strokeLinecap=Me(d,"butt"),e.strokeMiterlimit=Nl(p,4),e.strokeDasharray=Me(y,"none"),e.strokeDashoffset=Me(g,"0")),e.target=Pe(o),e.ariaLabel=Pe(A),e.ariaDescription=Pe(i),e.ariaHidden=Pe(s),e.opacity=Nl(Y,1),e.mixBlendMode=Me(b,"normal"),e.imageFilter=Me(w,"none"),e.paintOrder=Me(_,"normal"),e.pointerEvents=Me(x,"auto"),e.shapeRendering=Me(v,"auto"),{title:{value:t,optional:!0,filter:null},href:{value:n,optional:!0,filter:null},ariaLabel:{value:r,optional:!0,filter:null},fill:{value:k,scale:"auto",optional:!0},fillOpacity:{value:B,scale:"auto",optional:!0},stroke:{value:q,scale:"auto",optional:!0},strokeOpacity:{value:G,scale:"auto",optional:!0},strokeWidth:{value:J,optional:!0},opacity:{value:K,scale:"auto",optional:!0}}}function Bet(e,t){t&&e.filter(n=>j1(t[n])).append("title").call(Uet,t)}function Pet(e,t){t&&e.filter(([n])=>j1(t[n])).append("title").call(zet,t)}function Uet(e,t){t&&e.text(n=>ec(t[n]))}function zet(e,t){t&&e.text(([n])=>ec(t[n]))}function be(e,{target:t,tip:n},{ariaLabel:r,title:i,fill:s,fillOpacity:o,stroke:a,strokeOpacity:c,strokeWidth:u,opacity:l,href:h}){r&&ut(e,"aria-label",f=>r[f]),s&&ut(e,"fill",f=>s[f]),o&&ut(e,"fill-opacity",f=>o[f]),a&&ut(e,"stroke",f=>a[f]),c&&ut(e,"stroke-opacity",f=>c[f]),u&&ut(e,"stroke-width",f=>u[f]),l&&ut(e,"opacity",f=>l[f]),h&&aD(e,f=>h[f],t),n||Bet(e,i)}function Xp(e,{target:t,tip:n},{ariaLabel:r,title:i,fill:s,fillOpacity:o,stroke:a,strokeOpacity:c,strokeWidth:u,opacity:l,href:h}){r&&ut(e,"aria-label",([f])=>r[f]),s&&ut(e,"fill",([f])=>s[f]),o&&ut(e,"fill-opacity",([f])=>o[f]),a&&ut(e,"stroke",([f])=>a[f]),c&&ut(e,"stroke-opacity",([f])=>c[f]),u&&ut(e,"stroke-width",([f])=>u[f]),l&&ut(e,"opacity",([f])=>l[f]),h&&aD(e,([f])=>h[f],t),n||Pet(e,i)}function qet({ariaLabel:e,title:t,fill:n,fillOpacity:r,stroke:i,strokeOpacity:s,strokeWidth:o,opacity:a,href:c},{tip:u}){return[e,u?void 0:t,n,r,i,s,o,a,c].filter(l=>l!==void 0)}function qb(e,t,n){const r=vs(e,i=>t[i]);return n===void 0&&r.size>1+e.length>>1&&Wi("Warning: the implicit z channel has high cardinality. This may occur when the fill or stroke channel is associated with quantitative data rather than ordinal or categorical data. You can suppress this warning by setting the z option explicitly; if this data represents a single series, set z to null."),r.values()}function*sD(e,t,n,r){const{z:i}=n,{z:s}=r,o=qet(r,n),a=[...t,...o];for(const c of s?qb(e,s,i):[e]){let u,l;t:for(const h of c){for(const f of a)if(!Be(f[h])){l&&l.push(-1);continue t}if(u===void 0){l&&(yield l),u=o.map(f=>Ui(f[h])),l=[h];continue}l.push(h);for(let f=0;f<o.length;++f)if(Ui(o[f][h])!==u[f]){yield l,u=o.map(p=>Ui(p[h])),l=[h];continue t}}l&&(yield l)}}function jet(e,t,n,r){let i;const{clip:s=r.clip}=t;s==="frame"?(e=Ft("svg:g",r).each(function(){this.appendChild(e.node()),e.node=()=>this}),i=Vet(r,n)):s&&(i=Get(s,r)),ut(e,"aria-label",t.ariaLabel),ut(e,"aria-description",t.ariaDescription),ut(e,"aria-hidden",t.ariaHidden),ut(e,"clip-path",i)}function Yet(e){const t=new WeakMap;return(n,r)=>{let i=t.get(n);if(!i){const s=zb();oe(n.ownerSVGElement).append("clipPath").attr("id",s).call(e,n,r),t.set(n,i=`url(#${s})`)}return i}}const Vet=Yet((e,t,n)=>{const{width:r,height:i,marginLeft:s,marginRight:o,marginTop:a,marginBottom:c}=n;e.append("rect").attr("x",s).attr("y",a).attr("width",r-o-s).attr("height",i-a-c)}),oD=new WeakMap,Wet={type:"Sphere"};function Get(e,t){let n,r;if((n=oD.get(t))||oD.set(t,n=new WeakMap),e.type==="Sphere"&&(e=Wet),!(r=n.get(e))){const i=zb();oe(t.ownerSVGElement).append("clipPath").attr("id",i).append("path").attr("d",t.path()(e)),n.set(e,r=`url(#${i})`)}return r}function ce(e,t,n,r){jet(e,t,n,r),ut(e,"class",t.className),ut(e,"fill",t.fill),ut(e,"fill-opacity",t.fillOpacity),ut(e,"stroke",t.stroke),ut(e,"stroke-width",t.strokeWidth),ut(e,"stroke-opacity",t.strokeOpacity),ut(e,"stroke-linejoin",t.strokeLinejoin),ut(e,"stroke-linecap",t.strokeLinecap),ut(e,"stroke-miterlimit",t.strokeMiterlimit),ut(e,"stroke-dasharray",t.strokeDasharray),ut(e,"stroke-dashoffset",t.strokeDashoffset),ut(e,"shape-rendering",t.shapeRendering),ut(e,"filter",t.imageFilter),ut(e,"paint-order",t.paintOrder);const{pointerEvents:i=r.pointerSticky===!1?"none":void 0}=t;ut(e,"pointer-events",i)}function Gt(e,t){Xet(e,"mix-blend-mode",t.mixBlendMode),ut(e,"opacity",t.opacity)}function aD(e,t,n){e.each(function(r){const i=t(r);if(i!=null){const s=this.ownerDocument.createElementNS(Ai.svg,"a");s.setAttribute("fill","inherit"),s.setAttributeNS(Ai.xlink,"href",i),n!=null&&s.setAttribute("target",n),this.parentNode.insertBefore(s,this).appendChild(this)}})}function ut(e,t,n){n!=null&&e.attr(t,n)}function Xet(e,t,n){n!=null&&e.style(t,n)}function Zt(e,t,{x:n,y:r},i=ze,s=ze){i+=t.dx,s+=t.dy,n?.bandwidth&&(i+=n.bandwidth()/2),r?.bandwidth&&(s+=r.bandwidth()/2),(i||s)&&e.attr("transform",`translate(${i},${s})`)}function Me(e,t){if((e=Pe(e))!==t)return e}function Nl(e,t){if((e=ae(e))!==t)return e}const Het=/^-?([_a-z]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])([_a-z0-9-]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])*$/i;function jb(e){if(e===void 0)return"plot-d6a7b5";if(e=`${e}`,!Het.test(e))throw new Error(`invalid class name: ${e}`);return e}function Yb(e,t){if(typeof t=="string")e.property("style",t);else if(t!=null)for(const n of e)Object.assign(n.style,t)}function ri({frameAnchor:e},{width:t,height:n,marginTop:r,marginRight:i,marginBottom:s,marginLeft:o}){return[/left$/.test(e)?o:/right$/.test(e)?t-i:(o+t-i)/2,/^top/.test(e)?r:/^bottom/.test(e)?n-s:(r+n-s)/2]}let te=class{constructor(t,n={},r={},i){const{facet:s="auto",facetAnchor:o,fx:a,fy:c,sort:u,dx:l=0,dy:h=0,margin:f=0,marginTop:d=f,marginRight:p=f,marginBottom:y=f,marginLeft:g=f,className:m,clip:b=i?.clip,channels:w,tip:_,render:x}=r;if(this.data=t,this.sort=Fs(u)?u:null,this.initializer=Ke(r).initializer,this.transform=this.initializer?r.transform:Ar(r).transform,s===null||s===!1?this.facet=null:(this.facet=Dn(s===!0?"include":s,"facet",["auto","include","exclude","super"]),this.fx=t===dl&&typeof a=="string"?[a]:a,this.fy=t===dl&&typeof c=="string"?[c]:c),this.facetAnchor=het(o),n=rb(n),w!==void 0&&(n={...Qet(w),...n}),i!==void 0&&(n={...iD(this,r,i),...n}),this.channels=Object.fromEntries(Object.entries(n).map(([v,S])=>{if(Zr(S.value)){const{value:A,label:M=S.label,scale:T=S.scale}=S.value;S={...S,label:M,scale:T,value:A}}if(t===dl&&typeof S.value=="string"){const{value:A}=S;S={...S,value:[A]}}return[v,S]}).filter(([v,{value:S,optional:A}])=>{if(S!=null)return!0;if(A)return!1;throw new Error(`missing channel value: ${v}`)})),this.dx=+l,this.dy=+h,this.marginTop=+d,this.marginRight=+p,this.marginBottom=+y,this.marginLeft=+g,this.clip=tO(b),this.tip=Jet(_),this.className=Pe(m),this.facet==="super"){if(a||c)throw new Error("super-faceting cannot use fx or fy");for(const v in this.channels){const{scale:S}=n[v];if(!(S!=="x"&&S!=="y"))throw new Error("super-faceting cannot use x or y")}}x!=null&&(this.render=Rl(x,this.render))}initialize(t,n,r){let i=Wa(this.data);t===void 0&&i!=null&&(t=[Pi(i)]);const s=t;this.transform!=null&&({facets:t,data:i}=this.transform(i,t,r),i=Wa(i)),t!==void 0&&(t.original=s);const o=gO(this.channels,i);return this.sort!=null&&ptt(i,t,o,n,this.sort),{data:i,facets:t,channels:o}}filter(t,n,r){for(const i in n){const{filter:s=Be}=n[i];if(s!==null){const o=r[i];t=t.filter(a=>s(o[a]))}}return t}project(t,n,r){for(const i in t)if(t[i].scale==="x"&&/^x|x$/.test(i)){const s=i.replace(/^x|x$/,"y");s in t&&t[s].scale==="y"&&eD(i,s,n,r.projection)}}scale(t,n,r){const i=Up(t,n);return r.projection&&this.project(t,i,r),i}};function nr(...e){return e.plot=te.prototype.plot,e}function Rl(e,t){if(e==null)return t===null?void 0:t;if(t==null)return e===null?void 0:e;if(typeof e!="function")throw new TypeError(`invalid render transform: ${e}`);if(typeof t!="function")throw new TypeError(`invalid render transform: ${t}`);return function(n,r,i,s,o,a){return e.call(this,n,r,i,s,o,(c,u,l,h,f)=>t.call(this,c,u,l,h,f,a))}}function Qet(e){return Object.fromEntries(Object.entries(rb(e)).map(([t,n])=>(n=typeof n=="string"?{value:n,label:t}:Qa(n),n.filter===void 0&&n.scale==null&&(n={...n,filter:null}),[t,n])))}function Jet(e){return e===!0?"xy":e===!1||e==null?null:typeof e=="string"?Dn(e,"tip",["x","y","xy"]):e}function Do(e,t){return e?.tip===!0?{...e,tip:t}:Ln(e?.tip)&&e.tip.pointer===void 0?{...e,tip:{...e.tip,pointer:t}}:e}function Ket(e,t,n={}){let r=.5-ze,i=.5+ze,s=.5+ze,o=.5-ze;for(const{marginTop:y,marginRight:g,marginBottom:m,marginLeft:b}of t)y>r&&(r=y),g>i&&(i=g),m>s&&(s=m),b>o&&(o=b);let{margin:a,marginTop:c=a!==void 0?a:r,marginRight:u=a!==void 0?a:i,marginBottom:l=a!==void 0?a:s,marginLeft:h=a!==void 0?a:o}=n;c=+c,u=+u,l=+l,h=+h;let{width:f=640,height:d=Zet(e,n,{width:f,marginTopDefault:r,marginRightDefault:i,marginBottomDefault:s,marginLeftDefault:o})+Math.max(0,c-r+l-s)}=n;f=+f,d=+d;const p={width:f,height:d,marginTop:c,marginRight:u,marginBottom:l,marginLeft:h};if(e.fx||e.fy){let{margin:y,marginTop:g=y!==void 0?y:c,marginRight:m=y!==void 0?y:u,marginBottom:b=y!==void 0?y:l,marginLeft:w=y!==void 0?y:h}=n.facet??{};g=+g,m=+m,b=+b,w=+w,p.facet={marginTop:g,marginRight:m,marginBottom:b,marginLeft:w}}return p}function Zet({x:e,y:t,fy:n,fx:r},{projection:i,aspectRatio:s},{width:o,marginTopDefault:a,marginRightDefault:c,marginBottomDefault:u,marginLeftDefault:l}){const h=n&&n.scale.domain().length||1,f=Aet(i);if(f){const p=r?r.scale.domain().length:1,y=(1.1*h-.1)/(1.1*p-.1)*f,g=Math.max(.1,Math.min(10,y));return Math.round((o-l-c)*g+a+u)}const d=t?Oo(t)?t.scale.domain().length||1:Math.max(7,17/h):1;if(s!=null){if(s=+s,!(isFinite(s)&&s>0))throw new Error(`invalid aspectRatio: ${s}`);const p=cD("y",t)/(cD("x",e)*s),y=r?r.scale.bandwidth():1,g=n?n.scale.bandwidth():1,m=y*(o-l-c)-e.insetLeft-e.insetRight;return(p*m+t.insetTop+t.insetBottom)/g+a+u}return!!(t||n)*Math.max(1,Math.min(60,d*h))*20+!!r*30+60}function cD(e,t){if(!t)throw new Error(`aspectRatio requires ${e} scale`);const{type:n,domain:r}=t;let i;switch(n){case"linear":case"utc":case"time":i=Number;break;case"pow":{const a=t.scale.exponent();i=c=>Math.pow(c,a);break}case"log":i=Math.log;break;case"point":case"band":return r.length;default:throw new Error(`unsupported ${e} scale for aspectRatio: ${n}`)}const[s,o]=Ie(r);return Math.abs(i(o)-i(s))}const uD=new WeakMap;function Vb(e,t,{x:n,y:r,px:i,py:s,maxRadius:o=40,channels:a,render:c,...u}={}){return o=+o,i!=null&&(n??=null,a={...a,px:{value:i,scale:"x"}}),s!=null&&(r??=null,a={...a,py:{value:s,scale:"y"}}),{x:n,y:r,channels:a,...u,render:Rl(function(l,h,f,d,p,y){p={...p,pointerSticky:!1};const g=p.ownerSVGElement,{data:m}=p.getMarkState(this);let b=uD.get(g);b||uD.set(g,b={sticky:!1,roots:[],renders:[]});let w=b.renders.push(V)-1;const{x:_,y:x,fx:v,fy:S}=h;let A=v?v(l.fx)-d.marginLeft:0,M=S?S(l.fy)-d.marginTop:0;_?.bandwidth&&(A+=_.bandwidth()/2),x?.bandwidth&&(M+=x.bandwidth()/2);const T=l.fi!=null;let I;if(T){let Y=b.facetStates;Y||(b.facetStates=Y=new Map),I=Y.get(this),I||Y.set(this,I=new Map)}const[R,L]=ri(this,d),{px:E,py:$}=f,N=E?Y=>E[Y]:lD(f,R),D=$?Y=>$[Y]:fD(f,L);let k,C,B,P;function q(Y,J){if(T)if(P&&(P=cancelAnimationFrame(P)),Y==null)I.delete(l.fi);else{I.set(l.fi,J),P=requestAnimationFrame(()=>{P=null;for(const[z,W]of I)if(W<J||W===J&&z<l.fi){Y=null;break}V(Y)});return}V(Y)}function V(Y){if(k===Y&&B===b.sticky)return;k=Y,B=p.pointerSticky=b.sticky;const J=k==null?[]:[k];T&&(J.fx=l.fx,J.fy=l.fy,J.fi=l.fi);const z=y(J,h,f,d,p);if(C){if(T){const W=C.parentNode,H=C.getAttribute("transform"),U=z.getAttribute("transform");H?z.setAttribute("transform",H):z.removeAttribute("transform"),U?W.setAttribute("transform",U):W.removeAttribute("transform"),z.removeAttribute("aria-label"),z.removeAttribute("aria-description"),z.removeAttribute("aria-hidden")}C.replaceWith(z)}if(b.roots[w]=C=z,!(k==null&&I?.size>1)){const W=k==null?null:Bi(m)?m[k]:m.get(k);p.dispatchValue(W)}return z}function G(Y){if(b.sticky||Y.pointerType==="mouse"&&Y.buttons===1)return;let[J,z]=pr(Y);J-=A,z-=M;const W=J<d.marginLeft||J>d.width-d.marginRight?1:e,H=z<d.marginTop||z>d.height-d.marginBottom?1:t;let U=null,wt=o*o;for(const tt of l){const $t=W*(N(tt)-J),Ot=H*(D(tt)-z),X=$t*$t+Ot*Ot;X<=wt&&(U=tt,wt=X)}if(U!=null&&(e!==1||t!==1)){const tt=N(U)-J,$t=D(U)-z;wt=tt*tt+$t*$t}q(U,wt)}function Q(Y){Y.pointerType==="mouse"&&k!=null&&(b.sticky&&b.roots.some(J=>J?.contains(Y.target))||(b.sticky?(b.sticky=!1,b.renders.forEach(J=>J(null))):(b.sticky=!0,V(k)),Y.stopImmediatePropagation()))}function K(Y){Y.pointerType==="mouse"&&(b.sticky||q(null))}return g.addEventListener("pointerenter",G),g.addEventListener("pointermove",G),g.addEventListener("pointerdown",Q),g.addEventListener("pointerleave",K),V(null)},c)}}function Hp(e){return Vb(1,1,e)}function Qp(e){return Vb(1,.01,e)}function Ol(e){return Vb(.01,1,e)}function lD({x1:e,x2:t,x:n=e},r){return e&&t?i=>(e[i]+t[i])/2:n?i=>n[i]:()=>r}function fD({y1:e,y2:t,y:n=e},r){return e&&t?i=>(e[i]+t[i])/2:n?i=>n[i]:()=>r}function hD(e){return Oo(e)&&e.interval===void 0?void 0:"tabular-nums"}function tnt(e,t){let{label:n=e.label,tickSize:r=6,width:i=240,height:s=44+r,marginTop:o=18,marginRight:a=0,marginBottom:c=16+r,marginLeft:u=0,style:l,ticks:h=(i-u-a)/64,tickFormat:f,fontVariant:d=hD(e),round:p=!0,opacity:y,className:g}=t;const m=Gp(t);g=jb(g),y=Se(y)[1],f===null&&(f=()=>null);const b=Ft("svg",m).attr("class",`${g}-ramp`).attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("width",i).attr("height",s).attr("viewBox",`0 0 ${i} ${s}`).call(R=>R.append("style").text(`:where(.${g}-ramp) {
  display: block;
  height: auto;
  height: intrinsic;
  max-width: 100%;
  overflow: visible;
}
:where(.${g}-ramp text) {
  white-space: pre;
}`)).call(Yb,l);let w=R=>R.selectAll(".tick line").attr("y1",o+c-s),_;const x=p?(R,L)=>R.rangeRound(L):(R,L)=>R.range(L),{type:v,domain:S,range:A,interpolate:M,scale:T,pivot:I}=e;if(M){const R=A===void 0?M:od(M.length===1?Ab(M):M,A);_=x(T.copy(),mr(Xe(u,i-a),Math.min(S.length+(I!==void 0),A===void 0?1/0:A.length)));const L=256,E=m.document.createElement("canvas");E.width=L,E.height=1;const $=E.getContext("2d");for(let N=0,D=L-1;N<L;++N)$.fillStyle=R(N/D),$.fillRect(N,0,1,1);b.append("image").attr("opacity",y).attr("x",u).attr("y",o).attr("width",i-u-a).attr("height",s-o-c).attr("preserveAspectRatio","none").attr("xlink:href",E.toDataURL())}else if(v==="threshold"){const R=S,L=f===void 0?E=>E:typeof f=="string"?La(f):f;_=x(rp().domain([-1,A.length-1]),[u,i-a]),b.append("g").attr("fill-opacity",y).selectAll().data(A).enter().append("rect").attr("x",(E,$)=>_($-1)).attr("y",o).attr("width",(E,$)=>_($)-_($-1)).attr("height",s-o-c).attr("fill",E=>E),h=Kt(R,(E,$)=>$),f=E=>L(R[E],E)}else _=x(ep().domain(S),[u,i-a]),b.append("g").attr("fill-opacity",y).selectAll().data(S).enter().append("rect").attr("x",_).attr("y",o).attr("width",Math.max(0,_.bandwidth()-1)).attr("height",s-o-c).attr("fill",T),w=()=>{};return b.append("g").attr("transform",`translate(0,${s-c})`).call(UY(_).ticks(Array.isArray(h)?null:h,typeof f=="string"?f:void 0).tickFormat(typeof f=="function"?f:void 0).tickSize(r).tickValues(Array.isArray(h)?h:null)).attr("font-size",null).attr("font-family",null).attr("font-variant",Me(d,"normal")).call(w).call(R=>R.select(".domain").remove()),n!==void 0&&b.append("text").attr("x",u).attr("y",o-6).attr("fill","currentColor").attr("font-weight","bold").text(n),b.node()}const Jp=Math.PI/180;function nc(e,{marker:t,markerStart:n=t,markerMid:r=t,markerEnd:i=t}={}){e.markerStart=Wb(n),e.markerMid=Wb(r),e.markerEnd=Wb(i)}function Wb(e){if(e==null||e===!1)return null;if(e===!0)return pD;if(typeof e=="function")return e;switch(`${e}`.toLowerCase()){case"none":return null;case"arrow":return dD("auto");case"arrow-reverse":return dD("auto-start-reverse");case"dot":return ent;case"circle":case"circle-fill":return pD;case"circle-stroke":return nnt;case"tick":return Gb("auto");case"tick-x":return Gb(90);case"tick-y":return Gb(0)}throw new Error(`invalid marker: ${e}`)}function dD(e){return(t,n)=>Ft("svg:marker",n).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("orient",e).attr("fill","none").attr("stroke",t).attr("stroke-width",1.5).attr("stroke-linecap","round").attr("stroke-linejoin","round").call(r=>r.append("path").attr("d","M-1.5,-3l3,3l-3,3")).node()}function ent(e,t){return Ft("svg:marker",t).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",e).attr("stroke","none").call(n=>n.append("circle").attr("r",2.5)).node()}function pD(e,t){return Ft("svg:marker",t).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",e).attr("stroke","var(--plot-background)").attr("stroke-width",1.5).call(n=>n.append("circle").attr("r",3)).node()}function nnt(e,t){return Ft("svg:marker",t).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill","var(--plot-background)").attr("stroke",e).attr("stroke-width",1.5).call(n=>n.append("circle").attr("r",3)).node()}function Gb(e){return(t,n)=>Ft("svg:marker",n).attr("viewBox","-3 -3 6 6").attr("markerWidth",6).attr("markerHeight",6).attr("orient",e).attr("stroke",t).call(r=>r.append("path").attr("d","M0,-3v6")).node()}let rnt=0;function Dl(e,t,{stroke:n},r){return mD(e,t,n&&(i=>n[i]),null,r)}function int(e,t,{stroke:n,z:r},i){return mD(e,t,n&&(([s])=>n[s]),r,i)}const Xb=1,yD=2;function snt(e,t){const n=new Uint8Array(t.length),r=e.data().filter(s=>s.length>1),i=r.length;for(let s=0,o=Ub;s<i;++s){const a=r[s];if(a.length>1){const c=a[0];o!==(o=Ui(t[c]))&&(n[c]|=Xb)}}for(let s=i-1,o=Ub;s>=0;--s){const a=r[s];if(a.length>1){const c=a[0];o!==(o=Ui(t[c]))&&(n[c]|=yD)}}return([s])=>n[s]}function mD(e,{markerStart:t,markerMid:n,markerEnd:r,stroke:i},s=()=>i,o,a){if(!t&&!n&&!r)return;const c=new Map,u=o&&snt(e,o);function l(h,f,d){return function(p){if(d&&!d(p))return;const y=s(p);let g=c.get(f);g||c.set(f,g=new Map);let m=g.get(y);if(!m){const b=this.parentNode.insertBefore(f(y,a),this),w=`plot-marker-${++rnt}`;b.setAttribute("id",w),g.set(y,m=`url(#${w})`)}this.setAttribute(h,m)}}t&&e.each(l("marker-start",t,u&&(h=>u(h)&Xb))),n&&u&&e.each(l("marker-start",n,h=>!(u(h)&Xb))),n&&e.each(l("marker-mid",n)),r&&e.each(l("marker-end",r,u&&(h=>u(h)&yD)))}function Ll({inset:e,insetLeft:t,insetRight:n,...r}={}){return[t,n]=gD(e,t,n),{inset:e,insetLeft:t,insetRight:n,...r}}function Fl({inset:e,insetTop:t,insetBottom:n,...r}={}){return[t,n]=gD(e,t,n),{inset:e,insetTop:t,insetBottom:n,...r}}function gD(e,t,n){return e===void 0&&t===void 0&&n===void 0?ze?[1,0]:[.5,.5]:[t,n]}function bD(e,{interval:t}){return e={...Qa(e)},e.interval=Lp(e.interval===void 0?t:e.interval),e}function Kp(e,t,n,r){const{[e]:i,[`${e}1`]:s,[`${e}2`]:o}=n,{value:a,interval:c}=bD(i,n);if(a==null||c==null&&!r)return n;const u=ti(i);if(c==null){let d;const p={transform:y=>d||(d=Tt(y,a)),label:u};return{...n,[e]:void 0,[`${e}1`]:s===void 0?p:s,[`${e}2`]:o===void 0&&!(s===o&&r)?p:o}}let l,h;function f(d){return h!==void 0&&d===l?h:h=Kt(Tt(l=d,a),p=>c.floor(p))}return t({...n,[e]:void 0,[`${e}1`]:s===void 0?{transform:f,label:u}:s,[`${e}2`]:o===void 0?{transform:d=>f(d).map(p=>c.offset(p)),label:u}:o})}function _D(e,t,n){const{[e]:r}=n,{value:i,interval:s}=bD(r,n);return i==null||s==null?n:t({...n,[e]:{label:ti(r),transform:o=>{const a=Kt(Tt(o,i),u=>s.floor(u)),c=a.map(u=>s.offset(u));return a.map(fn(a)?(u,l)=>u==null||isNaN(u=+u)||(l=c[l],l==null)||isNaN(l=+l)?void 0:new Date((u+l)/2):(u,l)=>u==null||(l=c[l],l==null)?NaN:(+u+ +l)/2)}}})}function wD(e={}){return Kp("x",Ll,e,!0)}function vD(e={}){return Kp("y",Fl,e,!0)}function Hb(e={}){return Kp("x",Ll,e)}function Qb(e={}){return Kp("y",Fl,e)}function xD(e={}){return _D("x",Ll,e)}function SD(e={}){return _D("y",Fl,e)}const AD={ariaLabel:"rule",fill:null,stroke:"currentColor"};class ID extends te{constructor(t,n={}){const{x:r,y1:i,y2:s,inset:o=0,insetTop:a=o,insetBottom:c=o}=n;super(t,{x:{value:r,scale:"x",optional:!0},y1:{value:i,scale:"y",optional:!0},y2:{value:s,scale:"y",optional:!0}},Do(n,"x"),AD),this.insetTop=ae(a),this.insetBottom=ae(c),nc(this,n)}render(t,n,r,i,s){const{x:o,y:a}=n,{x:c,y1:u,y2:l}=r,{width:h,height:f,marginTop:d,marginRight:p,marginLeft:y,marginBottom:g}=i,{insetTop:m,insetBottom:b}=this;return Ft("svg:g",s).call(ce,this,i,s).call(Zt,this,{x:c&&o},ze,0).call(w=>w.selectAll().data(t).enter().append("line").call(Gt,this).attr("x1",c?_=>c[_]:(y+h-p)/2).attr("x2",c?_=>c[_]:(y+h-p)/2).attr("y1",u&&!ni(a)?_=>u[_]+m:d+m).attr("y2",l&&!ni(a)?a.bandwidth?_=>l[_]+a.bandwidth()-b:_=>l[_]-b:f-g-b).call(be,this,r).call(Dl,this,r,s)).node()}}class ED extends te{constructor(t,n={}){const{x1:r,x2:i,y:s,inset:o=0,insetRight:a=o,insetLeft:c=o}=n;super(t,{y:{value:s,scale:"y",optional:!0},x1:{value:r,scale:"x",optional:!0},x2:{value:i,scale:"x",optional:!0}},Do(n,"y"),AD),this.insetRight=ae(a),this.insetLeft=ae(c),nc(this,n)}render(t,n,r,i,s){const{x:o,y:a}=n,{y:c,x1:u,x2:l}=r,{width:h,height:f,marginTop:d,marginRight:p,marginLeft:y,marginBottom:g}=i,{insetLeft:m,insetRight:b}=this;return Ft("svg:g",s).call(ce,this,i,s).call(Zt,this,{y:c&&a},0,ze).call(w=>w.selectAll().data(t).enter().append("line").call(Gt,this).attr("x1",u&&!ni(o)?_=>u[_]+m:y+m).attr("x2",l&&!ni(o)?o.bandwidth?_=>l[_]+o.bandwidth()-b:_=>l[_]-b:h-p-b).attr("y1",c?_=>c[_]:(d+f-g)/2).attr("y2",c?_=>c[_]:(d+f-g)/2).call(be,this,r).call(Dl,this,r,s)).node()}}function Ps(e,t){let{x:n=nt,y:r,y1:i,y2:s,...o}=Qb(t);return[i,s]=MD(r,i,s),new ID(e,{...o,x:n,y1:i,y2:s})}function Us(e,t){let{y:n=nt,x:r,x1:i,x2:s,...o}=Hb(t);return[i,s]=MD(r,i,s),new ED(e,{...o,y:n,x1:i,x2:s})}function MD(e,t,n){if(e==null){if(t===void 0){if(n!==void 0)return[0,n]}else if(n===void 0)return[0,t]}else{if(t===void 0)return n===void 0?[0,e]:[e,n];if(n===void 0)return[e,t]}return[t,n]}function Cl(e,...t){let n=t.length;for(let r=0,i=!0;r<n;++r)typeof t[r]!="function"&&(i&&(e=e.slice(),i=!1),e.splice(r,2,e[r]+t[r]+e[r+1]),t.splice(r,1),--r,--n);return r=>{let i=e[0];for(let s=0;s<n;++s)i+=t[s](r)+e[s+1];return i}}const ont={ariaLabel:"text",strokeLinejoin:"round",strokeWidth:3,paintOrder:"stroke"},TD="­";class Zp extends te{constructor(t,n={}){const{x:r,y:i,text:s=zi(t)&&ZR(t)?nt:Ee,frameAnchor:o,textAnchor:a=/right$/i.test(o)?"end":/left$/i.test(o)?"start":"middle",lineAnchor:c=/^top/i.test(o)?"top":/^bottom/i.test(o)?"bottom":"middle",lineHeight:u=1,lineWidth:l=1/0,textOverflow:h,monospace:f,fontFamily:d=f?"ui-monospace, monospace":void 0,fontSize:p,fontStyle:y,fontVariant:g,fontWeight:m,rotate:b}=n,[w,_]=Se(b,0),[x,v]=lnt(p);if(super(t,{x:{value:r,scale:"x",optional:!0},y:{value:i,scale:"y",optional:!0},fontSize:{value:x,optional:!0},rotate:{value:kZ(w),optional:!0},text:{value:s,filter:j1,optional:!0}},n,ont),this.rotate=_,this.textAnchor=Me(a,"middle"),this.lineAnchor=Dn(c,"lineAnchor",["top","middle","bottom"]),this.lineHeight=+u,this.lineWidth=+l,this.textOverflow=$D(h),this.monospace=!!f,this.fontFamily=Pe(d),this.fontSize=v,this.fontStyle=Pe(y),this.fontVariant=Pe(g),this.fontWeight=Pe(m),this.frameAnchor=bl(o),!(this.lineWidth>=0))throw new Error(`invalid lineWidth: ${l}`);this.splitLines=LD(this),this.clipLine=FD(this)}render(t,n,r,i,s){const{x:o,y:a}=n,{x:c,y:u,rotate:l,text:h,title:f,fontSize:d}=r,{rotate:p}=this,[y,g]=ri(this,i);return Ft("svg:g",s).call(ce,this,i,s).call(OD,this,h,i).call(Zt,this,{x:c&&o,y:u&&a}).call(m=>m.selectAll().data(t).enter().append("text").call(Gt,this).call(ant,this,h,f).attr("transform",Cl`translate(${c?b=>c[b]:y},${u?b=>u[b]:g})${l?b=>` rotate(${l[b]})`:p?` rotate(${p})`:""}`).call(ut,"font-size",d&&(b=>d[b])).call(be,this,r)).node()}}function $D(e){return e==null?null:Dn(e,"textOverflow",["clip","ellipsis","clip-start","clip-end","ellipsis-start","ellipsis-middle","ellipsis-end"]).replace(/^(clip|ellipsis)$/,"$1-end")}function ant(e,t,n,r){if(!n)return;const{lineAnchor:i,lineHeight:s,textOverflow:o,splitLines:a,clipLine:c}=t;e.each(function(u){const l=a(ec(n[u])??"").map(c),h=l.length,f=i==="top"?.71:i==="bottom"?1-h:(164-h*100)/200;if(h>1){let d=0;for(let p=0;p<h;++p){if(++d,!l[p])continue;const y=this.ownerDocument.createElementNS(Ai.svg,"tspan");y.setAttribute("x",0),p===d-1?y.setAttribute("y",`${(f+p)*s}em`):y.setAttribute("dy",`${d*s}em`),y.textContent=l[p],this.appendChild(y),d=0}}else f&&this.setAttribute("y",`${f*s}em`),this.textContent=l[0];if(o&&!r&&l[0]!==n[u]){const d=this.ownerDocument.createElementNS(Ai.svg,"title");d.textContent=n[u],this.appendChild(d)}})}function rc(e,{x:t,y:n,...r}={}){return r.frameAnchor===void 0&&([t,n]=Sr(t,n)),new Zp(e,{...r,x:t,y:n})}function ND(e,{x:t=nt,...n}={}){return new Zp(e,SD({...n,x:t}))}function RD(e,{y:t=nt,...n}={}){return new Zp(e,xD({...n,y:t}))}function OD(e,t,n){ut(e,"text-anchor",t.textAnchor),ut(e,"font-family",t.fontFamily),ut(e,"font-size",t.fontSize),ut(e,"font-style",t.fontStyle),ut(e,"font-variant",t.fontVariant===void 0?cnt(n):t.fontVariant),ut(e,"font-weight",t.fontWeight)}function cnt(e){return e&&(Ja(e)||fn(e))?"tabular-nums":void 0}const unt=new Set(["inherit","initial","revert","unset","xx-small","x-small","small","medium","large","x-large","xx-large","xxx-large","larger","smaller"]);function lnt(e){return e==null||typeof e=="number"?[void 0,e]:typeof e!="string"?[e,void 0]:(e=e.trim().toLowerCase(),unt.has(e)||/^[+-]?\d*\.?\d+(e[+-]?\d+)?(\w*|%)$/.test(e)?[void 0,e]:[e,void 0])}function fnt(e,t,n){const r=[];let i,s=0;for(const[o,a,c]of hnt(e)){if(i===void 0&&(i=o),s>i&&n(e,i,a)>t&&(r.push(e.slice(i,s)+(e[s-1]===TD?"-":"")),i=o),c){r.push(e.slice(i,a)),i=void 0;continue}s=a}return r}function*hnt(e){let t=0,n=0;const r=e.length;for(;n<r;){let i=1;switch(e[n]){case TD:case"-":++n,yield[t,n,!1],t=n;break;case" ":for(yield[t,n,!1];e[++n]===" ";);t=n;break;case"\r":e[n+1]===`
`&&++i;case`
`:yield[t,n,!0],n+=i,t=n;break;default:++n;break}}yield[t,n,!0]}const DD={a:56,b:63,c:57,d:63,e:58,f:37,g:62,h:60,i:26,j:26,k:55,l:26,m:88,n:60,o:60,p:62,q:62,r:39,s:54,t:38,u:60,v:55,w:79,x:54,y:55,z:55,A:69,B:67,C:73,D:74,E:61,F:58,G:76,H:75,I:28,J:55,K:67,L:58,M:89,N:75,O:78,P:65,Q:78,R:67,S:65,T:65,U:75,V:69,W:98,X:69,Y:67,Z:67,0:64,1:48,2:62,3:64,4:66,5:63,6:65,7:58,8:65,9:65," ":29,"!":32,'"':49,"'":31,"(":39,")":39,",":31,"-":48,".":31,"/":32,":":31,";":31,"?":52,"‘":31,"’":31,"“":47,"”":47,"…":82};function Jb(e,t=0,n=e.length){let r=0;for(let i=t;i<n;i=oc(e,i))r+=DD[e[i]]??(UD(e,i)?120:DD.e);return r}function Kb(e,t=0,n=e.length){let r=0;for(let i=t;i<n;i=oc(e,i))r+=UD(e,i)?126:63;return r}function LD({monospace:e,lineWidth:t,textOverflow:n}){if(n!=null||t==1/0)return s=>s.split(/\r\n?|\n/g);const r=e?Kb:Jb,i=t*100;return s=>fnt(s,i,r)}function FD({monospace:e,lineWidth:t,textOverflow:n}){if(n==null||t==1/0)return s=>s;const r=e?Kb:Jb,i=t*100;switch(n){case"clip-start":return s=>kD(s,i,r,"");case"clip-end":return s=>CD(s,i,r,"");case"ellipsis-start":return s=>kD(s,i,r,ic);case"ellipsis-middle":return s=>dnt(s,i,r,ic);case"ellipsis-end":return s=>CD(s,i,r,ic)}}const ic="…";function sc(e,t,n,r){const i=[];let s=0;for(let o=0,a=0,c=e.length;o<c;o=a){a=oc(e,o);const u=n(e,o,a);if(s+u>t){for(s+=r;s>t&&o>0;)a=o,o=i.pop(),s-=n(e,o,a);return[o,t-s]}s+=u,i.push(o)}return[-1,0]}function CD(e,t,n,r){e=e.trim();const i=n(r),[s]=sc(e,t,n,i);return s<0?e:e.slice(0,s).trimEnd()+r}function dnt(e,t,n,r){e=e.trim();const i=n(e);if(i<=t)return e;const s=n(r)/2,[o,a]=sc(e,t/2,n,s),[c]=sc(e,i-t/2-a+s,n,-s);return c<0?r:e.slice(0,o).trimEnd()+r+e.slice(oc(e,c)).trimStart()}function kD(e,t,n,r){e=e.trim();const i=n(e);if(i<=t)return e;const s=n(r),[o]=sc(e,i-t+s,n,-s);return o<0?r:r+e.slice(oc(e,o)).trimStart()}const Zb=/[\p{Combining_Mark}\p{Emoji_Modifier}]+/uy,BD=new RegExp("\\p{Extended_Pictographic}","uy");function oc(e,t){return t+=pnt(e,t)?2:1,mnt(e,t)&&(t=Zb.lastIndex),ynt(e,t)?oc(e,t+1):t}function PD(e,t){return e.charCodeAt(t)<128}function pnt(e,t){const n=e.charCodeAt(t);if(n>=55296&&n<56320){const r=e.charCodeAt(t+1);return r>=56320&&r<57344}return!1}function ynt(e,t){return e.charCodeAt(t)===8205}function mnt(e,t){return PD(e,t)?!1:(Zb.lastIndex=t,Zb.test(e))}function UD(e,t){return PD(e,t)?!1:(BD.lastIndex=t,BD.test(e))}const zD={ariaLabel:"vector",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinejoin:"round",strokeLinecap:"round"},qD=3.5,gnt=qD*5,jD={draw(e,t,n){const r=t*n/gnt;e.moveTo(0,0),e.lineTo(0,-t),e.moveTo(-r,r-t),e.lineTo(0,-t),e.lineTo(r,r-t)}},YD={draw(e,t,n){e.moveTo(-n,0),e.lineTo(0,-t),e.lineTo(n,0)}},bnt=new Map([["arrow",jD],["spike",YD]]);function _nt(e){return e&&typeof e.draw=="function"}function wnt(e){if(_nt(e))return e;const t=bnt.get(`${e}`.toLowerCase());if(t)return t;throw new Error(`invalid shape: ${e}`)}class ty extends te{constructor(t,n={}){const{x:r,y:i,r:s=qD,length:o,rotate:a,shape:c=jD,anchor:u="middle",frameAnchor:l}=n,[h,f]=Se(o,12),[d,p]=Se(a,0);super(t,{x:{value:r,scale:"x",optional:!0},y:{value:i,scale:"y",optional:!0},length:{value:h,scale:"length",optional:!0},rotate:{value:d,optional:!0}},n,zD),this.r=+s,this.length=f,this.rotate=p,this.shape=wnt(c),this.anchor=Dn(u,"anchor",["start","middle","end"]),this.frameAnchor=bl(l)}render(t,n,r,i,s){const{x:o,y:a}=n,{x:c,y:u,length:l,rotate:h}=r,{length:f,rotate:d,anchor:p,shape:y,r:g}=this,[m,b]=ri(this,i);return Ft("svg:g",s).call(ce,this,i,s).call(Zt,this,{x:c&&o,y:u&&a}).call(w=>w.selectAll().data(t).enter().append("path").call(Gt,this).attr("transform",Cl`translate(${c?_=>c[_]:m},${u?_=>u[_]:b})${h?_=>` rotate(${h[_]})`:d?` rotate(${d})`:""}${p==="start"?"":p==="end"?l?_=>` translate(0,${l[_]})`:` translate(0,${f})`:l?_=>` translate(0,${l[_]/2})`:` translate(0,${f/2})`}`).attr("d",l?_=>{const x=$i();return y.draw(x,l[_],g),x}:(()=>{const _=$i();return y.draw(_,f,g),_})()).call(be,this,r)).node()}}function VD(e,t={}){let{x:n,y:r,...i}=t;return t.frameAnchor===void 0&&([n,r]=Sr(n,r)),new ty(e,{...i,x:n,y:r})}function WD(e,t={}){const{x:n=nt,...r}=t;return new ty(e,{...r,x:n})}function GD(e,t={}){const{y:n=nt,...r}=t;return new ty(e,{...r,y:n})}function vnt(e,t={}){const{shape:n=YD,stroke:r=zD.stroke,strokeWidth:i=1,fill:s=r,fillOpacity:o=.3,anchor:a="start",...c}=t;return VD(e,{...c,shape:n,stroke:r,strokeWidth:i,fill:s,fillOpacity:o,anchor:a})}function zs(e,t){return arguments.length<2&&!zi(e)&&(t=e,e=null),t===void 0&&(t={}),[e,t]}function ey({anchor:e}={},t){return e===void 0?t[0]:Dn(e,"anchor",t)}function XD(e){return ey(e,["left","right"])}function HD(e){return ey(e,["right","left"])}function QD(e){return ey(e,["bottom","top"])}function JD(e){return ey(e,["top","bottom"])}function t_(){const[e,t]=zs(...arguments);return tL("y",XD(t),e,t)}function KD(){const[e,t]=zs(...arguments);return tL("fy",HD(t),e,t)}function e_(){const[e,t]=zs(...arguments);return eL("x",QD(t),e,t)}function ZD(){const[e,t]=zs(...arguments);return eL("fx",JD(t),e,t)}function tL(e,t,n,{color:r="currentColor",opacity:i=1,stroke:s=r,strokeOpacity:o=i,strokeWidth:a=1,fill:c=r,fillOpacity:u=i,textAnchor:l,textStroke:h,textStrokeOpacity:f,textStrokeWidth:d,tickSize:p=e==="y"?6:0,tickPadding:y,tickRotate:g,x:m,margin:b,marginTop:w=b===void 0?20:b,marginRight:_=b===void 0?t==="right"?40:0:b,marginBottom:x=b===void 0?20:b,marginLeft:v=b===void 0?t==="left"?40:0:b,label:S,labelAnchor:A,labelArrow:M,labelOffset:T,ariaLabel:I=`${e}-axis`,...R}){return p=ae(p),y=ae(y),g=ae(g),A!==void 0&&(A=Dn(A,"labelAnchor",["center","top","bottom"])),M=dL(M),nr(p&&!he(s)?xnt(e,t,n,{stroke:s,strokeOpacity:o,strokeWidth:a,tickSize:p,tickPadding:y,tickRotate:g,x:m,ariaLabel:I,...R}):null,he(c)?null:Ant(e,t,n,{fill:c,fillOpacity:u,stroke:h,strokeOpacity:f,strokeWidth:d,textAnchor:l,tickSize:p,tickPadding:y,tickRotate:g,x:m,marginTop:w,marginRight:_,marginBottom:x,marginLeft:v,ariaLabel:I,...R}),!he(c)&&S!==null?rc([],uL({fill:c,fillOpacity:u,...R},function(L,E,$,N,D){const k=N[e],{marginTop:C,marginRight:B,marginBottom:P,marginLeft:q}=e==="y"&&D.inset||D,V=A??(k.bandwidth?"center":"top"),G=T??(t==="right"?B:q)-3;return V==="center"?(this.textAnchor=void 0,this.lineAnchor=t==="right"?"bottom":"top",this.frameAnchor=t,this.rotate=-90):(this.textAnchor=t==="right"?"end":"start",this.lineAnchor=V,this.frameAnchor=`${V}-${t}`,this.rotate=0),this.dy=V==="top"?3-C:V==="bottom"?P-3:0,this.dx=t==="right"?G:-G,this.ariaLabel=`${I} label`,{facets:[[0]],channels:{text:{value:[hL(e,k,{anchor:t,label:S,labelAnchor:V,labelArrow:M})]}}}})):null)}function eL(e,t,n,{color:r="currentColor",opacity:i=1,stroke:s=r,strokeOpacity:o=i,strokeWidth:a=1,fill:c=r,fillOpacity:u=i,textAnchor:l,textStroke:h,textStrokeOpacity:f,textStrokeWidth:d,tickSize:p=e==="x"?6:0,tickPadding:y,tickRotate:g,y:m,margin:b,marginTop:w=b===void 0?t==="top"?30:0:b,marginRight:_=b===void 0?20:b,marginBottom:x=b===void 0?t==="bottom"?30:0:b,marginLeft:v=b===void 0?20:b,label:S,labelAnchor:A,labelArrow:M,labelOffset:T,ariaLabel:I=`${e}-axis`,...R}){return p=ae(p),y=ae(y),g=ae(g),A!==void 0&&(A=Dn(A,"labelAnchor",["center","left","right"])),M=dL(M),nr(p&&!he(s)?Snt(e,t,n,{stroke:s,strokeOpacity:o,strokeWidth:a,tickSize:p,tickPadding:y,tickRotate:g,y:m,ariaLabel:I,...R}):null,he(c)?null:Int(e,t,n,{fill:c,fillOpacity:u,stroke:h,strokeOpacity:f,strokeWidth:d,textAnchor:l,tickSize:p,tickPadding:y,tickRotate:g,y:m,marginTop:w,marginRight:_,marginBottom:x,marginLeft:v,ariaLabel:I,...R}),!he(c)&&S!==null?rc([],uL({fill:c,fillOpacity:u,...R},function(L,E,$,N,D){const k=N[e],{marginTop:C,marginRight:B,marginBottom:P,marginLeft:q}=e==="x"&&D.inset||D,V=A??(k.bandwidth?"center":"right"),G=T??(t==="top"?C:P)-3;return V==="center"?(this.frameAnchor=t,this.textAnchor=void 0):(this.frameAnchor=`${t}-${V}`,this.textAnchor=V==="right"?"end":"start"),this.lineAnchor=t,this.dy=t==="top"?-G:G,this.dx=V==="right"?B-3:V==="left"?3-q:0,this.ariaLabel=`${I} label`,{facets:[[0]],channels:{text:{value:[hL(e,k,{anchor:t,label:S,labelAnchor:V,labelArrow:M})]}}}})):null)}function xnt(e,t,n,{strokeWidth:r=1,strokeLinecap:i=null,strokeLinejoin:s=null,facetAnchor:o=t+(e==="y"?"-empty":""),frameAnchor:a=t,tickSize:c,inset:u=0,insetLeft:l=u,insetRight:h=u,dx:f=0,y:d=e==="y"?void 0:null,ariaLabel:p,...y}){return ac(GD,e,n,{ariaLabel:`${p} tick`,ariaHidden:!0},{strokeWidth:r,strokeLinecap:i,strokeLinejoin:s,facetAnchor:o,frameAnchor:a,y:d,...y,dx:t==="left"?+f-ze+ +l:+f+ze-h,anchor:"start",length:c,shape:t==="left"?$nt:Nnt})}function Snt(e,t,n,{strokeWidth:r=1,strokeLinecap:i=null,strokeLinejoin:s=null,facetAnchor:o=t+(e==="x"?"-empty":""),frameAnchor:a=t,tickSize:c,inset:u=0,insetTop:l=u,insetBottom:h=u,dy:f=0,x:d=e==="x"?void 0:null,ariaLabel:p,...y}){return ac(WD,e,n,{ariaLabel:`${p} tick`,ariaHidden:!0},{strokeWidth:r,strokeLinejoin:s,strokeLinecap:i,facetAnchor:o,frameAnchor:a,x:d,...y,dy:t==="bottom"?+f-ze-h:+f+ze+ +l,anchor:"start",length:c,shape:t==="bottom"?Mnt:Tnt})}function Ant(e,t,n,{facetAnchor:r=t+(e==="y"?"-empty":""),frameAnchor:i=t,tickSize:s,tickRotate:o=0,tickPadding:a=Math.max(3,9-s)+(Math.abs(o)>60?4*Math.cos(o*Jp):0),text:c,textAnchor:u=Math.abs(o)>60?"middle":t==="left"?"end":"start",lineAnchor:l=o>60?"top":o<-60?"bottom":"middle",fontVariant:h,inset:f=0,insetLeft:d=f,insetRight:p=f,dx:y=0,ariaLabel:g,y:m=e==="y"?void 0:null,...b}){return ac(RD,e,n,{ariaLabel:`${g} tick label`},{facetAnchor:r,frameAnchor:i,text:c,textAnchor:u,lineAnchor:l,fontVariant:h,rotate:o,y:m,...b,dx:t==="left"?+y-s-a+ +d:+y+ +s+ +a-p},function(w,_,x,v,S){h===void 0&&(this.fontVariant=fL(w)),c===void 0&&(S.text=lL(w,_,x,v,t))})}function Int(e,t,n,{facetAnchor:r=t+(e==="x"?"-empty":""),frameAnchor:i=t,tickSize:s,tickRotate:o=0,tickPadding:a=Math.max(3,9-s)+(Math.abs(o)>=10?4*Math.cos(o*Jp):0),text:c,textAnchor:u=Math.abs(o)>=10?o<0^t==="bottom"?"start":"end":"middle",lineAnchor:l=Math.abs(o)>=10?"middle":t==="bottom"?"top":"bottom",fontVariant:h,inset:f=0,insetTop:d=f,insetBottom:p=f,dy:y=0,x:g=e==="x"?void 0:null,ariaLabel:m,...b}){return ac(ND,e,n,{ariaLabel:`${m} tick label`},{facetAnchor:r,frameAnchor:i,text:c===void 0?null:c,textAnchor:u,lineAnchor:l,fontVariant:h,rotate:o,x:g,...b,dy:t==="bottom"?+y+ +s+ +a-p:+y-s-a+ +d},function(w,_,x,v,S){h===void 0&&(this.fontVariant=fL(w)),c===void 0&&(S.text=lL(w,_,x,v,t))})}function nL(){const[e,t]=zs(...arguments);return oL("y",XD(t),e,t)}function rL(){const[e,t]=zs(...arguments);return oL("fy",HD(t),e,t)}function iL(){const[e,t]=zs(...arguments);return aL("x",QD(t),e,t)}function sL(){const[e,t]=zs(...arguments);return aL("fx",JD(t),e,t)}function oL(e,t,n,{y:r=e==="y"?void 0:null,x:i=null,x1:s=t==="left"?i:null,x2:o=t==="right"?i:null,ariaLabel:a=`${e}-grid`,ariaHidden:c=!0,...u}){return ac(Us,e,n,{ariaLabel:a,ariaHidden:c},{y:r,x1:s,x2:o,...cL(u)})}function aL(e,t,n,{x:r=e==="x"?void 0:null,y:i=null,y1:s=t==="top"?i:null,y2:o=t==="bottom"?i:null,ariaLabel:a=`${e}-grid`,ariaHidden:c=!0,...u}){return ac(Ps,e,n,{ariaLabel:a,ariaHidden:c},{x:r,y1:s,y2:o,...cL(u)})}function cL({color:e="currentColor",opacity:t=.1,stroke:n=e,strokeOpacity:r=t,strokeWidth:i=1,...s}){return{stroke:n,strokeOpacity:r,strokeWidth:i,...s}}function uL({fill:e,fillOpacity:t,fontFamily:n,fontSize:r,fontStyle:i,fontVariant:s,fontWeight:o,monospace:a,pointerEvents:c,shapeRendering:u,clip:l=!1},h){return[,e]=ln(e),[,t]=Se(t),{facet:"super",x:null,y:null,fill:e,fillOpacity:t,fontFamily:n,fontSize:r,fontStyle:i,fontVariant:s,fontWeight:o,monospace:a,pointerEvents:c,shapeRendering:u,clip:l,initializer:h}}function ac(e,t,n,r,i,s){let o;function a(l,h,f,d,p,y){const g=l==null&&(t==="fx"||t==="fy"),{[t]:m}=d;if(!m)throw new Error(`missing scale: ${t}`);const b=m.domain();let{interval:w,ticks:_,tickFormat:x,tickSpacing:v=t==="x"?80:35}=i;if(typeof _=="string"&&pL(m)&&(w=_,_=void 0),_===void 0&&(_=Xa(w,m.type)??Ent(m,v)),l==null){if(zi(_))l=Ls(_);else if(Ha(_))l=r_(_,...Ie(b));else if(m.interval){let A=m.interval;if(m.ticks){const[M,T]=Ie(b),I=(T-M)/A[fl];A=FR(A,I/_)??A,l=r_(A,M,T)}else{l=b;const M=l.length;A=FR(A,M/_)??A,A!==m.interval&&(l=r_(A,...Ie(l)))}if(A===m.interval){const M=Math.round(l.length/_);M>1&&(l=l.filter((T,I)=>I%M===0))}}else m.ticks?l=m.ticks(_):l=b;if(!m.ticks&&l.length&&l!==b){const A=new ba(b);l=l.filter(M=>A.has(M)),l.length||Wi(`Warning: the ${t}-axis ticks appear to not align with the scale domain, resulting in no ticks. Try different ticks?`)}t==="y"||t==="x"?h=[Pi(l)]:o[t]={scale:t,value:nt}}s?.call(this,m,l,_,x,o);const S=Object.fromEntries(Object.entries(o).map(([A,M])=>[A,{...M,value:Tt(l,M.value)}]));return g&&(h=y.filterFacets(l,S)),{data:l,facets:h,channels:S}}const c=Ke(i).initializer,u=e(n,Ke({...i,initializer:a},c));return n==null?(o=u.channels,u.channels={}):o={},r!==void 0&&Object.assign(u,r),u.clip===void 0&&(u.clip=!1),u}function Ent(e,t){const[n,r]=Ie(e.range());return(r-n)/t}function lL(e,t,n,r,i){return{value:n_(e,t,n,r,i)}}function n_(e,t,n,r,i){return typeof r=="function"&&!(e.type==="log"&&e.tickFormat)?r:r===void 0&&t&&fn(t)?TZ(e.type,t,i)??ec:e.tickFormat?e.tickFormat(typeof n=="number"?n:null,r):typeof r=="string"&&e.domain().length>0?(fn(e.domain())?al:La)(r):r===void 0?ec:Ue(r)}function r_(e,t,n){return e.range(t,e.offset(e.floor(n)))}const Mnt={draw(e,t){e.moveTo(0,0),e.lineTo(0,t)}},Tnt={draw(e,t){e.moveTo(0,0),e.lineTo(0,-t)}},$nt={draw(e,t){e.moveTo(0,0),e.lineTo(-t,0)}},Nnt={draw(e,t){e.moveTo(0,0),e.lineTo(t,0)}};function fL(e){return e.bandwidth&&!e.interval?void 0:"tabular-nums"}function hL(e,t,{anchor:n,label:r=t.label,labelAnchor:i,labelArrow:s}={}){if(!(r==null||r.inferred&&pL(t)&&/^(date|time|year)$/i.test(r))){if(r=String(r),s==="auto"&&(s=(!t.bandwidth||t.interval)&&!/[↑↓→←]/.test(r)),!s)return r;if(s===!0){const o=zO(t);o&&(s=/x$/.test(e)||i==="center"?/x$/.test(e)===o<0?"left":"right":o<0?"up":"down")}switch(s){case"left":return`← ${r}`;case"right":return`${r} →`;case"up":return n==="right"?`${r} ↑`:`↑ ${r}`;case"down":return n==="right"?`${r} ↓`:`↓ ${r}`}return r}}function dL(e="auto"){return he(e)?!1:typeof e=="boolean"?e:Dn(e,"labelArrow",["auto","up","right","down","left"])}function pL(e){return fn(e.domain())}function yL(e,t){if(t==null)return t;const n=e(t);if(!n)throw new Error(`scale not found: ${t}`);return n}function Rnt(e,{opacity:t,...n}={}){if(!Oo(e)&&!QO(e))throw new Error(`swatches legend requires ordinal or threshold color scale (not ${e.type})`);return mL(e,n,(r,i,s,o)=>r.append("svg").attr("width",s).attr("height",o).attr("fill",i.scale).attr("fill-opacity",Se(t)[1]).append("rect").attr("width","100%").attr("height","100%"))}function Ont(e,{fill:t=e.hint?.fill!==void 0?e.hint.fill:"none",fillOpacity:n=1,stroke:r=e.hint?.stroke!==void 0?e.hint.stroke:he(t)?"currentColor":"none",strokeOpacity:i=1,strokeWidth:s=1.5,r:o=4.5,...a}={},c){const[u,l]=ln(t),[h,f]=ln(r),d=yL(c,u),p=yL(c,h),y=o*o*Math.PI;return n=Se(n)[1],i=Se(i)[1],s=Se(s)[1],mL(e,a,(g,m,b,w)=>g.append("svg").attr("viewBox","-8 -8 16 16").attr("width",b).attr("height",w).attr("fill",u==="color"?_=>d.scale(_):l).attr("fill-opacity",n).attr("stroke",h==="color"?_=>p.scale(_):f).attr("stroke-opacity",i).attr("stroke-width",s).append("path").attr("d",_=>{const x=$i();return e.scale(_).draw(x,y),x}))}function mL(e,t={},n){let{columns:r,tickFormat:i,fontVariant:s=hD(e),swatchSize:o=15,swatchWidth:a=o,swatchHeight:c=o,marginLeft:u=0,className:l,style:h,width:f}=t;const d=Gp(t);l=jb(l),i=n_(e.scale,e.domain,void 0,i);const p=Ft("div",d).attr("class",`${l}-swatches ${l}-swatches-${r!=null?"columns":"wrap"}`);let y;return r!=null?(y=`:where(.${l}-swatches-columns .${l}-swatch) {
  display: flex;
  align-items: center;
  break-inside: avoid;
  padding-bottom: 1px;
}
:where(.${l}-swatches-columns .${l}-swatch::before) {
  flex-shrink: 0;
}
:where(.${l}-swatches-columns .${l}-swatch-label) {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}`,p.style("columns",r).selectAll().data(e.domain).enter().append("div").attr("class",`${l}-swatch`).call(n,e,a,c).call(g=>g.append("div").attr("class",`${l}-swatch-label`).attr("title",i).text(i))):(y=`:where(.${l}-swatches-wrap) {
  display: flex;
  align-items: center;
  min-height: 33px;
  flex-wrap: wrap;
}
:where(.${l}-swatches-wrap .${l}-swatch) {
  display: inline-flex;
  align-items: center;
  margin-right: 1em;
}`,p.selectAll().data(e.domain).enter().append("span").attr("class",`${l}-swatch`).call(n,e,a,c).append(function(){return this.ownerDocument.createTextNode(i.apply(this,arguments))})),p.call(g=>g.insert("style","*").text(`:where(.${l}-swatches) {
  font-family: system-ui, sans-serif;
  font-size: 10px;
  margin-bottom: 0.5em;
}
:where(.${l}-swatch > svg) {
  margin-right: 0.5em;
  overflow: visible;
}
${y}`)).style("margin-left",u?`${+u}px`:null).style("width",f===void 0?null:`${+f}px`).style("font-variant",Me(s,"normal")).call(Yb,h).node()}const ny=new Map([["symbol",Ont],["color",gL],["opacity",Fnt]]);function Dnt(e={}){for(const[t,n]of ny){const r=e[t];if($o(r)){const i=Gp(e);let s;if(t==="symbol"){const{fill:o,stroke:a=o===void 0&&$o(e.color)?"color":void 0}=e;s={fill:o,stroke:a}}return n($b(t,r,s),i_(i,r,e),o=>$o(e[o])?$b(o,e[o]):null)}}throw new Error("unknown legend type; no scale found")}function Lnt(e,t,n={}){return(r,i)=>{if(!ny.has(r))throw new Error(`unknown legend type: ${r}`);if(r in e)return ny.get(r)(e[r],i_(t,n[r],i),s=>e[s])}}function i_({className:e,...t},{label:n,ticks:r,tickFormat:i}={},s){return YZ(s,{className:e,...t},{label:n,ticks:r,tickFormat:i})}function gL(e,{legend:t=!0,...n}){if(t===!0&&(t=e.type==="ordinal"?"swatches":"ramp"),e.domain!==void 0)switch(`${t}`.toLowerCase()){case"swatches":return Rnt(e,n);case"ramp":return tnt(e,n);default:throw new Error(`unknown legend type: ${t}`)}}function Fnt({type:e,interpolate:t,...n},{legend:r=!0,color:i=Nn(0,0,0),...s}){if(!t)throw new Error(`${e} opacity scales are not supported`);if(r===!0&&(r="ramp"),`${r}`.toLowerCase()!=="ramp")throw new Error(`${r} opacity legends are not supported`);return gL({type:e,...n,interpolate:Cnt(i)},{legend:r,...s})}function Cnt(e){const{r:t,g:n,b:r}=Nn(e)||Nn(0,0,0);return i=>`rgba(${t},${n},${r},${i})`}function knt(e,t,n){const r=[];for(const[i,s]of ny){const o=n[i];if(o?.legend&&i in e){const a=s(e[i],i_(t,e[i],o),c=>e[c]);a!=null&&r.push(a)}}return r}function ry(e={},t="x"){return GR(e)?e:{...e,[t]:nt}}function iy(e={},t="y"){return XR(e)?e:{...e,[t]:nt}}function bL(e,t){if(t.length===1)return{data:e,facets:t};const n=ml(e),r=new Uint8Array(n);let i=0;for(const a of t)for(const c of a)r[c]&&++i,r[c]=1;if(i===0)return{data:e,facets:t};e=yl(e);const s=e[PR]=new Uint32Array(n+i);t=t.map(a=>yl(a,Uint32Array));let o=n;r.fill(0);for(const a of t)for(let c=0,u=a.length;c<u;++c){const l=a[c];r[l]?(a[c]=o,e[o]=e[l],s[o]=l,++o):s[l]=l,r[l]=1}return{data:e,facets:t}}function _L(e={},t={}){arguments.length===1&&([e,t]=cc(e));const{y1:n,y:r=n,x:i,...s}=t,[o,a,c,u]=uc(r,i,"y","x",e,s);return{...o,y1:n,y:a,x1:c,x2:u,x:Op(c,u)}}function Bnt(e={},t={}){arguments.length===1&&([e,t]=cc(e));const{y1:n,y:r=n,x:i}=t,[s,o,a]=uc(r,i,"y","x",e,t);return{...s,y1:n,y:o,x:a}}function Pnt(e={},t={}){arguments.length===1&&([e,t]=cc(e));const{y1:n,y:r=n,x:i}=t,[s,o,,a]=uc(r,i,"y","x",e,t);return{...s,y1:n,y:o,x:a}}function wL(e={},t={}){arguments.length===1&&([e,t]=cc(e));const{x1:n,x:r=n,y:i,...s}=t,[o,a,c,u]=uc(r,i,"x","y",e,s);return{...o,x1:n,x:a,y1:c,y2:u,y:Op(c,u)}}function Unt(e={},t={}){arguments.length===1&&([e,t]=cc(e));const{x1:n,x:r=n,y:i}=t,[s,o,a]=uc(r,i,"x","y",e,t);return{...s,x1:n,x:o,y:a}}function znt(e={},t={}){arguments.length===1&&([e,t]=cc(e));const{x1:n,x:r=n,y:i}=t,[s,o,,a]=uc(r,i,"x","y",e,t);return{...s,x1:n,x:o,y:a}}function sy({x:e,x1:t,x2:n,...r}={}){return r=Do(r,"y"),t===void 0&&n===void 0?_L({x:e,...r}):([t,n]=HR(e,t,n),{...r,x1:t,x2:n})}function oy({y:e,y1:t,y2:n,...r}={}){return r=Do(r,"x"),t===void 0&&n===void 0?wL({y:e,...r}):([t,n]=HR(e,t,n),{...r,y1:t,y2:n})}function cc(e){const{offset:t,order:n,reverse:r,...i}=e;return[{offset:t,order:n,reverse:r},i]}const qnt={length:!0};function uc(e,t=J1,n,r,{offset:i,order:s,reverse:o},a){if(t===null)throw new Error(`stack requires ${r}`);const c=Cs(a),[u,l]=xn(e),[h,f]=Fn(t),[d,p]=Fn(t);return h.hint=d.hint=qnt,i=jnt(i),s=Wnt(s,i,r),[Ar(a,(y,g,m)=>{({data:y,facets:g}=bL(y,g));const b=e==null?void 0:l(Dp(Tt(y,e),m?.[n])),w=Tt(y,t,Float64Array),_=Tt(y,c),x=s&&s(y,b,w,_),v=ml(y),S=f(new Float64Array(v)),A=p(new Float64Array(v)),M=[];for(const T of g){const I=b?Array.from(vs(T,R=>b[R]).values()):[T];if(x)for(const R of I)R.sort(x);for(const R of I){let L=0,E=0;o&&R.reverse();for(const $ of R){const N=w[$];N<0?L=A[$]=(S[$]=L)+N:N>0?E=A[$]=(S[$]=E)+N:A[$]=S[$]=E}}M.push(I)}return i&&i(M,S,A,_),{data:y,facets:g}}),u,h,d]}function jnt(e){if(e!=null){if(typeof e=="function")return e;switch(`${e}`.toLowerCase()){case"expand":case"normalize":return Ynt;case"center":case"silhouette":return Vnt;case"wiggle":return xL}throw new Error(`unknown offset: ${e}`)}}function vL(e,t){let n=0,r=0;for(const i of e){const s=t[i];s<n&&(n=s),s>r&&(r=s)}return[n,r]}function Ynt(e,t,n){for(const r of e)for(const i of r){const[s,o]=vL(i,n);for(const a of i){const c=1/(o-s||1);t[a]=c*(t[a]-s),n[a]=c*(n[a]-s)}}}function Vnt(e,t,n){for(const r of e){for(const i of r){const[s,o]=vL(i,n);for(const a of i){const c=(o+s)/2;t[a]-=c,n[a]-=c}}SL(r,t,n)}AL(e,t,n)}function xL(e,t,n,r){for(const i of e){const s=new fo;let o=0;for(const a of i){let c=-1;const u=a.map(d=>Math.abs(n[d]-t[d])),l=a.map(d=>{c=r?r[d]:++c;const p=n[d]-t[d],y=s.has(c)?p-s.get(c):0;return s.set(c,p),y}),h=[0,..._Y(l)];for(const d of a)t[d]+=o,n[d]+=o;const f=dr(u);f&&(o-=dr(u,(d,p)=>(l[p]/2+h[p])*d)/f)}SL(i,t,n)}AL(e,t,n)}function SL(e,t,n){const r=fe(e,i=>fe(i,s=>t[s]));for(const i of e)for(const s of i)t[s]-=r,n[s]-=r}function AL(e,t,n){const r=e.length;if(r===1)return;const i=e.map(a=>a.flat()),s=i.map(a=>(fe(a,c=>t[c])+me(a,c=>n[c]))/2),o=fe(s);for(let a=0;a<r;a++){const c=o-s[a];for(const u of i[a])t[u]+=c,n[u]+=c}}function Wnt(e,t,n){if(e===void 0&&t===xL)return IL(er);if(e!=null){if(typeof e=="string"){const r=e.startsWith("-"),i=r?Sp:er;switch((r?e.slice(1):e).toLowerCase()){case"value":case n:return Gnt(i);case"z":return Xnt(i);case"sum":return Hnt(i);case"appearance":return Qnt(i);case"inside-out":return IL(i)}return EL(qR(e))}if(typeof e=="function")return(e.length===1?EL:Jnt)(e);if(Bi(e))return Knt(e);throw new Error(`invalid order: ${e}`)}}function Gnt(e){return(t,n,r)=>(i,s)=>e(r[i],r[s])}function Xnt(e){return(t,n,r,i)=>(s,o)=>e(i[s],i[o])}function Hnt(e){return ay(e,(t,n,r,i)=>Gm(Pi(t),s=>dr(s,o=>r[o]),s=>i[s]))}function Qnt(e){return ay(e,(t,n,r,i)=>Gm(Pi(t),s=>n[Qm(s,o=>r[o])],s=>i[s]))}function IL(e){return ay(e,(t,n,r,i)=>{const s=Pi(t),o=Gm(s,h=>n[Qm(h,f=>r[f])],h=>i[h]),a=_a(s,h=>dr(h,f=>r[f]),h=>i[h]),c=[],u=[];let l=0;for(const h of o)l<0?(l+=a.get(h),c.push(h)):(l-=a.get(h),u.push(h));return u.reverse().concat(c)})}function EL(e){return t=>{const n=Tt(t,e);return(r,i)=>er(n[r],n[i])}}function Jnt(e){return t=>Bi(t)?(n,r)=>e(t[n],t[r]):(n,r)=>e(t.get(n),t.get(r))}function Knt(e){return ay(er,()=>e)}function ay(e,t){return(n,r,i,s)=>{if(!s)throw new Error("missing channel: z");const o=new fo(t(n,r,i,s).map((a,c)=>[a,c]));return(a,c)=>e(o.get(s[a]),o.get(s[c]))}}const Znt={ariaLabel:"rect"};class cy extends te{constructor(t,n={}){const{x1:r,y1:i,x2:s,y2:o}=n;super(t,{x1:{value:r,scale:"x",type:r!=null&&s==null?"band":void 0,optional:!0},y1:{value:i,scale:"y",type:i!=null&&o==null?"band":void 0,optional:!0},x2:{value:s,scale:"x",optional:!0},y2:{value:o,scale:"y",optional:!0}},n,Znt),s_(this,n),o_(this,n)}render(t,n,r,i,s){const{x:o,y:a}=n;let{x1:c,y1:u,x2:l,y2:h}=r;const{marginTop:f,marginRight:d,marginBottom:p,marginLeft:y,width:g,height:m}=i,{projection:b}=s,{insetTop:w,insetRight:_,insetBottom:x,insetLeft:v}=this,{rx:S,ry:A,rx1y1:M,rx1y2:T,rx2y1:I,rx2y2:R}=this;(c||l)&&!b&&ni(o)&&(c=l=null),(u||h)&&!b&&ni(a)&&(u=h=null);const L=o?.bandwidth?o.bandwidth():0,E=a?.bandwidth?a.bandwidth():0;return Ft("svg:g",s).call(ce,this,i,s).call(Zt,this,{},0,0).call($=>$.selectAll().data(t).enter().call(M||T||I||R?N=>N.append("path").call(Gt,this).call(a_,c&&l?D=>c[D]+(l[D]<c[D]?-_:v):c?D=>c[D]+v:y+v,u&&h?D=>u[D]+(h[D]<u[D]?-x:w):u?D=>u[D]+w:f+w,c&&l?D=>l[D]-(l[D]<c[D]?-v:_):c?D=>c[D]+L-_:g-d-_,u&&h?D=>h[D]-(h[D]<u[D]?-w:x):u?D=>u[D]+E-x:m-p-x,this).call(be,this,r):N=>N.append("rect").call(Gt,this).attr("x",c?l?D=>Math.min(c[D],l[D])+v:D=>c[D]+v:y+v).attr("y",u?h?D=>Math.min(u[D],h[D])+w:D=>u[D]+w:f+w).attr("width",c?l?D=>Math.max(0,Math.abs(l[D]-c[D])+L-v-_):L-v-_:g-d-y-_-v).attr("height",u?h?D=>Math.max(0,Math.abs(u[D]-h[D])+E-w-x):E-w-x:m-f-p-w-x).call(ut,"rx",S).call(ut,"ry",A).call(be,this,r))).node()}}function s_(e,{inset:t=0,insetTop:n=t,insetRight:r=t,insetBottom:i=t,insetLeft:s=t}={}){e.insetTop=ae(n),e.insetRight=ae(r),e.insetBottom=ae(i),e.insetLeft=ae(s)}function o_(e,{r:t,rx:n,ry:r,rx1:i=t,ry1:s=t,rx2:o=t,ry2:a=t,rx1y1:c=i!==void 0?+i:s!==void 0?+s:0,rx1y2:u=i!==void 0?+i:a!==void 0?+a:0,rx2y1:l=o!==void 0?+o:s!==void 0?+s:0,rx2y2:h=o!==void 0?+o:a!==void 0?+a:0}={}){c||u||l||h?(e.rx1y1=c,e.rx1y2=u,e.rx2y1=l,e.rx2y2=h):(e.rx=Me(n,"auto"),e.ry=Me(r,"auto"))}function a_(e,t,n,r,i,s){const{rx1y1:o,rx1y2:a,rx2y1:c,rx2y2:u}=s;typeof t!="function"&&(t=Ue(t)),typeof n!="function"&&(n=Ue(n)),typeof r!="function"&&(r=Ue(r)),typeof i!="function"&&(i=Ue(i));const l=Math.max(Math.abs(o+c),Math.abs(a+u)),h=Math.max(Math.abs(o+a),Math.abs(c+u));e.attr("d",f=>{const d=t(f),p=n(f),y=r(f),g=i(f),m=d>y,b=p>g,w=m?y:d,_=m?d:y,x=b?g:p,v=b?p:g,S=Math.min(1,(_-w)/l,(v-x)/h),A=S*(m?b?u:c:b?a:o),M=S*(m?b?a:o:b?u:c),T=S*(m?b?o:a:b?c:u),I=S*(m?b?c:u:b?o:a);return`M${w},${x+ly(A,I)}A${A},${A} 0 0 ${A<0?0:1} ${w+uy(A,I)},${x}H${_-uy(M,T)}A${M},${M} 0 0 ${M<0?0:1} ${_},${x+ly(M,T)}V${v-ly(T,M)}A${T},${T} 0 0 ${T<0?0:1} ${_-uy(T,M)},${v}H${w+uy(I,A)}A${I},${I} 0 0 ${I<0?0:1} ${w},${v-ly(I,A)}Z`})}function uy(e,t){return t<0?e:Math.abs(e)}function ly(e,t){return t<0?Math.abs(e):e}function c_(e,t){return new cy(e,wD(vD(t)))}function fy(e,t={}){return Ga(t)||(t={...t,y:Ee,x2:nt,interval:1}),new cy(e,sy(vD(ry(t))))}function hy(e,t={}){return Ga(t)||(t={...t,x:Ee,y2:nt,interval:1}),new cy(e,oy(wD(iy(t))))}const trt={ariaLabel:"frame",fill:"none",stroke:"currentColor",clip:!1},ert={ariaLabel:"frame",fill:null,stroke:"currentColor",strokeLinecap:"square",clip:!1};class ML extends te{constructor(t={}){const{anchor:n=null}=t;super(dl,void 0,t,n==null?trt:ert),this.anchor=VR(n,"anchor",["top","right","bottom","left"]),s_(this,t),n||o_(this,t)}render(t,n,r,i,s){const{marginTop:o,marginRight:a,marginBottom:c,marginLeft:u,width:l,height:h}=i,{anchor:f,insetTop:d,insetRight:p,insetBottom:y,insetLeft:g}=this,{rx:m,ry:b,rx1y1:w,rx1y2:_,rx2y1:x,rx2y2:v}=this,S=u+g,A=l-a-p,M=o+d,T=h-c-y;return Ft(f?"svg:line":w||_||x||v?"svg:path":"svg:rect",s).datum(0).call(ce,this,i,s).call(Gt,this).call(be,this,r).call(Zt,this,{}).call(f==="left"?I=>I.attr("x1",S).attr("x2",S).attr("y1",M).attr("y2",T):f==="right"?I=>I.attr("x1",A).attr("x2",A).attr("y1",M).attr("y2",T):f==="top"?I=>I.attr("x1",S).attr("x2",A).attr("y1",M).attr("y2",M):f==="bottom"?I=>I.attr("x1",S).attr("x2",A).attr("y1",T).attr("y2",T):w||_||x||v?I=>I.call(a_,S,M,A,T,this):I=>I.attr("x",S).attr("y",M).attr("width",A-S).attr("height",T-M).attr("rx",m).attr("ry",b)).node()}}function u_(e){return new ML(e)}const l_={ariaLabel:"tip",fill:"var(--plot-background)",stroke:"currentColor"},nrt=new Set(["geometry","href","src","ariaLabel","scales"]);class TL extends te{constructor(t,n={}){n.tip&&(n={...n,tip:!1}),n.title===void 0&&zi(t)&&ZR(t)&&(n={...n,title:nt});const{x:r,y:i,x1:s,x2:o,y1:a,y2:c,anchor:u,preferredAnchor:l="bottom",monospace:h,fontFamily:f=h?"ui-monospace, monospace":void 0,fontSize:d,fontStyle:p,fontVariant:y,fontWeight:g,lineHeight:m=1,lineWidth:b=20,frameAnchor:w,format:_,textAnchor:x="start",textOverflow:v,textPadding:S=8,title:A,pointerSize:M=12,pathFilter:T="drop-shadow(0 3px 4px rgba(0,0,0,0.2))"}=n;super(t,{x:{value:s!=null&&o!=null?null:r,scale:"x",optional:!0},y:{value:a!=null&&c!=null?null:i,scale:"y",optional:!0},x1:{value:s,scale:"x",optional:o==null},y1:{value:a,scale:"y",optional:c==null},x2:{value:o,scale:"x",optional:s==null},y2:{value:c,scale:"y",optional:a==null},title:{value:A,optional:!0}},n,l_),this.anchor=nb(u,"anchor"),this.preferredAnchor=nb(l,"preferredAnchor"),this.frameAnchor=bl(w),this.textAnchor=Me(x,"middle"),this.textPadding=+S,this.pointerSize=+M,this.pathFilter=Pe(T),this.lineHeight=+m,this.lineWidth=+b,this.textOverflow=$D(v),this.monospace=!!h,this.fontFamily=Pe(f),this.fontSize=ae(d),this.fontStyle=Pe(p),this.fontVariant=Pe(y),this.fontWeight=Pe(g);for(const I in l_)I in this.channels&&(this[I]=l_[I]);this.splitLines=LD(this),this.clipLine=FD(this),this.format=typeof _=="string"||typeof _=="function"?{title:_}:{..._}}render(t,n,r,i,s){const o=this,{x:a,y:c,fx:u,fy:l}=n,{ownerSVGElement:h,document:f}=s,{anchor:d,monospace:p,lineHeight:y,lineWidth:g}=this,{textPadding:m,pointerSize:b,pathFilter:w}=this,{marginTop:_,marginLeft:x}=i,{x1:v,y1:S,x2:A,y2:M,x:T=v??A,y:I=S??M}=r,R=u?u(t.fx)-x:0,L=l?l(t.fy)-_:0,[E,$]=ri(this,i),N=lD(r,E),D=fD(r,$),k=p?Kb:Jb,C=k(ic);let B,P;"title"in r?(B=NL.call(this,{title:r.channels.title},n),P=ort):(B=NL.call(this,r.channels,n),P=art);const q=Ft("svg:g",s).call(ce,this,i,s).call(OD,this).call(Zt,this,{x:T&&a,y:I&&c}).call(Q=>Q.selectAll().data(t).enter().append("g").attr("transform",K=>`translate(${Math.round(N(K))},${Math.round(D(K))})`).call(Gt,this).call(K=>K.append("path").attr("filter",w)).call(K=>K.append("text").each(function(Y){const J=oe(this);this.setAttribute("fill","currentColor"),this.setAttribute("fill-opacity",1),this.setAttribute("stroke","none");const z=P.call(o,Y,t,B,n,r);if(typeof z=="string")for(const W of o.splitLines(z))V(J,{value:o.clipLine(W)});else{const W=new Set;for(const H of z){const{label:U=""}=H;U&&W.has(U)||(W.add(U),V(J,H))}}})));function V(Q,{label:K,value:Y,color:J,opacity:z}){K??="",Y??="";const W=J!=null||z!=null;let H,U=g*100;const[wt]=sc(K,U,k,C);if(wt>=0)K=K.slice(0,wt).trimEnd()+ic,H=Y.trim(),Y="";else{(K||!Y&&!W)&&(Y=" "+Y);const[$t]=sc(Y,U-k(K),k,C);$t>=0&&(H=Y.trim(),Y=Y.slice(0,$t).trimEnd()+ic)}const tt=Q.append("tspan").attr("x",0).attr("dy",`${y}em`).text("​");K&&tt.append("tspan").attr("font-weight","bold").text(K),Y&&tt.append(()=>f.createTextNode(Y)),W&&tt.append("tspan").text(" ■").attr("fill",J).attr("fill-opacity",z).style("user-select","none"),H&&tt.append("title").text(H)}function G(){const{width:Q,height:K}=i.facet??i;q.selectChildren().each(function(Y){let{x:J,width:z,height:W}=this.getBBox();z=Math.round(z),W=Math.round(W);let H=d;if(H===void 0){const tt=N(Y)+R,$t=D(Y)+L,Ot=tt+z+b+m*2<Q,X=tt-z-b-m*2>0,jt=$t+W+b+m*2<K,Cn=$t-W-b-m*2>0;H=Ot&&X?jt&&Cn?o.preferredAnchor:Cn?"bottom":"top":jt&&Cn?Ot?"left":"right":(Ot||X)&&(jt||Cn)?`${Cn?"bottom":"top"}-${Ot?"left":"right"}`:o.preferredAnchor}const U=this.firstChild,wt=this.lastChild;if(U.setAttribute("d",srt(H,b,m,z,W)),J)for(const tt of wt.childNodes)tt.setAttribute("x",-J);wt.setAttribute("y",`${+rrt(H,wt.childNodes.length,y).toFixed(6)}em`),wt.setAttribute("transform",`translate(${irt(H,b,m,z,W)})`)}),q.attr("visibility",null)}return t.length&&(q.attr("visibility","hidden"),h.isConnected?Promise.resolve().then(G):typeof requestAnimationFrame<"u"&&requestAnimationFrame(G)),q.node()}}function $L(e,{x:t,y:n,...r}={}){return r.frameAnchor===void 0&&([t,n]=Sr(t,n)),new TL(e,{...r,x:t,y:n})}function rrt(e,t,n){return/^top(?:-|$)/.test(e)?.94-n:-.29-t*n}function irt(e,t,n,r,i){switch(e){case"middle":return[-r/2,i/2];case"top-left":return[n,t+n];case"top":return[-r/2,t/2+n];case"top-right":return[-r-n,t+n];case"right":return[-t/2-r-n,i/2];case"bottom-left":return[n,-t-n];case"bottom":return[-r/2,-t/2-n];case"bottom-right":return[-r-n,-t-n];case"left":return[n+t/2,i/2]}}function srt(e,t,n,r,i){const s=r+n*2,o=i+n*2;switch(e){case"middle":return`M${-s/2},${-o/2}h${s}v${o}h${-s}z`;case"top-left":return`M0,0l${t},${t}h${s-t}v${o}h${-s}z`;case"top":return`M0,0l${t/2},${t/2}h${(s-t)/2}v${o}h${-s}v${-o}h${(s-t)/2}z`;case"top-right":return`M0,0l${-t},${t}h${t-s}v${o}h${s}z`;case"right":return`M0,0l${-t/2},${-t/2}v${t/2-o/2}h${-s}v${o}h${s}v${t/2-o/2}z`;case"bottom-left":return`M0,0l${t},${-t}h${s-t}v${-o}h${-s}z`;case"bottom":return`M0,0l${t/2},${-t/2}h${(s-t)/2}v${-o}h${-s}v${o}h${(s-t)/2}z`;case"bottom-right":return`M0,0l${-t},${-t}h${t-s}v${-o}h${s}z`;case"left":return`M0,0l${t/2},${-t/2}v${t/2-o/2}h${s}v${o}h${-s}v${t/2-o/2}z`}}function NL(e,t){const n={};let r=this.format;r=RL(r,e,"x"),r=RL(r,e,"y"),this.format=r;for(const i in r){const s=r[i];if(!(s===null||s===!1))if(i==="fx"||i==="fy")n[i]=!0;else{const o=wb(e,i);o&&(n[i]=o)}}for(const i in e){if(i in n||i in r||nrt.has(i)||(i==="x"||i==="y")&&e.geometry)continue;const s=wb(e,i);if(s){if(s.scale==null&&s.defaultScale==="color")continue;n[i]=s}}this.facet&&(t.fx&&!("fx"in r)&&(n.fx=!0),t.fy&&!("fy"in r)&&(n.fy=!0));for(const i in n){const s=this.format[i];if(typeof s=="string"){const o=n[i]?.value??t[i]?.domain()??[];this.format[i]=(fn(o)?al:La)(s)}else if(s===void 0||s===!0){const o=t[i];this.format[i]=o?.bandwidth?n_(o,o.domain()):ec}}return n}function RL(e,t,n){if(!(n in e))return e;const r=`${n}1`,i=`${n}2`;if((r in e||!(r in t))&&(i in e||!(i in t)))return e;const s=Object.entries(e),o=e[n];return s.splice(s.findIndex(([a])=>a===n)+1,0,[r,o],[i,o]),Object.fromEntries(s)}function ort(e,t,{title:n}){return this.format.title(n.value[e],e)}function*art(e,t,n,r,i){for(const s in n){if(s==="fx"||s==="fy"){yield{label:dy(r,n,s),value:this.format[s](t[s],e)};continue}if(s==="x1"&&"x2"in n||s==="y1"&&"y2"in n)continue;const o=n[s];if(s==="x2"&&"x1"in n)yield{label:DL(r,n,"x"),value:OL(this.format.x2,n.x1,o,e)};else if(s==="y2"&&"y1"in n)yield{label:DL(r,n,"y"),value:OL(this.format.y2,n.y1,o,e)};else{const a=o.value[e],c=o.scale;if(!Be(a)&&c==null)continue;yield{label:dy(r,n,s),value:this.format[s](a,e),color:c==="color"?i[s][e]:null,opacity:c==="opacity"?i[s][e]:null}}}}function OL(e,t,n,r){return n.hint?.length?`${e(n.value[r]-t.value[r],r)}`:`${e(t.value[r],r)}–${e(n.value[r],r)}`}function DL(e,t,n){const r=dy(e,t,`${n}1`,n),i=dy(e,t,`${n}2`,n);return r===i?r:`${r}–${i}`}function dy(e,t,n,r=n){const i=t[n],s=e[i?.scale??n];return String(s?.label??i?.label??r)}function f_(e={}){const{facet:t,style:n,title:r,subtitle:i,caption:s,ariaLabel:o,ariaDescription:a}=e,c=jb(e.className),u=e.marks===void 0?[]:FL(e.marks);u.push(...prt(u));const l=hrt(t,e),h=new Map;for(const C of u){const B=kL(C,l,e);B&&h.set(C,B)}const f=new Map;l&&kl(f,[l],e),kl(f,h,e);const d=FL(yrt(u,f,e));for(const C of d){const B=kL(C,l,e);B&&h.set(C,B)}u.unshift(...d);let p=oet(f,e);if(p!==void 0){const C=l?kb(p,l):void 0;for(const P of u){if(P.facet===null||P.facet==="super")continue;const q=h.get(P);q!==void 0&&(q.facetsIndex=P.fx!=null||P.fy!=null?kb(p,q):C)}const B=new Set;for(const{facetsIndex:P}of h.values())P?.forEach((q,V)=>{q?.length>0&&B.add(V)});p.forEach(0<B.size&&B.size<p.length?(P,q)=>P.empty=!B.has(q):P=>P.empty=!1);for(const P of u)if(P.facet==="exclude"){const q=h.get(P);q!==void 0&&(q.facetsIndex=uet(q.facetsIndex))}}for(const C of ge.keys())$o(e[C])&&C!=="fx"&&C!=="fy"&&f.set(C,[]);const y=new Map;for(const C of u){if(y.has(C))throw new Error("duplicate mark; each mark must be unique");const{facetsIndex:B,channels:P}=h.get(C)??{},{data:q,facets:V,channels:G}=C.initialize(B,P,e);h_(G,e),y.set(C,{data:q,facets:V,channels:G})}const g=Mb(kl(f,y,e),e),m=Ket(g,u,e);Ztt(g,m);const b=UO(g),{fx:w,fy:_}=b,x=w||_?qO(g,m):m,v=w||_?xrt(b,m):m,S=Gp(e),A=S.document,M=Jh("svg").call(A.documentElement);let T=M;S.ownerSVGElement=M,S.className=c,S.projection=_et(e,x),S.path=function(){return qu(this.projection??Eet(b))},S.filterFacets=(C,B)=>kb(p,{channels:B,groups:Rb(C,B)}),S.getMarkState=C=>{const B=y.get(C),P=h.get(C);return{...B,channels:{...B.channels,...P?.channels}}},S.dispatchValue=C=>{T.value!==C&&(T.value=C,T.dispatchEvent(new S.document.defaultView.Event("input",{bubbles:!0})))};const I=new Set;for(const[C,B]of y)if(C.initializer!=null){const P=C.facet==="super"?v:x,q=C.initializer(B.data,B.facets,B.channels,b,P,S);if(q.data!==void 0&&(B.data=q.data),q.facets!==void 0&&(B.facets=q.facets),q.channels!==void 0){const{fx:V,fy:G,...Q}=q.channels;frt(Q),Object.assign(B.channels,Q);for(const K of Object.values(Q)){const{scale:Y}=K;Y!=null&&!GZ(ge.get(Y))&&(CL(K,e),I.add(Y))}(V!=null||G!=null)&&h.set(C,!0)}}if(I.size){const C=new Map;kl(C,y,e,V=>I.has(V)),kl(f,y,e,V=>I.has(V));const B=vrt(Mb(C,e),g),{scales:P,...q}=UO(B);Object.assign(g,B),Object.assign(b,q),Object.assign(b.scales,P)}let R,L;p!==void 0&&(R={x:w?.domain(),y:_?.domain()},p=aet(p,R),L=cet(w,_,m));for(const[C,B]of y)B.values=C.scale(B.channels,b,S);const{width:E,height:$}=m;oe(M).attr("class",c).attr("fill","currentColor").attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("text-anchor","middle").attr("width",E).attr("height",$).attr("viewBox",`0 0 ${E} ${$}`).attr("aria-label",o).attr("aria-description",a).call(C=>C.append("style").text(`:where(.${c}) {
  --plot-background: white;
  display: block;
  height: auto;
  height: intrinsic;
  max-width: 100%;
}
:where(.${c} text),
:where(.${c} tspan) {
  white-space: pre;
}`)).call(Yb,n);for(const C of u){const{channels:B,values:P,facets:q}=y.get(C);if(p===void 0||C.facet==="super"){let V=null;if(q&&(V=q[0],V=C.filter(V,B,P),V.length===0))continue;const G=C.render(V,b,P,v,S);if(G==null)continue;M.appendChild(G)}else{let V;for(const G of p){if(!(C.facetAnchor?.(p,R,G)??!G.empty))continue;let Q=null;if(q){const Y=h.has(C);if(Q=q[Y?G.i:0],Q=C.filter(Q,B,P),Q.length===0)continue;!Y&&Q===q[0]&&(Q=No(Q)),Q.fx=G.x,Q.fy=G.y,Q.fi=G.i}const K=C.render(Q,b,P,x,S);if(K!=null){(V??=oe(M).append("g")).append(()=>K).datum(G);for(const Y of["aria-label","aria-description","aria-hidden","transform"])K.hasAttribute(Y)&&(V.attr(Y,K.getAttribute(Y)),K.removeAttribute(Y))}}V?.selectChildren().each(L)}}const N=knt(g,S,e),{figure:D=r!=null||i!=null||s!=null||N.length>0}=e;D&&(T=A.createElement("figure"),T.className=`${c}-figure`,T.style.maxWidth="initial",r!=null&&T.append(LL(A,r,"h2")),i!=null&&T.append(LL(A,i,"h3")),T.append(...N,M),s!=null&&T.append(crt(A,s)),"value"in M&&(T.value=M.value,delete M.value)),T.scale=set(b.scales),T.legend=Lnt(g,S,e);const k=Ctt();return k>0&&oe(M).append("text").attr("x",E).attr("y",20).attr("dy","-1em").attr("text-anchor","end").attr("font-family","initial").text("⚠️").append("title").text(`${k.toLocaleString("en-US")} warning${k===1?"":"s"}. Please check the console.`),T}function LL(e,t,n){if(t.ownerDocument)return t;const r=e.createElement(n);return r.append(t),r}function crt(e,t){const n=e.createElement("figcaption");return n.append(t),n}function FL(e){return e.flat(1/0).filter(t=>t!=null).map(urt)}function urt(e){return typeof e.render=="function"?e:new lrt(e)}class lrt extends te{constructor(t){if(typeof t!="function")throw new TypeError("invalid mark; missing render function");super(),this.render=t}render(){}}function h_(e,t){for(const n in e)CL(e[n],t);return e}function CL(e,t){const{scale:n,transform:r=!0}=e;if(n==null||!r)return;const{type:i,percent:s,interval:o,transform:a=s?c=>c==null?NaN:c*100:JR(o,i)}=t[n]??{};a!=null&&(e.value=Kt(e.value,a),e.transform=!1)}function frt(e){for(const t in e)bO(t,e[t])}function kl(e,t,n,r=DZ){for(const{channels:i}of t.values())for(const s in i){const o=i[s],{scale:a}=o;if(a!=null&&r(a))if(a==="projection"){if(!xet(n)){const c=n.x?.domain===void 0,u=n.y?.domain===void 0;if(c||u){const[l,h]=Iet(o);c&&d_(e,"x",l),u&&d_(e,"y",h)}}}else d_(e,a,o)}return e}function d_(e,t,n){const r=e.get(t);r!==void 0?r.push(n):e.set(t,[n])}function hrt(e,t){if(e==null)return;const{x:n,y:r}=e;if(n==null&&r==null)return;const i=Wa(e.data);if(i==null)throw new Error("missing facet data");const s={};n!=null&&(s.fx=Al(i,{value:n,scale:"fx"})),r!=null&&(s.fy=Al(i,{value:r,scale:"fy"})),h_(s,t);const o=Rb(i,s);return{channels:s,groups:o,data:e.data}}function kL(e,t,n){if(e.facet===null||e.facet==="super")return;const{fx:r,fy:i}=e;if(r!=null||i!=null){const c=Wa(e.data??r??i);if(c===void 0)throw new Error(`missing facet data in ${e.ariaLabel}`);if(c===null)return;const u={};return r!=null&&(u.fx=Al(c,{value:r,scale:"fx"})),i!=null&&(u.fy=Al(c,{value:i,scale:"fy"})),h_(u,n),{channels:u,groups:Rb(c,u)}}if(t===void 0)return;const{channels:s,groups:o,data:a}=t;if(e.facet!=="auto"||e.data===a)return{channels:s,groups:o};a.length>0&&(o.size>1||o.size===1&&s.fx&&s.fy&&[...o][0][1].size>1)&&ml(Wa(e.data))===ml(a)&&Wi(`Warning: the ${e.ariaLabel} mark appears to use faceted data, but isn’t faceted. The mark data has the same length as the facet data and the mark facet option is "auto", but the mark data and facet data are distinct. If this mark should be faceted, set the mark facet option to true; otherwise, suppress this warning by setting the mark facet option to false.`)}function drt(e,t={}){return Ke({...t,x:null,y:null},(n,r,i,s,o,a)=>a.getMarkState(e))}function prt(e){const t=[];for(const n of e){let r=n.tip;if(r){r===!0?r={}:typeof r=="string"&&(r={pointer:r});let{pointer:i,preferredAnchor:s}=r;i=/^x$/i.test(i)?Qp:/^y$/i.test(i)?Ol:Hp,r=i(drt(n,r)),r.title=null,s===void 0&&(r.preferredAnchor=i===Ol?"left":"bottom");const o=$L(n.data,r);o.facet=n.facet,o.facetAnchor=n.facetAnchor,t.push(o)}}return t}function yrt(e,t,n){let{projection:r,x:i={},y:s={},fx:o={},fy:a={},axis:c,grid:u,facet:l={},facet:{axis:h=c,grid:f}=l,x:{axis:d=c,grid:p=d===null?null:u}=i,y:{axis:y=c,grid:g=y===null?null:u}=s,fx:{axis:m=h,grid:b=m===null?null:f}=o,fy:{axis:w=h,grid:_=w===null?null:f}=a}=n;(r||!$o(i)&&!BL("x",e))&&(d=p=null),(r||!$o(s)&&!BL("y",e))&&(y=g=null),t.has("fx")||(m=b=null),t.has("fy")||(w=_=null),d===void 0&&(d=!my(e,"x")),y===void 0&&(y=!my(e,"y")),m===void 0&&(m=!my(e,"fx")),w===void 0&&(w=!my(e,"fy")),d===!0&&(d="bottom"),y===!0&&(y="left"),m===!0&&(m=d==="top"||d===null?"bottom":"top"),w===!0&&(w=y==="right"||y===null?"left":"right");const x=[];return yy(x,_,rL,a),py(x,w,KD,"right","left",l,a),yy(x,b,sL,o),py(x,m,ZD,"top","bottom",l,o),yy(x,g,nL,s),py(x,y,t_,"left","right",n,s),yy(x,p,iL,i),py(x,d,e_,"bottom","top",n,i),x}function py(e,t,n,r,i,s,o){if(!t)return;const a=mrt(t);o=grt(a?r:t,s,o);const{line:c}=o;(n===t_||n===e_)&&c&&!Ka(c)&&e.push(u_(brt(o))),e.push(n(o)),a&&e.push(n({...o,anchor:i,label:null}))}function yy(e,t,n,r){!t||Ka(t)||e.push(n(_rt(t,r)))}function mrt(e){return/^\s*both\s*$/i.test(e)}function grt(e,t,{line:n=t.line,ticks:r,tickSize:i,tickSpacing:s,tickPadding:o,tickFormat:a,tickRotate:c,fontVariant:u,ariaLabel:l,ariaDescription:h,label:f=t.label,labelAnchor:d,labelArrow:p=t.labelArrow,labelOffset:y}){return{anchor:e,line:n,ticks:r,tickSize:i,tickSpacing:s,tickPadding:o,tickFormat:a,tickRotate:c,fontVariant:u,ariaLabel:l,ariaDescription:h,label:f,labelAnchor:d,labelArrow:p,labelOffset:y}}function brt(e){const{anchor:t,line:n}=e;return{anchor:t,facetAnchor:t+"-empty",stroke:n===!0?void 0:n}}function _rt(e,{stroke:t=gl(e)?e:void 0,ticks:n=wrt(e)?e:void 0,tickSpacing:r,ariaLabel:i,ariaDescription:s}){return{stroke:t,ticks:n,tickSpacing:r,ariaLabel:i,ariaDescription:s}}function wrt(e){switch(typeof e){case"number":return!0;case"string":return!gl(e)}return zi(e)||typeof e?.range=="function"}function my(e,t){const n=`${t}-axis `;return e.some(r=>r.ariaLabel?.startsWith(n))}function BL(e,t){for(const n of t)for(const r in n.channels){const{scale:i}=n.channels[r];if(i===e||i==="projection")return!0}return!1}function vrt(e,t){for(const n in e){const r=e[n],i=t[n];r.label===void 0&&i&&(r.label=i.label)}return e}function xrt({fx:e,fy:t},n){const{marginTop:r,marginRight:i,marginBottom:s,marginLeft:o,width:a,height:c}=Tb(n),u=e&&PL(e),l=t&&PL(t);return{marginTop:t?l[0]:r,marginRight:e?a-u[1]:i,marginBottom:t?c-l[1]:s,marginLeft:e?u[0]:o,inset:{marginTop:n.marginTop,marginRight:n.marginRight,marginBottom:n.marginBottom,marginLeft:n.marginLeft},width:a,height:c}}function PL(e){const t=e.domain();if(t.length===0)return[0,e.bandwidth()];let n=e(t[0]),r=e(t[t.length-1]);return r<n&&([n,r]=[r,n]),[n,r+e.bandwidth()]}const Srt=new Map([["basis",KK],["basis-closed",ZK],["basis-open",tZ],["bundle",eZ],["bump-x",zK],["bump-y",qK],["cardinal",nZ],["cardinal-closed",rZ],["cardinal-open",iZ],["catmull-rom",sZ],["catmull-rom-closed",oZ],["catmull-rom-open",aZ],["linear",cl],["linear-closed",cZ],["monotone-x",uZ],["monotone-y",lZ],["natural",fZ],["step",hZ],["step-after",pZ],["step-before",dZ]]);function p_(e=cl,t){if(typeof e=="function")return e;const n=Srt.get(`${e}`.toLowerCase());if(!n)throw new Error(`unknown curve: ${e}`);if(t!==void 0){if("beta"in n)return n.beta(t);if("tension"in n)return n.tension(t);if("alpha"in n)return n.alpha(t)}return n}function UL(e=lc,t){return typeof e!="function"&&`${e}`.toLowerCase()==="auto"?lc:p_(e,t)}function lc(e){return cl(e)}function qs(e={y:"count"},t={}){[e,t]=b_(e,t);const{x:n,y:r}=t;return g_(gy(n,t,nt),null,null,r,e,Ll(t))}function js(e={x:"count"},t={}){[e,t]=b_(e,t);const{x:n,y:r}=t;return g_(null,gy(r,t,nt),n,null,e,Fl(t))}function Lo(e={fill:"count"},t={}){[e,t]=b_(e,t);const{x:n,y:r}=Art(t);return g_(n,r,null,null,e,Ll(Fl(t)))}function zL(e,t,n={}){if(n?.interval==null)return n;const{reduce:r=bb}=n,i={filter:null};return n[t]!=null&&(i[t]=r),n[`${t}1`]!=null&&(i[`${t}1`]=r),n[`${t}2`]!=null&&(i[`${t}2`]=r),e(i,n)}function y_(e={}){return zL(qs,"y",Do(e,"x"))}function m_(e={}){return zL(js,"x",Do(e,"y"))}function g_(e,t,n,r,{data:i=gb,filter:s=Pp,sort:o,reverse:a,...c}={},u={}){e=qL(e),t=qL(t),c=Irt(c,u),i=WL(i,nt),o=o==null?void 0:YL("sort",o,u),s=s==null?void 0:VL("filter",s,u),n!=null&&ks(c,"x","x1","x2")&&(n=null),r!=null&&ks(c,"y","y1","y2")&&(r=null);const[l,h]=xn(e),[f,d]=xn(e),[p,y]=xn(t),[g,m]=xn(t),[b,w]=n!=null?[n,"x"]:r!=null?[r,"y"]:[],[_,x]=xn(b),{x:v,y:S,z:A,fill:M,stroke:T,x1:I,x2:R,y1:L,y2:E,domain:$,cumulative:N,thresholds:D,interval:k,...C}=u,[B,P]=xn(A),[q]=ln(M),[V]=ln(T),[G,Q]=xn(q),[K,Y]=xn(V);return{..."z"in u&&{z:B||A},..."fill"in u&&{fill:G||M},..."stroke"in u&&{stroke:K||T},...Ar(C,(J,z,W)=>{const H=Dp(Tt(J,b),W?.[w]),U=Tt(J,A),wt=Tt(J,q),tt=Tt(J,V),$t=mb(c,{z:U,fill:wt,stroke:tt}),Ot=[],X=[],jt=H&&x([]),Cn=U&&P([]),ai=wt&&Q([]),Rut=tt&&Y([]),wk=e&&h([]),Out=e&&d([]),vk=t&&y([]),Dut=t&&m([]),Lut=Trt(e,t,J);let Fut=0;for(const Sc of c)Sc.initialize(J);o&&o.initialize(J),s&&s.initialize(J);for(const Sc of z){const xk=[];for(const Ac of c)Ac.scope("facet",Sc);o&&o.scope("facet",Sc),s&&s.scope("facet",Sc);for(const[Ac,Cut]of Ro(Sc,$t))for(const[kut,Qy]of Ro(Cut,H))for(const[ci,Ki]of Lut(Qy))if($t&&(Ki.z=Ac),!(s&&!s.reduce(ci,Ki))){xk.push(Fut++),X.push(i.reduceIndex(ci,J,Ki)),H&&jt.push(kut),U&&Cn.push($t===U?Ac:U[(ci.length>0?ci:Qy)[0]]),wt&&ai.push($t===wt?Ac:wt[(ci.length>0?ci:Qy)[0]]),tt&&Rut.push($t===tt?Ac:tt[(ci.length>0?ci:Qy)[0]]),wk&&(wk.push(Ki.x1),Out.push(Ki.x2)),vk&&(vk.push(Ki.y1),Dut.push(Ki.y2));for(const But of c)But.reduce(ci,Ki);o&&o.reduce(ci,Ki)}Ot.push(xk)}return dO(Ot,o,a),{data:X,facets:Ot}}),...!ks(c,"x")&&(l?{x1:l,x2:f,x:Op(l,f)}:{x:v,x1:I,x2:R}),...!ks(c,"y")&&(p?{y1:p,y2:g,y:Op(p,g)}:{y:S,y1:L,y2:E}),..._&&{[w]:_},...Object.fromEntries(c.map(({name:J,output:z})=>[J,z]))}}function b_({cumulative:e,domain:t,thresholds:n,interval:r,...i},s){return[i,{cumulative:e,domain:t,thresholds:n,interval:r,...s}]}function gy(e,{cumulative:t,domain:n,thresholds:r,interval:i},s){return e={...Qa(e)},e.domain===void 0&&(e.domain=n),e.cumulative===void 0&&(e.cumulative=t),e.thresholds===void 0&&(e.thresholds=r),e.interval===void 0&&(e.interval=i),e.value===void 0&&(e.value=s),e.thresholds=jL(e.thresholds,e.interval),e}function Art(e){let{x:t,y:n}=e;return t=gy(t,e),n=gy(n,e),[t.value,n.value]=Sr(t.value,n.value),{x:t,y:n}}function qL(e){if(e==null)return;const{value:t,cumulative:n,domain:r=Ie,thresholds:i}=e,s=o=>{let a=Tt(o,t),c;if(fn(a)||Mrt(i)){a=Kt(a,YR,Float64Array);let[l,h]=typeof r=="function"?r(a):r,f=typeof i=="function"&&!Ha(i)?i(a,l,h):i;typeof f=="number"&&(f=vN(l,h,f)),Ha(f)&&(r===Ie&&(l=f.floor(l),h=f.offset(f.floor(h))),f=f.range(l,f.offset(h))),c=f}else{a=vn(a);let[l,h]=typeof r=="function"?r(a):r,f=typeof i=="function"&&!Ha(i)?i(a,l,h):i;if(typeof f=="number")if(r===Ie){let d=bu(l,h,f);if(isFinite(d))if(d>0){let p=Math.round(l/d),y=Math.round(h/d);p*d<=l||--p,y*d>h||++y;let g=y-p+1;f=new Float64Array(g);for(let m=0;m<g;++m)f[m]=(p+m)*d}else if(d<0){d=-d;let p=Math.round(l*d),y=Math.round(h*d);p/d<=l||--p,y/d>h||++y;let g=y-p+1;f=new Float64Array(g);for(let m=0;m<g;++m)f[m]=(p+m)/d}else f=[l];else f=[l]}else f=xs(l,h,f);else Ha(f)&&(r===Ie&&(l=f.floor(l),h=f.offset(f.floor(h))),f=f.range(l,f.offset(h)));c=f}const u=[];if(c.length===1)u.push([c[0],c[0]]);else for(let l=1;l<c.length;++l)u.push([c[l-1],c[l]]);return u.bin=(n<0?Nrt:n>0?$rt:__)(u,c,a),u};return s.label=ti(t),s}function jL(e,t,n=GL){if(e===void 0)return t===void 0?n:Xa(t);if(typeof e=="string"){switch(e.toLowerCase()){case"freedman-diaconis":return TY;case"scott":return u4;case"sturges":return Hm;case"auto":return GL}return Tp(e)}return e}function Irt(e,t){return cO(e,t,YL)}function YL(e,t,n){return pb(e,t,n,VL)}function VL(e,t,n){return yb(e,t,n,WL)}function WL(e,t){return Bp(e,t,Ert)}function Ert(e){switch(`${e}`.toLowerCase()){case"x":return Rrt;case"x1":return Drt;case"x2":return Lrt;case"y":return Ort;case"y1":return Frt;case"y2":return Crt;case"z":return mO}throw new Error(`invalid bin reduce: ${e}`)}function GL(e,t,n){return Math.min(200,u4(e,t,n))}function Mrt(e){return CZ(e)||zi(e)&&fn(e)}function Trt(e,t,n){const r=e?.(n),i=t?.(n);return r&&i?function*(s){const o=r.bin(s);for(const[a,[c,u]]of r.entries()){const l=i.bin(o[a]);for(const[h,[f,d]]of i.entries())yield[l[h],{data:n,x1:c,y1:f,x2:u,y2:d}]}}:r?function*(s){const o=r.bin(s);for(const[a,[c,u]]of r.entries())yield[o[a],{data:n,x1:c,x2:u}]}:function*(s){const o=i.bin(s);for(const[a,[c,u]]of i.entries())yield[o[a],{data:n,y1:c,y2:u}]}}function __(e,t,n){return t=vn(t),r=>{const i=e.map(()=>[]);for(const s of r)i[qh(t,n[s])-1]?.push(s);return i}}function $rt(e,t,n){const r=__(e,t,n);return i=>{const s=r(i);for(let o=1,a=s.length;o<a;++o){const c=s[o-1],u=s[o];for(const l of c)u.push(l)}return s}}function Nrt(e,t,n){const r=__(e,t,n);return i=>{const s=r(i);for(let o=s.length-2;o>=0;--o){const a=s[o+1],c=s[o];for(const u of a)c.push(u)}return s}}function XL(e,t){const n=(+e+ +t)/2;return e instanceof Date?new Date(n):n}const Rrt={reduceIndex(e,t,{x1:n,x2:r}){return XL(n,r)}},Ort={reduceIndex(e,t,{y1:n,y2:r}){return XL(n,r)}},Drt={reduceIndex(e,t,{x1:n}){return n}},Lrt={reduceIndex(e,t,{x2:n}){return n}},Frt={reduceIndex(e,t,{y1:n}){return n}},Crt={reduceIndex(e,t,{y2:n}){return n}},krt={ariaLabel:"area",strokeWidth:1,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class by extends te{constructor(t,n={}){const{x1:r,y1:i,x2:s,y2:o,z:a,curve:c,tension:u}=n;super(t,{x1:{value:r,scale:"x"},y1:{value:i,scale:"y"},x2:{value:s,scale:"x",optional:!0},y2:{value:o,scale:"y",optional:!0},z:{value:Cs(n),optional:!0}},n,krt),this.z=a,this.curve=p_(c,u)}filter(t){return t}render(t,n,r,i,s){const{x1:o,y1:a,x2:c=o,y2:u=a}=r;return Ft("svg:g",s).call(ce,this,i,s).call(Zt,this,n,0,0).call(l=>l.selectAll().data(sD(t,[o,a,c,u],this,r)).enter().append("path").call(Gt,this).call(Xp,this,r).attr("d",L1().curve(this.curve).defined(h=>h>=0).x0(h=>o[h]).y0(h=>a[h]).x1(h=>c[h]).y1(h=>u[h]))).node()}}function w_(e,t){return t===void 0?fc(e,{x:Np,y:pl}):new by(e,t)}function Bl(e,t){const{y:n=Ee,...r}=m_(t);return new by(e,sy(ry({...r,y1:n,y2:void 0},n===Ee?"x2":"x")))}function fc(e,t){const{x:n=Ee,...r}=y_(t);return new by(e,oy(iy({...r,x1:n,x2:void 0},n===Ee?"y2":"y")))}const Brt={ariaLabel:"link",fill:"none",stroke:"currentColor",strokeMiterlimit:1};class HL extends te{constructor(t,n={}){const{x1:r,y1:i,x2:s,y2:o,curve:a,tension:c}=n;super(t,{x1:{value:r,scale:"x"},y1:{value:i,scale:"y"},x2:{value:s,scale:"x",optional:!0},y2:{value:o,scale:"y",optional:!0}},n,Brt),this.curve=UL(a,c),nc(this,n)}project(t,n,r){this.curve!==lc&&super.project(t,n,r)}render(t,n,r,i,s){const{x1:o,y1:a,x2:c=o,y2:u=a}=r,{curve:l}=this;return Ft("svg:g",s).call(ce,this,i,s).call(Zt,this,n).call(h=>h.selectAll().data(t).enter().append("path").call(Gt,this).attr("d",l===lc&&s.projection?Prt(s.path(),o,a,c,u):f=>{const d=$i(),p=l(d);return p.lineStart(),p.point(o[f],a[f]),p.point(c[f],u[f]),p.lineEnd(),d}).call(be,this,r).call(Dl,this,r,s)).node()}}function Prt(e,t,n,r,i){return t=vn(t),n=vn(n),r=vn(r),i=vn(i),s=>e({type:"LineString",coordinates:[[t[s],n[s]],[r[s],i[s]]]})}function QL(e,{x:t,x1:n,x2:r,y:i,y1:s,y2:o,...a}={}){return[n,r]=_y(t,n,r),[s,o]=_y(i,s,o),new HL(e,{...a,x1:n,x2:r,y1:s,y2:o})}function _y(e,t,n){if(e===void 0){if(t===void 0){if(n!==void 0)return[n]}else if(n===void 0)return[t]}else{if(t===void 0)return n===void 0?[e]:[e,n];if(n===void 0)return[e,t]}return[t,n]}const Urt={ariaLabel:"arrow",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeMiterlimit:1,strokeWidth:1.5};class JL extends te{constructor(t,n={}){const{x1:r,y1:i,x2:s,y2:o,bend:a=0,headAngle:c=60,headLength:u=8,inset:l=0,insetStart:h=l,insetEnd:f=l,sweep:d}=n;super(t,{x1:{value:r,scale:"x"},y1:{value:i,scale:"y"},x2:{value:s,scale:"x",optional:!0},y2:{value:o,scale:"y",optional:!0}},n,Urt),this.bend=a===!0?22.5:Math.max(-90,Math.min(90,a)),this.headAngle=+c,this.headLength=+u,this.insetStart=+h,this.insetEnd=+f,this.sweep=zrt(d)}render(t,n,r,i,s){const{x1:o,y1:a,x2:c=o,y2:u=a,SW:l}=r,{strokeWidth:h,bend:f,headAngle:d,headLength:p,insetStart:y,insetEnd:g}=this,m=l?_=>l[_]:Ue(h===void 0?1:h),b=d*Jp/2,w=p/1.5;return Ft("svg:g",s).call(ce,this,i,s).call(Zt,this,n).call(_=>_.selectAll().data(t).enter().append("path").call(Gt,this).attr("d",x=>{let v=o[x],S=a[x],A=c[x],M=u[x];const T=Math.hypot(A-v,M-S);if(T<=y+g)return null;let I=Math.atan2(M-S,A-v);const R=Math.min(w*m(x),T/3),L=this.sweep(v,S,A,M)*f*Jp,E=Math.hypot(T/Math.tan(L),T)/2;if(y||g)if(E<1e5){const G=Math.sign(L),[Q,K]=qrt([v,S],[A,M],E,G);if(y&&([v,S]=KL([Q,K,E],[v,S,y],-G*Math.sign(y))),g){const[Y,J]=KL([Q,K,E],[A,M,g],G*Math.sign(g));I+=Math.atan2(J-K,Y-Q)-Math.atan2(M-K,A-Q),A=Y,M=J}}else{const G=A-v,Q=M-S,K=Math.hypot(G,Q);y&&(v+=G/K*y,S+=Q/K*y),g&&(A-=G/K*g,M-=Q/K*g)}const $=I+L,N=$+b,D=$-b,k=A-R*Math.cos(N),C=M-R*Math.sin(N),B=A-R*Math.cos(D),P=M-R*Math.sin(D),q=E<1e5?`A${E},${E} 0,0,${L>0?1:0} `:"L",V=R?`M${k},${C}L${A},${M}L${B},${P}`:"";return`M${v},${S}${q}${A},${M}${V}`}).call(be,this,r)).node()}}function zrt(e=1){if(typeof e=="number")return Ue(Math.sign(e));if(typeof e=="function")return(t,n,r,i)=>Math.sign(e(t,n,r,i));switch(Dn(e,"sweep",["+x","-x","+y","-y"])){case"+x":return(t,n,r)=>qt(t,r);case"-x":return(t,n,r)=>lo(t,r);case"+y":return(t,n,r,i)=>qt(n,i);case"-y":return(t,n,r,i)=>lo(n,i)}}function qrt([e,t],[n,r],i,s){const o=n-e,a=r-t,c=Math.hypot(o,a),u=s*Math.sqrt(i*i-c*c/4)/c;return[(e+n)/2-a*u,(t+r)/2+o*u]}function KL([e,t,n],[r,i,s],o){const a=r-e,c=i-t,u=Math.hypot(a,c),l=(a*a+c*c-s*s+n*n)/(2*u),h=o*Math.sqrt(n*n-l*l);return[e+(a*l+c*h)/u,t+(c*l-a*h)/u]}function jrt(e,{x:t,x1:n,x2:r,y:i,y1:s,y2:o,...a}={}){return[n,r]=_y(t,n,r),[s,o]=_y(i,s,o),new JL(e,{...a,x1:n,x2:r,y1:s,y2:o})}const Yrt={ariaLabel:"bar"};class v_ extends te{constructor(t,n,r={},i=Yrt){super(t,n,r,i),s_(this,r),o_(this,r)}render(t,n,r,i,s){const{rx:o,ry:a,rx1y1:c,rx1y2:u,rx2y1:l,rx2y2:h}=this,f=this._x(n,r,i),d=this._y(n,r,i),p=this._width(n,r,i),y=this._height(n,r,i);return Ft("svg:g",s).call(ce,this,i,s).call(this._transform,this,n).call(g=>g.selectAll().data(t).enter().call(c||u||l||h?m=>m.append("path").call(Gt,this).call(a_,f,d,ZL(f,p),ZL(d,y),this).call(be,this,r):m=>m.append("rect").call(Gt,this).attr("x",f).attr("width",p).attr("y",d).attr("height",y).call(ut,"rx",o).call(ut,"ry",a).call(be,this,r))).node()}_x(t,{x:n},{marginLeft:r}){const{insetLeft:i}=this;return n?s=>n[s]+i:r+i}_y(t,{y:n},{marginTop:r}){const{insetTop:i}=this;return n?s=>n[s]+i:r+i}_width({x:t},{x:n},{marginRight:r,marginLeft:i,width:s}){const{insetLeft:o,insetRight:a}=this,c=n&&t?t.bandwidth():s-r-i;return Math.max(0,c-o-a)}_height({y:t},{y:n},{marginTop:r,marginBottom:i,height:s}){const{insetTop:o,insetBottom:a}=this,c=n&&t?t.bandwidth():s-r-i;return Math.max(0,c-o-a)}}function ZL(e,t){return typeof e=="function"&&typeof t=="function"?n=>e(n)+t(n):typeof e=="function"?n=>e(n)+t:typeof t=="function"?n=>e+t(n):e+t}class x_ extends v_{constructor(t,n={},r){const{x1:i,x2:s,y:o}=n;super(t,{x1:{value:i,scale:"x"},x2:{value:s,scale:"x"},y:{value:o,scale:"y",type:"band",optional:!0}},n,r)}_transform(t,n,{x:r}){t.call(Zt,n,{x:r},0,0)}_x({x:t},{x1:n,x2:r},{marginLeft:i}){const{insetLeft:s}=this;return ni(t)?i+s:o=>Math.min(n[o],r[o])+s}_width({x:t},{x1:n,x2:r},{marginRight:i,marginLeft:s,width:o}){const{insetLeft:a,insetRight:c}=this;return ni(t)?o-i-s-a-c:u=>Math.max(0,Math.abs(r[u]-n[u])-a-c)}}class S_ extends v_{constructor(t,n={},r){const{x:i,y1:s,y2:o}=n;super(t,{y1:{value:s,scale:"y"},y2:{value:o,scale:"y"},x:{value:i,scale:"x",type:"band",optional:!0}},n,r)}_transform(t,n,{y:r}){t.call(Zt,n,{y:r},0,0)}_y({y:t},{y1:n,y2:r},{marginTop:i}){const{insetTop:s}=this;return ni(t)?i+s:o=>Math.min(n[o],r[o])+s}_height({y:t},{y1:n,y2:r},{marginTop:i,marginBottom:s,height:o}){const{insetTop:a,insetBottom:c}=this;return ni(t)?o-i-s-a-c:u=>Math.max(0,Math.abs(r[u]-n[u])-a-c)}}function Fo(e,t={}){return Ga(t)||(t={...t,y:Ee,x2:nt}),new x_(e,sy(Hb(ry(t))))}function Co(e,t={}){return Ga(t)||(t={...t,x:Ee,y2:nt}),new S_(e,oy(Qb(iy(t))))}const Vrt={ariaLabel:"cell"};class wy extends v_{constructor(t,{x:n,y:r,...i}={}){super(t,{x:{value:n,scale:"x",type:"band",optional:!0},y:{value:r,scale:"y",type:"band",optional:!0}},i,Vrt)}_transform(t,n){t.call(Zt,n,{},0,0)}}function hc(e,{x:t,y:n,...r}={}){return[t,n]=Sr(t,n),new wy(e,{...r,x:t,y:n})}function Wrt(e,{x:t=Ee,fill:n,stroke:r,...i}={}){return n===void 0&&ln(r)[0]===void 0&&(n=nt),new wy(e,{...i,x:t,fill:n,stroke:r})}function Grt(e,{y:t=Ee,fill:n,stroke:r,...i}={}){return n===void 0&&ln(r)[0]===void 0&&(n=nt),new wy(e,{...i,y:t,fill:n,stroke:r})}const Xrt={ariaLabel:"dot",fill:"none",stroke:"currentColor",strokeWidth:1.5};function A_(e){return e.sort===void 0&&e.reverse===void 0?oO({channel:"-r"},e):e}class vy extends te{constructor(t,n={}){const{x:r,y:i,r:s,rotate:o,symbol:a=ul,frameAnchor:c}=n,[u,l]=Se(o,0),[h,f]=JZ(a),[d,p]=Se(s,h==null?3:4.5);super(t,{x:{value:r,scale:"x",optional:!0},y:{value:i,scale:"y",optional:!0},r:{value:d,scale:"r",filter:Ci,optional:!0},rotate:{value:u,optional:!0},symbol:{value:h,scale:"auto",optional:!0}},A_(n),Xrt),this.r=p,this.rotate=l,this.symbol=f,this.frameAnchor=bl(c);const{channels:y}=this,{symbol:g}=y;if(g){const{fill:m,stroke:b}=y;g.hint={fill:m?m.value===g.value?"color":"currentColor":this.fill??"currentColor",stroke:b?b.value===g.value?"color":"currentColor":this.stroke??"none"}}}render(t,n,r,i,s){const{x:o,y:a}=n,{x:c,y:u,r:l,rotate:h,symbol:f}=r,{r:d,rotate:p,symbol:y}=this,[g,m]=ri(this,i),b=y===ul,w=l?void 0:d*d*Math.PI;return Ip(d)&&(t=[]),Ft("svg:g",s).call(ce,this,i,s).call(Zt,this,{x:c&&o,y:u&&a}).call(_=>_.selectAll().data(t).enter().append(b?"circle":"path").call(Gt,this).call(b?x=>{x.attr("cx",c?v=>c[v]:g).attr("cy",u?v=>u[v]:m).attr("r",l?v=>l[v]:d)}:x=>{x.attr("transform",Cl`translate(${c?v=>c[v]:g},${u?v=>u[v]:m})${h?v=>` rotate(${h[v]})`:p?` rotate(${p})`:""}`).attr("d",l&&f?v=>{const S=$i();return f[v].draw(S,l[v]*l[v]*Math.PI),S}:l?v=>{const S=$i();return y.draw(S,l[v]*l[v]*Math.PI),S}:f?v=>{const S=$i();return f[v].draw(S,w),S}:(()=>{const v=$i();return y.draw(v,w),v})())}).call(be,this,r)).node()}}function Ys(e,{x:t,y:n,...r}={}){return r.frameAnchor===void 0&&([t,n]=Sr(t,n)),new vy(e,{...r,x:t,y:n})}function Hrt(e,{x:t=nt,...n}={}){return new vy(e,SD({...n,x:t}))}function Qrt(e,{y:t=nt,...n}={}){return new vy(e,xD({...n,y:t}))}function Jrt(e,t){return Ys(e,{...t,symbol:"circle"})}function Krt(e,t){return Ys(e,{...t,symbol:"hexagon"})}const Zrt={ariaLabel:"line",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class xy extends te{constructor(t,n={}){const{x:r,y:i,z:s,curve:o,tension:a}=n;super(t,{x:{value:r,scale:"x"},y:{value:i,scale:"y"},z:{value:Cs(n),optional:!0}},n,Zrt),this.z=s,this.curve=UL(o,a),nc(this,n)}filter(t){return t}project(t,n,r){this.curve!==lc&&super.project(t,n,r)}render(t,n,r,i,s){const{x:o,y:a}=r,{curve:c}=this;return Ft("svg:g",s).call(ce,this,i,s).call(Zt,this,n).call(u=>u.selectAll().data(sD(t,[o,a],this,r)).enter().append("path").call(Gt,this).call(Xp,this,r).call(int,this,r,s).attr("d",c===lc&&s.projection?tit(s.path(),o,a):tR().curve(c).defined(l=>l>=0).x(l=>o[l]).y(l=>a[l]))).node()}}function tit(e,t,n){return t=vn(t),n=vn(n),r=>{let i=[];const s=[i];for(const o of r)o===-1?(i=[],s.push(i)):i.push([t[o],n[o]]);return e({type:"MultiLineString",coordinates:s})}}function Sy(e,{x:t,y:n,...r}={}){return[t,n]=Sr(t,n),new xy(e,{...r,x:t,y:n})}function Pl(e,{x:t=nt,y:n=Ee,...r}={}){return new xy(e,m_({...r,x:t,y:n}))}function Ul(e,{x:t=Ee,y:n=nt,...r}={}){return new xy(e,y_({...r,x:t,y:n}))}function tF(e,t){t=nit(t);const{x:n,y:r,color:i,size:s}=t,o=Ay(e,n),a=Ay(e,r),c=Ay(e,i),u=Ay(e,s);let{fx:l,fy:h,x:{value:f,reduce:d,zero:p,...y},y:{value:g,reduce:m,zero:b,...w},color:{value:_,color:x,reduce:v},size:{value:S,reduce:A},mark:M}=t;if(d===void 0&&(d=m==null&&f==null&&S==null&&g!=null?"count":null),m===void 0&&(m=d==null&&g==null&&S==null&&f!=null?"count":null),A===void 0&&S==null&&v==null&&d==null&&m==null&&(f==null||we(o))&&(g==null||we(a))&&(A="count"),p===void 0&&(p=Iy(d)?!0:void 0),b===void 0&&(b=Iy(m)?!0:void 0),f==null&&g==null)throw new Error("must specify x or y");if(d!=null&&g==null)throw new Error("reducing x requires y");if(m!=null&&f==null)throw new Error("reducing y requires x");M===void 0&&(M=S!=null||A!=null?"dot":Iy(d)||Iy(m)||v!=null?"bar":f!=null&&g!=null?we(o)||we(a)||d==null&&m==null&&!zl(o)&&!zl(a)?"dot":"line":f!=null||g!=null?"rule":null);let T,I,R;switch(M){case"dot":R=Ys,I="stroke";break;case"line":R=o&&a||d!=null||m!=null?b||m!=null||o&&zl(o)?Ul:p||d!=null||a&&zl(a)?Pl:Sy:o?Pl:Ul,I="stroke",nF(c)&&(T=null);break;case"area":R=!(b||m!=null)&&(p||d!=null||a&&zl(a))?Bl:fc,I="fill",nF(c)&&(T=null);break;case"rule":R=o?Ps:Us,I="stroke";break;case"bar":R=d!=null?we(a)?eF(d)&&o&&we(o)?hc:Fo:fy:m!=null?we(o)?eF(m)&&a&&we(a)?hc:Co:hy:v!=null||A!=null?o&&we(o)&&a&&we(a)?hc:o&&we(o)?Co:a&&we(a)?Fo:c_:o&&Ja(o)&&!(a&&Ja(a))?Fo:a&&Ja(a)&&!(o&&Ja(o))?Co:hc,I="fill";break;default:throw new Error(`invalid mark: ${M}`)}let L={fx:l,fy:h,x:o??void 0,y:a??void 0,[I]:c??x,z:T,r:u??void 0,tip:!0},E,$={[I]:v??void 0,r:A??void 0};if(d!=null&&m!=null)throw new Error("cannot reduce both x and y");return m!=null?($.y=m,E=we(o)?xl:qs):d!=null?($.x=d,E=we(a)?Sl:js):(v!=null||A!=null)&&(o&&a?E=we(o)&&we(a)?db:we(o)?js:we(a)?qs:Lo:o?E=we(o)?xl:qs:a&&(E=we(a)?Sl:js)),(E===Lo||E===qs)&&(L.x={value:o,...y}),(E===Lo||E===js)&&(L.y={value:a,...w}),p===void 0&&(p=o&&!(E===Lo||E===qs)&&(R===Fo||R===Bl||R===fy||R===Us)),b===void 0&&(b=a&&!(E===Lo||E===js)&&(R===Co||R===fc||R===hy||R===Ps)),{fx:l??null,fy:h??null,x:{value:f??null,reduce:d??null,zero:!!p,...y},y:{value:g??null,reduce:m??null,zero:!!b,...w},color:{value:_??null,reduce:v??null,...x!==void 0&&{color:x}},size:{value:S??null,reduce:A??null},mark:M,markImpl:rF[R],markOptions:L,transformImpl:rF[E],transformOptions:$,colorMode:I}}function eit(e,t){const n=tF(e,t),{fx:r,fy:i,x:{zero:s},y:{zero:o},markOptions:a,transformOptions:c,colorMode:u}=n,l=I_[n.markImpl],h=I_[n.transformImpl],f=r!=null||i!=null?u_({strokeOpacity:.1}):null,d=[s?Ps([0]):null,o?Us([0]):null],p=l(e,h?h(c,a):a);return u==="stroke"?nr(f,d,p):nr(f,p,d)}function zl(e){let t,n;for(const r of e){if(r==null)continue;if(t===void 0){t=r;continue}const i=Math.sign(qt(t,r));if(i){if(n!==void 0&&i!==n)return!1;t=r,n=i}}return!0}function nit({x:e,y:t,color:n,size:r,fx:i,fy:s,mark:o}={}){return Zr(e)||(e=dc(e)),Zr(t)||(t=dc(t)),Zr(n)||(n=gl(n)?{color:n}:dc(n)),Zr(r)||(r=dc(r)),Zr(i)&&({value:i}=dc(i)),Zr(s)&&({value:s}=dc(s)),o!=null&&(o=`${o}`.toLowerCase()),{x:e,y:t,color:n,size:r,fx:i,fy:s,mark:o}}function Ay(e,t){const n=Tt(e,t.value);return n&&(n.label=ti(t.value)),n}function dc(e){return rit(e)?{reduce:e}:{value:e}}function Iy(e){return/^(?:distinct|count|sum|proportion)$/i.test(e)}function eF(e){return/^(?:first|last|mode)$/i.test(e)}function rit(e){if(e==null)return!1;if(typeof e.reduceIndex=="function"||typeof e.reduce=="function"&&Ln(e)||/^p\d{2}$/i.test(e))return!0;switch(`${e}`.toLowerCase()){case"first":case"last":case"count":case"distinct":case"sum":case"proportion":case"proportion-facet":case"deviation":case"min":case"min-index":case"max":case"max-index":case"mean":case"median":case"variance":case"mode":return!0}return!1}function nF(e){return e?new ba(e).size>e.length>>1:!1}const I_={dot:Ys,line:Sy,lineX:Pl,lineY:Ul,areaX:Bl,areaY:fc,ruleX:Ps,ruleY:Us,barX:Fo,barY:Co,rect:c_,rectX:fy,rectY:hy,cell:hc,bin:Lo,binX:qs,binY:js,group:db,groupX:xl,groupY:Sl},rF=Object.fromEntries(Object.entries(I_).map(([e,t])=>[t,e]));function E_(e,t={}){let{x:n,x1:r,x2:i}=t;n===void 0&&r===void 0&&i===void 0&&(t={...t,x:n=nt});const s={};return n!=null&&(s.x=e),r!=null&&(s.x1=e),i!=null&&(s.x2=e),ii(s,t)}function M_(e,t={}){let{y:n,y1:r,y2:i}=t;n===void 0&&r===void 0&&i===void 0&&(t={...t,y:n=nt});const s={};return n!=null&&(s.y=e),r!=null&&(s.y1=e),i!=null&&(s.y2=e),ii(s,t)}function ii(e={},t={}){const n=Cs(t),r=Object.entries(e).map(([i,s])=>{const o=QR(i,t);if(o==null)throw new Error(`missing channel: ${i}`);const[a,c]=Fn(o);return{key:i,input:o,output:a,setOutput:c,map:iit(s)}});return{...Ar(t,(i,s)=>{const o=Tt(i,n),a=r.map(({input:u})=>Tt(i,u)),c=r.map(({setOutput:u})=>u(new Array(i.length)));for(const u of s)for(const l of o?vs(u,h=>o[h]).values():[u])r.forEach(({map:h},f)=>h.mapIndex(l,a[f],c[f]));return{data:i,facets:s}}),...Object.fromEntries(r.map(({key:i,output:s})=>[i,s]))}}function iit(e){if(e==null)throw new Error("missing map");if(typeof e.mapIndex=="function")return e;if(typeof e.map=="function"&&Ln(e))return sit(e);if(typeof e=="function")return T_(tb(e));switch(`${e}`.toLowerCase()){case"cumsum":return ait;case"rank":return T_((t,n)=>h4(t,r=>n[r]));case"quantile":return T_((t,n)=>oit(t,r=>n[r]))}throw new Error(`invalid map: ${e}`)}function sit(e){return console.warn("deprecated map interface; implement mapIndex instead."),{mapIndex:e.map.bind(e)}}function oit(e,t){const n=jh(e,t)-1;return h4(e,t).map(r=>r/n)}function T_(e){return{mapIndex(t,n,r){const i=e(t,n);if(i.length!==t.length)throw new Error("map function returned a mismatched length");for(let s=0,o=t.length;s<o;++s)r[t[s]]=i[s]}}}const ait={mapIndex(e,t,n){let r=0;for(const i of e)n[i]=r+=t[i]}};function cit(e={},t){return arguments.length===1&&(t=e),E_(Ey(e),t)}function uit(e={},t){return arguments.length===1&&(t=e),M_(Ey(e),t)}function Ey(e={}){typeof e=="number"&&(e={k:e});let{k:t,reduce:n,shift:r,anchor:i,strict:s}=e;if(i===void 0&&r!==void 0&&(i=fit(r),Wi(`Warning: the shift option is deprecated; please use anchor "${i}" instead.`)),!((t=Math.floor(t))>0))throw new Error(`invalid k: ${t}`);return hit(n)(t,lit(i,t),s)}function lit(e="middle",t){switch(`${e}`.toLowerCase()){case"middle":return t-1>>1;case"start":return 0;case"end":return t-1}throw new Error(`invalid anchor: ${e}`)}function fit(e){switch(`${e}`.toLowerCase()){case"centered":return"middle";case"leading":return"start";case"trailing":return"end"}throw new Error(`invalid shift: ${e}`)}function hit(e="mean"){if(typeof e=="string"){if(/^p\d{2}$/i.test(e))return My(K1(e));switch(e.toLowerCase()){case"deviation":return My(mu);case"max":return Ty((t,n)=>me(t,r=>n[r]));case"mean":return dit;case"median":return My(wu);case"min":return Ty((t,n)=>fe(t,r=>n[r]));case"mode":return Ty((t,n)=>f4(t,r=>n[r]));case"sum":return iF;case"variance":return My(qm);case"difference":return mit;case"ratio":return git;case"first":return bit;case"last":return _it}}if(typeof e!="function")throw new Error(`invalid reduce: ${e}`);return Ty(tb(e))}function My(e){return(t,n,r)=>r?{mapIndex(i,s,o){const a=u=>s[u]==null?NaN:+s[u];let c=0;for(let u=0;u<t-1;++u)isNaN(a(u))&&++c;for(let u=0,l=i.length-t+1;u<l;++u)isNaN(a(u+t-1))&&++c,o[i[u+n]]=c===0?e(No(i,u,u+t),a):NaN,isNaN(a(u))&&--c}}:{mapIndex(i,s,o){const a=c=>s[c]==null?NaN:+s[c];for(let c=-n;c<0;++c)o[i[c+n]]=e(No(i,0,c+t),a);for(let c=0,u=i.length-n;c<u;++c)o[i[c+n]]=e(No(i,c,c+t),a)}}}function Ty(e){return(t,n,r)=>r?{mapIndex(i,s,o){let a=0;for(let c=0;c<t-1;++c)a+=Be(s[i[c]]);for(let c=0,u=i.length-t+1;c<u;++c)a+=Be(s[i[c+t-1]]),a===t&&(o[i[c+n]]=e(No(i,c,c+t),s)),a-=Be(s[i[c]])}}:{mapIndex(i,s,o){for(let a=-n;a<0;++a)o[i[a+n]]=e(No(i,0,a+t),s);for(let a=0,c=i.length-n;a<c;++a)o[i[a+n]]=e(No(i,a,a+t),s)}}}function iF(e,t,n){return n?{mapIndex(r,i,s){let o=0,a=0;for(let c=0;c<e-1;++c){const u=i[r[c]];u===null||isNaN(u)?++o:a+=+u}for(let c=0,u=r.length-e+1;c<u;++c){const l=i[r[c]],h=i[r[c+e-1]];h===null||isNaN(h)?++o:a+=+h,s[r[c+t]]=o===0?a:NaN,l===null||isNaN(l)?--o:a-=+l}}}:{mapIndex(r,i,s){let o=0;const a=r.length;for(let c=0,u=Math.min(a,e-t-1);c<u;++c)o+=+i[r[c]]||0;for(let c=-t,u=a-t;c<u;++c)o+=+i[r[c+e-1]]||0,s[r[c+t]]=o,o-=+i[r[c]]||0}}}function dit(e,t,n){if(n){const r=iF(e,t,n);return{mapIndex(i,s,o){r.mapIndex(i,s,o);for(let a=0,c=i.length-e+1;a<c;++a)o[i[a+t]]/=e}}}else return{mapIndex(r,i,s){let o=0,a=0;const c=r.length;for(let u=0,l=Math.min(c,e-t-1);u<l;++u){let h=i[r[u]];h!==null&&!isNaN(h=+h)&&(o+=h,++a)}for(let u=-t,l=c-t;u<l;++u){let h=i[r[u+e-1]],f=i[r[u]];h!==null&&!isNaN(h=+h)&&(o+=h,++a),s[r[u+t]]=o/a,f!==null&&!isNaN(f=+f)&&(o-=f,--a)}}}}function pit(e,t,n,r){for(let i=n+r;n<i;++n){const s=e[t[n]];if(Be(s))return s}}function yit(e,t,n,r){for(let i=n+r-1;i>=n;--i){const s=e[t[i]];if(Be(s))return s}}function sF(e,t,n,r){for(let i=n+r;n<i;++n){let s=e[t[n]];if(s!==null&&!isNaN(s=+s))return s}}function oF(e,t,n,r){for(let i=n+r-1;i>=n;--i){let s=e[t[i]];if(s!==null&&!isNaN(s=+s))return s}}function mit(e,t,n){return n?{mapIndex(r,i,s){for(let o=0,a=r.length-e;o<a;++o){const c=i[r[o]],u=i[r[o+e-1]];s[r[o+t]]=c===null||u===null?NaN:u-c}}}:{mapIndex(r,i,s){for(let o=-t,a=r.length-e+t+1;o<a;++o)s[r[o+t]]=oF(i,r,o,e)-sF(i,r,o,e)}}}function git(e,t,n){return n?{mapIndex(r,i,s){for(let o=0,a=r.length-e;o<a;++o){const c=i[r[o]],u=i[r[o+e-1]];s[r[o+t]]=c===null||u===null?NaN:u/c}}}:{mapIndex(r,i,s){for(let o=-t,a=r.length-e+t+1;o<a;++o)s[r[o+t]]=oF(i,r,o,e)/sF(i,r,o,e)}}}function bit(e,t,n){return n?{mapIndex(r,i,s){for(let o=0,a=r.length-e;o<a;++o)s[r[o+t]]=i[r[o]]}}:{mapIndex(r,i,s){for(let o=-t,a=r.length-e+t+1;o<a;++o)s[r[o+t]]=pit(i,r,o,e)}}}function _it(e,t,n){return n?{mapIndex(r,i,s){for(let o=0,a=r.length-e;o<a;++o)s[r[o+t]]=i[r[o+e-1]]}}:{mapIndex(r,i,s){for(let o=-t,a=r.length-e+t+1;o<a;++o)s[r[o+t]]=yit(i,r,o,e)}}}const Xi={n:20,k:2,color:"currentColor",opacity:.2,strict:!0,anchor:"end"};function wit(e,{x:t=nt,y:n,k:r=Xi.k,color:i=Xi.color,opacity:s=Xi.opacity,fill:o=i,fillOpacity:a=s,stroke:c=i,strokeOpacity:u,strokeWidth:l,...h}={}){return nr(he(o)?null:Bl(e,ii({x1:ko({k:-r,...h}),x2:ko({k:r,...h})},{x1:t,x2:t,y:n,fill:o,fillOpacity:a,...h})),he(c)?null:Pl(e,ii({x:ko(h)},{x:t,y:n,stroke:c,strokeOpacity:u,strokeWidth:l,...h})))}function vit(e,{x:t,y:n=nt,k:r=Xi.k,color:i=Xi.color,opacity:s=Xi.opacity,fill:o=i,fillOpacity:a=s,stroke:c=i,strokeOpacity:u,strokeWidth:l,...h}={}){return nr(he(o)?null:fc(e,ii({y1:ko({k:-r,...h}),y2:ko({k:r,...h})},{x:t,y1:n,y2:n,fill:o,fillOpacity:a,...h})),he(c)?null:Ul(e,ii({y:ko(h)},{x:t,y:n,stroke:c,strokeOpacity:u,strokeWidth:l,...h})))}function ko({n:e=Xi.n,k:t=0,strict:n=Xi.strict,anchor:r=Xi.anchor}={}){return Ey({k:e,reduce:i=>Wh(i)+t*(mu(i)||0),strict:n,anchor:r})}const xit={ariaLabel:"tick",fill:null,stroke:"currentColor"};class aF extends te{constructor(t,n,r){super(t,n,r,xit),nc(this,r)}render(t,n,r,i,s){return Ft("svg:g",s).call(ce,this,i,s).call(this._transform,this,n).call(o=>o.selectAll().data(t).enter().append("line").call(Gt,this).attr("x1",this._x1(n,r,i)).attr("x2",this._x2(n,r,i)).attr("y1",this._y1(n,r,i)).attr("y2",this._y2(n,r,i)).call(be,this,r).call(Dl,this,r,s)).node()}}class cF extends aF{constructor(t,n={}){const{x:r,y:i,inset:s=0,insetTop:o=s,insetBottom:a=s}=n;super(t,{x:{value:r,scale:"x"},y:{value:i,scale:"y",type:"band",optional:!0}},n),this.insetTop=ae(o),this.insetBottom=ae(a)}_transform(t,n,{x:r}){t.call(Zt,n,{x:r},ze,0)}_x1(t,{x:n}){return r=>n[r]}_x2(t,{x:n}){return r=>n[r]}_y1({y:t},{y:n},{marginTop:r}){const{insetTop:i}=this;return n&&t?s=>n[s]+i:r+i}_y2({y:t},{y:n},{height:r,marginBottom:i}){const{insetBottom:s}=this;return n&&t?o=>n[o]+t.bandwidth()-s:r-i-s}}class uF extends aF{constructor(t,n={}){const{x:r,y:i,inset:s=0,insetRight:o=s,insetLeft:a=s}=n;super(t,{y:{value:i,scale:"y"},x:{value:r,scale:"x",type:"band",optional:!0}},n),this.insetRight=ae(o),this.insetLeft=ae(a)}_transform(t,n,{y:r}){t.call(Zt,n,{y:r},0,ze)}_x1({x:t},{x:n},{marginLeft:r}){const{insetLeft:i}=this;return n&&t?s=>n[s]+i:r+i}_x2({x:t},{x:n},{width:r,marginRight:i}){const{insetRight:s}=this;return n&&t?o=>n[o]+t.bandwidth()-s:r-i-s}_y1(t,{y:n}){return r=>n[r]}_y2(t,{y:n}){return r=>n[r]}}function lF(e,{x:t=nt,...n}={}){return new cF(e,{...n,x:t})}function fF(e,{y:t=nt,...n}={}){return new uF(e,{...n,y:t})}function Sit(e,{x:t=nt,y:n=null,r,fill:i="#ccc",fillOpacity:s,stroke:o="currentColor",strokeOpacity:a,strokeWidth:c=2,sort:u,...l}={}){const h=n!=null?Sl:hb;return nr(Us(e,h({x1:$_,x2:N_},{x:t,y:n,stroke:o,strokeOpacity:a,...l})),Fo(e,h({x1:"p25",x2:"p75"},{x:t,y:n,fill:i,fillOpacity:s,...l})),lF(e,h({x:"p50"},{x:t,y:n,stroke:o,strokeOpacity:a,strokeWidth:c,sort:u,...l})),Ys(e,ii({x:hF},{x:t,y:n,z:n,r,stroke:o,strokeOpacity:a,...l})))}function Ait(e,{y:t=nt,x:n=null,r,fill:i="#ccc",fillOpacity:s,stroke:o="currentColor",strokeOpacity:a,strokeWidth:c=2,sort:u,...l}={}){const h=n!=null?xl:hb;return nr(Ps(e,h({y1:$_,y2:N_},{x:n,y:t,stroke:o,strokeOpacity:a,...l})),Co(e,h({y1:"p25",y2:"p75"},{x:n,y:t,fill:i,fillOpacity:s,...l})),fF(e,h({y:"p50"},{x:n,y:t,stroke:o,strokeOpacity:a,strokeWidth:c,sort:u,...l})),Ys(e,ii({y:hF},{x:n,y:t,z:n,r,stroke:o,strokeOpacity:a,...l})))}function hF(e){const t=$_(e),n=N_(e);return e.map(r=>r<t||r>n?r:NaN)}function $_(e){const t=dF(e)*2.5-pF(e)*1.5;return fe(e,n=>n>=t?n:NaN)}function N_(e){const t=pF(e)*2.5-dF(e)*1.5;return me(e,n=>n<=t?n:NaN)}function dF(e){return Ss(e,.25)}function pF(e){return Ss(e,.75)}const Iit={ariaLabel:"raster",stroke:null,pixelSize:1};function pc(e,t){const n=+e;if(isNaN(n))throw new Error(`invalid ${t}: ${e}`);return n}function yF(e,t){const n=Math.floor(e);if(isNaN(n))throw new Error(`invalid ${t}: ${e}`);return n}class mF extends te{constructor(t,n,r={},i){let{width:s,height:o,x:a,y:c,x1:u=a==null?0:void 0,y1:l=c==null?0:void 0,x2:h=a==null?s:void 0,y2:f=c==null?o:void 0,pixelSize:d=i.pixelSize,blur:p=0,interpolate:y}=r;if(s!=null&&(s=yF(s,"width")),o!=null&&(o=yF(o,"height")),u!=null&&(u=pc(u,"x1")),l!=null&&(l=pc(l,"y1")),h!=null&&(h=pc(h,"x2")),f!=null&&(f=pc(f,"y2")),a==null&&(u==null||h==null))throw new Error("missing x");if(c==null&&(l==null||f==null))throw new Error("missing y");t!=null&&s!=null&&o!=null&&(a===void 0&&u!=null&&h!=null&&(a=Lit(u,h,s)),c===void 0&&l!=null&&f!=null&&(c=Fit(l,f,s,o))),super(t,{x:{value:a,scale:"x",optional:!0},y:{value:c,scale:"y",optional:!0},x1:{value:u==null?null:[u],scale:"x",optional:!0,filter:null},y1:{value:l==null?null:[l],scale:"y",optional:!0,filter:null},x2:{value:h==null?null:[h],scale:"x",optional:!0,filter:null},y2:{value:f==null?null:[f],scale:"y",optional:!0,filter:null},...n},r,i),this.width=s,this.height=o,this.pixelSize=pc(d,"pixelSize"),this.blur=pc(p,"blur"),this.interpolate=a==null||c==null?null:Mit(y)}}class gF extends mF{constructor(t,n={}){const{imageRendering:r}=n;if(t==null){const{fill:i,fillOpacity:s}=n;Se(s)[0]!==void 0&&(n=R_("fillOpacity",n)),ln(i)[0]!==void 0&&(n=R_("fill",n))}super(t,void 0,n,Iit),this.imageRendering=Me(r,"auto")}scale(t,{color:n,...r},i){return super.scale(t,r,i)}render(t,n,r,i,s){const o=n[r.channels.fill?.scale]??($=>$),{x:a,y:c}=r,{document:u}=s,[l,h,f,d]=_F(r,i,s),p=f-l,y=d-h,{pixelSize:g,width:m=Math.round(Math.abs(p)/g),height:b=Math.round(Math.abs(y)/g)}=this,w=m*b;let{fill:_,fillOpacity:x}=r,v=0;if(this.interpolate){const $=m/p,N=b/y,D=Kt(a,C=>(C-l)*$,Float64Array),k=Kt(c,C=>(C-h)*N,Float64Array);_&&(_=this.interpolate(t,m,b,D,k,_)),x&&(x=this.interpolate(t,m,b,D,k,x))}else this.data==null&&t&&(v=t.fi*w);const S=u.createElement("canvas");S.width=m,S.height=b;const A=S.getContext("2d"),M=A.createImageData(m,b),T=M.data;let{r:I,g:R,b:L}=Nn(this.fill)??{r:0,g:0,b:0},E=(this.fillOpacity??1)*255;for(let $=0;$<w;++$){const N=$<<2;if(_){const D=o(_[$+v]);if(D==null){T[N+3]=0;continue}({r:I,g:R,b:L}=Nn(D))}x&&(E=x[$+v]*255),T[N+0]=I,T[N+1]=R,T[N+2]=L,T[N+3]=E}return this.blur>0&&fY(M,this.blur),A.putImageData(M,0,0),Ft("svg:g",s).call(ce,this,i,s).call(Zt,this,n).call($=>$.append("image").attr("transform",`translate(${l},${h}) scale(${Math.sign(f-l)},${Math.sign(d-h)})`).attr("width",Math.abs(p)).attr("height",Math.abs(y)).attr("preserveAspectRatio","none").call(ut,"image-rendering",this.imageRendering).call(Gt,this).attr("xlink:href",S.toDataURL())).node()}}function bF(e,t,n){arguments.length<3&&(n=t,t=null);let{x:r,y:i,[e]:s,...o}=n;return r===void 0&&i===void 0&&BZ(t)&&(r=Np,i=pl,s===void 0&&(s=LZ)),[t,{...o,x:r,y:i,[e]:s}]}function Eit(){const[e,t]=bF("fill",...arguments);return new gF(e,e==null||t.fill!==void 0||t.fillOpacity!==void 0?t:{...t,fill:nt})}function _F({x1:e,y1:t,x2:n,y2:r},i,{projection:s}){const{width:o,height:a,marginTop:c,marginRight:u,marginBottom:l,marginLeft:h}=i;return[e&&s==null?e[0]:h,t&&s==null?t[0]:c,n&&s==null?n[0]:o-u,r&&s==null?r[0]:a-l]}function wF({x1:e,y1:t,x2:n,y2:r},i,s,o){const a={};return e&&(a.x1=e),t&&(a.y1=t),n&&(a.x2=n),r&&(a.y2=r),_F(Up(a,i),s,o)}function R_(e,t={}){const{[e]:n}=t;if(typeof n!="function")throw new Error(`invalid ${e}: not a function`);return Ke({...t,[e]:void 0},function(r,i,s,o,a,c){const{x:u,y:l}=o;if(!u)throw new Error("missing scale: x");if(!l)throw new Error("missing scale: y");const[h,f,d,p]=wF(s,o,a,c),y=d-h,g=p-f,{pixelSize:m}=this,{width:b=Math.round(Math.abs(y)/m),height:w=Math.round(Math.abs(g)/m)}=t,_=new Array(b*w*(i?i.length:1)),x=y/b,v=g/w;let S=0;for(const A of i??[void 0])for(let M=.5;M<w;++M)for(let T=.5;T<b;++T,++S)_[S]=n(u.invert(h+T*x),l.invert(f+M*v),A);return{data:_,facets:i,channels:{[e]:{value:_,scale:"auto"}}}})}function Mit(e){if(typeof e=="function")return e;if(e==null)return O_;switch(`${e}`.toLowerCase()){case"none":return O_;case"nearest":return L_;case"barycentric":return D_();case"random-walk":return F_()}throw new Error(`invalid interpolate: ${e}`)}function O_(e,t,n,r,i,s){const o=new Array(t*n);for(const a of e)r[a]<0||r[a]>=t||i[a]<0||i[a]>=n||(o[Math.floor(i[a])*t+Math.floor(r[a])]=s[a]);return o}function D_({random:e=b1(42)}={}){return(t,n,r,i,s,o)=>{const{points:a,triangles:c,hull:u}=Ms.from(t,d=>i[d],d=>s[d]),l=new o.constructor(n*r).fill(NaN),h=new Uint8Array(n*r),f=Dit(o,e);for(let d=0;d<c.length;d+=3){const p=c[d],y=c[d+1],g=c[d+2],m=a[2*p],b=a[2*y],w=a[2*g],_=a[2*p+1],x=a[2*y+1],v=a[2*g+1],S=Math.min(m,b,w),A=Math.max(m,b,w),M=Math.min(_,x,v),T=Math.max(_,x,v),I=(x-v)*(m-w)+(_-v)*(w-b);if(!I)continue;const R=o[t[p]],L=o[t[y]],E=o[t[g]];for(let $=Math.floor(S);$<A;++$)for(let N=Math.floor(M);N<T;++N){if($<0||$>=n||N<0||N>=r)continue;const D=$+.5,k=N+.5,C=Math.sign(I),B=(x-v)*(D-w)+(k-v)*(w-b);if(B*C<0)continue;const P=(v-_)*(D-w)+(k-v)*(m-w);if(P*C<0)continue;const q=I-(B+P);if(q*C<0)continue;const V=$+n*N;l[V]=f(R,B/I,L,P/I,E,q/I,$,N),h[V]=1}}return Tit(l,h,i,s,o,n,r,u,t,f),l}}function Tit(e,t,n,r,i,s,o,a,c,u){n=Float64Array.from(a,d=>n[c[d]]),r=Float64Array.from(a,d=>r[c[d]]),i=Array.from(a,d=>i[c[d]]);const l=n.length,h=Array.from({length:l},(d,p)=>Nit(p,n,r));let f=0;for(let d=0;d<o;++d){const p=d+.5;for(let y=0;y<s;++y){const g=y+s*d;if(!t[g]){const m=y+.5;for(let b=0;b<l;++b){const w=(l+f+(b%2?(b+1)/2:-b/2))%l;if(h[w](m,p)){const _=$it(n.at(w-1),r.at(w-1),n[w],r[w],m,p);e[g]=u(i.at(w-1),_,i[w],1-_,i[w],0,y,d),f=w;break}}}}}}function $it(e,t,n,r,i,s){const o=n-e,a=r-t,c=o*(n-i)+a*(r-s),u=o*(i-e)+a*(s-t);return c>0&&u>0?c/(c+u):+(c>u)}function ql(e,t,n,r){return e*r-n*t}function Nit(e,t,n){const r=t.length,i=t.at(e-2),s=n.at(e-2),o=t.at(e-1),a=n.at(e-1),c=t[e],u=n[e],l=t.at(e+1-r),h=n.at(e+1-r),f=o-c,d=a-u,p=i-o,y=s-a,g=c-l,m=u-h,b=Math.hypot(f,d),w=Math.hypot(p,y),_=Math.hypot(g,m);return(x,v)=>{const S=x-o,A=v-a,M=x-c,T=v-u;return ql(S,A,M,T)>-1e-6&&ql(S,A,f,d)*w-ql(S,A,p,y)*b>-1e-6&&ql(M,T,g,m)*b-ql(M,T,f,d)*_<=0}}function L_(e,t,n,r,i,s){const o=new s.constructor(t*n),a=Ms.from(e,l=>r[l],l=>i[l]);let c,u;for(let l=.5,h=0;l<n;++l){u=c;for(let f=.5;f<t;++f,++h)u=a.find(f,l,u),f===.5&&(c=u),o[h]=s[e[u]]}return o}function F_({random:e=b1(42),minDistance:t=.5,maxSteps:n=2}={}){return(r,i,s,o,a,c)=>{const u=new c.constructor(i*s),l=Ms.from(r,p=>o[p],p=>a[p]);let h,f,d;for(let p=.5,y=0;p<s;++p){f=h;for(let g=.5;g<i;++g,++y){let m=g,b=p;d=f=l.find(m,b,f),g===.5&&(h=f);let w,_=0;for(;(w=Math.hypot(o[r[d]]-m,a[r[d]]-b))>t&&_<n;){const x=e(g,p,_)*2*Math.PI;m+=Math.cos(x)*w,b+=Math.sin(x)*w,d=l.find(m,b,d),++_}u[y]=c[r[d]]}}return u}}function Rit(e,t,n,r,i,s){return t*e+r*n+s*i}function Oit(e){return(t,n,r,i,s,o,a,c)=>{const u=e(a,c);return u<n?t:u<n+i?r:s}}function Dit(e,t){return Ja(e)||fn(e)?Rit:Oit(t)}function Lit(e,t,n){return{transform(r){const i=r.length,s=new Float64Array(i),o=(t-e)/n,a=e+o/2;for(let c=0;c<i;++c)s[c]=c%n*o+a;return s}}}function Fit(e,t,n,r){return{transform(i){const s=i.length,o=new Float64Array(s),a=(t-e)/r,c=e+a/2;for(let u=0;u<s;++u)o[u]=Math.floor(u/n)%r*a+c;return o}}}const vF={ariaLabel:"contour",fill:"none",stroke:"currentColor",strokeMiterlimit:1,pixelSize:2};class xF extends mF{constructor(t,{smooth:n=!0,value:r,...i}={}){const s=iD({},i,vF);if(r===void 0){for(const a in s)if(s[a].value!=null){if(r!==void 0)throw new Error("ambiguous contour value");r=i[a],i[a]="value"}}if(r!=null){const a={transform:c=>c.map(u=>u.value),label:ti(r)};for(const c in s)i[c]==="value"&&(i[c]=a)}if(t==null){if(r==null)throw new Error("missing contour value");i=R_("value",{value:r,...i}),r=null}else{let{interpolate:a}=i;r===void 0&&(r=nt),a===void 0&&(i.interpolate="nearest")}super(t,{value:{value:r,optional:!0}},Cit(i),vF);const o={geometry:{value:nt}};for(const a in this.channels){const c=this.channels[a],{scale:u}=c;u==="x"||u==="y"||a==="value"||(o[a]=c,delete this.channels[a])}this.contourChannels=o,this.smooth=!!n}filter(t,{x:n,y:r,value:i,...s},o){return super.filter(t,s,o)}render(t,n,r,i,s){const{geometry:o}=r,a=qu();return Ft("svg:g",s).call(ce,this,i,s).call(Zt,this,n).call(c=>{c.selectAll().data(t).enter().append("path").call(Gt,this).attr("d",u=>a(o[u])).call(be,this,r)}).node()}}function Cit({thresholds:e,interval:t,...n}){return e=jL(e,t,Hm),Ke(n,function(r,i,s,o,a,c){const[u,l,h,f]=wF(s,o,a,c),d=h-u,p=f-l,{pixelSize:y,width:g=Math.round(Math.abs(d)/y),height:m=Math.round(Math.abs(p)/y)}=this,b=g/d,w=m/p,_=s.value.value,x=[];if(this.interpolate){const{x:T,y:I}=$l(s,o,c),R=Kt(T,N=>(N-u)*b,Float64Array),L=Kt(I,N=>(N-l)*w,Float64Array),E=[s.x,s.y,s.value],$=[R,L,_];for(const N of i){const D=this.filter(N,E,$);x.push(this.interpolate(D,g,m,R,L,_))}}else if(i){const T=g*m,I=i.length;for(let R=0;R<I;++R)x.push(_.slice(R*T,R*T+T))}else x.push(_);if(this.blur>0)for(const T of x)e4({data:T,width:g,height:m},this.blur);const v=kit(e,_,...Pit(x));if(v===null)throw new Error(`unsupported thresholds: ${e}`);const{contour:S}=md().size([g,m]).smooth(this.smooth),A=[],M=[];for(const T of x)M.push(Tn(A.length,A.push(...Kt(v,I=>S(T,I)))));for(const{coordinates:T}of A)for(const I of T)for(const R of I)for(const L of R)L[0]=L[0]/b+u,L[1]=L[1]/w+l;return{data:A,facets:M,channels:gO(this.contourChannels,A)}})}function kit(e,t,n,r){if(typeof e?.range=="function")return e.range(e.floor(n),r);if(typeof e=="function"&&(e=e(t,n,r)),typeof e!="number")return Ls(e);const i=xs(...a4(n,r,e),e);for(;i[i.length-1]>=r;)i.pop();for(;i[1]<n;)i.shift();return i}function Bit(){return new xF(...bF("value",...arguments))}function Pit(e){return[fe(e,t=>fe(t,SF)),me(e,t=>me(t,SF))]}function SF(e){return isFinite(e)?e:NaN}function Uit(e,t){return C_(Hp,e,t)}function zit(e,t={}){return C_(Qp,e,t)}function qit(e,t={}){return C_(Ol,e,t)}function C_(e,t,n={}){const{x:r,y:i,maxRadius:s}=n,o=e({px:r,py:i,maxRadius:s}),a=[];r!=null&&a.push(Ps(t,IF("x",{...o,inset:-6},n))),i!=null&&a.push(Us(t,IF("y",{...o,inset:-6},n))),r!=null&&a.push(rc(t,EF("x",{...o,dy:9,frameAnchor:"bottom",lineAnchor:"top"},n))),i!=null&&a.push(rc(t,EF("y",{...o,dx:-9,frameAnchor:"left",textAnchor:"end"},n)));for(const c of a)c.ariaLabel=`crosshair ${c.ariaLabel}`;return nr(...a)}function AF(e,{channels:t,...n},{facet:r,facetAnchor:i,fx:s,fy:o,[e]:a,channels:c,transform:u,initializer:l}){return{...n,facet:r,facetAnchor:i,fx:s,fy:o,[e]:a,channels:{...t,...c},transform:u,initializer:jit(e,l)}}function jit(e,t){return t==null?t:function(n,r,{x:i,y:s,px:o,py:a,...c},...u){const{channels:{x:l,y:h,...f}={},...d}=t.call(this,n,r,{...c,x:o,y:a},...u);return{channels:{...f,...l&&{px:l,...e==="x"&&{x:l}},...h&&{py:h,...e==="y"&&{y:h}}},...d}}}function IF(e,t,n){const{color:r="currentColor",opacity:i=.2,ruleStroke:s=r,ruleStrokeOpacity:o=i,ruleStrokeWidth:a}=n;return{...AF(e,t,n),stroke:s,strokeOpacity:o,strokeWidth:a}}function EF(e,t,n){const{color:r="currentColor",textFill:i=r,textFillOpacity:s,textStroke:o="var(--plot-background)",textStrokeOpacity:a,textStrokeWidth:c=5}=n;return{...AF(e,t,Yit(e,n)),fill:i,fillOpacity:s,stroke:o,strokeOpacity:a,strokeWidth:c}}function Yit(e,t){return Ke(t,(n,r,i)=>({channels:{text:{value:wb(i,e)?.value}}}))}const Vit={ariaLabel:"delaunay link",fill:"none",stroke:"currentColor",strokeMiterlimit:1},Wit={ariaLabel:"delaunay mesh",fill:null,stroke:"currentColor",strokeOpacity:.2},Git={ariaLabel:"hull",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeMiterlimit:1},Xit={ariaLabel:"voronoi",fill:"none",stroke:"currentColor",strokeMiterlimit:1},Hit={ariaLabel:"voronoi mesh",fill:null,stroke:"currentColor",strokeOpacity:.2};class Qit extends te{constructor(t,n={}){const{x:r,y:i,z:s,curve:o,tension:a}=n;super(t,{x:{value:r,scale:"x",optional:!0},y:{value:i,scale:"y",optional:!0},z:{value:s,optional:!0}},n,Vit),this.curve=p_(o,a),nc(this,n)}render(t,n,r,i,s){const{x:o,y:a}=n,{x:c,y:u,z:l}=r,{curve:h}=this,[f,d]=ri(this,i),p=c?b=>c[b]:Ue(f),y=u?b=>u[b]:Ue(d),g=this;function m(b){let w=-1;const _=[],x={};for(const E in r)x[E]=[];const v=[],S=[],A=[],M=[];function T(E,$){E=b[E],$=b[$],_.push(++w),v[w]=p(E),A[w]=y(E),S[w]=p($),M[w]=y($);for(const N in r)x[N].push(r[N][$])}const{halfedges:I,hull:R,triangles:L}=Ms.from(b,p,y);for(let E=0;E<I.length;++E){const $=I[E];$>E&&T(L[E],L[$])}for(let E=0;E<R.length;++E)T(R[E],R[(E+1)%R.length]);oe(this).selectAll().data(_).enter().append("path").call(Gt,g).attr("d",E=>{const $=$i(),N=h($);return N.lineStart(),N.point(v[E],A[E]),N.point(S[E],M[E]),N.lineEnd(),$}).call(be,g,x).call(Dl,g,x,s)}return Ft("svg:g",s).call(ce,this,i,s).call(Zt,this,{x:c&&o,y:u&&a}).call(l?b=>b.selectAll().data(vs(t,w=>l[w]).values()).enter().append("g").each(m):b=>b.datum(t).each(m)).node()}}class k_ extends te{constructor(t,n={},r,i=({z:s})=>s){const{x:s,y:o}=n;super(t,{x:{value:s,scale:"x",optional:!0},y:{value:o,scale:"y",optional:!0},z:{value:i(n),optional:!0}},n,r)}render(t,n,r,i,s){const{x:o,y:a}=n,{x:c,y:u,z:l}=r,[h,f]=ri(this,i),d=c?m=>c[m]:Ue(h),p=u?m=>u[m]:Ue(f),y=this;function g(m){const b=Ms.from(m,d,p);oe(this).append("path").datum(m[0]).call(Gt,y).attr("d",y._render(b,i)).call(be,y,r)}return Ft("svg:g",s).call(ce,this,i,s).call(Zt,this,{x:c&&o,y:u&&a}).call(l?m=>m.selectAll().data(vs(t,b=>l[b]).values()).enter().append("g").each(g):m=>m.datum(t).each(g)).node()}}class Jit extends k_{constructor(t,n={}){super(t,n,Wit),this.fill="none"}_render(t){return t.render()}}class Kit extends k_{constructor(t,n={}){super(t,n,Git,Cs)}_render(t){return t.renderHull()}}class Zit extends te{constructor(t,n={}){const{x:r,y:i,z:s}=n;super(t,{x:{value:r,scale:"x",optional:!0},y:{value:i,scale:"y",optional:!0},z:{value:s,optional:!0}},Ke(n,function(o,a,c,u,l,h){let{x:f,y:d,z:p}=c;({x:f,y:d}=$l(c,u,h)),p=p?.value;const y=new Array((f??d).length).fill(null),[g,m]=ri(this,l),b=f?_=>f[_]:Ue(g),w=d?_=>d[_]:Ue(m);for(let _ of a){f&&(_=_.filter(x=>Be(b(x)))),d&&(_=_.filter(x=>Be(w(x))));for(const[,x]of Ro(_,p)){const v=Ms.from(x,b,w),S=MF(v,l);for(let A=0,M=x.length;A<M;++A)y[x[A]]=S.renderCell(A)}}return{data:o,facets:a,channels:{cells:{value:y}}}}),Xit)}render(t,n,r,i,s){const{x:o,y:a}=n,{x:c,y:u,cells:l}=r;return Ft("svg:g",s).call(ce,this,i,s).call(Zt,this,{x:c&&o,y:u&&a}).call(h=>{h.selectAll().data(t).enter().append("path").call(Gt,this).attr("d",f=>l[f]).call(be,this,r)}).node()}}class tst extends k_{constructor(t,n){super(t,n,Hit),this.fill="none"}_render(t,n){return MF(t,n).render()}}function MF(e,t){const{width:n,height:r,marginTop:i,marginRight:s,marginBottom:o,marginLeft:a}=t;return e.voronoi([a,i,n-s,r-o])}function jl(e,t,{x:n,y:r,...i}={}){return[n,r]=Sr(n,r),new e(t,{...i,x:n,y:r})}function est(e,t){return jl(Qit,e,t)}function nst(e,t){return jl(Jit,e,t)}function rst(e,t){return jl(Kit,e,t)}function ist(e,{x:t,y:n,initializer:r,...i}={}){return jl(Zit,e,{...Ar({...i,x:t,y:n},bL),initializer:r})}function sst(e,t){return jl(tst,e,t)}const ost={ariaLabel:"density",fill:"none",stroke:"currentColor",strokeMiterlimit:1};class TF extends te{constructor(t,{x:n,y:r,z:i,weight:s,fill:o,stroke:a,...c}={}){const u=$F(o)&&(o="currentColor",!0),l=$F(a)&&(a="currentColor",!0);super(t,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},z:{value:Cs({z:i,fill:o,stroke:a}),optional:!0},weight:{value:s,optional:!0}},ust({...c,fill:o,stroke:a},u,l),ost),u&&(this.fill=void 0),l&&(this.stroke=void 0),this.z=i}filter(t){return t}render(t,n,r,i,s){const{contours:o}=r,a=qu();return Ft("svg:g",s).call(ce,this,i,s).call(Zt,this,{}).call(c=>c.selectAll().data(t).enter().append("path").call(Gt,this).call(be,this,r).attr("d",u=>a(o[u]))).node()}}function ast(e,{x:t,y:n,...r}={}){return[t,n]=Sr(t,n),new TF(e,{...r,x:t,y:n})}const cst=new Set(["x","y","z","weight"]);function ust(e,t,n){let{bandwidth:i,thresholds:s}=e;return i=i===void 0?20:+i,s=s===void 0?20:typeof s?.[Symbol.iterator]=="function"?vn(s):+s,Ke(e,function(o,a,c,u,l,h){const f=c.weight?vn(c.weight.value):null,d=c.z?.value,{z:p}=this,[y,g]=ri(this,l),{width:m,height:b}=l,{x:w,y:_}=$l(c,u,h),x=Object.fromEntries(Object.entries(c).filter(([L])=>!cst.has(L)).map(([L,E])=>[L,{...E,value:[]}])),v=t&&[],S=n&&[],A=WX().x(w?L=>w[L]:y).y(_?L=>_[L]:g).weight(f?L=>f[L]:1).size([m,b]).bandwidth(i),M=[];for(const L of a){const E=[];M.push(E);for(const $ of d?qb(L,d,p):[L]){const N=A.contours($);E.push([$,N])}}let T=s;if(!(T instanceof $p)){let L=0;for(const E of M)for(const[,$]of E){const N=$.max;N>L&&(L=N)}T=Float64Array.from({length:s-1},(E,$)=>L*100*($+1)/s)}const I=[],R=[];for(const L of M){const E=[];I.push(E);for(const[$,N]of L)for(const D of T){E.push(R.length),R.push(N(D/100)),v&&v.push(D),S&&S.push(D);for(const k in x)x[k].value.push(c[k].value[$[0]])}}return v&&v.push(0),S&&S.push(0),{data:o,facets:I,channels:{...x,...v&&{fill:{value:v,scale:"color"}},...S&&{stroke:{value:S,scale:"color"}},contours:{value:R}}}})}function $F(e){return/^density$/i.test(e)}function lst(e,t){return NF("x",e,t)}function fst(e,t){return NF("y",e,t)}function NF(e,t,{x1:n,x2:r,y1:i,y2:s,x:o=n===void 0&&r===void 0?e==="y"?Ee:nt:void 0,y:a=i===void 0&&s===void 0?e==="x"?Ee:nt:void 0,fill:c,positiveFill:u="#3ca951",negativeFill:l="#4269d0",fillOpacity:h=1,positiveFillOpacity:f=h,negativeFillOpacity:d=h,stroke:p,strokeOpacity:y,z:g=ln(p)[0],clip:m,tip:b,render:w,..._}={}){return[n,r]=RF(o,n,r),[i,s]=RF(a,i,s),n===r&&i===s&&(e==="y"?i=Hi(0):n=Hi(0)),{tip:b}=Do({tip:b},e==="y"?"x":"y"),nr(he(u)?null:Object.assign(w_(t,{x1:n,x2:r,y1:i,y2:s,z:g,fill:u,fillOpacity:f,render:Rl(w,OF(e,!0)),clip:m,..._}),{ariaLabel:"positive difference"}),he(l)?null:Object.assign(w_(t,{x1:n,x2:r,y1:i,y2:s,z:g,fill:l,fillOpacity:d,render:Rl(w,OF(e,!1)),clip:m,..._}),{ariaLabel:"negative difference"}),Sy(t,{x:r,y:s,z:g,stroke:p,strokeOpacity:y,tip:b,clip:!0,..._}))}function RF(e,t,n){return t===void 0&&n===void 0?t=n=Hi(e):t===void 0?(n=Hi(n),t=e===void 0?n:Hi(e)):n===void 0?(t=Hi(t),n=e===void 0?t:Hi(e)):(t=Hi(t),n=Hi(n)),[t,n]}function Hi(e){let t;const{value:n,label:r=ti(n)}=Qa(e);return{transform:i=>t||(t=Tt(i,n)),label:r}}function OF(e,t){const n=e==="x"?"y":"x",r=`${n}1`,i=`${n}2`,s=`${e}1`,o=`${e}2`;return(a,c,u,l,h,f)=>{const{[r]:d,[i]:p}=u,y=new Float32Array(d.length),g=new Float32Array(p.length),m=l[e==="y"?"height":"width"];(t===zO(c[e])<0?y:g).fill(m);const b=f(a,c,{...u,[i]:d,[o]:g},l,h),w=f(a,c,{...u,[r]:p,[s]:y},l,h),_=b.querySelector("g")??b,x=w.querySelector("g")??w;for(let v=0;_.firstChild;v+=2){const S=zb(),A=Ft("svg:clipPath",h).attr("id",S).node();A.appendChild(_.firstChild),x.childNodes[v].setAttribute("clip-path",`url(#${S})`),x.insertBefore(A,x.childNodes[v])}return w}}function DF({geometry:e=nt,...t}={}){const n=tc(r=>Tt(r,e));return Ke({...t,x:null,y:null,geometry:{transform:n}},(r,i,s,o,a,c)=>{const u=n(r),l=u.length,h=new Float64Array(l),f=new Float64Array(l),{centroid:d}=c.path();for(let p=0;p<l;++p)[h[p],f[p]]=d(u[p]);return{data:r,facets:i,channels:{x:{value:h,scale:null,source:null},y:{value:f,scale:null,source:null}}}})}function hst({geometry:e=nt,...t}={}){const n=tc(i=>Tt(i,e)),r=tc(i=>Tt(n(i),$H));return{...t,x:{transform:i=>Float64Array.from(r(i),([s])=>s)},y:{transform:i=>Float64Array.from(r(i),([,s])=>s)},geometry:{transform:n}}}const dst={ariaLabel:"geo",fill:"none",stroke:"currentColor",strokeWidth:1,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class LF extends te{constructor(t,n={}){const[r,i]=Se(n.r,3);super(t,{x:{value:n.tip?n.x:null,scale:"x",optional:!0},y:{value:n.tip?n.y:null,scale:"y",optional:!0},r:{value:r,scale:"r",filter:Ci,optional:!0},geometry:{value:n.geometry,scale:"projection"}},A_(n),dst),this.r=i}render(t,n,r,i,s){const{geometry:o,r:a}=r,c=s.path(),{r:u}=this;return Ip(u)?t=[]:u!==void 0&&c.pointRadius(u),Ft("svg:g",s).call(ce,this,i,s).call(Zt,this,n).call(l=>{l.selectAll().data(t).enter().append("path").call(Gt,this).attr("d",a?h=>c.pointRadius(a[h])(o[h]):h=>c(o[h])).call(be,this,r)}).node()}}function B_(e,t={}){return t.tip&&t.x===void 0&&t.y===void 0?t=DF(t):t.geometry===void 0&&(t={...t,geometry:nt}),new LF(e,t)}function pst({strokeWidth:e=1.5,...t}={}){return B_({type:"Sphere"},{strokeWidth:e,...t})}function yst({strokeOpacity:e=.1,...t}={}){return B_(zH(),{strokeOpacity:e,...t})}const Yl=.5,Vl=0;function mst(e={fill:"count"},{binWidth:t,...n}={}){const{z:r}=n;return t=t===void 0?20:ae(t),e=uO(e,n),ks(e,"fill")&&(n.channels={...n.channels,fill:{value:[]}}),n.symbol===void 0&&(n.symbol="hexagon"),n.r===void 0&&!ks(e,"r")&&(n.r=t/2),Ke(n,(i,s,o,a,c,u)=>{let{x:l,y:h,z:f,fill:d,stroke:p,symbol:y}=o;if(l===void 0)throw new Error("missing channel: x");if(h===void 0)throw new Error("missing channel: y");({x:l,y:h}=$l(o,a,u)),f=f?f.value:Tt(i,r),d=d?.value,p=p?.value,y=y?.value;const g=mb(e,{z:f,fill:d,stroke:p,symbol:y}),m=f&&[],b=d&&[],w=p&&[],_=y&&[],x=[],v=[],S=[];let A=-1;for(const R of e)R.initialize(i);for(const R of s){const L=[];for(const E of e)E.scope("facet",R);for(const[E,$]of Ro(R,g))for(const{index:N,extent:D}of gst(i,$,l,h,t)){L.push(++A),v.push(D.x),S.push(D.y),f&&m.push(g===f?E:f[N[0]]),d&&b.push(g===d?E:d[N[0]]),p&&w.push(g===p?E:p[N[0]]),y&&_.push(g===y?E:y[N[0]]);for(const k of e)k.reduce(N,D)}x.push(L)}const M=o.x.scale,T=o.y.scale,I={x:{value:v,source:a[M]?{value:Kt(v,a[M].invert),scale:M}:null},y:{value:S,source:a[T]?{value:Kt(S,a[T].invert),scale:T}:null},...f&&{z:{value:m}},...d&&{fill:{value:b,scale:"auto"}},...p&&{stroke:{value:w,scale:"auto"}},...y&&{symbol:{value:_,scale:"auto"}},...Object.fromEntries(e.map(({name:R,output:L})=>[R,{scale:"auto",label:L.label,radius:R==="r"?t/2:void 0,value:L.transform()}]))};return{data:i,facets:x,channels:I}})}function gst(e,t,n,r,i){const s=i*(1.5/iO),o=new Map;for(const a of t){let c=n[a],u=r[a];if(isNaN(c)||isNaN(u))continue;let l=Math.round(u=(u-Vl)/s),h=Math.round(c=(c-Yl)/i-(l&1)/2),f=u-l;if(Math.abs(f)*3>1){let y=c-h,g=h+(c<h?-1:1)/2,m=l+(u<l?-1:1),b=c-g,w=u-m;y*y+f*f>b*b+w*w&&(h=g+(l&1?1:-1)/2,l=m)}const d=`${h},${l}`;let p=o.get(d);p===void 0&&(p={index:[],extent:{data:e,x:(h+(l&1)/2)*i+Yl,y:l*s+Vl}},o.set(d,p)),p.index.push(a)}return o.values()}const bst={ariaLabel:"hexgrid",fill:"none",stroke:"currentColor",strokeOpacity:.1};function _st(e){return new FF(e)}class FF extends te{constructor({binWidth:t=20,clip:n=!0,...r}={}){super(dl,void 0,{clip:n,...r},bst),this.binWidth=ae(t)}render(t,n,r,i,s){const{binWidth:o}=this,{marginTop:a,marginRight:c,marginBottom:u,marginLeft:l,width:h,height:f}=i,d=l-Yl,p=h-c-Yl,y=a-Vl,g=f-u-Vl,m=o/2,b=m*sO,w=b/2,_=m*2,x=b*1.5,v=Math.floor(d/_),S=Math.ceil(p/_),A=Math.floor((y+w)/x),M=Math.ceil((g-w)/x)+1,T=`m0,${Vs(-b)}l${Vs(m)},${Vs(w)}v${Vs(b)}l${Vs(-m)},${Vs(w)}`;let I=T;for(let R=A;R<M;++R)for(let L=v;L<S;++L)I+=`M${Vs(L*_+(R&1)*m)},${Vs(R*x)}${T}`;return Ft("svg:g",s).datum(0).call(ce,this,i,s).call(Zt,this,{},ze+Yl,ze+Vl).call(R=>R.append("path").call(Gt,this).call(be,this,r).attr("d",I)).node()}}function Vs(e){return Math.round(e*1e3)/1e3}const wst={ariaLabel:"image",fill:null,stroke:null};function vst(e){return/^\.*\//.test(e)}function xst(e){return/^(blob|data|file|http|https):/i.test(e)}function Sst(e){return typeof e=="string"&&(vst(e)||xst(e))?[void 0,e]:[e,void 0]}class CF extends te{constructor(t,n={}){let{x:r,y:i,r:s,width:o,height:a,rotate:c,src:u,preserveAspectRatio:l,crossOrigin:h,frameAnchor:f,imageRendering:d}=n;s==null&&(s=void 0),s===void 0&&o===void 0&&a===void 0?o=a=16:o===void 0&&a!==void 0?o=a:a===void 0&&o!==void 0&&(a=o);const[p,y]=Sst(u),[g,m]=Se(s),[b,w]=Se(o,m!==void 0?m*2:void 0),[_,x]=Se(a,m!==void 0?m*2:void 0),[v,S]=Se(c,0);super(t,{x:{value:r,scale:"x",optional:!0},y:{value:i,scale:"y",optional:!0},r:{value:g,scale:"r",filter:Ci,optional:!0},width:{value:b,filter:Ci,optional:!0},height:{value:_,filter:Ci,optional:!0},rotate:{value:v,optional:!0},src:{value:p,optional:!0}},A_(n),wst),this.src=y,this.width=w,this.rotate=S,this.height=x,this.r=m,this.preserveAspectRatio=Me(l,"xMidYMid"),this.crossOrigin=Pe(h),this.frameAnchor=bl(f),this.imageRendering=Me(d,"auto")}render(t,n,r,i,s){const{x:o,y:a}=n,{x:c,y:u,width:l,height:h,r:f,rotate:d,src:p}=r,{r:y,width:g,height:m,rotate:b}=this,[w,_]=ri(this,i);return Ft("svg:g",s).call(ce,this,i,s).call(Zt,this,{x:c&&o,y:u&&a}).call(x=>x.selectAll().data(t).enter().append("image").call(Gt,this).attr("x",kF(c,l,f,w,g,y)).attr("y",kF(u,h,f,_,m,y)).attr("width",l?v=>l[v]:g!==void 0?g:f?v=>f[v]*2:y*2).attr("height",h?v=>h[v]:m!==void 0?m:f?v=>f[v]*2:y*2).attr("transform",d?v=>`rotate(${d[v]})`:b?`rotate(${b})`:null).attr("transform-origin",d||b?Cl`${c?v=>c[v]:w}px ${u?v=>u[v]:_}px`:null).call(ut,"href",p?v=>p[v]:this.src).call(ut,"preserveAspectRatio",this.preserveAspectRatio).call(ut,"crossorigin",this.crossOrigin).call(ut,"image-rendering",this.imageRendering).call(ut,"clip-path",f?v=>`circle(${f[v]}px)`:y!==void 0?`circle(${y}px)`:null).call(be,this,r)).node()}}function kF(e,t,n,r,i,s){return t&&e?o=>e[o]-t[o]/2:t?o=>r-t[o]/2:e&&i!==void 0?o=>e[o]-i/2:i!==void 0?r-i/2:n&&e?o=>e[o]-n[o]:n?o=>r-n[o]:e?o=>e[o]-s:r-s}function Ast(e,{x:t,y:n,...r}={}){return r.frameAnchor===void 0&&([t,n]=Sr(t,n)),new CF(e,{...r,x:t,y:n})}function Ist(e,t,n){var r=1e-8,i=t-1,s=n-1,o=0,a,c,u,l,h,f,d,p;if(e<=0)return 0;if(e>=1)return 1;for(a=Math.log(t/(t+n)),c=Math.log(n/(t+n)),u=Math.exp(t*a)/t,l=Math.exp(n*c)/n,d=u+l,e<u/d?f=Math.pow(t*d*e,1/t):f=1-Math.pow(n*d*(1-e),1/n),p=-yc(t)-yc(n)+yc(t+n);o<10;o++){if(f===0||f===1)return f;if(h=Est(f,t,n)-e,u=Math.exp(i*Math.log(f)+s*Math.log(1-f)+p),l=h/u,f-=u=l/(1-.5*Math.min(1,l*(i/f-s/(1-f)))),f<=0&&(f=.5*(f+u)),f>=1&&(f=.5*(f+u+1)),Math.abs(u)<r*f&&o>0)break}return f}function Est(e,t,n){var r=e===0||e===1?0:Math.exp(yc(t+n)-yc(t)-yc(n)+t*Math.log(e)+n*Math.log(1-e));return e<0||e>1?!1:e<(t+1)/(t+n+2)?r*BF(e,t,n)/t:1-r*BF(1-e,n,t)/n}function BF(e,t,n){var r=1e-30,i=1,s=t+n,o=t+1,a=t-1,c=1,u=1-s*e/o,l,h,f,d;for(Math.abs(u)<r&&(u=r),u=1/u,d=u;i<=100&&(l=2*i,h=i*(n-i)*e/((a+l)*(t+l)),u=1+h*u,Math.abs(u)<r&&(u=r),c=1+h/c,Math.abs(c)<r&&(c=r),u=1/u,d*=u*c,h=-(t+i)*(s+i)*e/((t+l)*(o+l)),u=1+h*u,Math.abs(u)<r&&(u=r),c=1+h/c,Math.abs(c)<r&&(c=r),u=1/u,f=u*c,d*=f,!(Math.abs(f-1)<3e-7));i++);return d}function yc(e){var t=0,n=[76.18009172947146,-86.5053203294167,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],r=1.000000000190015,i,s,o;for(o=(s=i=e)+5.5,o-=(i+.5)*Math.log(o);t<6;t++)r+=n[t]/++s;return Math.log(2.506628274631*r/i)-o}function Mst(e,t){var n=Ist(2*Math.min(e,1-e),.5*t,.5);return n=Math.sqrt(t*(1-n)/n),e>.5?n:-n}const Tst={ariaLabel:"linear-regression",fill:"currentColor",fillOpacity:.1,stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class PF extends te{constructor(t,n={}){const{x:r,y:i,z:s,ci:o=.95,precision:a=4}=n;if(super(t,{x:{value:r,scale:"x"},y:{value:i,scale:"y"},z:{value:Cs(n),optional:!0}},n,Tst),this.z=s,this.ci=+o,this.precision=+a,!(0<=this.ci&&this.ci<1))throw new Error(`invalid ci; not in [0, 1): ${o}`);if(!(this.precision>0))throw new Error(`invalid precision: ${a}`)}render(t,n,r,i,s){const{x:o,y:a,z:c}=r,{ci:u}=this;return Ft("svg:g",s).call(ce,this,i,s).call(Zt,this,n).call(l=>l.selectAll().data(c?qb(t,c,this.z):[t]).enter().call(h=>h.append("path").attr("fill","none").call(Gt,this).call(Xp,this,{...r,fill:null,fillOpacity:null}).attr("d",f=>this._renderLine(f,o,a)).call(u&&!Ka(this.fill)?f=>f.select($st).attr("stroke","none").call(Gt,this).call(Xp,this,{...r,stroke:null,strokeOpacity:null,strokeWidth:null}).attr("d",d=>this._renderBand(d,o,a)):()=>{}))).node()}}function $st(){return this.parentNode.insertBefore(this.ownerDocument.createElementNS(Ai.svg,"path"),this)}class Nst extends PF{constructor(t,n){super(t,n)}_renderBand(t,n,r){const{ci:i,precision:s}=this,[o,a]=Ie(t,l=>r[l]),c=$y(t,r,n),u=UF(t,r,n,(1-i)/2,c);return L1().y(l=>l).x0(l=>u(l,-1)).x1(l=>u(l,1))(Tn(o,a-s/2,s).concat(a))}_renderLine(t,n,r){const[i,s]=Ie(t,a=>r[a]),o=$y(t,r,n);return`M${o(i)},${i}L${o(s)},${s}`}}class Rst extends PF{constructor(t,n){super(t,n)}_renderBand(t,n,r){const{ci:i,precision:s}=this,[o,a]=Ie(t,l=>n[l]),c=$y(t,n,r),u=UF(t,n,r,(1-i)/2,c);return L1().x(l=>l).y0(l=>u(l,-1)).y1(l=>u(l,1))(Tn(o,a-s/2,s).concat(a))}_renderLine(t,n,r){const[i,s]=Ie(t,a=>n[a]),o=$y(t,n,r);return`M${i},${o(i)}L${s},${o(s)}`}}function Ost(e,{y:t=Ee,x:n=nt,stroke:r,fill:i=he(r)?"currentColor":r,...s}={}){return new Nst(e,m_({...s,x:n,y:t,fill:i,stroke:r}))}function Dst(e,{x:t=Ee,y:n=nt,stroke:r,fill:i=he(r)?"currentColor":r,...s}={}){return new Rst(e,y_({...s,x:t,y:n,fill:i,stroke:r}))}function $y(e,t,n){let r=0,i=0,s=0,o=0;for(const l of e){const h=t[l],f=n[l];r+=h,i+=f,s+=h*f,o+=h*h}const a=e.length,c=(a*s-r*i)/(a*o-r*r),u=(i-c*r)/a;return l=>c*l+u}function UF(e,t,n,r,i){const s=dr(e,l=>t[l])/e.length;let o=0,a=0;for(const l of e)o+=(t[l]-s)**2,a+=(n[l]-i(t[l]))**2;const c=Math.sqrt(a/(e.length-2)),u=Mst(r,e.length-2);return(l,h)=>{const f=i(l),d=c*Math.sqrt(1/e.length+(l-s)**2/o);return f+h*u*d}}function P_({path:e=nt,delimiter:t,frameAnchor:n,treeLayout:r=Zd,treeSort:i,treeSeparation:s,treeAnchor:o,treeFilter:a,...c}={}){o=U_(o),i=qF(i),a!=null&&(a=q_(a)),n===void 0&&(n=o.frameAnchor);const u=YF(t),l=KF(c,q_),[h,f]=Fn(),[d,p]=Fn();return{x:h,y:d,frameAnchor:n,...Ar(c,(y,g)=>{const m=u(Tt(y,e)),b=f([]),w=p([]);let _=-1;const x=[],v=[],S=j$().path(T=>m[T]),A=Bi(y)?T=>T.data=y[T.data]:T=>T.data=y.get(T.data),M=r();M.nodeSize&&M.nodeSize([1,1]),M.separation&&s!==void 0&&M.separation(s??J1);for(const T of l)T[Ry]=T[QF]([]);for(const T of g){const I=[],R=S(T.filter(L=>m[L]!=null)).each(A);i!=null&&R.sort(i),M(R);for(const L of R.descendants())if(!(a!=null&&!a(L))){I.push(++_),x[_]=L.data,o.position(L,_,b,w);for(const E of l)E[Ry][_]=E[JF](L)}v.push(I)}return{data:x,facets:v}}),...Object.fromEntries(l)}}function zF({path:e=nt,delimiter:t,curve:n="bump-x",stroke:r="#555",strokeWidth:i=1.5,strokeOpacity:s=.5,treeLayout:o=Zd,treeSort:a,treeSeparation:c,treeAnchor:u,treeFilter:l,...h}={}){u=U_(u),a=qF(a),l!=null&&(l=GF(l)),h={curve:n,stroke:r,strokeWidth:i,strokeOpacity:s,...h};const f=YF(t),d=KF(h,GF),[p,y]=Fn(),[g,m]=Fn(),[b,w]=Fn(),[_,x]=Fn();return{x1:p,x2:g,y1:b,y2:_,...Ar(h,(v,S)=>{const A=f(Tt(v,e)),M=y([]),T=m([]),I=w([]),R=x([]);let L=-1;const E=[],$=[],N=j$().path(k=>A[k]),D=o();D.nodeSize&&D.nodeSize([1,1]),D.separation&&c!==void 0&&D.separation(c??J1);for(const k of d)k[Ry]=k[QF]([]);for(const k of S){const C=[],B=N(k.filter(P=>A[P]!=null)).each(P=>P.data=v[P.data]);a!=null&&B.sort(a),D(B);for(const{source:P,target:q}of B.links())if(!(l!=null&&!l(q,P))){C.push(++L),E[L]=q.data,u.position(P,L,M,I),u.position(q,L,T,R);for(const V of d)V[Ry][L]=V[JF](q,P)}$.push(C)}return{data:E,facets:$}}),...Object.fromEntries(d)}}function U_(e="left"){switch(`${e}`.trim().toLowerCase()){case"left":return Lst;case"right":return Fst}throw new Error(`invalid tree anchor: ${e}`)}const Lst={frameAnchor:"left",dx:6,position({x:e,y:t},n,r,i){r[n]=t,i[n]=-e}},Fst={frameAnchor:"right",dx:-6,position({x:e,y:t},n,r,i){r[n]=-t,i[n]=-e}};function qF(e){return e==null||typeof e=="function"?e:`${e}`.trim().toLowerCase().startsWith("node:")?jF(q_(e)):jF(Cst(e))}function jF(e){return(t,n)=>er(e(t),e(n))}function Cst(e){return t=>t.data?.[e]}function YF(e="/"){if(e=`${e}`,e==="/")return n=>n;if(e.length!==1)throw new Error("delimiter must be exactly one character");const t=e.charCodeAt(0);return n=>n.map(r=>kst(r,t))}const z_=92,VF=47;function kst(e,t){if(t===z_)throw new Error("delimiter cannot be backslash");let n=!1;for(let r=0,i=e.length;r<i;++r){switch(e.charCodeAt(r)){case z_:if(!n){n=!0;continue}break;case t:n?(e=e.slice(0,r-1)+e.slice(r),--r,--i):e=e.slice(0,r)+"/"+e.slice(r+1);break;case VF:n?(e=e.slice(0,r)+"\\\\"+e.slice(r),r+=2,i+=2):(e=e.slice(0,r)+"\\"+e.slice(r),++r,++i);break}n=!1}return e}function Bst(e){let t=!1;for(let n=0,r=e.length;n<r;++n){switch(e.charCodeAt(n)){case z_:if(!t){t=!0;continue}case VF:t&&(e=e.slice(0,n-1)+e.slice(n),--n,--r);break}t=!1}return e}function WF(e){return Ln(e)&&typeof e.node=="function"}function Pst(e){return Ln(e)&&typeof e.link=="function"}function q_(e){if(WF(e))return e.node;if(e=`${e}`.trim().toLowerCase(),!!e.startsWith("node:")){switch(e){case"node:name":return Y_;case"node:path":return j_;case"node:internal":return XF;case"node:external":return HF;case"node:depth":return V_;case"node:height":return W_}throw new Error(`invalid node value: ${e}`)}}function GF(e){if(WF(e))return e.node;if(Pst(e))return e.link;if(e=`${e}`.trim().toLowerCase(),!(!e.startsWith("node:")&&!e.startsWith("parent:"))){switch(e){case"parent:name":return Ny(Y_);case"parent:path":return Ny(j_);case"parent:depth":return Ny(V_);case"parent:height":return Ny(W_);case"node:name":return Y_;case"node:path":return j_;case"node:internal":return XF;case"node:external":return HF;case"node:depth":return V_;case"node:height":return W_}throw new Error(`invalid link value: ${e}`)}}function j_(e){return e.id}function Y_(e){return Ust(e.id)}function V_(e){return e.depth}function W_(e){return e.height}function XF(e){return!!e.children}function HF(e){return!e.children}function Ny(e){return(t,n)=>n==null?void 0:e(n)}function Ust(e){let t=e.length;for(;--t>0&&!zst(e,t););return Bst(e.slice(t+1))}function zst(e,t){if(e[t]==="/"){let n=0;for(;t>0&&e[--t]==="\\";)++n;if((n&1)===0)return!0}return!1}const QF=2,JF=3,Ry=4;function KF(e,t){const n=[];for(const r in e){const i=e[r],s=t(i);s!==void 0&&n.push([r,...Fn(i),s])}return n}function ZF(e,{fill:t,stroke:n,strokeWidth:r,strokeOpacity:i,strokeLinejoin:s,strokeLinecap:o,strokeMiterlimit:a,strokeDasharray:c,strokeDashoffset:u,marker:l,markerStart:h=l,markerEnd:f=l,dot:d=he(h)&&he(f),text:p="node:name",textStroke:y="var(--plot-background)",title:g="node:path",dx:m,dy:b,textAnchor:w,treeLayout:_=Zd,textLayout:x=_===Zd||_===P$?"mirrored":"normal",tip:v,...S}={}){if(m===void 0&&(m=U_(S.treeAnchor).dx),w!==void 0)throw new Error("textAnchor is not a configurable tree option");x=Dn(x,"textLayout",["mirrored","normal"]);function A(M){return rc(e,P_({treeLayout:_,text:p,fill:t===void 0?"currentColor":t,stroke:y,dx:m,dy:b,title:g,...M,...S}))}return nr(QL(e,zF({treeLayout:_,markerStart:h,markerEnd:f,stroke:n!==void 0?n:t===void 0?"node:internal":t,strokeWidth:r,strokeOpacity:i,strokeLinejoin:s,strokeLinecap:o,strokeMiterlimit:a,strokeDasharray:c,strokeDashoffset:u,...S})),d?Ys(e,P_({treeLayout:_,fill:t===void 0?"node:internal":t,title:g,tip:v,...S})):null,p!=null?x==="mirrored"?[A({textAnchor:"start",treeFilter:"node:external"}),A({textAnchor:"end",treeFilter:"node:internal",dx:-m})]:A():null)}function qst(e,t){return ZF(e,{...t,treeLayout:P$})}const t7={ariaLabel:"waffle"};class e7 extends x_{constructor(t,{unit:n=1,gap:r=1,round:i,multiple:s,...o}={}){super(t,r7("x",o),t7),this.unit=Math.max(0,n),this.gap=+r,this.round=i7(i),this.multiple=s7(s)}}class n7 extends S_{constructor(t,{unit:n=1,gap:r=1,round:i,multiple:s,...o}={}){super(t,r7("y",o),t7),this.unit=Math.max(0,n),this.gap=+r,this.round=i7(i),this.multiple=s7(s)}}function r7(e,t){const n=e==="y"?"x":"y",r=`${e}1`,i=`${e}2`;return Ke(jst(t),function(s,o,a,c,u){const{round:l,unit:h}=this,f=a[r].value,d=a[i].value,p=Up({...n in a&&{[n]:a[n]},[r]:a[r],[i]:a[i]},c),y=this[e==="y"?"_width":"_height"](c,p,u),g=this[e==="y"?"_x":"_y"](c,p,u),m=h*Wst(c.scales[e]),{multiple:b=Math.max(1,Math.floor(Math.sqrt(y/m)))}=this,w=Math.min(y/b,m*b),_=m*b,x=(y-b*w)/2,v=typeof g=="function"?N=>g(N)+x:g+x,S=c[e](0),A=e==="y"?([N,D])=>[N*w,-D*_]:([N,D])=>[D*_,N*w],M=typeof v=="function"?N=>v(N)-y/2:()=>v,[T,I]=e==="y"?[0,1]:[1,0],R=d.length,L=new Array(R),E=new Float64Array(R),$=new Float64Array(R);for(let N=0;N<R;++N){L[N]=G_(l(f[N]/h),l(d[N]/h),b).map(A);const D=L[N].pop();E[N]=D[T]+M(N),$[N]=D[I]+S}return{channels:{polygon:{value:L,source:null,filter:null},[`c${n}`]:{value:[w,v],source:null,filter:null},[`c${e}`]:{value:[_,S],source:null,filter:null},[n]:{value:E,scale:null,source:null},[r]:{value:$,scale:null,source:a[r]},[i]:{value:$,scale:null,source:a[i]}}}})}function jst({render:e,...t}){return{...t,render:Rl(e,function(n,r,i,s,o){const{gap:a,rx:c,ry:u}=this,{channels:l,ariaLabel:h,href:f,title:d,...p}=i,{document:y}=o,g=l.polygon.value,[m,b]=l.cx.value,[w,_]=l.cy.value,x=ket(),v=y.createElementNS(Ai.svg,"pattern");v.setAttribute("width",m),v.setAttribute("height",w),v.setAttribute("patternUnits","userSpaceOnUse");const S=v.appendChild(y.createElementNS(Ai.svg,"rect"));return S.setAttribute("x",a/2),S.setAttribute("y",a/2),S.setAttribute("width",m-a),S.setAttribute("height",w-a),c!=null&&S.setAttribute("rx",c),u!=null&&S.setAttribute("ry",u),Ft("svg:g",o).call(ce,this,s,o).call(this._transform,this,r).call(A=>A.selectAll().data(n).enter().append(()=>v.cloneNode(!0)).attr("id",M=>`${x}-${M}`).select("rect").call(Gt,this).call(be,this,p)).call(A=>A.selectAll().data(n).enter().append("path").attr("transform",Cl`translate(${b},${_})`).attr("d",M=>`M${g[M].join("L")}Z`).attr("fill",M=>`url(#${x}-${M})`).attr("stroke",this.stroke==null?null:"none").call(be,this,{ariaLabel:h,href:f,title:d})).node()})}}function G_(e,t,n){if(t<e)return G_(t,e,n);if(e<0)return Yst(e,t,n,Math.ceil(-Math.min(e,t)/n));const r=Math.floor(e%n),i=Math.ceil(e%n),s=Math.floor(t%n),o=Math.ceil(t%n),a=Math.floor(e/n),c=Math.ceil(e/n),u=Math.floor(t/n),l=Math.ceil(t/n),h=[];return l>c&&h.push([0,c]),h.push([r,c],[r,a+e%1],[i,a+e%1]),e%n>n-1||(h.push([i,a]),u>a&&h.push([n,a])),u>a&&h.push([n,u]),h.push([o,u],[o,u+t%1],[s,u+t%1]),t%n<1||(h.push([s,l]),l>c&&h.push([0,l])),h.push(Vst(e,t,n)),h}function Yst(e,t,n,r){return G_(e+r*n,t+r*n,n).map(([i,s])=>[i,s-r])}function Vst(e,t,n){const r=Math.floor(t/n)-Math.floor(e/n);return r===0?X_(e,t,n):r===1?Math.floor(t%n)>Math.ceil(e%n)?[(Math.floor(t%n)+Math.ceil(e%n))/2,Math.floor(t/n)]:t%n>n-e%n?X_(t-t%n,t,n):X_(e,n*Math.ceil(e/n),n):[n/2,(Math.round(e/n)+Math.round(t/n))/2]}function X_(e,t,n){const r=Math.floor(t)-Math.floor(e);return r===0?[Math.floor(e%n)+.5,Math.floor(e/n)+(e+t)/2%1]:r===1?t%1-e%1>.5?[Math.ceil(e%n),Math.floor(t/n)+(e%1+t%1)/2]:t%1>1-e%1?[Math.floor(t%n)+.5,Math.floor(t/n)+t%1/2]:[Math.floor(e%n)+.5,Math.floor(e/n)+(1+e%1)/2]:[Math.ceil(e%n)+Math.ceil(Math.floor(t)-Math.ceil(e))/2,Math.floor(e/n)+(t>=1+e?.5:(e+t)/2%1)]}function i7(e){if(e===void 0||e===!1)return Number;if(e===!0)return Math.round;if(typeof e!="function")throw new Error(`invalid round: ${e}`);return e}function s7(e){return e===void 0?void 0:Math.max(1,Math.floor(e))}function Wst({domain:e,range:t}){return o7(t)/o7(e)}function o7(e){const[t,n]=Ie(e);return n-t}function Gst(e,{tip:t,...n}={}){return Ga(n)||(n={...n,y:Ee,x2:nt}),new e7(e,{tip:a7(t),...sy(Hb(ry(n)))})}function Xst(e,{tip:t,...n}={}){return Ga(n)||(n={...n,x:Ee,y2:nt}),new n7(e,{tip:a7(t),...oy(Qb(iy(n)))})}function a7(e){return e===!0?{maxRadius:1/0}:Ln(e)&&e.maxRadius===void 0?{...e,maxRadius:1/0}:void 0}function Hst(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var H_,c7;function Qst(){if(c7)return H_;c7=1;function e(o,a,c,u,l){for(var h=l+1;u<=l;){var f=u+l>>>1,d=o[f],p=c!==void 0?c(d,a):d-a;p>=0?(h=f,l=f-1):u=f+1}return h}function t(o,a,c,u,l){for(var h=l+1;u<=l;){var f=u+l>>>1,d=o[f],p=c!==void 0?c(d,a):d-a;p>0?(h=f,l=f-1):u=f+1}return h}function n(o,a,c,u,l){for(var h=u-1;u<=l;){var f=u+l>>>1,d=o[f],p=c!==void 0?c(d,a):d-a;p<0?(h=f,u=f+1):l=f-1}return h}function r(o,a,c,u,l){for(var h=u-1;u<=l;){var f=u+l>>>1,d=o[f],p=c!==void 0?c(d,a):d-a;p<=0?(h=f,u=f+1):l=f-1}return h}function i(o,a,c,u,l){for(;u<=l;){var h=u+l>>>1,f=o[h],d=c!==void 0?c(f,a):f-a;if(d===0)return h;d<=0?u=h+1:l=h-1}return-1}function s(o,a,c,u,l,h){return typeof c=="function"?h(o,a,c,u===void 0?0:u|0,l===void 0?o.length-1:l|0):h(o,a,void 0,c===void 0?0:c|0,u===void 0?o.length-1:u|0)}return H_={ge:function(o,a,c,u,l){return s(o,a,c,u,l,e)},gt:function(o,a,c,u,l){return s(o,a,c,u,l,t)},lt:function(o,a,c,u,l){return s(o,a,c,u,l,n)},le:function(o,a,c,u,l){return s(o,a,c,u,l,r)},eq:function(o,a,c,u,l){return s(o,a,c,u,l,i)}},H_}var Q_,u7;function Jst(){if(u7)return Q_;u7=1;var e=Qst(),t=0,n=1,r=2;Q_=w;function i(_,x,v,S,A){this.mid=_,this.left=x,this.right=v,this.leftPoints=S,this.rightPoints=A,this.count=(x?x.count:0)+(v?v.count:0)+S.length}var s=i.prototype;function o(_,x){_.mid=x.mid,_.left=x.left,_.right=x.right,_.leftPoints=x.leftPoints,_.rightPoints=x.rightPoints,_.count=x.count}function a(_,x){var v=g(x);_.mid=v.mid,_.left=v.left,_.right=v.right,_.leftPoints=v.leftPoints,_.rightPoints=v.rightPoints,_.count=v.count}function c(_,x){var v=_.intervals([]);v.push(x),a(_,v)}function u(_,x){var v=_.intervals([]),S=v.indexOf(x);return S<0?t:(v.splice(S,1),a(_,v),n)}s.intervals=function(_){return _.push.apply(_,this.leftPoints),this.left&&this.left.intervals(_),this.right&&this.right.intervals(_),_},s.insert=function(_){var x=this.count-this.leftPoints.length;if(this.count+=1,_[1]<this.mid)this.left?4*(this.left.count+1)>3*(x+1)?c(this,_):this.left.insert(_):this.left=g([_]);else if(_[0]>this.mid)this.right?4*(this.right.count+1)>3*(x+1)?c(this,_):this.right.insert(_):this.right=g([_]);else{var v=e.ge(this.leftPoints,_,p),S=e.ge(this.rightPoints,_,y);this.leftPoints.splice(v,0,_),this.rightPoints.splice(S,0,_)}},s.remove=function(_){var x=this.count-this.leftPoints;if(_[1]<this.mid){if(!this.left)return t;var v=this.right?this.right.count:0;if(4*v>3*(x-1))return u(this,_);var S=this.left.remove(_);return S===r?(this.left=null,this.count-=1,n):(S===n&&(this.count-=1),S)}else if(_[0]>this.mid){if(!this.right)return t;var A=this.left?this.left.count:0;if(4*A>3*(x-1))return u(this,_);var S=this.right.remove(_);return S===r?(this.right=null,this.count-=1,n):(S===n&&(this.count-=1),S)}else{if(this.count===1)return this.leftPoints[0]===_?r:t;if(this.leftPoints.length===1&&this.leftPoints[0]===_){if(this.left&&this.right){for(var M=this,T=this.left;T.right;)M=T,T=T.right;if(M===this)T.right=this.right;else{var I=this.left,S=this.right;M.count-=T.count,M.right=T.left,T.left=I,T.right=S}o(this,T),this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else this.left?o(this,this.left):o(this,this.right);return n}for(var I=e.ge(this.leftPoints,_,p);I<this.leftPoints.length&&this.leftPoints[I][0]===_[0];++I)if(this.leftPoints[I]===_){this.count-=1,this.leftPoints.splice(I,1);for(var S=e.ge(this.rightPoints,_,y);S<this.rightPoints.length&&this.rightPoints[S][1]===_[1];++S)if(this.rightPoints[S]===_)return this.rightPoints.splice(S,1),n}return t}};function l(_,x,v){for(var S=0;S<_.length&&_[S][0]<=x;++S){var A=v(_[S]);if(A)return A}}function h(_,x,v){for(var S=_.length-1;S>=0&&_[S][1]>=x;--S){var A=v(_[S]);if(A)return A}}function f(_,x){for(var v=0;v<_.length;++v){var S=x(_[v]);if(S)return S}}s.queryPoint=function(_,x){if(_<this.mid){if(this.left){var v=this.left.queryPoint(_,x);if(v)return v}return l(this.leftPoints,_,x)}else if(_>this.mid){if(this.right){var v=this.right.queryPoint(_,x);if(v)return v}return h(this.rightPoints,_,x)}else return f(this.leftPoints,x)},s.queryInterval=function(_,x,v){if(_<this.mid&&this.left){var S=this.left.queryInterval(_,x,v);if(S)return S}if(x>this.mid&&this.right){var S=this.right.queryInterval(_,x,v);if(S)return S}return x<this.mid?l(this.leftPoints,x,v):_>this.mid?h(this.rightPoints,_,v):f(this.leftPoints,v)};function d(_,x){return _-x}function p(_,x){var v=_[0]-x[0];return v||_[1]-x[1]}function y(_,x){var v=_[1]-x[1];return v||_[0]-x[0]}function g(_){if(_.length===0)return null;for(var x=[],v=0;v<_.length;++v)x.push(_[v][0],_[v][1]);x.sort(d);for(var S=x[x.length>>1],A=[],M=[],T=[],v=0;v<_.length;++v){var I=_[v];I[1]<S?A.push(I):S<I[0]?M.push(I):T.push(I)}var R=T,L=T.slice();return R.sort(p),L.sort(y),new i(S,g(A),g(M),R,L)}function m(_){this.root=_}var b=m.prototype;b.insert=function(_){this.root?this.root.insert(_):this.root=new i(_[0],null,null,[_],[_])},b.remove=function(_){if(this.root){var x=this.root.remove(_);return x===r&&(this.root=null),x!==t}return!1},b.queryPoint=function(_,x){if(this.root)return this.root.queryPoint(_,x)},b.queryInterval=function(_,x,v){if(_<=x&&this.root)return this.root.queryInterval(_,x,v)},Object.defineProperty(b,"count",{get:function(){return this.root?this.root.count:0}}),Object.defineProperty(b,"intervals",{get:function(){return this.root?this.root.intervals([]):[]}});function w(_){return!_||_.length===0?new m(null):new m(g(_))}return Q_}var Kst=Jst();const Zst=Hst(Kst),tot=({marginLeft:e})=>[1,e],eot=({width:e,marginRight:t})=>[-1,e-t],not=({width:e,marginLeft:t,marginRight:n})=>[0,(t+e-n)/2],rot=({marginTop:e})=>[1,e],iot=({height:e,marginBottom:t})=>[-1,e-t],sot=({height:e,marginTop:t,marginBottom:n})=>[0,(t+e-n)/2];function l7(e){return typeof e=="string"?{anchor:e}:e}function oot(e={},t={}){arguments.length===1&&([e,t]=f7(e));let{anchor:n="left",padding:r=1,r:i=t.r}=l7(e);switch(`${n}`.toLowerCase()){case"left":n=tot;break;case"right":n=eot;break;case"middle":n=not;break;default:throw new Error(`unknown dodge anchor: ${n}`)}return h7("x","y",n,ae(r),i,t)}function aot(e={},t={}){arguments.length===1&&([e,t]=f7(e));let{anchor:n="bottom",padding:r=1,r:i=t.r}=l7(e);switch(`${n}`.toLowerCase()){case"top":n=rot;break;case"bottom":n=iot;break;case"middle":n=sot;break;default:throw new Error(`unknown dodge anchor: ${n}`)}return h7("y","x",n,ae(r),i,t)}function f7(e){const{anchor:t,padding:n,...r}=e,{r:i}=r;return[{anchor:t,padding:n,r:i},r]}function h7(e,t,n,r,i,s){if(i!=null&&typeof i!="number"){let{channels:o,sort:a,reverse:c}=s;o=rb(o),o?.r===void 0&&(s={...s,channels:{...o,r:{value:i,scale:"r"}}}),a===void 0&&c===void 0&&(s.sort={channel:"-r"})}return Ke(s,function(o,a,c,u,l,h){let{[t]:f,r:d}=c;if(!c[t])throw new Error(`missing channel: ${t}`);({[t]:f}=$l(c,u,h));const p=d?void 0:i!==void 0?ae(i):this.r!==void 0?this.r:3;d&&(d=Tt(d.value,u[d.scale]||nt,Float64Array));let[y,g]=n(l);const m=y?uot:cot,b=new Float64Array(f.length),w=d?_=>d[_]:()=>p;for(let _ of a){const x=Zst();_=_.filter(d?S=>Ap(f[S])&&Ci(d[S]):S=>Ap(f[S]));const v=new Float64Array(2*_.length+2);for(const S of _){const A=w(S),M=y?A+r:0,T=f[S]-A,I=f[S]+A;let R=2;x.queryInterval(T-r,I+r,([,,E])=>{const $=b[E]-M,N=f[S]-f[E],D=r+(d?d[S]+d[E]:2*p),k=Math.sqrt(D*D-N*N);v[R++]=$-k,v[R++]=$+k});let L=v.slice(0,R);y&&(L=L.filter(E=>E>=0));t:for(const E of L.sort(m)){for(let $=0;$<R;$+=2)if(v[$]+1e-6<E&&E<v[$+1]-1e-6)continue t;b[S]=E+M;break}x.insert([T,I,S])}}y||(y=1);for(const _ of a)for(const x of _)b[x]=b[x]*y+g;return{data:o,facets:a,channels:{[e]:{value:b,source:null},[t]:{value:f,source:c[t]},...d&&{r:{value:d,source:c.r}}}}})}function cot(e,t){return Math.abs(e)-Math.abs(t)}function uot(e,t){return e-t}function lot(e,t){return arguments.length===1&&({basis:e,...t}=e),E_(J_(e),t)}function fot(e,t){return arguments.length===1&&({basis:e,...t}=e),M_(J_(e),t)}function J_(e){if(e===void 0)return d7;if(typeof e=="function")return Oy(tb(e));if(/^p\d{2}$/i.test(e))return mc(K1(e));switch(`${e}`.toLowerCase()){case"deviation":return pot;case"first":return d7;case"last":return dot;case"max":return yot;case"mean":return mot;case"median":return got;case"min":return bot;case"sum":return _ot;case"extent":return hot}throw new Error(`invalid basis: ${e}`)}function Oy(e){return{mapIndex(t,n,r){const i=+e(t,n);for(const s of t)r[s]=n[s]===null?NaN:n[s]/i}}}function mc(e){return Oy((t,n)=>e(t,r=>n[r]))}const hot={mapIndex(e,t,n){const[r,i]=Ie(e,o=>t[o]),s=i-r;for(const o of e)n[o]=t[o]===null?NaN:(t[o]-r)/s}},d7=Oy((e,t)=>{for(let n=0;n<e.length;++n){const r=t[e[n]];if(Be(r))return r}}),dot=Oy((e,t)=>{for(let n=e.length-1;n>=0;--n){const r=t[e[n]];if(Be(r))return r}}),pot={mapIndex(e,t,n){const r=Wh(e,s=>t[s]),i=mu(e,s=>t[s]);for(const s of e)n[s]=t[s]===null?NaN:i?(t[s]-r)/i:0}},yot=mc(me),mot=mc(Wh),got=mc(wu),bot=mc(fe),_ot=mc(dr);function wot(e,t){return p7("x",e,t)}function vot(e,t){return p7("y",e,t)}function p7(e,t,n={}){let r,i=1;if(typeof t=="number")i=t,r=(u,l)=>+u+l;else{if(typeof t=="string"){const u=t.startsWith("-")?-1:1;[t,i]=G1(t.replace(/^[+-]/,"")),i*=u}t=Lp(t),r=(u,l)=>t.offset(u,l)}const s=`${e}1`,o=`${e}2`,a=ii({[s]:u=>u.map(l=>r(l,i)),[o]:u=>u},n),c=a[o].transform;return a[o].transform=()=>{const u=c(),[l,h]=Ie(u);return u.domain=i<0?[l,r(h,i)]:[r(l,i),h],u},a}function xot(e,t={}){if(typeof e=="string")switch(e.toLowerCase()){case"first":return K_(t);case"last":return Z_(t)}if(typeof e=="function")return Ws(null,e,t);let n,r;for(n in e){if(r!==void 0)throw new Error("ambiguous selector; multiple inputs");r=Sot(e[n])}if(r===void 0)throw new Error(`invalid selector: ${e}`);return Ws(n,r,t)}function Sot(e){if(typeof e=="function")return e;switch(`${e}`.toLowerCase()){case"min":return tw;case"max":return ew}throw new Error(`unknown selector: ${e}`)}function K_(e){return Ws(null,Aot,e)}function Z_(e){return Ws(null,Iot,e)}function y7(e){return Ws("x",tw,e)}function m7(e){return Ws("y",tw,e)}function g7(e){return Ws("x",ew,e)}function b7(e){return Ws("y",ew,e)}function*Aot(e){yield e[0]}function*Iot(e){yield e[e.length-1]}function*tw(e,t){yield OY(e,n=>t[n])}function*ew(e,t){yield Qm(e,n=>t[n])}function Ws(e,t,n){if(e!=null){if(n[e]==null)throw new Error(`missing channel: ${e}`);e=n[e]}const r=Cs(n);return Ar(n,(i,s)=>{const o=Tt(i,r),a=Tt(i,e),c=[];for(const u of s){const l=[];for(const h of o?vs(u,f=>o[f]).values():[u])for(const f of t(h,a))l.push(f);c.push(l)}return{data:i,facets:c}})}te.prototype.plot=function({marks:e=[],...t}={}){return f_({...t,marks:[...e,this]})};const Eot=Object.freeze(Object.defineProperty({__proto__:null,Area:by,Arrow:JL,BarX:x_,BarY:S_,Cell:wy,Contour:xF,Density:TF,Dot:vy,Frame:ML,Geo:LF,Hexgrid:FF,Image:CF,Line:xy,Link:HL,Mark:te,Raster:gF,Rect:cy,RuleX:ID,RuleY:ED,Text:Zp,TickX:cF,TickY:uF,Tip:TL,Vector:ty,WaffleX:e7,WaffleY:n7,area:w_,areaX:Bl,areaY:fc,arrow:jrt,auto:eit,autoSpec:tF,axisFx:ZD,axisFy:KD,axisX:e_,axisY:t_,barX:Fo,barY:Co,bin:Lo,binX:qs,binY:js,bollinger:ko,bollingerX:wit,bollingerY:vit,boxX:Sit,boxY:Ait,cell:hc,cellX:Wrt,cellY:Grt,centroid:DF,circle:Jrt,cluster:qst,column:Fn,contour:Bit,crosshair:Uit,crosshairX:zit,crosshairY:qit,delaunayLink:est,delaunayMesh:nst,density:ast,differenceX:lst,differenceY:fst,dodgeX:oot,dodgeY:aot,dot:Ys,dotX:Hrt,dotY:Qrt,filter:KZ,find:dtt,formatIsoDate:rD,formatMonth:Oet,formatNumber:nD,formatWeekday:Det,frame:u_,geo:B_,geoCentroid:hst,graticule:yst,gridFx:sL,gridFy:rL,gridX:iL,gridY:nL,group:db,groupX:xl,groupY:Sl,groupZ:hb,hexagon:Krt,hexbin:mst,hexgrid:_st,hull:rst,identity:nt,image:Ast,indexOf:Ee,initializer:Ke,interpolateNearest:L_,interpolateNone:O_,interpolatorBarycentric:D_,interpolatorRandomWalk:F_,legend:Dnt,line:Sy,lineX:Pl,lineY:Ul,linearRegressionX:Ost,linearRegressionY:Dst,link:QL,map:ii,mapX:E_,mapY:M_,marks:nr,normalize:J_,normalizeX:lot,normalizeY:fot,numberInterval:KR,plot:f_,pointer:Hp,pointerX:Qp,pointerY:Ol,raster:Eit,rect:c_,rectX:fy,rectY:hy,reverse:ZZ,ruleX:Ps,ruleY:Us,scale:Tl,select:xot,selectFirst:K_,selectLast:Z_,selectMaxX:g7,selectMaxY:b7,selectMinX:y7,selectMinY:m7,shiftX:wot,shiftY:vot,shuffle:ttt,sort:oO,sphere:pst,spike:vnt,stackX:_L,stackX1:Bnt,stackX2:Pnt,stackY:wL,stackY1:Unt,stackY2:znt,text:rc,textX:ND,textY:RD,tickX:lF,tickY:fF,timeInterval:X1,tip:$L,transform:Ar,tree:ZF,treeLink:zF,treeNode:P_,utcInterval:Tp,valueof:Tt,vector:VD,vectorX:WD,vectorY:GD,voronoi:ist,voronoiMesh:sst,waffleX:Gst,waffleY:Xst,window:Ey,windowX:cit,windowY:uit},Symbol.toStringTag,{value:"Module"})),Mot=new Map([["style","style"],["width","width"],["height","height"],["margin","margin"],["marginLeft","marginLeft"],["marginRight","marginRight"],["marginTop","marginTop"],["marginBottom","marginBottom"],["align","align"],["aspectRatio","aspectRatio"],["axis","axis"],["inset","inset"],["grid","grid"],["label","label"],["padding","padding"],["xScale","x.type"],["xDomain","x.domain"],["xRange","x.range"],["xNice","x.nice"],["xInset","x.inset"],["xInsetLeft","x.insetLeft"],["xInsetRight","x.insetRight"],["xClamp","x.clamp"],["xRound","x.round"],["xAlign","x.align"],["xPadding","x.padding"],["xPaddingInner","x.paddingInner"],["xPaddingOuter","x.paddingOuter"],["xAxis","x.axis"],["xTicks","x.ticks"],["xTickSize","x.tickSize"],["xTickSpacing","x.tickSpacing"],["xTickPadding","x.tickPadding"],["xTickFormat","x.tickFormat"],["xTickRotate","x.tickRotate"],["xGrid","x.grid"],["xLine","x.line"],["xLabel","x.label"],["xLabelAnchor","x.labelAnchor"],["xLabelArrow","x.labelArrow"],["xLabelOffset","x.labelOffset"],["xFontVariant","x.fontVariant"],["xAriaLabel","x.ariaLabel"],["xAriaDescription","x.ariaDescription"],["xPercent","x.percent"],["xReverse","x.reverse"],["xZero","x.zero"],["xBase","x.base"],["xExponent","x.exponent"],["xConstant","x.constant"],["yScale","y.type"],["yDomain","y.domain"],["yRange","y.range"],["yNice","y.nice"],["yInset","y.inset"],["yInsetTop","y.insetTop"],["yInsetBottom","y.insetBottom"],["yClamp","y.clamp"],["yRound","y.round"],["yAlign","y.align"],["yPadding","y.padding"],["yPaddingInner","y.paddingInner"],["yPaddingOuter","y.paddingOuter"],["yAxis","y.axis"],["yTicks","y.ticks"],["yTickSize","y.tickSize"],["yTickSpacing","y.tickSpacing"],["yTickPadding","y.tickPadding"],["yTickFormat","y.tickFormat"],["yTickRotate","y.tickRotate"],["yGrid","y.grid"],["yLine","y.line"],["yLabel","y.label"],["yLabelAnchor","y.labelAnchor"],["yLabelArrow","y.labelArrow"],["yLabelOffset","y.labelOffset"],["yFontVariant","y.fontVariant"],["yAriaLabel","y.ariaLabel"],["yAriaDescription","y.ariaDescription"],["yPercent","y.percent"],["yReverse","y.reverse"],["yZero","y.zero"],["yBase","y.base"],["yExponent","y.exponent"],["yConstant","y.constant"],["facetMargin","facet.margin"],["facetMarginTop","facet.marginTop"],["facetMarginBottom","facet.marginBottom"],["facetMarginLeft","facet.marginLeft"],["facetMarginRight","facet.marginRight"],["facetGrid","facet.grid"],["facetLabel","facet.label"],["fxDomain","fx.domain"],["fxRange","fx.range"],["fxInset","fx.inset"],["fxInsetLeft","fx.insetLeft"],["fxInsetRight","fx.insetRight"],["fxRound","fx.round"],["fxAlign","fx.align"],["fxPadding","fx.padding"],["fxPaddingInner","fx.paddingInner"],["fxPaddingOuter","fx.paddingOuter"],["fxAxis","fx.axis"],["fxTicks","fx.ticks"],["fxTickSize","fx.tickSize"],["fxTickSpacing","fx.tickSpacing"],["fxTickPadding","fx.tickPadding"],["fxTickFormat","fx.tickFormat"],["fxTickRotate","fx.tickRotate"],["fxGrid","fx.grid"],["fxLine","fx.line"],["fxLabel","fx.label"],["fxLabelAnchor","fx.labelAnchor"],["fxLabelOffset","fx.labelOffset"],["fxFontVariant","fx.fontVariant"],["fxAriaLabel","fx.ariaLabel"],["fxAriaDescription","fx.ariaDescription"],["fxReverse","fx.reverse"],["fyDomain","fy.domain"],["fyRange","fy.range"],["fyInset","fy,inset"],["fyInsetTop","fy.insetTop"],["fyInsetBottom","fy.insetBottom"],["fyRound","fy.round"],["fyAlign","fy.align"],["fyPadding","fy.padding"],["fyPaddingInner","fy.paddingInner"],["fyPaddingOuter","fy.paddingOuter"],["fyAxis","fy.axis"],["fyTicks","fy.ticks"],["fyTickSize","fy.tickSize"],["fyTickSpacing","fy.tickSpacing"],["fyTickPadding","fy.tickPadding"],["fyTickFormat","fy.tickFormat"],["fyTickRotate","fy.tickRotate"],["fyGrid","fy.grid"],["fyLine","fy.line"],["fyLabel","fy.label"],["fyLabelAnchor","fy.labelAnchor"],["fyLabelOffset","fy.labelOffset"],["fyFontVariant","fy.fontVariant"],["fyAriaLabel","fy.ariaLabel"],["fyAriaDescription","fy.ariaDescription"],["fyReverse","fy.reverse"],["colorScale","color.type"],["colorDomain","color.domain"],["colorRange","color.range"],["colorClamp","color.clamp"],["colorN","color.n"],["colorNice","color.nice"],["colorScheme","color.scheme"],["colorInterpolate","color.interpolate"],["colorPivot","color.pivot"],["colorSymmetric","color.symmetric"],["colorLabel","color.label"],["colorPercent","color.percent"],["colorReverse","color.reverse"],["colorZero","color.zero"],["colorTickFormat","color.tickFormat"],["colorBase","color.base"],["colorExponent","color.exponent"],["colorConstant","color.constant"],["opacityScale","opacity.type"],["opacityDomain","opacity.domain"],["opacityRange","opacity.range"],["opacityClamp","opacity.clamp"],["opacityNice","opacity.nice"],["opacityLabel","opacity.label"],["opacityPercent","opacity.percent"],["opacityReverse","opacity.reverse"],["opacityZero","opacity.zero"],["opacityTickFormat","opacity.tickFormat"],["opacityBase","opacity.base"],["opacityExponent","opacity.exponent"],["opacityConstant","opacity.constant"],["symbolScale","symbol.type"],["symbolDomain","symbol.domain"],["symbolRange","symbol.range"],["rScale","r.type"],["rDomain","r.domain"],["rRange","r.range"],["rClamp","r.clamp"],["rNice","r.nice"],["rLabel","r.label"],["rPercent","r.percent"],["rZero","r.zero"],["rBase","r.base"],["rExponent","r.exponent"],["rConstant","r.constant"],["lengthScale","length.type"],["lengthDomain","length.domain"],["lengthRange","length.range"],["lengthClamp","length.clamp"],["lengthNice","length.nice"],["lengthPercent","length.percent"],["lengthZero","length.zero"],["lengthBase","length.base"],["lengthExponent","length.exponent"],["lengthConstant","length.constant"],["projectionType","projection.type"],["projectionParallels","projection.parallels"],["projectionPrecision","projection.precision"],["projectionRotate","projection.rotate"],["projectionDomain","projection.domain"],["projectionInset","projection.inset"],["projectionInsetLeft","projection.insetLeft"],["projectionInsetRight","projection.insetRight"],["projectionInsetTop","projection.insetTop"],["projectionInsetBottom","projection.insetBottom"],["projectionClip","projection.clip"]]);function Tot(e,t,n){for(let r=0;r<t.length;++r){const i=t[r];r===t.length-1?e[i]=n:e=e[i]||(e[i]={})}}function $ot(e,t,n){for(const r in e){const i=Mot.get(r);if(i==null)throw new Error(`Unrecognized plot attribute: ${r}`);const s=e[r];typeof s=="symbol"?n.push(r):s!==void 0&&Tot(t,i.split("."),s)}}const Not=new Set(["frame","hexgrid","sphere","graticule"]),Rot=new Map([["first",K_],["last",Z_],["maxX",g7],["maxY",b7],["minX",y7],["minY",m7],["nearest",Hp],["nearestX",Qp],["nearestXY",Ol]]);async function Oot(e){const t={marks:[]},n=[],{attributes:r,marks:i}=e;$ot(r,t,n);const s=[];for(const a of i)for(const{type:c,data:u,options:l}of a.plotSpecs()){const{select:h,...f}=l,d=Rot.get(h)?.(f)??f,p=Not.has(c)?[d]:[u,d];t.marks.push(Eot[c](...p)),s.push(a.index)}Lot(t,e);const o=f_(t);Cot(o,s),Dot(e,o,r,n);for(const a of e.interactors)await a.init(o);return o}function Dot(e,t,n,r){r.forEach(i=>{const s=n[i];if(s===ya){if(!i.endsWith("Domain"))throw new Error(`Unsupported fixed attribute: ${i}`);const o=i.slice(0,-6),a=t.scale(o);a?.domain&&e.setAttribute(i,n[`${o}Reverse`]?a.domain.slice().reverse():a.domain)}else throw new Error(`Unrecognized symbol: ${s}`)})}function Lot(e,t){const{marks:n}=t;Dy("x",e,n),Dy("y",e,n),Dy("fx",e,n),Dy("fy",e,n)}function Dy(e,t,n){const r=t[e]||{};if(r.axis===null||r.label!==void 0)return;const i=n.map(o=>o.channelField(e)?.field);if(i.every(o=>o==null))return;let s;for(let o=0;o<i.length;++o){const a=_7(i[o]);a!==void 0&&(s===void 0?s=a:s!==a&&(s=void 0))}s!==void 0&&(t[e]={...r,label:s})}function _7(e){if(e){switch(e.type){case"COLUMN_REF":return e.column;case"CAST":return _7(e.expr);case"FUNCTION":if(e.name==="make_date")return"date";break}return Fot(e)}}function Fot(e){const t=`${e}`.replaceAll('"',"").replaceAll("(*)","()");return t.endsWith("()")?t.slice(0,-2):t}function Cot(e,t){let n=-1;for(const r of e.children){const i=r.getAttribute("aria-label")||"";r.nodeName==="style"||i.includes("-axis")||i.includes("-grid")||r.setAttribute("data-index",t[++n])}}const kot={width:640,marginLeft:40,marginRight:20,marginTop:20,marginBottom:30};class Bot{constructor(t){this.attributes={...kot},this.listeners=null,this.interactors=[],this.legends=[],this.marks=[],this.markset=null,this.params=new Map,this.synch=new KT,this.element=t||document.createElement("div"),this.element.setAttribute("class","plot"),this.element.style.display="flex",Object.assign(this.element,{value:this})}margins(){return{left:this.getAttribute("marginLeft"),top:this.getAttribute("marginTop"),bottom:this.getAttribute("marginBottom"),right:this.getAttribute("marginRight")}}innerWidth(){const{left:t,right:n}=this.margins();return this.getAttribute("width")-t-n}innerHeight(t=400){const{top:n,bottom:r}=this.margins();let i=this.getAttribute("height");return i==null&&(i=Pot(this,n,r)||t,this.setAttribute("height",i,{silent:!0})),i-n-r}pending(t){this.synch.pending(t)}update(t){return this.synch.ready(t)&&!this.pendingRender&&(this.pendingRender=!0,requestAnimationFrame(()=>this.render())),this.synch.promise}async render(){this.pendingRender=!1;const t=await Oot(this),n=this.legends.flatMap(({legend:r,include:i})=>{const s=r.init(t);return i?s:[]});this.element.replaceChildren(t,...n),this.synch.resolve()}getAttribute(t){return this.attributes[t]}setAttribute(t,n,r){return U0(this.attributes[t],n)?(n===void 0?delete this.attributes[t]:this.attributes[t]=n,r?.silent||this.listeners?.get(t)?.forEach(i=>i(t,n)),!0):!1}addAttributeListener(t,n){const r=this.listeners||(this.listeners=new Map);return r.has(t)||r.set(t,new Set),r.get(t).add(n),this}removeAttributeListener(t,n){return this.listeners?.get(t)?.delete(n)}addParams(t,n){const{params:r}=this;for(const i of n)r.has(i)?r.get(i).push(t):(r.set(i,[t]),i.addEventListener("value",()=>Promise.allSettled(r.get(i).map(s=>s.initialize()))))}addMark(t){return t.setPlot(this,this.marks.length),this.marks.push(t),this.markset=null,this}get markSet(){return this.markset||(this.markset=new Set(this.marks))}addInteractor(t){return this.interactors.push(t),this}addLegend(t,n=!0){t.setPlot(this),this.legends.push({legend:t,include:n})}}function Pot(e,t,n){const r=e.getAttribute("aspectRatio");if(r==null)return;const i=e.getAttribute("xDomain"),s=e.getAttribute("yDomain");if(!i||!s)return;const o=Math.abs(i[1]-i[0]);return Math.abs(s[1]-s[0])*e.innerWidth()/(r*o)+t+n}function w7(e){return typeof e!="string"?!1:(e=e.toLowerCase().trim(),e==="none"||e==="currentcolor"||e.startsWith("url(")&&e.endsWith(")")||e.startsWith("var(")&&e.endsWith(")")||Is(e)!==null)}const Uot=new Set(["offset","order","reverse","sort","label","anchor","curve","tension","marker","markerStart","markerMid","markerEnd","textAnchor","lineAnchor","lineHeight","textOverflow","monospace","fontFamily","fontSize","fontStyle","fontVariant","fontWeight","frameAnchor","strokeLinejoin","strokeLinecap","strokeMiterlimit","strokeDasharray","strokeDashoffset","mixBlendMode","shapeRendering","imageRendering","preserveAspectRatio","interpolate","crossOrigin","paintOrder","pointerEvents","target","select"]);function zot(e){return Uot.has(e)}const qot=new Set(["asterisk","circle","cross","diamond","diamond2","hexagon","plus","square","square2","star","times","triangle","triangle2","wye"]);function jot(e){return qot.has(`${e}`.toLowerCase())}const v7=e=>e==="stroke"||e==="fill",Yot=e=>/opacity$/i.test(e),Vot=e=>e==="symbol",Wot=(e,t)=>e!=="sort"&&e!=="tip"&&t!=null&&!Array.isArray(t),nw=(e,t)=>({channel:e,field:t,as:Sf(t)&&!S9(t)?t.column:e}),rw=(e,t)=>({channel:e,value:t}),iw=e=>Array.isArray(e);class Gs extends qo{constructor(t,n,r,i={}){super(n?.options?.filterBy),this.type=t,this.reqs=i,this.source=n;const s=this.channels=[],o=this.detail=new Set,a=this.params=new Set;iw(n)?this.data=ws(n):Sn(n?.table)&&a.add(n.table);const c=(u,l)=>{const h=typeof l;if(u==="channels")for(const f in l)o.add(f),c(f,l[f]);else if(h==="function"&&l[ZT]){const f=l(this,u);for(const d in f)c(d,f[d])}else if(h==="string")zot(u)||v7(u)&&w7(l)||Vot(u)&&jot(l)?s.push(rw(u,l)):s.push(nw(u,If(l)));else if(Bc(l)){const f=rw(u,l.value);s.push(f),l.addEventListener("value",d=>(f.value=d,this.update()))}else Tr(l)?(TP(l).forEach(f=>a.add(f)),s.push(nw(u,l))):h==="object"&&Wot(u,l)?s.push(nw(u,l)):l!==void 0&&s.push(rw(u,l))};for(const u in r)c(u,r[u])}setPlot(t,n){this.plot=t,this.index=n,t.addParams(this,this.params),this.source?.table&&this.queryPending()}sourceTable(){const t=this.source?.table;return t?Sn(t)?t.value:t:null}hasOwnData(){return this.source==null||iw(this.source)}hasFieldInfo(){return!!this._fieldInfo}channel(t){return this.channels.find(n=>n.channel===t)}channelField(t,{exact:n=!1}={}){const r=n?this.channel(t):this.channels.find(i=>i.channel.startsWith(t));return r?.field?r:null}async prepare(){if(this.hasOwnData())return null;const{channels:t,reqs:n}=this,r=new Map;for(const{channel:a,field:c}of t){if(!c)continue;const u=c.stats?.stats||[],l=c.stats?.column??c,h=r.get(l)??r.set(l,new Set).get(l);u.forEach(f=>h.add(f)),n[a]?.forEach(f=>h.add(f))}const i=this.sourceTable(),s=await zm(this.coordinator,Array.from(r,([a,c])=>({table:i,column:a,stats:Array.from(c)}))),o=Object.fromEntries(s.map(a=>[a.column,a]));for(const a of this.channels){const{field:c}=a;c&&Object.assign(a,o[c.stats?.column??c])}this._fieldInfo=!0}query(t=[]){return this.hasOwnData()?null:sw(this.channels,this.sourceTable()).where(t)}queryPending(){return this.plot.pending(this),this}queryResult(t){return this.data=ws(t),this}update(){return this.plot.update(this)}plotSpecs(){const{type:t,data:n,detail:r,channels:i}=this;return x7(t,r,i,n)}}function rr(e,t){const n=t?.[e.as]??e.as;return Object.hasOwn(e,"value")?e.value:v7(e.channel)?{value:n,scale:"color"}:Yot(e.channel)?{value:n,scale:"opacity"}:n}function sw(e,t,n=[]){const r=gt.from({source:t}),i=new Set;let s=!1;for(const o of e){const{channel:a,field:c,as:u}=o;if(!n.includes(a)){if(a==="orderby")r.orderby(o.value??c);else if(c){if(us(c))s=!0;else{if(i.has(u))continue;i.add(u)}r.select({[u]:c})}}}return s&&r.groupby(Array.from(i)),r}function x7(e,t,n,r,i={}){const{numRows:s,values:o,columns:a}=r??{},c={};for(const h of n){const f=t.has(h.channel)?c:i;f[h.channel]=rr(h,a)}return t.size&&(i.channels=c),[{type:e,data:o??(r?{length:s}:null),options:i}]}function Ly(e,t){const{plot:n}=e;let r=n.getAttribute(`${t}Scale`);if(!r){const{type:s}=e.channelField(t);r=s==="date"?"time":"linear"}const i={type:r};switch(r){case"log":i.base=n.getAttribute(`${t}Base`)??10;break;case"pow":i.exponent=n.getAttribute(`${t}Exponent`)??1;break;case"symlog":i.constant=n.getAttribute(`${t}Constant`)??1;break}return D0(i)}function Xs(e,t,n,r,i=1,s){const{field:o}=e.channelField(t);s=s??o;const{type:a,apply:c,sqlApply:u}=Ly(e,t),l=!!e.plot.getAttribute(`${t}Reverse`),[h,f]=r.map(y=>c(y)),d=u(s),p=a==="time"||a==="utc"?d:s;return[RP(d,h,f,n-i,l),p]}const S7={x:["min","max"]},A7={y:["min","max"]},I7={...S7,...A7};function E7(e,t,n,r,i){const{plot:s}=e,o=s.getAttribute(r),a=s.getAttribute(i);if(Array.isArray(o)&&!o[hr])return o;{const{column:c,min:u,max:l}=e.channelField(n),h=M7(t,c)||(a?rp().domain([u,l]).nice().domain():[u,l]);return o!==ya&&(h[hr]=!0),s.setAttribute(r,h,{silent:!0}),h}}function Wl(e,t){return E7(e,t,"x","xDomain","xNice")}function Gl(e,t){return E7(e,t,"y","yDomain","yNice")}function M7(e,t){if(!e)return;let n,r;return[e].flat().forEach(i=>to(i,s=>{if(s instanceof RI&&`${s.expr}`===t){const o=(s.extent??[]).map(a=>a?.value??a);(n==null||o[0]<n)&&(n=o[0]),(r==null||o[1]>r)&&(r=o[1])}})),n!=null&&r!=null&&n!==r?[n,r]:void 0}class Got extends Gs{constructor(t,n,r){const i=t.endsWith("X")?"y":t.endsWith("Y")?"x":null,s=i?{[i]:["count","min","max"]}:void 0;super(t,n,r,s),this.dim=i}query(t=[]){const{plot:n,dim:r,source:i}=this;let s=i.options?.optimize;const o=super.query(t);if(!r)return o;const a=r==="x"?"y":"x",c=this.channelField(a,{exact:!0})?.as,{field:u,as:l,type:h,count:f,min:d,max:p}=this.channelField(r),y=h==="date"||h==="number",g=r==="x"?n.innerWidth():n.innerHeight();if(s??=f/g>10,s&&y&&c){const[m,b]=M7(t,u)||[d,p],[w]=Xs(this,r,g,[m,b],1,l),_=o._select.map(x=>x.alias).filter(x=>x!==l&&x!==c);return QP(o,w,l,c,_)}else return o.orderby(l)}}function ow(e,t=[]){return new t.constructor(e)}function Xot(e,t,n,r,i){if(!t?.length)return{numRows:0,columns:{}};const s=t.length,o={},a=[];if(i?.length){const c=new Int32Array(s),u=i.map(f=>r[f]),l={};for(let f=0;f<s;++f){const d=u.map(p=>p[f]);c[f]=l[d]??=a.push(d)-1}for(let f=0;f<i.length;++f)o[i[f]]=a.map(d=>d[f]);const h=o._grid=a.map(()=>ow(e,n));for(let f=0;f<s;++f)h[c[f]][t[f]]=n[f]}else{a.push([]);const[c]=o._grid=[ow(e,n)];for(let u=0;u<s;++u)c[t[u]]=n[u]}return{numRows:a.length,columns:o}}function Hot(e,t,n,r,i,s,o){if(!n?.length)return{numRows:0,columns:{}};const a=n.length,c=e*t,u=i.map(d=>r[d]),l={},h=[],f=new Int32Array(a);if(s?.length){const d=s.map(y=>r[y]),p={};for(let y=0;y<a;++y){const g=d.map(m=>m[y]);f[y]=p[g]??=h.push(g)-1}for(let y=0;y<s.length;++y)l[s[y]]=h.map(g=>g[y])}else h.push([]);if(o){const d=n.map(g=>g%e),p=n.map(g=>Math.floor(g/e)),y=h.map(()=>[]);for(let g=0;g<a;++g)y[f[g]].push(g);i.forEach((g,m)=>{const b=u[m];l[g]=h.map((w,_)=>o(y[_],e,t,d,p,b))})}else i.forEach((d,p)=>{const y=u[p],g=l[d]=h.map(()=>ow(c,y));for(let m=0;m<a;++m)g[f[m]][n[m]]=y[m]});return{numRows:h.length,columns:l}}function aw(e){let t=1/0,n=-1/0;return e.forEach(r=>{const i=r.length;for(let s=0;s<i;++s){const o=r[s];o<t&&(t=o),o>n&&(n=o)}}),Number.isFinite(t)&&Number.isFinite(n)?[t,n]:[0,1]}function Qot(e){const t=new ba;return e.forEach(n=>{const r=n.length;for(let i=0;i<r;++i)t.add(n[i])}),Array.from(t).sort(qt)}function Ze(e,t){return Sn(e)?(e.addEventListener("value",t),e.value):e}function cw(e,t=!1){const n=new Float64Array(5),r=new Float64Array(4);Jot(n,r,e);const i=Float64Array.of(0,r[1]-n[1]*r[0],r[2]-n[2]*r[0],r[3]-n[3]*r[0],-n[4]*r[0]),s=1+n[1]+n[2]+n[3]+n[4],o=(r[0]+r[1]+r[2]+r[3])/s,a=(i[1]+i[2]+i[3]+i[4])/s;return{sigma:e,negative:t,a:n,b_causal:r,b_anticausal:i,sum_causal:o,sum_anticausal:a}}function Jot(e,t,n){const i=Float64Array.of(.84,1.8675,.84,-1.8675,-.34015,-.1299,-.34015,.1299),s=Math.exp(-1.783/n),o=Math.exp(-1.723/n),a=.6318/n,c=1.997/n,u=Float64Array.of(-s*Math.cos(a),s*Math.sin(a),-s*Math.cos(-a),s*Math.sin(-a),-o*Math.cos(c),o*Math.sin(c),-o*Math.cos(-c),o*Math.sin(-c)),l=n*2.5066282746310007,h=Float64Array.of(i[0],i[1],0,0,0,0,0,0),f=Float64Array.of(1,0,u[0],u[1],0,0,0,0,0,0);let d,p;for(p=2;p<8;p+=2){for(h[p]=u[p]*h[p-2]-u[p+1]*h[p-1],h[p+1]=u[p]*h[p-1]+u[p+1]*h[p-2],d=p-2;d>0;d-=2)h[d]+=u[p]*h[d-2]-u[p+1]*h[d-1],h[d+1]+=u[p]*h[d-1]+u[p+1]*h[d-2];for(d=0;d<=p;d+=2)h[d]+=i[p]*f[d]-i[p+1]*f[d+1],h[d+1]+=i[p]*f[d+1]+i[p+1]*f[d];for(f[p+2]=u[p]*f[p]-u[p+1]*f[p+1],f[p+3]=u[p]*f[p+1]+u[p+1]*f[p],d=p;d>0;d-=2)f[d]+=u[p]*f[d-2]-u[p+1]*f[d-1],f[d+1]+=u[p]*f[d-1]+u[p+1]*f[d-2]}for(p=0;p<4;++p)d=p<<1,t[p]=h[d]/l,e[p+1]=f[d+2]}function Kot(e,t,n,[r,i]){const s=new Float64Array(Math.max(r,i)),o=new Float64Array(Math.max(r,i)),a=new Float64Array(5),c=new Float64Array(n.length);for(let u=0,l=0;u<i;++u,l+=r){const h=c.subarray(l);uw(e,n.subarray(l),r,1,s,o,a,h)}for(let u=0;u<r;++u){const l=c.subarray(u);uw(t,l,i,r,s,o,a,l)}return c}function uw(e,t,n,r=1,i=new Float64Array(n),s=new Float64Array(n),o=new Float64Array(5),a=i,c=Zot){const u=r*2,l=r*3,h=r*4,f=r*n;let d,p;for(c(i,t,n,r,e.b_causal,3,e.a,4,e.sum_causal,o,e.sigma),p=4,d=h;p<n;++p,d+=r)i[p]=e.b_causal[0]*t[d]+e.b_causal[1]*t[d-r]+e.b_causal[2]*t[d-u]+e.b_causal[3]*t[d-l]-e.a[1]*i[p-1]-e.a[2]*i[p-2]-e.a[3]*i[p-3]-e.a[4]*i[p-4];for(c(s,t,n,-r,e.b_anticausal,4,e.a,4,e.sum_anticausal,o,e.sigma),p=4,d=f-r*5;p<n;++p,d-=r)s[p]=e.b_anticausal[1]*t[d+r]+e.b_anticausal[2]*t[d+u]+e.b_anticausal[3]*t[d+l]+e.b_anticausal[4]*t[d+h]-e.a[1]*s[p-1]-e.a[2]*s[p-2]-e.a[3]*s[p-3]-e.a[4]*s[p-4];if(e.negative)for(p=0,d=0;p<n;++p,d+=r)a[d]=i[p]+s[n-p-1];else for(p=0,d=0;p<n;++p,d+=r)a[d]=Math.max(0,i[p]+s[n-p-1]);return a}function Zot(e,t,n,r,i,s,o,a,c,u,l,h=.5){const f=Math.abs(r)*n,d=r<0?f+r:0;let p,y,g;for(y=0;y<=a;++y)for(u[y]=y<=s?i[y]:0,g=1;g<=a&&g<=y;++g)u[y]-=o[g]*u[y-g];for(g=0;g<a;++g)for(e[g]=0,y=1;y<=g;++y)p=d+r*y,p>=0&&p<f&&(e[g]+=u[g-y]*t[p]);const m=t[d],b=Math.ceil(l*10);for(y=0;y<b;++y){for(g=0;g<a;++g)e[g]+=u[g]*m;if(c-=Math.abs(u[0]),c<=h)break;for(u[a]=y+a<=s?i[y+a]:0,g=1;g<=a;++g)u[a]-=o[g]*u[a-g];for(g=0;g<a;++g)u[g]=u[g+1]}}const si="density";class Fy extends Gs{constructor(t,n,r){const{bandwidth:i=0,interpolate:s="none",pixelSize:o=1,pad:a=1,width:c,height:u,...l}=r,h=tat(l);super(t,n,l,I7),this.densityMap=h,this.bandwidth=Ze(i,f=>(this.bandwidth=f,this.grids?this.convolve().update():null)),this.interpolate=Ze(s,f=>(this.interpolate=f,this.requestUpdate())),this.pixelSize=Ze(o,f=>(this.pixelSize=f,this.requestUpdate())),this.pad=Ze(a,f=>(this.pad=f,this.requestUpdate())),this.width=Ze(c,f=>(this.width=f,this.requestUpdate())),this.height=Ze(u,f=>(this.height=f,this.requestUpdate()))}setPlot(t,n){const r=()=>{this.hasFieldInfo()&&this.requestUpdate()};t.addAttributeListener("xDomain",r),t.addAttributeListener("yDomain",r),super.setPlot(t,n)}get filterStable(){const t=this.plot.getAttribute("xDomain"),n=this.plot.getAttribute("yDomain");return t&&n&&!t[hr]&&!n[hr]}query(t=[]){const{interpolate:n,pad:r,channels:i,densityMap:s}=this,[o,a]=this.extentX=Wl(this,t),[c,u]=this.extentY=Gl(this,t),[l,h]=this.bins=this.binDimensions(),[f,d]=Xs(this,"x",l,[o,a],r),[p,y]=Xs(this,"y",h,[c,u],r),g=r?[cr(d,[+o,+a]),cr(y,[+c,+u])]:[pi(+o,d),Oe(d,+a),pi(+c,y),Oe(y,+u)],m=gt.from(this.sourceTable()).where(t.concat(g)),b=this.groupby=[],w={};for(const x of i)if(Object.hasOwn(x,"field")){const{as:v,channel:S,field:A}=x;us(A)?(w[S]=A,s[S]=!0):S==="weight"?w[si]=ee(A):S!=="x"&&S!=="y"&&(m.select({[v]:A}),b.push(v))}const _=this.aggr=Object.keys(w);if(w.density&&_.length>1)throw new Error("Weight option can not be used with custom aggregates.");if(_.length||(_.push(si),w[si]=ar()),n==="linear"){if(_.length>1)throw new Error("Linear binning not applicable to multiple aggregates.");if(!w[si])throw new Error("Linear binning not applicable to custom aggregates.");const x=$0(w[si])[0];return XP(m,f,p,x,l,b)}else return OP(m,f,p,w,l,b)}binDimensions(){const{plot:t,pixelSize:n,width:r,height:i}=this;return[r??Math.round(t.innerWidth()/n),i??Math.round(t.innerHeight()/n)]}queryResult(t){const[n,r]=this.bins,i=eat(this.interpolate),{columns:s}=ws(t);return this.grids0=Hot(n,r,s.index,s,this.aggr,this.groupby,i),this.convolve()}convolve(){const{aggr:t,bandwidth:n,bins:r,grids0:i,plot:s}=this;if(this.grids=i,n>0&&i.numRows>0){const o=t.length===1?t[0]:t.includes(si)?si:null;if(!o)return console.warn("No compatible grid found for smoothing."),this;const a=i.columns[o],c=s.innerWidth(),u=s.innerHeight(),[l,h]=r,f=a.some(y=>y.some(g=>g<0)),d=cw(n*(l-1)/c,f),p=cw(n*(h-1)/u,f);this.grids={numRows:i.numRows,columns:{...i.columns,[o]:a.map(y=>Kot(d,p,y,r))}}}return this}}function tat(e){const t={};for(const n in e)e[n]==="density"&&(delete e[n],t[n]=!0);return t}function eat(e="none"){if(typeof e=="function")return e;switch(e.toLowerCase()){case"none":case"linear":return;case"nearest":return L_;case"barycentric":return D_();case"random-walk":return F_()}throw new Error(`invalid interpolate: ${e}`)}class nat extends Fy{constructor(t,n){const{thresholds:r=10,...i}=n;super("geo",t,{bandwidth:20,interpolate:"linear",pixelSize:2,...i}),this.thresholds=Ze(r,s=>(this.thresholds=s,this.grids?this.contours().update():null))}convolve(){return super.convolve().contours()}contours(){const{bins:t,densityMap:n,grids:r,thresholds:i,plot:s}=this,{numRows:o,columns:a}=r;let c=i,u;if(Array.isArray(c))u=c;else{const[,I]=aw(a.density);u=Array.from({length:c-1},(R,L)=>I*(L+1)/c)}(n.fill||n.stroke)&&this.plot.getAttribute("colorScale")!=="log"&&this.plot.setAttribute("colorZero",!0);const[l,h]=t,[f,d]=s.getAttribute("xDomain"),[p,y]=s.getAttribute("yDomain"),g=(d-f)/l,m=(y-p)/h,b=+f,w=+p,_=I=>b+I*g,x=I=>w+I*m,v=md().size(t),S=this.contourData=Array(o*u.length),{density:A,...M}=a,T=Object.entries(M);for(let I=0,R=0;I<o;++I){const L=A[I],E=T.reduce(($,[N,D])=>($[N]=D[I],$),{});for(let $=0;$<u.length;++$,++R)S[R]=Object.assign(rat(v.contour(L,u[$]),_,x),E)}return this}plotSpecs(){const{type:t,channels:n,densityMap:r,contourData:i}=this,s={};for(const o of n){const{channel:a}=o;a!=="x"&&a!=="y"&&(s[a]=rr(o))}for(const o in r)r[o]&&(s[o]=rr({channel:o,as:"value"}));return[{type:t,data:i,options:s}]}}function rat(e,t,n){function r(o){o.forEach(i)}function i(o){o.forEach(s)}function s(o){o[0]=t(o[0]),o[1]=n(o[1])}return e.coordinates.forEach(r),e}function lw(e){return Array.from({length:e},(t,n)=>n)}function T7(e,t){const n=t.reduce((i,s,o)=>(i[s]=o,i),{}),r=lw(e.length);return r.sort((i,s)=>n[e[i]]-n[e[s]]),r}function $7(e,t){if(typeof document<"u"){const n=document.createElement("canvas");return n.setAttribute("width",e),n.setAttribute("height",t),n}throw new Error("Can not create a canvas instance.")}function iat(e=1){const t=255*e|0;return(n,r,i)=>{for(let s=0,o=0;s<i;++s)for(let a=0;a<r;++a,o+=4)n[o+3]=t}}function sat(e){const{apply:t}=e;return(n,r,i,s)=>{for(let o=0,a=0;o<i;++o)for(let c=0,u=(i-o-1)*r;c<r;++c,a+=4)n[a+3]=255*t(s[c+u])|0}}function oat(e={}){const{r:t=0,g:n=0,b:r=0,opacity:i=1}=typeof e=="string"?Nn(e):e,s=new Uint8ClampedArray([t,n,r,255*i|0]);return(o,a,c)=>{for(let u=0,l=0;u<c;++u)for(let h=0;h<a;++h,l+=4)o[l+0]=s[0],o[l+1]=s[1],o[l+2]=s[2],o[l+3]=s[3]}}function aat(e){const{domain:t,range:n}=e,r=Object.create(null),i=new Uint8ClampedArray(4*t.length),s=t.length-1,o=n.length;for(let a=0;a<=s;++a){const c=n[a%o],{r:u,g:l,b:h,opacity:f=1}=typeof c=="string"?Nn(c):c,d=a<<2;i[d+0]=u,i[d+1]=l,i[d+2]=h,i[d+3]=255*f|0,r[t[a]]=d}return(a,c,u,l)=>{if(l.map)for(let h=0,f=0;h<u;++h)for(let d=0,p=(u-h-1)*c;d<c;++d,f+=4){const y=r[l[d+p]];a[f+0]=i[y+0],a[f+1]=i[y+1],a[f+2]=i[y+2],a[f+3]=i[y+3]}else{const h=r[l];for(let f=0,d=0;f<u;++f)for(let p=0;p<c;++p,d+=4)a[d+0]=i[h+0],a[d+1]=i[h+1],a[d+2]=i[h+2],a[d+3]=i[h+3]}}}function cat(e,t,n){const{interpolate:r}=t,i=new Uint8ClampedArray(4*e),s=e-1;for(let o=0;o<=s;++o){const a=r(o/s),{r:c,g:u,b:l,opacity:h=1}=typeof a=="string"?Nn(a):a,f=o<<2;i[f+0]=c,i[f+1]=u,i[f+2]=l,i[f+3]=255*h|0}return(o,a,c,u)=>{for(let l=0,h=0;l<c;++l)for(let f=0,d=(c-l-1)*a;f<a;++f,h+=4){const p=s*n(u[f+d])<<2;o[h+0]=i[p+0],o[h+1]=i[p+1],o[h+2]=i[p+2],o[h+3]=i[p+3]}}}class fw extends Fy{constructor(t,n){super("image",t,n),this.image=null}setPlot(t,n){const r=()=>{this.hasFieldInfo()&&this.rasterize()};t.addAttributeListener("schemeColor",r),super.setPlot(t,n)}convolve(){return super.convolve().rasterize()}rasterize(){const{bins:t,grids:n}=this,[r,i]=t,{numRows:s,columns:o}=n,{canvas:a,ctx:c,img:u}=dat(this,r,i),{alpha:l,alphaProp:h,color:f,colorProp:d}=N7(this),p=o[h]??[],y=o[d]??[],g=s>1&&d&&this.groupby?.includes(d)?T7(y,this.plot.getAttribute("colorDomain")):lw(s);return this.data={numRows:s,columns:{src:Array.from({length:s},(m,b)=>(f?.(u.data,r,i,y[g[b]]),l?.(u.data,r,i,p[g[b]]),c.putImageData(u,0,0),a.toDataURL()))}},this}plotSpecs(){const{type:t,plot:n,data:{numRows:r,columns:i}}=this,s={src:i.src,width:n.innerWidth(),height:n.innerHeight(),preserveAspectRatio:"none",imageRendering:this.channel("imageRendering")?.value,frameAnchor:"middle"};return[{type:t,data:{length:r},options:s}]}}class uat extends fw{constructor(t,n){super(t,{bandwidth:20,interpolate:"linear",pixelSize:2,...n})}}function N7(e){const{aggr:t,densityMap:n,groupby:r,plot:i}=e,s=t.includes(si),o=t.includes("fillOpacity"),a=e.channel("fill"),c=e.channel("fillOpacity");if(t.length>2||s&&o)throw new Error("Invalid raster encodings. Try dropping an aggregate?");if(r.includes(c?.as))throw new Error("Raster fillOpacity must be an aggregate or constant.");const u=n.fill||t.includes("fill")?"grid":r.includes(a?.as)?"group":w7(a?.value)?a.value:s&&i.getAttribute("colorScheme")?"grid":void 0,l=n.fillOpacity||t.includes("fillOpacity")?"grid":typeof c?.value=="number"?c.value:s&&u!=="grid"?"grid":void 0;if(u!=="grid"&&l!=="grid")throw new Error("Raster mark missing density values.");const h=a?.as??(u==="grid"?si:null),f=c?.as??(l==="grid"?si:null),d=u!=="grid"&&u!=="group"?oat(u):fat(e,h),p=l!=="grid"?iat(l):lat(e,f);return{alphaProp:f,colorProp:h,alpha:p,color:d}}function lat(e,t){const{plot:n,grids:r}=e,i=n.getAttribute("opacityDomain"),s=i===ya,o=i?.[hr],a=!s&&!o&&i||aw(r.columns[t]);(s||o||!i)&&(s||(a[hr]=!0),n.setAttribute("opacityDomain",a));const c=Tl({opacity:{type:n.getAttribute("opacityScale"),domain:a,range:n.getAttribute("opacityRange"),clamp:n.getAttribute("opacityClamp"),nice:n.getAttribute("opacityNice"),reverse:n.getAttribute("opacityReverse"),zero:n.getAttribute("opacityZero"),base:n.getAttribute("opacityBase"),exponent:n.getAttribute("opacityExponent"),constant:n.getAttribute("opacityConstant")}});return sat(c)}function fat(e,t){const{plot:n,grids:r}=e,i=r.columns[t]??[],s=!i[0]?.map,o=s||Array.isArray(i[0]),a=n.getAttribute("colorDomain"),c=a===ya,u=a?.[hr],l=!c&&!u&&a||(s?i.slice().sort(qt):o?Qot(i):aw(i));(c||u||!a)&&(c||(l[hr]=!0),n.setAttribute("colorDomain",l));const h=Tl({color:{type:n.getAttribute("colorScale"),domain:l,range:n.getAttribute("colorRange"),clamp:n.getAttribute("colorClamp"),n:n.getAttribute("colorN"),nice:n.getAttribute("colorNice"),reverse:n.getAttribute("colorReverse"),scheme:n.getAttribute("colorScheme"),interpolate:n.getAttribute("colorInterpolate"),pivot:n.getAttribute("colorPivot"),symmetric:n.getAttribute("colorSymmetric"),zero:n.getAttribute("colorZero"),base:n.getAttribute("colorBase"),exponent:n.getAttribute("colorExponent"),constant:n.getAttribute("colorConstant")}});if(o)return aat(h);{const f=Tl({x:{type:hat(h.type),domain:h.domain,reverse:h.reverse,range:[0,1],clamp:h.clamp,base:h.base,exponent:h.exponent,constant:h.constant}});return cat(1024,h,f.apply)}}function hat(e){return e.endsWith("symlog")?"symlog":e.endsWith("log")?"log":e.endsWith("pow")?"pow":e.endsWith("sqrt")?"sqrt":e==="diverging"?"linear":e}function dat(e,t,n){if(!e.image||e.image.w!==t||e.image.h!==n){const r=$7(t,n),i=r.getContext("2d",{willReadFrequently:!0}),s=i.getImageData(0,0,t,n);e.image={canvas:r,ctx:i,img:s,w:t,h:n}}return e.image}class pat extends fw{constructor(t,n){const{normalize:r=!0,...i}=n;super(t,i),this.normalize=Ze(r,s=>(this.normalize=s,this.requestUpdate()))}query(t=[]){const{channels:n,normalize:r,pad:i}=this,[s,o]=this.bins=this.binDimensions(),[a]=Xs(this,"x",s,Wl(this,t),i),[c]=Xs(this,"y",o,Gl(this,t),i),u=gt.from(this.sourceTable()).where(yat(this,t));this.aggr=["density"];const l=this.groupby=[],h=[];for(const f of n)if(Object.hasOwn(f,"field")){const{channel:d,field:p}=f;d==="z"?(u.select({[d]:p}),h.push("z")):d!=="x"&&d!=="y"&&(u.select({[d]:p}),l.push(d))}return HP(u,a,c,h,s,o,l,r)}}function yat(e,t){if(Array.isArray(t)&&!t.length)return t;const n=e.channelField("x").column,r=e.channelField("y").column,i=o=>{const a=`${o.expr}`;return o.type!=="BETWEEN"||a!==n&&a!==r},s=o=>o.op==="AND"?fi(o.clauses.filter(a=>i(a))):o;return Array.isArray(t)?t.filter(o=>i(o)).map(o=>s(o)):s(t)}const mat={fill:1,stroke:1,z:1};class R7 extends Gs{constructor(t,n,r){const{bins:i=1024,bandwidth:s=20,normalize:o=!1,stack:a=!1,...c}=r,u=t.endsWith("X")?"y":"x";super(t,n,c,u==="x"?S7:A7),this.dim=u,this.bins=Ze(i,l=>(this.bins=l,this.requestUpdate())),this.bandwidth=Ze(s,l=>(this.bandwidth=l,this.grids?this.convolve().update():null)),this.normalize=Ze(o,l=>(this.normalize=l,this.convolve().update())),this.stack=Ze(a,l=>(this.stack=l,this.update()))}get filterStable(){const t=this.dim==="x"?"xDomain":"yDomain",n=this.plot.getAttribute(t);return n&&!n[hr]}query(t=[]){if(this.hasOwnData())throw new Error("Density1DMark requires a data source");const{bins:n,channels:r,dim:i}=this,s=this.extent=(i==="x"?Wl:Gl)(this,t),[o,a]=Xs(this,i,n,s),c=sw(r,this.sourceTable(),[i]).where(t.concat(cr(a,s))),u=this.channelField("weight")?"weight":null,l=this.groupby=r.flatMap(h=>mat[h.channel]&&h.field?h.as:[]);return GP(c,o,u,l)}queryResult(t){const n=ws(t).columns;return this.grids=Xot(this.bins,n.index,n.density,n,this.groupby),this.convolve()}convolve(){const{bins:t,bandwidth:n,normalize:r,dim:i,grids:s,groupby:o,plot:a,extent:[c,u]}=this,l=s.columns,h=s.numRows,f=this.channelField(i).as,d=i==="x"?"y":"x",p=i==="x"?a.innerWidth():a.innerHeight(),y=l._grid.some(S=>S.some(A=>A<0)),g=cw(n*(t-1)/p,y),m=+c,b=(u-m)/(t-1),w=t*h,_=new Float64Array(w),x=new Float64Array(w),v=o.reduce((S,A)=>(S[A]=Array(w),S),{});for(let S=0,A=0;A<h;++A){o.forEach(R=>v[R].fill(l[R][A],S,S+t));const M=l._grid[A],T=uw(g,M,t),I=1/gat(M,T,b,r);for(let R=0;R<t;++R,++S)_[S]=m+R*b,x[S]=T[R]*I}return this.data={numRows:w,columns:{[f]:_,[d]:x,...v}},this}plotSpecs(){const{type:t,data:{numRows:n,columns:r},channels:i,dim:s,stack:o}=this,a=t.startsWith("area")&&!o?"2":"",c=s==="x"?{[`y${a}`]:r.y}:{[`x${a}`]:r.x};for(const u of i)c[u.channel]=rr(u,r);return[{type:t,data:{length:n},options:c}]}}function gat(e,t,n,r){return(r===!0||r==="sum"?dr(e):r==="max"?me(t):n)||1}class bat extends Fy{constructor(t,n){const{type:r="dot",...i}=n;super(r,t,{bandwidth:20,interpolate:"linear",pad:0,pixelSize:2,...i})}convolve(){super.convolve();const{bins:t,pad:n,extentX:r,extentY:i}=this,[s,o]=t,a=Ly(this,"x"),c=Ly(this,"y"),[u,l]=r.map(g=>a.apply(g)),[h,f]=i.map(g=>c.apply(g)),d=(l-u)/(s-n),p=(f-h)/(o-n),y=n?0:.5;return this.data=_at(this.grids,t,u,h,d,p,a.invert,c.invert,y),this}plotSpecs(){const{type:t,channels:n,densityMap:r,data:{numRows:i,columns:s}}=this,o={};for(const a of n){const{channel:c}=a;o[c]=c==="x"||c==="y"?s[c]:rr(a,s)}for(const a in r)r[a]&&(o[a]=s.density);return[{type:t,data:{length:i},options:o}]}}function _at(e,t,n,r,i,s,o,a,c){const u=1/(i*s),[l,h]=t,f=l*h,d=f*e.numRows,p=new Float64Array(d),y=new Float64Array(d),g=new Float64Array(d),m={x:p,y,density:g},{density:b,...w}=e.columns;for(const x in w)m[x]=new w[x].constructor(d);let _=0;for(let x=0;x<e.numRows;++x){for(const S in w)m[S].fill(w[S][x],_,_+f);const v=b[x];for(let S=0,A=0;A<h;++A)for(let M=0;M<l;++M,++_,++S)p[_]=o(n+(M+c)*i),y[_]=a(r+(A+c)*s),g[_]=v[S]*u}return{numRows:d,columns:m}}function wat(e,t,n){var r=1e-8,i=t-1,s=n-1,o=0,a,c,u,l,h,f,d,p;if(e<=0)return 0;if(e>=1)return 1;for(a=Math.log(t/(t+n)),c=Math.log(n/(t+n)),u=Math.exp(t*a)/t,l=Math.exp(n*c)/n,d=u+l,e<u/d?f=Math.pow(t*d*e,1/t):f=1-Math.pow(n*d*(1-e),1/n),p=-gc(t)-gc(n)+gc(t+n);o<10;o++){if(f===0||f===1)return f;if(h=vat(f,t,n)-e,u=Math.exp(i*Math.log(f)+s*Math.log(1-f)+p),l=h/u,f-=u=l/(1-.5*Math.min(1,l*(i/f-s/(1-f)))),f<=0&&(f=.5*(f+u)),f>=1&&(f=.5*(f+u+1)),Math.abs(u)<r*f&&o>0)break}return f}function vat(e,t,n){var r=e===0||e===1?0:Math.exp(gc(t+n)-gc(t)-gc(n)+t*Math.log(e)+n*Math.log(1-e));return e<0||e>1?0:e<(t+1)/(t+n+2)?r*O7(e,t,n)/t:1-r*O7(1-e,n,t)/n}function O7(e,t,n){var r=1e-30,i=1,s=t+n,o=t+1,a=t-1,c=1,u=1-s*e/o,l,h,f,d;for(Math.abs(u)<r&&(u=r),u=1/u,d=u;i<=100&&(l=2*i,h=i*(n-i)*e/((a+l)*(t+l)),u=1+h*u,Math.abs(u)<r&&(u=r),c=1+h/c,Math.abs(c)<r&&(c=r),u=1/u,d*=u*c,h=-(t+i)*(s+i)*e/((t+l)*(o+l)),u=1+h*u,Math.abs(u)<r&&(u=r),c=1+h/c,Math.abs(c)<r&&(c=r),u=1/u,f=u*c,d*=f,!(Math.abs(f-1)<3e-7));i++);return d}function gc(e){var t=0,n=[76.18009172947146,-86.5053203294167,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],r=1.000000000190015,i,s,o;for(o=(s=i=e)+5.5,o-=(i+.5)*Math.log(o);t<6;t++)r+=n[t]/++s;return Math.log(2.506628274631*r/i)-o}function xat(e,t){var n=wat(2*Math.min(e,1-e),.5*t,.5);return n=Math.sqrt(t*(1-n)/n),e>.5?n:-n}function Sat(e){let t=-Math.log((1-e)*(1+e)),n;return t<6.25?(t-=3.125,n=-364441206401782e-35,n=-16850591381820166e-35+n*t,n=128584807152564e-32+n*t,n=11157877678025181e-33+n*t,n=-1333171662854621e-31+n*t,n=20972767875968562e-33+n*t,n=6637638134358324e-30+n*t,n=-4054566272975207e-29+n*t,n=-8151934197605472e-29+n*t,n=26335093153082323e-28+n*t,n=-12975133253453532e-27+n*t,n=-5415412054294628e-26+n*t,n=10512122733215323e-25+n*t,n=-4112633980346984e-24+n*t,n=-29070369957882005e-24+n*t,n=42347877827932404e-23+n*t,n=-13654692000834679e-22+n*t,n=-13882523362786469e-21+n*t,n=.00018673420803405714+n*t,n=-.000740702534166267+n*t,n=-.006033670871430149+n*t,n=.24015818242558962+n*t,n=1.6536545626831027+n*t):t<16?(t=Math.sqrt(t)-3.25,n=22137376921775787e-25,n=9075656193888539e-23+n*t,n=-27517406297064545e-23+n*t,n=18239629214389228e-24+n*t,n=15027403968909828e-22+n*t,n=-4013867526981546e-21+n*t,n=29234449089955446e-22+n*t,n=12475304481671779e-21+n*t,n=-47318229009055734e-21+n*t,n=6828485145957318e-20+n*t,n=24031110387097894e-21+n*t,n=-.0003550375203628475+n*t,n=.0009532893797373805+n*t,n=-.0016882755560235047+n*t,n=.002491442096107851+n*t,n=-.003751208507569241+n*t,n=.005370914553590064+n*t,n=1.0052589676941592+n*t,n=3.0838856104922208+n*t):Number.isFinite(t)?(t=Math.sqrt(t)-5,n=-27109920616438573e-27,n=-2555641816996525e-25+n*t,n=15076572693500548e-25+n*t,n=-3789465440126737e-24+n*t,n=761570120807834e-23+n*t,n=-1496002662714924e-23+n*t,n=2914795345090108e-23+n*t,n=-6771199775845234e-23+n*t,n=22900482228026655e-23+n*t,n=-99298272942317e-20+n*t,n=4526062597223154e-21+n*t,n=-1968177810553167e-20+n*t,n=7599527703001776e-20+n*t,n=-.00021503011930044477+n*t,n=-.00013871931833623122+n*t,n=1.0103004648645344+n*t,n=4.849906401408584+n*t):n=1/0,n*e}class D7 extends Gs{constructor(t,n,r){const i=t.endsWith("X")?"y":"x",{ci:s=.95,...o}=r;super(t,n,o),this.dim=i,this.field=this.channelField(i).field,this.channels=this.channels.filter(a=>a.channel!==i),this.ci=Ze(s,a=>(this.ci=a,this.update()))}query(t=[]){const{channels:n,field:r}=this,i=n.concat([{field:x0(r),as:"__avg__"},{field:ne(S0(r),Wc(ar(r))),as:"__se__"}]);return sw(i,this.sourceTable()).where(t)}queryResult(t){return this.data=ws(t),this}plotSpecs(){const{type:t,dim:n,detail:r,data:i,ci:s,channels:o}=this,a=Math.SQRT2*Sat(s),{columns:{__avg__:c,__se__:u}}=i,l={[`${n}1`]:c.map((h,f)=>h-a*u[f]),[`${n}2`]:c.map((h,f)=>h+a*u[f])};return x7(t,r,o,i,l)}}const Aat="geom";class Iat extends Gs{constructor(t,n={},r){!iw(t)&&!n?.geometry&&(n.geometry=M0(Aat)),super("geo",t,n,r)}queryResult(t){super.queryResult(t);const n=this.channelField("geometry")?.as;if(n){const{columns:r}=this.data;typeof r[n][0]=="string"&&(r[n]=r[n].map(i=>JSON.parse(i)))}return this}}class Eat extends Gs{constructor(t,n){const{type:r="hexagon",binWidth:i=20,...s}=n;super(r,t,{r:i/2,clip:!0,...s},I7),this.binWidth=Ze(i,o=>(this.binWidth=o,this.requestUpdate()))}get filterStable(){const t=this.plot.getAttribute("xDomain"),n=this.plot.getAttribute("yDomain");return t&&n&&!t[hr]&&!n[hr]}query(t=[]){if(this.hasOwnData())return null;const{plot:n,binWidth:r,channels:i}=this;let s,o;const a=new Set,c={};for(const T of i)if(T.channel!=="orderby"){if(T.channel==="x")s=T;else if(T.channel==="y")o=T;else if(Object.hasOwn(T,"field")){const{as:I,field:R}=T;c[I]=R,us(R)||a.add(I)}}const[u,l]=Wl(this,t),[h,f]=Gl(this,t),d=.5-n.getAttribute("marginLeft"),p=0-n.getAttribute("marginTop"),y=qe(r),g=qe(r*(1.5/Math.sqrt(3))),m=qe(n.innerWidth()/(l-u)),b=qe(n.innerHeight()/(f-h)),w="_x",_="_y",x="_px",v="_py",S="_pi",A="_pj",M="_tt";return gt.select({[s.as]:Ht(qe(u),ne(Ht(It(Ht(w,It(.5,I0(_,1))),y),d),m)),[o.as]:St(qe(f),ne(Ht(It(_,g),p),b)),...c}).groupby(w,_,...a).from(gt.select({[v]:ne(St(It(b,St(f,o.field)),p),g),[A]:Ae(Gc(v)),[x]:St(ne(St(It(m,St(s.field,u)),d),y),It(.5,I0(A,1))),[S]:Ae(Gc(x)),[M]:fi(di(It(dn(St(v,A)),3),1),di(Ht(je(St(x,S),2),je(St(v,A),2)),Ht(je(St(St(x,S),It(.5,Zs(Oe(x,S),-1,1))),2),je(St(St(v,A),Zs(Oe(v,A),-1,1)),2)))),[w]:Zs(M,Ae(Ht(Ht(S,Zs(Oe(x,S),-.5,.5)),Zs(Xo(I0(A,1),0),.5,-.5))),S),[_]:Zs(M,Ae(Ht(A,Zs(Oe(v,A),-1,1))),A)},"*").from(this.sourceTable()).where(cs(s.field),cs(o.field),t))}}class Mat extends Fy{constructor(t,n){const{origin:r=[0,0],dim:i="xy",...s}=n;super("image",t,s),this.image=null,this.origin=r,this.tileX=i.toLowerCase().includes("x"),this.tileY=i.toLowerCase().includes("y")}setPlot(t,n){const r=()=>{this.hasFieldInfo()&&this.rasterize()};t.addAttributeListener("schemeColor",r),super.setPlot(t,n)}requestQuery(){return this.requestTiles()}query(t=[]){return this._filter=t,null}tileQuery(t){const{interpolate:n,pad:r,channels:i,densityMap:s}=this,[[o,a],[c,u]]=t,[l,h]=this.bins,[f,d]=Xs(this,"x",l,[o,a],r),[p,y]=Xs(this,"y",h,[c,u],r),g=r?[cr(d,[+o,+a]),cr(y,[+c,+u])]:[pi(+o,d),Oe(d,+a),pi(+c,y),Oe(y,+u)],m=gt.from(this.sourceTable()).where(g),b=this.groupby=[],w={};for(const x of i)if(Object.hasOwn(x,"field")){const{as:v,channel:S,field:A}=x;A.aggregate?(w[S]=A,s[S]=!0):S==="weight"?w.density=ee(A):S!=="x"&&S!=="y"&&(m.select({[v]:A}),b.push(v))}const _=this.aggr=Object.keys(w);if(w.density&&_.length>1)throw new Error("Weight option can not be used with custom aggregates.");if(_.length||(_.push("density"),w.density=ar()),n==="linear"){if(_.length>1)throw new Error("Linear binning not applicable to multiple aggregates.");if(!w.density)throw new Error("Linear binning not applicable to custom aggregates.");return Oat(m,f,p,w.density,l,b)}else return Rat(m,f,p,w,l,b)}async requestTiles(){const t=ls();this.prefetch&&t.cancel(this.prefetch);const{pad:n,tileX:r,tileY:i,origin:[s,o]}=this,[a,c]=this.bins=this.binDimensions(),[u,l]=Wl(this,this._filter),[h,f]=Gl(this,this._filter),d=l-u,p=f-h,y=Math.floor((u-s)*(a-n)/d),g=Math.floor((h-o)*(c-n)/p),m=(I,R)=>[[s+I*d,s+(I+1)*d],[o+R*p,o+(R+1)*p]],b=Math.floor((u-s)/d),w=r?L7((l-s)/d):b,_=Math.floor((h-o)/p),x=i?L7((f-o)/p):_,v=[];for(let I=b;I<=w;++I)for(let R=_;R<=x;++R)v.push([I,R]);const S=v.map(([I,R])=>t.query(this.tileQuery(m(I,R)))),A=[];if(r)for(let I=_;I<=x;++I)A.push([w+1,I]),A.push([b-1,I]);if(i){const I=r?b-1:b,R=r?w+1:w;for(let L=I;L<=R;++L)A.push([L,x+1]),A.push([L,_-1])}this.prefetch=A.map(([I,R])=>t.prefetch(this.tileQuery(m(I,R))));const M=await Promise.all(S),T=Tat(a,c,y,g,v,M);this.grids0={numRows:T.length,columns:{density:[T]}},this.convolve().update()}convolve(){return super.convolve().rasterize()}rasterize(){const{bins:t,grids:n}=this,[r,i]=t,{numRows:s,columns:o}=n,{canvas:a,ctx:c,img:u}=Nat(this,r,i),{alpha:l,alphaProp:h,color:f,colorProp:d}=N7(this),p=o[h]??[],y=o[d]??[],g=s>1&&d&&this.groupby?.includes(d)?T7(y,this.plot.getAttribute("colorDomain")):lw(s);return this.data={numRows:s,columns:{src:Array.from({length:s},(m,b)=>(f?.(u.data,r,i,y[g[b]]),l?.(u.data,r,i,p[g[b]]),c.putImageData(u,0,0),a.toDataURL()))}},this}plotSpecs(){const{type:t,plot:n,data:{numRows:r,columns:i}}=this,s={src:i.src,width:n.innerWidth(),height:n.innerHeight(),preserveAspectRatio:"none",imageRendering:this.channel("imageRendering")?.value,frameAnchor:"middle"};return[{type:t,data:{length:r},options:s}]}}function Tat(e,t,n,r,i,s){const o=new Float64Array(e*t);return s.forEach((a,c)=>{const[u,l]=i[c],h=u*e-n,f=l*t-r;$at(e,t,o,a,h,f)}),o}function $at(e,t,n,r,i,s){const o=r.numRows;if(o===0)return;const a=r.getChild("index").toArray(),c=r.getChild("density").toArray();for(let u=0;u<o;++u){const l=a[u],h=i+l%e,f=s+Math.floor(l/e);0<=h&&h<e&&0<=f&&f<t&&(n[h+f*e]=c[u])}}function Nat(e,t,n){if(!e.image||e.image.w!==t||e.image.h!==n){const r=$7(t,n),i=r.getContext("2d",{willReadFrequently:!0}),s=i.getImageData(0,0,t,n);e.image={canvas:r,ctx:i,img:s,w:t,h:n}}return e.image}function Rat(e,t,n,r,i,s){return e.select({index:tn`FLOOR(${t})::INTEGER + FLOOR(${n})::INTEGER * ${i}`,...r}).groupby("index",s)}function Oat(e,t,n,r,i,s){const o=r.column?`* ${r.column}`:"",a=(f,d)=>e.clone().select({xp:t,yp:n,i:f,w:d}),c=a(tn`FLOOR(xp)::INTEGER + FLOOR(yp)::INTEGER * ${i}`,tn`(FLOOR(xp)::INTEGER + 1 - xp) * (FLOOR(yp)::INTEGER + 1 - yp)${o}`),u=a(tn`FLOOR(xp)::INTEGER + (FLOOR(yp)::INTEGER + 1) * ${i}`,tn`(FLOOR(xp)::INTEGER + 1 - xp) * (yp - FLOOR(yp)::INTEGER)${o}`),l=a(tn`FLOOR(xp)::INTEGER + 1 + FLOOR(yp)::INTEGER * ${i}`,tn`(xp - FLOOR(xp)::INTEGER) * (FLOOR(yp)::INTEGER + 1 - yp)${o}`),h=a(tn`FLOOR(xp)::INTEGER + 1 + (FLOOR(yp)::INTEGER + 1) * ${i}`,tn`(xp - FLOOR(xp)::INTEGER) * (yp - FLOOR(yp)::INTEGER)${o}`);return gt.from(gt.unionAll(c,u,l,h)).select({index:"i",density:ee("w")},s).groupby("index",s).having(Xo("density",0))}function L7(e){const t=Math.floor(e);return t===e?t-1:t}class Dat extends Gs{constructor(t,n){const{ci:r=.95,precision:i=4,...s}=n;super("line",t,s);const o=()=>this.modelFit?this.confidenceBand().update():null;this.ci=Ze(r,a=>(this.ci=a,o())),this.precision=Ze(i,a=>(this.precision=a,o()))}query(t=[]){const n=this.channelField("x").as,r=this.channelField("y").as,i=Array.from(new Set(["stroke","z","fx","fy"].flatMap(s=>this.channelField(s)?.as||[])));return gt.from(super.query(t)).select({intercept:tP(r,n),slope:rP(r,n),n:eE(r,n),ssy:nP(r,n),ssx:eP(r,n),xm:tE(r,n),x0:qe(os(n).where(cs(r))),x1:qe(Nr(n).where(cs(r)))}).select(i).groupby(i)}queryResult(t){return this.modelFit=ws(t),this.lineData=Lat(this.modelFit),this.confidenceBand()}confidenceBand(){const{ci:t,modelFit:n,precision:r,plot:i}=this,s=i.innerWidth();return this.areaData=t?Fat(n,t,r,s):null,this}plotSpecs(){const{lineData:t,areaData:n,channels:r,ci:i}=this,s=t.columns,o=i?n.columns:{},a={x:s.x,y:s.y},c={x:o.x,y1:o.y1,y2:o.y2,fillOpacity:.1};for(const u of r)switch(u.channel){case"x":case"y":case"fill":break;case"tip":c.tip=rr(u,o);break;case"stroke":a.stroke=rr(u,s),c.fill=rr(u,o);break;case"strokeOpacity":a.strokeOpacity=rr(u,s);break;case"fillOpacity":c.fillOpacity=rr(u,o);break;default:a[u.channel]=rr(u,s),c[u.channel]=rr(u,o);break}return[...i?[{type:"areaY",data:{length:n.numRows},options:c}]:[],{type:"line",data:{length:t.numRows},options:a}]}}function hw(e,t){if(e.concat)return e.concat(t);const n=new e.constructor(e.length+t.length);return n.set(e,0),n.set(t,e.length),n}function Lat(e){const{x0:t=[],x1:n=[],xm:r,intercept:i,slope:s,n:o,ssx:a,ssy:c,...u}=e.columns,l=(d,p)=>i[p]+d*s[p],h=hw(t,n),f=hw(t.map(l),n.map(l));for(const d in u)u[d]=hw(u[d],u[d]);return{numRows:h.length,columns:{x:h,y:f,...u}}}function Fat(e,t,n,r){const i=e.numRows,{x0:s,x1:o,xm:a,intercept:c,slope:u,n:l,ssx:h,ssy:f,...d}=e.columns,p=Object.keys(d),y={x:[],y1:[],y2:[]};p.forEach(g=>y[g]=[]);for(let g=0;g<i;++g){const m=n*(o[g]-s[g])/r,b=xat((1-t)/2,l[g]-2)*Math.sqrt(f[g]/(l[g]-2));Tn(s[g],o[g]-m/2,m).concat(o[g]).forEach(w=>{const _=c[g]+w*u[g],x=b*Math.sqrt(1/l[g]+(w-a[g])**2/h[g]);y.x.push(w),y.y1.push(_-x),y.y2.push(_+x),p.forEach(v=>y[v].push(d[v][g]))})}return{numRows:y.x.length,columns:y}}function dw(e){e.tagName==="a"&&(e=e.children[0]);const t=e.__data__;return Array.isArray(t)?t[0]:t}function Cat(e){const t=e.toLowerCase(),n=e.length;let r="";for(let i=0;i<n;++i)r+=(e[i]!==t[i]?"-":"")+t[i];return r}function Cy(e){const t={};for(const n in e)t[Cat(n)]=e[n];return t}function kat(e){const{channels:t}=e,n=new Set;let r=!1,i=!1;for(const s of t){const{channel:o,field:a,as:c}=s;if(o==="orderby")r=!0;else if(a)if(us(a))i=!0;else{if(n.has(c))continue;n.add(c)}}return!r&&i&&n.size&&e.channels.push({channel:"orderby",value:Array.from(n)}),e}class Bat{constructor(t,{selection:n,channels:r={}}){this.mark=kat(t),this.selection=n;const i=Object.entries(Cy(r));this.channels=i.length?i:[["opacity",.2]],this.selection.addEventListener("value",Ky(()=>this.update()))}init(t){this.svg=t;const n=this.values=[],i=`g[data-index="${this.mark.index}"]`,s=`${i} > *:not(g), ${i} > g > *`,o=this.nodes=t.querySelectorAll(s),{channels:a}=this;for(let c=0;c<o.length;++c){const u=o[c];n.push(a.map(l=>u.getAttribute(l[0])))}return this.update()}async update(){const{svg:t,nodes:n,channels:r,values:i,mark:s,selection:o}=this;if(!t)return;const a=await Pat(s,o);for(let c=0;c<n.length;++c){const u=n[c],l=i[c],h=a(dw(u));for(let f=0;f<r.length;++f){const[d,p]=r[f];u.setAttribute(d,h?l[f]:p)}}}}async function Pat(e,t){const n=t?.predicate(e);if(!n||n.length===0)return()=>!0;const r=e.filterBy?.predicate(e,!0),i={__:fi(n)},s=e.query(r);(s.queries||[s]).forEach(c=>{c._groupby.length?c.select(i):c.setSelect(i)});const o=await e.coordinator.query(s),a=o.getChild?.("__");return o.numRows||o.length?a?(c=>a.at(c)):(c=>o[c].__):(()=>!1)}function F7(){const e=this,t=e.getScreenCTM;let n;e.getScreenCTM=()=>e.isConnected?n=t.call(e):n}function pw(e){const t=e.on;let n=!0;function r(i){n=!1,i(),n=!0}return e.reset=(...i)=>{r(()=>e.clear(...i))},e.moveSilent=(...i)=>{r(()=>e.move(...i))},e.on=(...i)=>{if(i.length>1&&i[1]){const s=i[1];i[1]=(...o)=>n&&s(...o)}return t(...i)},e}function C7(){return pw(NX())}function Uat(){return pw(TX())}function zat(){return pw($X())}function k7(e,t,n,r,i){let s=oe(t??e).append("g").attr("class",i);const o=e.scale("fx"),a=e.scale("fy");if(o||a){const c=o?.domain.map(l=>o.apply(l)-n),u=a?.domain.map(l=>a.apply(l)-r);if(c&&u)for(let l=0;l<c.length;++l)for(let h=0;h<u.length;++h)s.append("g").attr("transform",`translate(${c[l]}, ${u[h]})`);else if(c)for(let l=0;l<c.length;++l)s.append("g").attr("transform",`translate(${c[l]}, 0})`);else if(u)for(let l=0;l<u.length;++l)s.append("g").attr("transform",`translate(0, ${u[l]})`);s=s.selectAll("g")}return s.each(F7)}const B7=1e-12;function yw(e,t){return e===t||e&&t&&Math.abs(e[0]-t[0])<B7&&Math.abs(e[1]-t[1])<B7||!1}function P7(e){if(Tr(e)){if(e.type==="COLUMN_REF")return e.column;if(e.type==="AGGREGATE")return e.args[0]??e}return e}function bc(e,t){return P7(e.channelField(t)?.field)}function qat(e,t){const n=[],r=[];return t.forEach(i=>{const s=i==="color"?["color","fill","stroke"]:i==="x"?["x","x1","x2"]:i==="y"?["y","y1","y2"]:[i];for(let o=0;o<s.length;++o){const a=e.channelField(s[o],{exact:!0});if(a){n.push(P7(a.field)),r.push(a.as);return}}throw new Error(`Missing channel: ${i}`)}),{fields:n,as:r}}function mw(e,t,n=1){return t.invert(n*Math.floor(e/n))}class gw{constructor(t,{channel:n,selection:r,field:i=void 0,pixelSize:s=1,peers:o=!0,brush:a}){this.mark=t,this.channel=n,this.pixelSize=s||1,this.selection=r,this.peers=o,this.field=i||bc(t,n),this.style=a&&Cy(a),this.brush=n==="y"?zat():Uat(),this.brush.on("brush end",({selection:c})=>this.publish(c))}reset(){this.value=void 0,this.g&&this.brush.reset(this.g)}activate(){this.selection.activate(this.clause(this.value||[0,1]))}publish(t){let n;t&&(n=t.map(r=>mw(r,this.scale,this.pixelSize)).sort((r,i)=>r-i)),yw(n,this.value)||(this.value=n,this.g.call(this.brush.moveSilent,t),this.selection.update(this.clause(n)))}clause(t){const{mark:n,pixelSize:r,field:i,scale:s}=this;return Uh(i,t,{source:this,clients:this.peers?n.plot.markSet:new Set().add(n),scale:s,pixelSize:r})}init(t,n){const{brush:r,channel:i,style:s}=this;this.scale=t.scale(i);const o=this.value?.map(this.scale.apply).sort(qt),a=t.scale("x").range,c=t.scale("y").range;if(r.extent([[fe(a),fe(c)],[me(a),me(c)]]),this.g=k7(t,n,fe(a),fe(c),`interval-${i}`).call(r).call(r.moveSilent,o),s){const u=this.g.selectAll("rect.selection");for(const l in s)u.attr(l,s[l])}t.addEventListener("pointerenter",u=>{u.buttons||this.activate()})}}class jat{constructor(t,{selection:n,xfield:r,yfield:i,pixelSize:s=1,peers:o=!0,brush:a}){this.mark=t,this.pixelSize=s||1,this.selection=n,this.peers=o,this.xfield=r||bc(t,"x"),this.yfield=i||bc(t,"y"),this.style=a&&Cy(a),this.brush=C7(),this.brush.on("brush end",({selection:c})=>this.publish(c))}reset(){this.value=void 0,this.g&&this.brush.reset(this.g)}activate(){this.selection.activate(this.clause(this.value||[[0,1],[0,1]]))}publish(t){const{value:n,pixelSize:r,xscale:i,yscale:s}=this;let o,a;if(t){const[c,u]=t;o=[c[0],u[0]].map(l=>mw(l,i,r)).sort(qt),a=[c[1],u[1]].map(l=>mw(l,s,r)).sort(qt)}(!yw(o,n?.[0])||!yw(a,n?.[1]))&&(this.value=t?[o,a]:void 0,this.g.call(this.brush.moveSilent,t),this.selection.update(this.clause(this.value)))}clause(t){const{mark:n,pixelSize:r,xfield:i,yfield:s,xscale:o,yscale:a}=this;return WT([i,s],t,{source:this,clients:this.peers?n.plot.markSet:new Set().add(n),scales:[o,a],pixelSize:r})}init(t){const{brush:n,style:r,value:i}=this,s=this.xscale=t.scale("x"),o=this.yscale=t.scale("y"),a=s.range,c=o.range;if(n.extent([[fe(a),fe(c)],[me(a),me(c)]]),this.g=k7(t,null,fe(a),fe(c),"interval-xy").call(n),r){const u=this.g.selectAll("rect.selection");for(const l in r)u.attr(l,r[l])}if(i){const[u,l]=i[0].map(s.apply).sort(qt),[h,f]=i[1].map(o.apply).sort(qt);this.g.call(n.moveSilent,[[u,h],[l,f]])}t.addEventListener("pointerenter",u=>{u.buttons||this.activate()})}}class bw{constructor(t,{selection:n,pointer:r,channels:i,fields:s,maxRadius:o=40}){this.mark=t,this.selection=n,this.clients=new Set().add(t),this.pointer=r,this.channels=i||(r==="x"?["x"]:r==="y"?["y"]:["x","y"]),this.fields=s||this.channels.map(a=>bc(t,[a])),this.maxRadius=o,this.valueIndex=-1}clause(t){const{clients:n,fields:r}=this,i={source:this,clients:n};return r.length>1?yu(r,t&&[t],i):pu(r[0],t?.[0],i)}init(t){const n=this,{mark:r,channels:i,selection:s,maxRadius:o}=this,{data:{columns:a}}=r,c=i.map(y=>r.channelField(y).as),u=!An(s),[l,h]=Yat(t,r),f=this.pointer==="y"?.01:1,d=this.pointer==="x"?.01:1,p=oe(t);p.on("pointerenter pointerdown pointermove",function(y){const[g,m]=pr(y,this),b=Vat(l,h,g,m,f,d,o);if(b!==this.valueIndex){this.valueIndex=b;const w=b<0?void 0:c.map(_=>a[_][b]);s.update(u?!w||w.length>1?w:w[0]:n.clause(w))}}),!u&&(p.on("pointerleave",()=>{s.update(n.clause(void 0))}),t.addEventListener("pointerenter",y=>{y.buttons||this.activate()}))}activate(){const t=this.channels.map(()=>0);this.selection.activate(this.clause(t))}}function Yat(e,t){const{data:{columns:n}}=t,r=h=>n[t.channelField(h)?.as],i=h=>e.scale(h),s=e.scale("x"),o=e.scale("y"),a=i("fx")?.apply,c=i("fy")?.apply,u=Array.from(r("x"),s.apply),l=Array.from(r("y"),o.apply);if(a){const h=fe(s.range),f=r("fx");for(let d=0;d<f.length;++d)u[d]+=a(f[d])-h}if(c){const h=fe(o.range),f=r("fy");for(let d=0;d<f.length;++d)l[d]+=c(f[d])-h}return[u,l]}function Vat(e,t,n,r,i,s,o){let a=o*o,c=-1;for(let u=0;u<e.length;++u){const l=i*(e[u]-n),h=s*(t[u]-r),f=l*l+h*h;f<=a&&(a=f,c=u)}return c}const U7=(e,t)=>e-t;class Wat{constructor(t,{x:n=new ro,y:r=new ro,xfield:i,yfield:s,zoom:o=!0,panx:a=!0,pany:c=!0}){this.mark=t,this.xsel=n,this.ysel=r,this.xfield=i||bc(t,"x"),this.yfield=s||bc(t,"y"),this.zoom=_w(o,[0,1/0],[1,1]),this.panx=this.xsel&&a,this.pany=this.ysel&&c;const{plot:u}=t;a&&this.xsel.addEventListener("value",l=>{u.setAttribute("xDomain",l)&&u.update()}),c&&this.ysel.addEventListener("value",l=>{u.setAttribute("yDomain",l)&&u.update()})}publish(t){if(this.panx){const n=Gat(t,this.xscale);this.xsel.update(this.clause(n,this.xfield,this.xscale))}if(this.pany){const n=Xat(t,this.yscale);this.ysel.update(this.clause(n,this.yfield,this.yscale))}}clause(t,n,r){return Uh(n,t,{source:this,clients:this.mark.plot.markSet,scale:r})}init(t){if(this.svg=t,this.initialized)return;this.initialized=!0;const{panx:n,pany:r,mark:{plot:{element:i}}}=this;this.xscale=t.scale("x"),this.yscale=t.scale("y");const s=this.xscale.range.slice().sort(U7),o=this.yscale.range.slice().sort(U7),a=_w(n,[-1/0,1/0],s),c=_w(r,[-1/0,1/0],o),u=vZ().extent([[s[0],o[0]],[s[1],o[1]]]).scaleExtent(this.zoom).translateExtent([[a[0],c[0]],[a[1],c[1]]]).on("start",()=>{this.xscale=this.svg.scale("x"),this.yscale=this.svg.scale("y")}).on("end",()=>i.__zoom=new Qr(1,0,0)).on("zoom",({transform:l})=>this.publish(l));if(oe(i).call(u),n||r){let l=!1;i.addEventListener("pointerenter",h=>{l||(l=!0,h.buttons||this.activate())}),i.addEventListener("pointerleave",()=>l=!1)}}activate(){if(this.panx){const{xscale:t,xfield:n}=this;this.xsel.activate(this.clause(t.domain,n,t))}if(this.pany){const{yscale:t,yfield:n}=this;this.ysel.activate(this.clause(t.domain,n,t))}}}function _w(e,t,n){return e?Array.isArray(e)?e:t:n}function Gat(e,t){return t.range.map(e.invertX,e).map(t.invert,t)}function Xat(e,t){return t.range.map(e.invertY,e).map(t.invert,t)}const Hat={m:2,l:2,h:1,v:1,z:0,c:6,s:4,q:4,t:2,a:7},Qat=/[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi,Jat=/^[+-]?(([0-9]*\.[0-9]+)|([0-9]+\.)|([0-9]+))([eE][+-]?[0-9]+)?/,Kat=/^((\s+,?\s*)|(,\s*))/,Zat=/^[01]/,z7=e=>`Invalid SVG path, incorrect parameter ${e}`;function tct(e){const t=[];return(e.match(Qat)||[]).forEach(r=>{let i=r[0];const s=i.toLowerCase(),o=Hat[s],a=ect(s,o,r.slice(1).trim()),c=a.length;if(c<o||c&&c%o!==0)throw new Error(z7("count"));if(t.push([i,...a.slice(0,o)]),c!==o){s==="m"&&(i=i==="M"?"L":"l");for(let u=o;u<c;u+=o)t.push([i,...a.slice(u,u+o)])}}),t}function ect(e,t,n){const r=[];for(let i=0;t&&i<n.length;)for(let s=0;s<t;++s){const o=e==="a"&&(s===3||s===4)?Zat:Jat,a=n.slice(i).match(o);if(a===null)throw new Error(z7("type"));i+=a[0].length,r.push(+a[0]);const c=n.slice(i).match(Kat);c!==null&&(i+=c[0].length)}return r}function nct(e,t,n){const{x:r,y:i}=e.getBoundingClientRect(),s=e.createSVGMatrix(),o=[];for(const a of t.children)if(a.tagName==="g"){const c=j7(a)??s;for(const u of a.children)q7(n,r,i,u,c)&&o.push(u)}else q7(n,r,i,a,s)&&o.push(a);return o}function q7(e,t,n,r,i){let[[s,o],[a,c]]=e;const{e:u,f:l}=i,h=r.getBoundingClientRect(),f=h.left-t,d=h.right-t,p=h.top-n,y=h.bottom-n;if(f>=s&&d<=a&&p>=o&&y<=c)return!0;if(f<=a&&d>=s&&p<=c&&y>=o){let g=r.tagName;if(g==="a"&&(r=r.children[0],g=r.tagName),g==="rect"||g==="text"||g==="image")return!0;switch(s-=u,o-=l,a-=u,c-=l,g){case"circle":return Y7(s,o,a,c,Bo(r.cx),Bo(r.cy),Bo(r.r));case"line":return V7(s,o,a,c,Bo(r.x1),Bo(r.y1),Bo(r.x2),Bo(r.y2));case"path":return rct(s,o,a,c,r)}}return!1}function Bo(e){return e.baseVal.value}function j7(e){const t=e.transform.baseVal,n=t.length;let r=t[0]?.matrix;for(let i=1;i<n;++i)r=r.multiply(t[i].matrix);return r}function Y7(e,t,n,r,i,s,o){const a=e<=i&&i<=n,c=t<=s&&s<=r;if(a&&c)return!0;const u=Math.min(Math.abs(e-i),Math.abs(n-i));if(c&&u<=o)return!0;const l=Math.min(Math.abs(t-s),Math.abs(r-s));return a&&l<=o||u*u+l*l<=o*o}function V7(e,t,n,r,i,s,o,a){const c=Math.max(Math.min(i,o),e),u=Math.min(Math.max(i,o),n);if(c>u)return!1;let l=s,h=a;const f=o-i;if(Math.abs(f)>1e-8){const y=(a-s)/f,g=s-y*i;l=y*c+g,h=y*u+g}const d=Math.max(Math.min(l,h),t),p=Math.min(Math.max(l,h),r);return d<=p}function rct(e,t,n,r,i){const s=i.__path__||(i.__path__=tct(i.getAttribute("d")));let o=0,a=0,c=0,u=0,l=!1,h=[0,0],f=2;const d=j7(i),p=(b,w)=>{h.length=f=2,h[0]=c=o=b,h[1]=u=a=w},y=d?(b,w)=>p(W7(d,b,w),G7(d,b,w)):(b,w)=>p(b,w),g=(b,w)=>(h[f]=b,h[f+1]=w,f+=2,V7(e,t,n,r,h[f-4],h[f-3],b,w)),m=d?(b,w)=>{l=g(W7(d,c=b,u=w),G7(d,b,w))}:(b,w)=>{l=g(c=b,u=w)};for(let b=0;b<s.length;++b){const w=s[b];switch(w[0]){case"M":y(w[1],w[2]);break;case"m":y(c+w[1],u+w[2]);break;case"L":case"T":m(w[1],w[2]);break;case"H":m(w[1],u);break;case"V":m(c,w[1]);break;case"l":case"t":m(c+w[1],u+w[2]);break;case"h":m(c+w[1],u);break;case"v":m(c,u+w[1]);break;case"C":m(w[5],w[6]);break;case"c":m(c+w[5],u+w[6]);break;case"S":case"Q":m(w[3],w[4]);break;case"s":case"q":m(c+w[3],u+w[4]);break;case"A":m(w[6],w[7]);break;case"a":if(ict(s,b))return Y7(e,t,n,r,c,u-w[2],w[2]);m(c+w[6],c+w[7]);break;case"z":case"Z":if(m(o,a),sct(e,t,h)>0)return!0;y(o,a);break;default:return console.warn("SVG path command not supported: ",w[0]),!1}if(l)return!0}return!1}function W7(e,t,n){return e.a*t+e.c*n+e.e}function G7(e,t,n){return e.b*t+e.d*n+e.f}function ict(e,t){const n=e[t],r=e[t+1];return r&&r[0]==="a"&&e[t+2]?.[0]==="z"&&n[1]===n[2]&&r[1]===r[2]&&n[1]===r[1]&&n[7]===-r[7]}function sct(e,t,n){let r=0;const i=n.length-2;for(let s=0;s<i;s+=2)n[s+1]<=t?n[s+3]>t&&X7(e,t,n,s)>0&&++r:n[s+3]<=t&&X7(e,t,n[s])<0&&--r;return r}function X7(e,t,n,r){return(n[r+2]-n[r])*(t-n[r+1])-(e-n[r])*(n[r+3]-n[r+1])}function H7(e,t){return e==null||t==null?e!=null||t!=null:e.length!==t.length||e.some((n,r)=>ww(n,t[r]))}function ww(e,t){const n=e.length;if(t.length!==n)return!0;for(let r=0;r<n;++r)if(e[r]!==t[r])return!0;return!1}class oct{constructor(t,{channels:n,selection:r,peers:i=!0,brush:s={fill:"none",stroke:"currentColor",strokeDasharray:"1,1"}}){this.mark=t,this.selection=r,this.peers=i,this.style=s&&Cy(s),this.brush=C7(),this.brush.on("brush end",c=>this.publish(c.selection)),this.extent=null,this.groups=null;const{fields:o,as:a}=qat(t,n);this.fields=o,this.as=a}reset(){this.value=void 0,this.extent=null,this.g&&this.brush.reset(this.g)}activate(){this.selection.activate(this.clause([this.fields.map(()=>0)]))}clause(t){const{fields:n,mark:r}=this;return yu(n,t,{source:this,clients:this.peers?r.plot.markSet:new Set().add(r)})}publish(t){const{as:n,group:r,mark:i,svg:s}=this;let o;if(t){const{data:{columns:a={}}={}}=i,c=new Map;nct(s,r,t).forEach(u=>{const l=dw(u),h=n.map(f=>a[f][l]);c.set(h.join("|"),h)}),o=Array.from(c.values())}this.extent=t,H7(o,this.value)&&(this.value=o,this.selection.update(this.clause(o)))}init(t){const{brush:n,extent:r,mark:i,style:s}=this;this.svg=t;const o=t.width.baseVal.value,a=t.height.baseVal.value;if(n.extent([[0,0],[o,a]]),this.group=t.querySelector(`[data-index="${i.index}"]`),this.g=oe(t).append("g").attr("class","region-xy").each(F7).call(n).call(n.moveSilent,r),s){const c=this.g.selectAll("rect.selection");for(const u in s)c.attr(u,s[u])}t.addEventListener("pointerenter",c=>{c.buttons||this.activate()})}}class Q7{constructor(t,{selection:n,channels:r,peers:i=!0}){this.mark=t,this.value=null,this.selection=n,this.peers=i;const s=this.fields=[],o=this.as=[];r.forEach(a=>{const c=a==="color"?["color","fill","stroke"]:a==="x"?["x","x1","x2"]:a==="y"?["y","y1","y2"]:[a];for(let u=0;u<c.length;++u){const l=t.channelField(c[u],{exact:!0});if(l){s.push(l.field?.basis||l.field),o.push(l.as);return}}throw new Error(`Missing channel: ${a}`)})}clause(t){const{fields:n,mark:r}=this;return yu(n,t,{source:this,clients:this.peers?r.plot.markSet:new Set().add(r)})}init(t,n,r){const{mark:i,as:s,selection:o}=this,{data:{columns:a={}}={}}=i;r??=u=>s.map(l=>a[l][dw(u)]),n??=`[data-index="${i.index}"]`;const c=Array.from(t.querySelectorAll(n));t.addEventListener("pointerdown",u=>{const l=o.single?o.value:this.value,h=u.target;let f=null;if(act(c,h)){const d=r(h);(u.shiftKey||u.metaKey)&&l?.length?(f=l.filter(p=>ww(p,d)),f.length===l.length&&f.push(d)):l?.length===1&&!ww(l[0],d)?f=null:f=[d]}this.value=f,H7(l,f)&&o.update(this.clause(f))}),t.addEventListener("pointerenter",u=>{u.buttons||this.activate()})}activate(){this.selection.activate(this.clause([this.fields.map(()=>0)]))}}function act(e,t){return e.some(n=>n.contains(t))}const J7=":scope > div, :scope > span",ky="swatch",K7="ramp";class Z7{constructor(t,n){const{as:r,field:i,...s}=n;this.channel=t,this.options=s,this.type=null,this.handler=null,this.selection=r,this.field=i,this.legend=null,this.element=document.createElement("div"),this.element.setAttribute("class","legend"),Object.defineProperty(this.element,"value",{value:this})}setPlot(t){this.plot=t}init(t){const n=cct(this,t);return this.element.replaceChildren(n),this.element}update(){if(!this.legend)return;const{selection:t,handler:n}=this,{single:r,value:i}=t,s=r?i:t.valueFor(n),o=s&&s.length?new Set(s.map(c=>c[0])):null,a=this.legend.querySelectorAll(J7);for(const c of a){const u=o?o.has(c.__data__):!0;c.style.opacity=u?1:.2}}}function cct(e,t){const{channel:n,plot:r,selection:i}=e,s=t.scale(n),o=s.type==="ordinal"?ky:K7,a={label:r.getAttribute(`${n}Label`)??null,...e.options},c=o===ky?a:a.label?{tickSize:2,...a}:{tickSize:2,marginTop:1,height:29,...a},u=t.legend(n,c);e.legend=u;let l=!!i;if(l&&o===K7){const h=c.width??240,f=hct(s,h);f?u.scale=function(d){return d==="x"?{range:[0,h]}:d==="y"?{range:[-10,0]}:d===n?f:void 0}:l=!1}if(l){const h=uct(e,o);o===ky?(h.init(u,J7,f=>[f.__data__]),e.update()):h.init(u,u.querySelector("g:last-of-type"))}return u}function uct(e,t){const{channel:n,handler:r,selection:i}=e;if(r)return r;const s=lct(e);return t===ky?(e.handler=new Q7(s,{selection:i,channels:[n],peers:!1}),i.addEventListener("value",()=>e.update())):e.handler=new gw(s,{selection:i,channel:n,brush:{fill:"none",stroke:"currentColor"},peers:!1}),e.handler}function lct(e){const{channel:t,plot:n}=e,r=e.field??fct(n.marks,t)??"value";if(r){const i={field:r};return{plot:n,channelField:s=>t===s?i:void 0}}}function fct(e,t){const n=t==="color"?["fill","stroke"]:t==="opacity"?["opacity","fillOpacity","strokeOpacity"]:null;if(n==null)return null;for(let r=e.length-1;r>-1;--r)for(const i of n){const s=e[r].channelField(i,{exact:!0});if(s)return s.field}return null}function hct(e,t){const{apply:n,invert:r,interpolate:i,...s}=e;let o=e.type;o.startsWith("diverging-")&&(o=o.slice(11));let a;switch(o){case"log":case"pow":case"sqrt":case"symlog":a=o;break;case"threshold":case"quantize":case"quantile":return console.warn(`Legends do not yet support ${o} scales.`),null;default:a="linear"}return Tl({x:{...s,type:a,range:[0,t]}})}const dct=new Set(["rectY-x","rectX-y","rect-x","rect-y","ruleY-x","ruleX-y"]);function pct(e,t){return dct.has(`${e.type}-${t}`)}function tC(e,t={}){const n=(r,i)=>pct(r,i)?{[`${i}1`]:vw(r,i,e,t),[`${i}2`]:vw(r,i,e,{...t,offset:1})}:{[i]:vw(r,i,e,t)};return n[ZT]=!0,n}function vw(e,t,n,r){return new mct(n,e,t,r)}function yct(e,t){const n=e.plot.getAttribute(`${t}Scale`);return n==="utc"||n==="time"}let mct=class extends le{constructor(t,n,r,i){super("COLUMN_REF"),this.column=t,this.mark=n,this.channel=r,this.options=i}get stats(){return{column:this.column,stats:["min","max"]}}toString(){const{mark:t,channel:n,column:r,options:i}=this,{type:s,min:o,max:a}=t.channelField(n);return`${i.interval||s==="date"||yct(t,n)?PP(r,[o,a],i):WP(r,[o,a],i,Ly(t,n))}`}};class By extends qo{constructor(t,n,r="input"){super(t),this.element=n||document.createElement("div"),r&&this.element.setAttribute("class",r),Object.defineProperty(this.element,"value",{value:this})}activate(){}}const gct=e=>e&&typeof e=="object"&&!Array.isArray(e);class bct extends By{constructor({element:t,filterBy:n,as:r,from:i,column:s,label:o=s,format:a=f=>f,options:c,value:u,field:l=s,listMatch:h}={}){super(n,t),this.from=i,this.column=s,this.format=a,this.field=l,this.listMatch=h;const f=this.selection=r,d=document.createElement("label");if(d.innerText=o||s,this.element.appendChild(d),this.select=document.createElement("select"),this.element.appendChild(this.select),c&&(this.data=c.map(p=>gct(p)?p:{value:p}),this.selectedValue(u===void 0?"":u),this.update()),f){const p=!An(f);u!=null&&(!p||f.value===void 0)&&this.publish(u),this.select.addEventListener("input",()=>{this.publish(this.selectedValue()??null)}),p?this.selection.addEventListener("value",y=>{y!==this.select.value&&this.selectedValue(y)}):(this.select.addEventListener("pointerenter",y=>{y.buttons||this.activate()}),this.select.addEventListener("focus",()=>this.activate()))}}selectedValue(t){if(arguments.length===0){const n=this.select.selectedIndex;return this.data[n].value}else{const n=this.data?.findIndex(r=>r.value===t);n>=0?this.select.selectedIndex=n:this.select.value=String(t)}}reset(){this.select.selectedIndex=this.from?0:-1}activate(){An(this.selection)&&this.selection.activate(pu(this.field,0,{source:this}))}publish(t){const{selection:n,field:r,listMatch:i}=this;if(An(n)){t===""&&(t=void 0);const s=i?QT(r,t,{source:this,listMatch:i}):pu(r,t,{source:this});n.update(s)}else Sn(n)&&n.update(t)}query(t=[]){const{from:n,column:r,listMatch:i}=this;return n?gt.from(n).select({value:i?SP(r):r}).distinct().where(t).orderby(r):null}queryResult(t){return this.data=[{value:"",label:"All"},...t],this}update(){const{data:t,format:n,select:r,selection:i}=this;r.replaceChildren();for(const{value:s,label:o}of t){const a=document.createElement("option");a.setAttribute("value",s),a.innerText=o??n(s),this.select.appendChild(a)}if(i){const s=An(i)?i.valueFor(this):i.value;this.selectedValue(s===void 0?"":s)}return this}}let _ct=0;class wct extends By{constructor({element:t,filterBy:n,from:r,column:i,label:s,type:o="contains",field:a=i,as:c}={}){if(super(n,t),this.id="search_"+ ++_ct,this.type=o,this.from=r,this.column=i,this.selection=c,this.field=a,s){const u=document.createElement("label");u.setAttribute("for",this.id),u.innerText=s,this.element.appendChild(u)}this.searchbox=document.createElement("input"),this.searchbox.setAttribute("id",this.id),this.searchbox.setAttribute("type","text"),this.searchbox.setAttribute("placeholder","Query"),this.element.appendChild(this.searchbox),this.selection&&(this.searchbox.addEventListener("input",()=>{this.publish(this.searchbox.value||null)}),An(this.selection)?(this.searchbox.addEventListener("pointerenter",u=>{u.buttons||this.activate()}),this.searchbox.addEventListener("focus",()=>this.activate())):this.selection.addEventListener("value",u=>{u!==this.searchbox.value&&(this.searchbox.value=u)}))}reset(){this.searchbox.value=""}clause(t){const{field:n,type:r}=this;return HT(n,t,{source:this,method:r})}activate(){An(this.selection)&&this.selection.activate(this.clause(""))}publish(t){const{selection:n}=this;An(n)?n.update(this.clause(t)):Sn(n)&&n.update(t)}query(t=[]){const{from:n,column:r}=this;return n?gt.from(n).select({list:r}).distinct().where(t):null}queryResult(t){return this.data=t,this}update(){const t=document.createElement("datalist"),n=`${this.id}_list`;t.setAttribute("id",n);for(const r of this.data){const i=document.createElement("option");i.setAttribute("value",r.list),t.append(i)}return this.datalist&&this.datalist.remove(),this.element.appendChild(this.datalist=t),this.searchbox.setAttribute("list",n),this}}let vct=0;class xct extends By{constructor({element:t,filterBy:n,as:r,min:i,max:s,step:o,from:a,column:c,label:u=c,value:l=r?.value,select:h="point",field:f=c,width:d}={}){if(super(n,t),this.id="slider_"+ ++vct,this.from=a,this.column=c||"value",this.selection=r,this.selectionType=h,this.field=f,this.min=i,this.max=s,this.step=o,u){const p=document.createElement("label");p.setAttribute("for",this.id),p.innerText=u,this.element.appendChild(p)}this.slider=document.createElement("input"),this.slider.setAttribute("id",this.id),this.slider.setAttribute("type","range"),d!=null&&(this.slider.style.width=`${+d}px`),i!=null&&this.slider.setAttribute("min",`${i}`),s!=null&&this.slider.setAttribute("max",`${s}`),o!=null&&this.slider.setAttribute("step",`${o}`),this.element.appendChild(this.slider),this.curval=document.createElement("label"),this.curval.setAttribute("for",this.id),this.curval.setAttribute("class","value"),this.element.appendChild(this.curval),l!=null&&(this.slider.setAttribute("value",`${l}`),this.selection?.value===void 0&&this.publish(l)),this.curval.innerText=this.slider.value,this.slider.addEventListener("input",()=>{const{value:p}=this.slider;this.curval.innerText=p,this.selection&&this.publish(+p)}),this.selection&&(An(this.selection)?(this.slider.addEventListener("pointerenter",p=>{p.buttons||this.activate()}),this.slider.addEventListener("focus",()=>this.activate())):this.selection.addEventListener("value",p=>{p!==+this.slider.value&&(this.slider.value=p,this.curval.innerText=p)}))}query(t=[]){const{from:n,column:r}=this;return!n||this.min!=null&&this.max!=null?null:gt.select({min:os(r),max:Nr(r)}).from(n).where(t)}queryResult(t){const{min:n,max:r}=Array.from(t)[0];return this.min==null&&(this.min=n,this.slider.setAttribute("min",`${n}`)),this.max==null&&(this.max=r,this.slider.setAttribute("max",`${r}`)),this.step==null&&(this.step=(r-n)/500,this.slider.setAttribute("step",`${this.step}`)),this}clause(t){const{field:n,selectionType:r}=this;if(r==="interval"){const i=[this.min??0,t];return Uh(n,i,{source:this,bin:"ceil",scale:{type:"identity",domain:i},pixelSize:this.step})}else return pu(n,t,{source:this})}activate(){An(this.selection)&&this.selection.activate(this.clause(0))}publish(t){const{selection:n}=this;An(n)?n.update(this.clause(t)):Sn(this.selection)&&n.update(t)}}const eC=rC(e=>{const t=xw(e);return n=>n==null?"":typeof n=="number"?t(n):n instanceof Date?nC(n):`${n}`}),xw=rC(e=>t=>t===0?"0":t.toLocaleString(e));eC(),xw();function nC(e){return Sct(e,"Invalid Date")}function rC(e){let t=null,n;return(r="en")=>r===t?n:n=e(t=r)}function Sct(e,t){if(e instanceof Date||(e=new Date(+e)),isNaN(+e))return typeof t=="function"?t(e):t;const n=e.getUTCHours(),r=e.getUTCMinutes(),i=e.getUTCSeconds(),s=e.getUTCMilliseconds();return`${Act(e.getUTCFullYear())}-${Qi(e.getUTCMonth()+1,2)}-${Qi(e.getUTCDate(),2)}${n||r||i||s?`T${Qi(n,2)}:${Qi(r,2)}${i||s?`:${Qi(i,2)}${s?`.${Qi(s,3)}`:""}`:""}Z`:""}`}function Act(e){return e<0?`-${Qi(-e,6)}`:e>9999?`+${Qi(e,6)}`:Qi(e,4)}function Qi(e,t){return`${e}`.padStart(t,"0")}let Ict=-1;class Ect extends By{constructor({element:t,filterBy:n,from:r,columns:i=["*"],align:s={},format:o,width:a,maxWidth:c,height:u=500,rowBatch:l=100,as:h}={}){super(n,t,null),this.id=`table-${++Ict}`,this.element.setAttribute("id",this.id),this.from=r,this.columns=i,this.format=o,this.align=s,this.widths=typeof a=="object"?a:{},Sn(r)&&r.addEventListener("value",()=>this.initialize()),this.offset=0,this.limit=+l,this.isPending=!1,this.selection=h,this.currentRow=-1,this.sortHeader=null,this.sortColumn=null,this.sortDesc=!1,typeof a=="number"&&(this.element.style.width=`${a}px`),c&&(this.element.style.maxWidth=`${c}px`),this.element.style.maxHeight=`${u}px`,this.element.style.overflow="auto";let f=-1;this.element.addEventListener("scroll",d=>{const{isPending:p,loaded:y}=this,{scrollHeight:g,scrollTop:m,clientHeight:b}=d.target,w=m<f;f=m,!(w||p||y)&&g-m<2*b&&(this.isPending=!0,this.requestData(this.offset+this.limit))}),this.tbl=document.createElement("table"),this.element.appendChild(this.tbl),this.head=document.createElement("thead"),this.tbl.appendChild(this.head),this.body=document.createElement("tbody"),this.tbl.appendChild(this.body),this.selection&&(this.body.addEventListener("pointerover",d=>{const p=Mct(d.target);p>-1&&p!==this.currentRow&&(this.currentRow=p,this.selection.update(this.clause([p])))}),this.body.addEventListener("pointerleave",()=>{this.currentRow=-1,this.selection.update(this.clause())})),this.style=document.createElement("style"),this.element.appendChild(this.style)}sourceTable(){return Sn(this.from)?this.from.value:this.from}clause(t=[]){const{data:n,limit:r,schema:i}=this,s=i.map(a=>a.column),o=t.map(a=>{const{columns:c}=n[~~(a/r)];return s.map(u=>c[u][a%r])});return yu(s,o,{source:this})}requestData(t=0){this.offset=t;const n=this.query(this.filterBy?.predicate(this));this.requestQuery(n),ls().prefetch(n.clone().offset(t+this.limit))}async prepare(){const t=this.sourceTable(),n=this.columns.map(o=>({column:o,table:t})),r=await zm(this.coordinator,n);this.schema=r;const i=this.head;i.innerHTML="";const s=document.createElement("tr");for(const{column:o}of r){const a=document.createElement("th");a.addEventListener("click",c=>this.sort(c,o)),a.appendChild(document.createElement("span")),a.appendChild(document.createTextNode(o)),s.appendChild(a)}i.appendChild(s),this.formats=Tct(this.format,r),this.style.innerText=Rct(this.id,$ct(this.align,r),Nct(this.widths,r))}query(t=[]){const{limit:n,offset:r,schema:i,sortColumn:s,sortDesc:o}=this;return gt.from(this.sourceTable()).select(i.map(a=>a.column)).where(t).orderby(s?o?yP(s):s:[]).limit(n).offset(r)}queryResult(t){return this.isPending||(this.loaded=!1,this.data=[],this.body.replaceChildren(),this.offset=0),this.data.push(ws(t)),this}update(){const{body:t,formats:n,data:r,schema:i,limit:s}=this,o=i.length,a=r.length-1,c=s*a,{numRows:u,columns:l}=r[a],h=i.map(f=>l[f.column]);for(let f=0;f<u;++f){const d=document.createElement("tr");Object.assign(d,{__row__:c+f});for(let p=0;p<o;++p){const y=h[p][f],g=document.createElement("td");g.innerText=y==null?"":n[p](y),d.appendChild(g)}t.appendChild(d)}return u<s&&(this.loaded=!0),this.isPending=!1,this}activate(){An(this.selection)&&this.selection.activate(this.clause([]))}sort(t,n){n===this.sortColumn?this.sortDesc=!this.sortDesc:(this.sortColumn=n,this.sortDesc=!1);const r=t.currentTarget,i=this.sortHeader;i===r&&t.metaKey?(i.firstChild.textContent="",this.sortHeader=null,this.sortColumn=null):(i&&(i.firstChild.textContent=""),this.sortHeader=r,r.firstChild.textContent=this.sortDesc?"▾":"▴"),this.requestData()}}function Mct(e){const t=e.parentElement;return Object.hasOwn(t,"__row__")?+t.__row__:-1}function Tct(e={},t,n){return t.map(({column:r,type:i})=>{if(r in e)return e[r];switch(i){case"number":return xw(n);case"date":return nC;default:return eC(n)}})}function $ct(e={},t){return t.map(({column:n,type:r})=>n in e?e[n]:r==="number"?"right":"left")}function Nct(e={},t){return t.map(({column:n})=>e[n])}function Rct(e,t,n){const r=[];return t.forEach((i,s)=>{const o=+n[s];if(i!=="left"||o){const a=i!=="left"?`text-align:${i};`:"",c=o?`width:${o}px;max-width:${o}px;`:"";r.push(`#${e} tr>:nth-child(${s+1}) {${a}${c}}`)}}),r.join(" ")}function Sw(e,...t){const n=e?.context?.coordinator??ls();for(const r of t)n.connect(r)}function Py(e,t,n){const r=new t(n);return Sw(e,r),r.element}function iC(e){return Py(this,bct,e)}function sC(e){return Py(this,wct,e)}function oC(e){return Py(this,xct,e)}function aC(e){return Py(this,Ect,e)}function cC({direction:e="vertical",wrap:t=!1},n){const r=document.createElement("div");return r.style.display="flex",r.style.flexDirection=e==="vertical"?"column":"row",r.style.flexWrap=t?t===!0?"wrap":t:"nowrap",r.style.justifyContent="flex-start",r.style.alignItems="flex-start",n.forEach(i=>r.appendChild(i)),Object.assign(r,{value:{element:r}}),r}function uC(...e){return cC({direction:"vertical"},e.flat())}function lC(...e){return cC({direction:"horizontal"},e.flat())}function fC({dim:e="width",size:t=10}){const n=document.createElement("span");return n.style.display="inline-block",n.style[e]=Number.isNaN(+t)?t:`${t}px`,Object.assign(n,{value:{element:n}})}function hC(e){return fC({dim:"height",size:e})}function dC(e){return fC({dim:"width",size:e})}class pC extends Map{request(t,n){if(this.has(t))n(this.get(t));else{const r=this.waiting||(this.waiting=new Map),i=r.get(t)||[];r.set(t,i.concat(n))}}set(t,n){this.has(t)&&console.warn(`Overwriting named plot "${t}".`);const{waiting:r}=this;return r?.has(t)&&(r.get(t).forEach(i=>i(n)),r.delete(t)),super.set(t,n)}clear(){return this.waiting?.clear(),super.clear()}}const Aw=new pC;function yC(e,t,n){(e?.context?.namedPlots??Aw).request(t,n)}function Oct(e,t,n){(e?.context?.namedPlots??Aw).set(t,n)}function Iw(e){return t=>Oct(this,e,t)}function mC(e,t,n){Sn(n)?(n.addEventListener("value",r=>{e.setAttribute(t,r),e.update()}),n.value!==void 0&&e.setAttribute(t,n.value)):e.setAttribute(t,n)}function Dct(e,t){return n=>{mC(n,e,t)}}function Ew(e){return t=>{for(const[n,r]of Object.entries(e))mC(t,n,r)}}function Mw(e){const{top:t,bottom:n,left:r,right:i}=e,s={};return t!==void 0&&(s.marginTop=t),n!==void 0&&(s.marginBottom=n),r!==void 0&&(s.marginLeft=r),i!==void 0&&(s.marginRight=i),Ew(s)}function Tw(e){return Ew({marginTop:e,marginBottom:e,marginLeft:e,marginRight:e})}function $w(e){return Ew({xDomain:e,yDomain:e})}const F=e=>t=>Dct(e,t),Nw=F("style"),Rw=F("width"),Ow=F("height"),Dw=F("marginLeft"),Lw=F("marginRight"),Fw=F("marginTop"),Cw=F("marginBottom"),kw=F("align"),Bw=F("aspectRatio"),Pw=F("axis"),Uw=F("inset"),zw=F("grid"),qw=F("clip"),jw=F("padding"),Yw=F("ariaLabel"),Vw=F("ariaDescription"),Ww=F("xScale"),Gw=F("xDomain"),Xw=F("xRange"),Hw=F("xNice"),Qw=F("xInset"),Jw=F("xInsetLeft"),Kw=F("xInsetRight"),Zw=F("xClamp"),tv=F("xRound"),ev=F("xAlign"),nv=F("xPadding"),rv=F("xPaddingInner"),iv=F("xPaddingOuter"),sv=F("xAxis"),ov=F("xTicks"),av=F("xTickSize"),cv=F("xTickSpacing"),uv=F("xTickPadding"),lv=F("xTickFormat"),fv=F("xTickRotate"),hv=F("xGrid"),dv=F("xLine"),pv=F("xLabel"),yv=F("xLabelAnchor"),mv=F("xLabelArrow"),gv=F("xLabelOffset"),bv=F("xFontVariant"),_v=F("xAriaLabel"),wv=F("xAriaDescription"),vv=F("xPercent"),xv=F("xReverse"),Sv=F("xZero"),Av=F("xBase"),Iv=F("xExponent"),Ev=F("xConstant"),Mv=F("yScale"),Tv=F("yDomain"),$v=F("yRange"),Nv=F("yNice"),Rv=F("yInset"),Ov=F("yInsetTop"),Dv=F("yInsetBottom"),Lv=F("yClamp"),Fv=F("yRound"),Cv=F("yAlign"),kv=F("yPadding"),Bv=F("yPaddingInner"),Pv=F("yPaddingOuter"),Uv=F("yAxis"),zv=F("yTicks"),qv=F("yTickSize"),jv=F("yTickSpacing"),Yv=F("yTickPadding"),Vv=F("yTickFormat"),Wv=F("yTickRotate"),Gv=F("yGrid"),Xv=F("yLine"),Hv=F("yLabel"),Qv=F("yLabelAnchor"),Jv=F("yLabelArrow"),Kv=F("yLabelOffset"),Zv=F("yFontVariant"),t2=F("yAriaLabel"),e2=F("yAriaDescription"),n2=F("yPercent"),r2=F("yReverse"),i2=F("yZero"),s2=F("yBase"),o2=F("yExponent"),a2=F("yConstant"),c2=F("facetMargin"),u2=F("facetMarginTop"),l2=F("facetMarginBottom"),f2=F("facetMarginLeft"),h2=F("facetMarginRight"),d2=F("facetGrid"),p2=F("facetLabel"),y2=F("fxDomain"),m2=F("fxRange"),g2=F("fxInset"),b2=F("fxInsetLeft"),_2=F("fxInsetRight"),w2=F("fxRound"),v2=F("fxAlign"),x2=F("fxPadding"),S2=F("fxPaddingInner"),A2=F("fxPaddingOuter"),I2=F("fxAxis"),E2=F("fxTicks"),M2=F("fxTickSize"),T2=F("fxTickSpacing"),$2=F("fxTickPadding"),N2=F("fxTickFormat"),R2=F("fxTickRotate"),O2=F("fxGrid"),D2=F("fxLine"),L2=F("fxLabel"),F2=F("fxLabelAnchor"),C2=F("fxLabelOffset"),k2=F("fxFontVariant"),B2=F("fxAriaLabel"),P2=F("fxAriaDescription"),U2=F("fxReverse"),z2=F("fyDomain"),q2=F("fyRange"),j2=F("fyInset"),Y2=F("fyInsetTop"),V2=F("fyInsetBottom"),W2=F("fyRound"),G2=F("fyAlign"),X2=F("fyPadding"),H2=F("fyPaddingInner"),Q2=F("fyPaddingOuter"),J2=F("fyAxis"),K2=F("fyTicks"),Z2=F("fyTickSize"),tx=F("fyTickSpacing"),ex=F("fyTickPadding"),nx=F("fyTickFormat"),rx=F("fyTickRotate"),ix=F("fyGrid"),sx=F("fyLine"),ox=F("fyLabel"),ax=F("fyLabelAnchor"),cx=F("fyLabelOffset"),ux=F("fyFontVariant"),lx=F("fyAriaLabel"),fx=F("fyAriaDescription"),hx=F("fyReverse"),dx=F("colorScale"),px=F("colorDomain"),yx=F("colorRange"),mx=F("colorClamp"),gx=F("colorN"),bx=F("colorNice"),_x=F("colorScheme"),wx=F("colorInterpolate"),vx=F("colorPivot"),xx=F("colorSymmetric"),Sx=F("colorLabel"),Ax=F("colorPercent"),Ix=F("colorReverse"),Ex=F("colorZero"),Mx=F("colorTickFormat"),Tx=F("colorBase"),$x=F("colorExponent"),Nx=F("colorConstant"),Rx=F("opacityScale"),Ox=F("opacityDomain"),Dx=F("opacityRange"),Lx=F("opacityClamp"),Fx=F("opacityNice"),Cx=F("opacityLabel"),kx=F("opacityPercent"),Bx=F("opacityReverse"),Px=F("opacityZero"),Ux=F("opacityTickFormat"),zx=F("opacityBase"),qx=F("opacityExponent"),jx=F("opacityConstant"),Yx=F("symbolScale"),Vx=F("symbolDomain"),Wx=F("symbolRange"),Gx=F("rScale"),Xx=F("rDomain"),Hx=F("rRange"),Qx=F("rClamp"),Jx=F("rNice"),Kx=F("rLabel"),Zx=F("rPercent"),tS=F("rZero"),eS=F("rBase"),nS=F("rExponent"),rS=F("rConstant"),iS=F("lengthScale"),sS=F("lengthDomain"),oS=F("lengthRange"),aS=F("lengthClamp"),cS=F("lengthNice"),uS=F("lengthPercent"),lS=F("lengthZero"),fS=F("lengthBase"),hS=F("lengthExponent"),dS=F("lengthConstant"),pS=F("projectionType"),yS=F("projectionParallels"),mS=F("projectionPrecision"),gS=F("projectionRotate"),bS=F("projectionDomain"),_S=F("projectionInset"),wS=F("projectionInsetLeft"),vS=F("projectionInsetRight"),xS=F("projectionInsetTop"),SS=F("projectionInsetBottom"),AS=F("projectionClip"),gC=Object.freeze(Object.defineProperty({__proto__:null,align:kw,ariaDescription:Vw,ariaLabel:Yw,aspectRatio:Bw,axis:Pw,clip:qw,colorBase:Tx,colorClamp:mx,colorConstant:Nx,colorDomain:px,colorExponent:$x,colorInterpolate:wx,colorLabel:Sx,colorN:gx,colorNice:bx,colorPercent:Ax,colorPivot:vx,colorRange:yx,colorReverse:Ix,colorScale:dx,colorScheme:_x,colorSymmetric:xx,colorTickFormat:Mx,colorZero:Ex,facetGrid:d2,facetLabel:p2,facetMargin:c2,facetMarginBottom:l2,facetMarginLeft:f2,facetMarginRight:h2,facetMarginTop:u2,fxAlign:v2,fxAriaDescription:P2,fxAriaLabel:B2,fxAxis:I2,fxDomain:y2,fxFontVariant:k2,fxGrid:O2,fxInset:g2,fxInsetLeft:b2,fxInsetRight:_2,fxLabel:L2,fxLabelAnchor:F2,fxLabelOffset:C2,fxLine:D2,fxPadding:x2,fxPaddingInner:S2,fxPaddingOuter:A2,fxRange:m2,fxReverse:U2,fxRound:w2,fxTickFormat:N2,fxTickPadding:$2,fxTickRotate:R2,fxTickSize:M2,fxTickSpacing:T2,fxTicks:E2,fyAlign:G2,fyAriaDescription:fx,fyAriaLabel:lx,fyAxis:J2,fyDomain:z2,fyFontVariant:ux,fyGrid:ix,fyInset:j2,fyInsetBottom:V2,fyInsetTop:Y2,fyLabel:ox,fyLabelAnchor:ax,fyLabelOffset:cx,fyLine:sx,fyPadding:X2,fyPaddingInner:H2,fyPaddingOuter:Q2,fyRange:q2,fyReverse:hx,fyRound:W2,fyTickFormat:nx,fyTickPadding:ex,fyTickRotate:rx,fyTickSize:Z2,fyTickSpacing:tx,fyTicks:K2,grid:zw,height:Ow,inset:Uw,lengthBase:fS,lengthClamp:aS,lengthConstant:dS,lengthDomain:sS,lengthExponent:hS,lengthNice:cS,lengthPercent:uS,lengthRange:oS,lengthScale:iS,lengthZero:lS,margin:Tw,marginBottom:Cw,marginLeft:Dw,marginRight:Lw,marginTop:Fw,margins:Mw,name:Iw,opacityBase:zx,opacityClamp:Lx,opacityConstant:jx,opacityDomain:Ox,opacityExponent:qx,opacityLabel:Cx,opacityNice:Fx,opacityPercent:kx,opacityRange:Dx,opacityReverse:Bx,opacityScale:Rx,opacityTickFormat:Ux,opacityZero:Px,padding:jw,projectionClip:AS,projectionDomain:bS,projectionInset:_S,projectionInsetBottom:SS,projectionInsetLeft:wS,projectionInsetRight:vS,projectionInsetTop:xS,projectionParallels:yS,projectionPrecision:mS,projectionRotate:gS,projectionType:pS,rBase:eS,rClamp:Qx,rConstant:rS,rDomain:Xx,rExponent:nS,rLabel:Kx,rNice:Jx,rPercent:Zx,rRange:Hx,rScale:Gx,rZero:tS,style:Nw,symbolDomain:Vx,symbolRange:Wx,symbolScale:Yx,width:Rw,xAlign:ev,xAriaDescription:wv,xAriaLabel:_v,xAxis:sv,xBase:Av,xClamp:Zw,xConstant:Ev,xDomain:Gw,xExponent:Iv,xFontVariant:bv,xGrid:hv,xInset:Qw,xInsetLeft:Jw,xInsetRight:Kw,xLabel:pv,xLabelAnchor:yv,xLabelArrow:mv,xLabelOffset:gv,xLine:dv,xNice:Hw,xPadding:nv,xPaddingInner:rv,xPaddingOuter:iv,xPercent:vv,xRange:Xw,xReverse:xv,xRound:tv,xScale:Ww,xTickFormat:lv,xTickPadding:uv,xTickRotate:fv,xTickSize:av,xTickSpacing:cv,xTicks:ov,xZero:Sv,xyDomain:$w,yAlign:Cv,yAriaDescription:e2,yAriaLabel:t2,yAxis:Uv,yBase:s2,yClamp:Lv,yConstant:a2,yDomain:Tv,yExponent:o2,yFontVariant:Zv,yGrid:Gv,yInset:Rv,yInsetBottom:Dv,yInsetTop:Ov,yLabel:Hv,yLabelAnchor:Qv,yLabelArrow:Jv,yLabelOffset:Kv,yLine:Xv,yNice:Nv,yPadding:kv,yPaddingInner:Bv,yPaddingOuter:Pv,yPercent:n2,yRange:$v,yReverse:r2,yRound:Fv,yScale:Mv,yTickFormat:Vv,yTickPadding:Yv,yTickRotate:Wv,yTickSize:qv,yTickSpacing:jv,yTicks:zv,yZero:i2},Symbol.toStringTag,{value:"Module"}));function bC(e,t=void 0){return{table:e,options:t}}const Lct=new Set(["frame","axisX","axisY","axisFx","axisFy","gridX","gridY","gridFx","gridFy","hexgrid","graticule","sphere"]);function rt(e,t,n={}){arguments.length===2&&!Array.isArray(t)&&(n=t,t=Lct.has(e)?null:[{}]);const r=e.startsWith("area")||e.startsWith("line")?Got:Gs;return Xl(r,e,t,n)}function Xl(e,t,n,r){return i=>{i.addMark(new e(t,n,r))}}function Ji(e,t,n){return r=>{r.addMark(new e(t,n))}}const IS=(...e)=>rt("area",...e),ES=(...e)=>rt("areaX",...e),MS=(...e)=>rt("areaY",...e),TS=(...e)=>rt("line",...e),$S=(...e)=>rt("lineX",...e),NS=(...e)=>rt("lineY",...e),RS=(...e)=>rt("barX",...e),OS=(...e)=>rt("barY",...e),DS=(...e)=>rt("cell",...e),LS=(...e)=>rt("cellX",...e),FS=(...e)=>rt("cellY",...e),CS=(...e)=>rt("rect",...e),kS=(...e)=>rt("rectX",...e),BS=(...e)=>rt("rectY",...e),PS=(...e)=>rt("dot",...e),US=(...e)=>rt("dotX",...e),zS=(...e)=>rt("dotY",...e),qS=(...e)=>rt("circle",...e),jS=(...e)=>rt("hexagon",...e),YS=(...e)=>rt("text",...e),VS=(...e)=>rt("textX",...e),WS=(...e)=>rt("textY",...e),GS=(...e)=>rt("ruleX",...e),XS=(...e)=>rt("ruleY",...e),HS=(...e)=>rt("tickX",...e),QS=(...e)=>rt("tickY",...e),JS=(...e)=>rt("vector",...e),KS=(...e)=>rt("vectoX",...e),ZS=(...e)=>rt("vectorY",...e),tA=(...e)=>rt("spike",...e),eA=(...e)=>rt("image",...e),nA=(...e)=>Xl(R7,"areaX",...e),rA=(...e)=>Xl(R7,"areaY",...e),iA=(...e)=>Ji(bat,...e),sA=(...e)=>Ji(pat,...e),oA=(...e)=>Ji(nat,...e),aA=(...e)=>Ji(uat,...e),cA=(...e)=>Ji(fw,...e),uA=(...e)=>Ji(Mat,...e),lA=(...e)=>Ji(Eat,...e),fA=(...e)=>rt("hexgrid",...e),hA=(...e)=>Ji(Dat,...e),dA=(...e)=>Xl(D7,"ruleY",...e),pA=(...e)=>Xl(D7,"ruleX",...e),yA=(...e)=>rt("voronoi",...e),mA=(...e)=>rt("voronoiMesh",...e),gA=(...e)=>rt("delaunayLink",...e),bA=(...e)=>rt("delaunayMesh",...e),_A=(...e)=>rt("hull",...e),wA=(...e)=>rt("arrow",...e),vA=(...e)=>rt("link",...e),xA=(...e)=>rt("frame",...e),SA=(...e)=>rt("axisX",...e),AA=(...e)=>rt("axisY",...e),IA=(...e)=>rt("axisFx",...e),EA=(...e)=>rt("axisFy",...e),MA=(...e)=>rt("gridX",...e),TA=(...e)=>rt("gridY",...e),$A=(...e)=>rt("gridFx",...e),NA=(...e)=>rt("gridFy",...e),RA=(...e)=>Ji(Iat,...e),OA=(...e)=>rt("sphere",...e),DA=(...e)=>rt("graticule",...e),LA=(...e)=>rt("waffleX",...e),FA=(...e)=>rt("waffleY",...e),_C=Object.freeze(Object.defineProperty({__proto__:null,area:IS,areaX:ES,areaY:MS,arrow:wA,axisFx:IA,axisFy:EA,axisX:SA,axisY:AA,barX:RS,barY:OS,cell:DS,cellX:LS,cellY:FS,circle:qS,contour:oA,delaunayLink:gA,delaunayMesh:bA,denseLine:sA,density:iA,densityX:nA,densityY:rA,dot:PS,dotX:US,dotY:zS,errorbarX:dA,errorbarY:pA,frame:xA,geo:RA,graticule:DA,gridFx:$A,gridFy:NA,gridX:MA,gridY:TA,heatmap:aA,hexagon:jS,hexbin:lA,hexgrid:fA,hull:_A,image:eA,line:TS,lineX:$S,lineY:NS,link:vA,raster:cA,rasterTile:uA,rect:CS,rectX:kS,rectY:BS,regressionY:hA,ruleX:GS,ruleY:XS,sphere:OA,spike:tA,text:YS,textX:VS,textY:WS,tickX:HS,tickY:QS,vector:JS,vectorX:KS,vectorY:ZS,voronoi:yA,voronoiMesh:mA,waffleX:LA,waffleY:FA},Symbol.toStringTag,{value:"Module"}));function oi(e,t){return n=>{const r=n.marks[n.marks.length-1];n.addInteractor(new e(r,t))}}function CA({by:e,...t}){return oi(Bat,{selection:e,channels:t})}function kA({as:e,...t}){return oi(gw,{...t,selection:e,channel:"x"})}function BA({as:e,...t}){return oi(gw,{...t,selection:e,channel:"y"})}function PA({as:e,...t}){return oi(jat,{...t,selection:e})}function UA({as:e,...t}){return oi(bw,{...t,selection:e,pointer:"xy"})}function zA({as:e,...t}){return oi(bw,{...t,selection:e,pointer:"x"})}function qA({as:e,...t}){return oi(bw,{...t,selection:e,pointer:"y"})}function jA({as:e,...t}){return oi(oct,{...t,selection:e})}function Po({as:e,...t}){return oi(Q7,{...t,selection:e})}function YA(e){return Po({...e,channels:["x"]})}function VA(e){return Po({...e,channels:["y"]})}function WA(e){return Po({...e,channels:["z"]})}function GA(e){return Po({...e,channels:["color"]})}function _c(e){return oi(Wat,e)}function XA(e={}){return _c({...e,zoom:!1})}function HA(e={}){return _c({...e,zoom:!1,pany:!1})}function QA(e={}){return _c({...e,zoom:!1,panx:!1})}function JA(e={}){return _c(e)}function KA(e={}){return _c({...e,pany:!1})}function ZA(e={}){return _c({...e,panx:!1})}const wC=Object.freeze(Object.defineProperty({__proto__:null,highlight:CA,intervalX:kA,intervalXY:PA,intervalY:BA,nearest:UA,nearestX:zA,nearestY:qA,pan:XA,panX:HA,panY:QA,panZoom:JA,panZoomX:KA,panZoomY:ZA,region:jA,toggle:Po,toggleColor:GA,toggleX:YA,toggleY:VA,toggleZ:WA},Symbol.toStringTag,{value:"Module"}));function t3(e,t={}){if(t.for){const{for:n,...r}=t,i=new Z7(e,r),s=typeof n,o=a=>a.addLegend(i,!1);return s==="string"?yC(this,n,o):n.value&&o(n.value),i.element}else return n=>n.addLegend(new Z7(e,t))}function e3(e){return t3.call(this,"color",e)}function n3(e){return t3.call(this,"opacity",e)}function r3(e){return t3.call(this,"symbol",e)}const vC=Object.freeze(Object.defineProperty({__proto__:null,colorLegend:e3,opacityLegend:n3,symbolLegend:r3},Symbol.toStringTag,{value:"Module"}));function xC(...e){const t=new Bot;return e.flat().forEach(n=>n(t)),Sw(this,...t.marks),t.update(),t.element}const Fct=Object.freeze(Object.defineProperty({__proto__:null,Fixed:ya,Param:yi,Query:gt,Selection:ro,align:kw,and:fi,area:IS,areaX:ES,areaY:MS,argmax:qc,argmin:jc,ariaDescription:Vw,ariaLabel:Yw,arrayAgg:UI,arrow:wA,aspectRatio:Bw,avg:x0,axis:Pw,axisFx:IA,axisFy:EA,axisX:SA,axisY:AA,barX:RS,barY:OS,bin:tC,cast:Yc,cell:DS,cellX:LS,cellY:FS,centroid:Df,centroidX:EE,centroidY:ME,circle:qS,clip:qw,colorBase:Tx,colorClamp:mx,colorConstant:Nx,colorDomain:px,colorExponent:$x,colorInterpolate:wx,colorLabel:Sx,colorLegend:e3,colorN:gx,colorNice:bx,colorPercent:Ax,colorPivot:vx,colorRange:yx,colorReverse:Ix,colorScale:dx,colorScheme:_x,colorSymmetric:xx,colorTickFormat:Mx,colorZero:Ex,column:If,contour:oA,coordinator:ls,corr:zI,count:ar,covarPop:jI,covariance:qI,createSchema:YE,createTable:Ho,cume_dist:LE,dateDay:bE,dateMonth:mE,dateMonthDay:gE,days:lE,delaunayLink:gA,delaunayMesh:bA,denseLine:sA,dense_rank:OE,density:iA,densityX:nA,densityY:rA,dot:PS,dotX:US,dotY:zS,entropy:YI,eq:vE,errorbarX:dA,errorbarY:pA,facetGrid:d2,facetLabel:p2,facetMargin:c2,facetMarginBottom:l2,facetMarginLeft:f2,facetMarginRight:h2,facetMarginTop:u2,first:VI,first_value:kE,float32:aE,float64:qe,frame:xA,frameGroups:qE,frameRange:zE,frameRows:UE,from:bC,fxAlign:v2,fxAriaDescription:P2,fxAriaLabel:B2,fxAxis:I2,fxDomain:y2,fxFontVariant:k2,fxGrid:O2,fxInset:g2,fxInsetLeft:b2,fxInsetRight:_2,fxLabel:L2,fxLabelAnchor:F2,fxLabelOffset:C2,fxLine:D2,fxPadding:x2,fxPaddingInner:S2,fxPaddingOuter:A2,fxRange:m2,fxReverse:U2,fxRound:w2,fxTickFormat:N2,fxTickPadding:$2,fxTickRotate:R2,fxTickSize:M2,fxTickSpacing:T2,fxTicks:E2,fyAlign:G2,fyAriaDescription:fx,fyAriaLabel:lx,fyAxis:J2,fyDomain:z2,fyFontVariant:ux,fyGrid:ix,fyInset:j2,fyInsetBottom:V2,fyInsetTop:Y2,fyLabel:ox,fyLabelAnchor:ax,fyLabelOffset:cx,fyLine:sx,fyPadding:X2,fyPaddingInner:H2,fyPaddingOuter:Q2,fyRange:q2,fyReverse:hx,fyRound:W2,fyTickFormat:nx,fyTickPadding:ex,fyTickRotate:rx,fyTickSize:Z2,fyTickSpacing:tx,fyTicks:K2,geo:RA,geojson:M0,geomean:WI,graticule:DA,grid:zw,gridFx:$A,gridFy:NA,gridX:MA,gridY:TA,gt:di,gte:xE,hconcat:lC,heatmap:aA,height:Ow,hexagon:jS,hexbin:lA,hexgrid:fA,highlight:CA,hours:fE,hspace:dC,hull:_A,image:eA,inset:Uw,int32:Ae,interval:zn,intervalX:kA,intervalXY:PA,intervalY:BA,isBetween:cr,isDistinct:SE,isNotBetween:AE,isNotDistinct:E0,isNotNull:cs,isNull:Of,kurtosis:GI,lag:CE,last:JI,last_value:BE,lead:Lf,lengthBase:fS,lengthClamp:aS,lengthConstant:dS,lengthDomain:sS,lengthExponent:hS,lengthNice:cS,lengthPercent:uS,lengthRange:oS,lengthScale:iS,lengthZero:lS,line:TS,lineX:$S,lineY:NS,link:vA,literal:hn,loadCSV:VE,loadExtension:N0,loadJSON:WE,loadObjects:HE,loadParquet:GE,loadSpatial:XE,lt:Oe,lte:pi,mad:XI,margin:Tw,marginBottom:Cw,marginLeft:Dw,marginRight:Lw,marginTop:Fw,margins:Mw,max:Nr,median:HI,menu:iC,microseconds:yE,milliseconds:pE,min:os,minutes:hE,mode:QI,months:uE,name:Iw,nearest:UA,nearestX:zA,nearestY:qA,neq:Xo,not:wE,nth_value:PE,ntile:FE,opacityBase:zx,opacityClamp:Lx,opacityConstant:jx,opacityDomain:Ox,opacityExponent:qx,opacityLabel:Cx,opacityLegend:n3,opacityNice:Fx,opacityPercent:kx,opacityRange:Dx,opacityReverse:Bx,opacityScale:Rx,opacityTickFormat:Ux,opacityZero:Px,or:hi,padding:jw,pan:XA,panX:HA,panY:QA,panZoom:JA,panZoomX:KA,panZoomY:ZA,percent_rank:DE,plot:xC,product:KI,projectionClip:AS,projectionDomain:bS,projectionInset:_S,projectionInsetBottom:SS,projectionInsetLeft:wS,projectionInsetRight:vS,projectionInsetTop:xS,projectionParallels:yS,projectionPrecision:mS,projectionRotate:gS,projectionType:pS,quantile:ZI,rBase:eS,rClamp:Qx,rConstant:rS,rDomain:Xx,rExponent:nS,rLabel:Kx,rNice:Jx,rPercent:Zx,rRange:Hx,rScale:Gx,rZero:tS,rank:RE,raster:cA,rasterTile:uA,rect:CS,rectX:kS,rectY:BS,region:jA,regressionY:hA,row_number:NE,ruleX:GS,ruleY:XS,search:sC,seconds:dE,skewness:nE,slider:oC,sphere:OA,spike:tA,sql:tn,stddev:S0,stddevPop:rE,stringAgg:iE,style:Nw,sum:ee,symbolDomain:Vx,symbolLegend:r3,symbolRange:Wx,symbolScale:Yx,table:aC,text:YS,textX:VS,textY:WS,tickX:HS,tickY:QS,toggle:Po,toggleColor:GA,toggleX:YA,toggleY:VA,toggleZ:WA,varPop:oE,variance:sE,vconcat:uC,vector:JS,vectorX:KS,vectorY:ZS,voronoi:yA,voronoiMesh:mA,vspace:hC,waffleX:LA,waffleY:FA,width:Rw,xAlign:ev,xAriaDescription:wv,xAriaLabel:_v,xAxis:sv,xBase:Av,xClamp:Zw,xConstant:Ev,xDomain:Gw,xExponent:Iv,xFontVariant:bv,xGrid:hv,xInset:Qw,xInsetLeft:Jw,xInsetRight:Kw,xLabel:pv,xLabelAnchor:yv,xLabelArrow:mv,xLabelOffset:gv,xLine:dv,xNice:Hw,xPadding:nv,xPaddingInner:rv,xPaddingOuter:iv,xPercent:vv,xRange:Xw,xReverse:xv,xRound:tv,xScale:Ww,xTickFormat:lv,xTickPadding:uv,xTickRotate:fv,xTickSize:av,xTickSpacing:cv,xTicks:ov,xZero:Sv,xyDomain:$w,yAlign:Cv,yAriaDescription:e2,yAriaLabel:t2,yAxis:Uv,yBase:s2,yClamp:Lv,yConstant:a2,yDomain:Tv,yExponent:o2,yFontVariant:Zv,yGrid:Gv,yInset:Rv,yInsetBottom:Dv,yInsetTop:Ov,yLabel:Hv,yLabelAnchor:Qv,yLabelArrow:Jv,yLabelOffset:Kv,yLine:Xv,yNice:Nv,yPadding:kv,yPaddingInner:Bv,yPaddingOuter:Pv,yPercent:n2,yRange:$v,yReverse:r2,yRound:Fv,yScale:Mv,yTickFormat:Vv,yTickPadding:Yv,yTickRotate:Wv,yTickSize:qv,yTickSpacing:jv,yTicks:zv,yZero:i2,years:cE},Symbol.toStringTag,{value:"Module"}));function SC({coordinator:e=ls(),namedPlots:t=new pC,extensions:n=null,...r}={}){return{...Fct,...n,context:{coordinator:e,namedPlots:t,...r}}}const Cct=Object.freeze(Object.defineProperty({__proto__:null,Coordinator:P0,DuckDBWASMConnector:Pm,Fixed:ya,MosaicClient:qo,Param:yi,Query:gt,RestConnector:z0,Selection:ro,SocketConnector:_f,align:kw,and:fi,area:IS,areaX:ES,areaY:MS,argmax:qc,argmin:jc,ariaDescription:Vw,ariaLabel:Yw,arrayAgg:UI,arrow:wA,aspectRatio:Bw,attributeDirectives:gC,avg:x0,axis:Pw,axisFx:IA,axisFy:EA,axisX:SA,axisY:AA,barX:RS,barY:OS,bin:tC,cast:Yc,cell:DS,cellX:LS,cellY:FS,centroid:Df,centroidX:EE,centroidY:ME,circle:qS,clip:qw,colorBase:Tx,colorClamp:mx,colorConstant:Nx,colorDomain:px,colorExponent:$x,colorInterpolate:wx,colorLabel:Sx,colorLegend:e3,colorN:gx,colorNice:bx,colorPercent:Ax,colorPivot:vx,colorRange:yx,colorReverse:Ix,colorScale:dx,colorScheme:_x,colorSymmetric:xx,colorTickFormat:Mx,colorZero:Ex,column:If,connect:Sw,contour:oA,coordinator:ls,corr:zI,count:ar,covarPop:jI,covariance:qI,createAPIContext:SC,createSchema:YE,createTable:Ho,cume_dist:LE,dateDay:bE,dateMonth:mE,dateMonthDay:gE,days:lE,delaunayLink:gA,delaunayMesh:bA,denseLine:sA,dense_rank:OE,density:iA,densityX:nA,densityY:rA,dot:PS,dotX:US,dotY:zS,entropy:YI,eq:vE,errorbarX:dA,errorbarY:pA,facetGrid:d2,facetLabel:p2,facetMargin:c2,facetMarginBottom:l2,facetMarginLeft:f2,facetMarginRight:h2,facetMarginTop:u2,first:VI,first_value:kE,float32:aE,float64:qe,frame:xA,frameGroups:qE,frameRange:zE,frameRows:UE,from:bC,fxAlign:v2,fxAriaDescription:P2,fxAriaLabel:B2,fxAxis:I2,fxDomain:y2,fxFontVariant:k2,fxGrid:O2,fxInset:g2,fxInsetLeft:b2,fxInsetRight:_2,fxLabel:L2,fxLabelAnchor:F2,fxLabelOffset:C2,fxLine:D2,fxPadding:x2,fxPaddingInner:S2,fxPaddingOuter:A2,fxRange:m2,fxReverse:U2,fxRound:w2,fxTickFormat:N2,fxTickPadding:$2,fxTickRotate:R2,fxTickSize:M2,fxTickSpacing:T2,fxTicks:E2,fyAlign:G2,fyAriaDescription:fx,fyAriaLabel:lx,fyAxis:J2,fyDomain:z2,fyFontVariant:ux,fyGrid:ix,fyInset:j2,fyInsetBottom:V2,fyInsetTop:Y2,fyLabel:ox,fyLabelAnchor:ax,fyLabelOffset:cx,fyLine:sx,fyPadding:X2,fyPaddingInner:H2,fyPaddingOuter:Q2,fyRange:q2,fyReverse:hx,fyRound:W2,fyTickFormat:nx,fyTickPadding:ex,fyTickRotate:rx,fyTickSize:Z2,fyTickSpacing:tx,fyTicks:K2,geo:RA,geojson:M0,geomean:WI,graticule:DA,grid:zw,gridFx:$A,gridFy:NA,gridX:MA,gridY:TA,gt:di,gte:xE,hconcat:lC,heatmap:aA,height:Ow,hexagon:jS,hexbin:lA,hexgrid:fA,highlight:CA,hours:fE,hspace:dC,hull:_A,image:eA,inset:Uw,int32:Ae,interactorDirectives:wC,interval:zn,intervalX:kA,intervalXY:PA,intervalY:BA,isBetween:cr,isDistinct:SE,isNotBetween:AE,isNotDistinct:E0,isNotNull:cs,isNull:Of,kurtosis:GI,lag:CE,last:JI,last_value:BE,lead:Lf,legendDirectives:vC,lengthBase:fS,lengthClamp:aS,lengthConstant:dS,lengthDomain:sS,lengthExponent:hS,lengthNice:cS,lengthPercent:uS,lengthRange:oS,lengthScale:iS,lengthZero:lS,line:TS,lineX:$S,lineY:NS,link:vA,literal:hn,loadCSV:VE,loadExtension:N0,loadJSON:WE,loadObjects:HE,loadParquet:GE,loadSpatial:XE,lt:Oe,lte:pi,mad:XI,margin:Tw,marginBottom:Cw,marginLeft:Dw,marginRight:Lw,marginTop:Fw,margins:Mw,markDirectives:_C,max:Nr,median:HI,menu:iC,microseconds:yE,milliseconds:pE,min:os,minutes:hE,mode:QI,months:uE,name:Iw,namedPlots:Aw,nearest:UA,nearestX:zA,nearestY:qA,neq:Xo,not:wE,nth_value:PE,ntile:FE,opacityBase:zx,opacityClamp:Lx,opacityConstant:jx,opacityDomain:Ox,opacityExponent:qx,opacityLabel:Cx,opacityLegend:n3,opacityNice:Fx,opacityPercent:kx,opacityRange:Dx,opacityReverse:Bx,opacityScale:Rx,opacityTickFormat:Ux,opacityZero:Px,or:hi,padding:jw,pan:XA,panX:HA,panY:QA,panZoom:JA,panZoomX:KA,panZoomY:ZA,percent_rank:DE,plot:xC,product:KI,projectionClip:AS,projectionDomain:bS,projectionInset:_S,projectionInsetBottom:SS,projectionInsetLeft:wS,projectionInsetRight:vS,projectionInsetTop:xS,projectionParallels:yS,projectionPrecision:mS,projectionRotate:gS,projectionType:pS,quantile:ZI,rBase:eS,rClamp:Qx,rConstant:rS,rDomain:Xx,rExponent:nS,rLabel:Kx,rNice:Jx,rPercent:Zx,rRange:Hx,rScale:Gx,rZero:tS,rank:RE,raster:cA,rasterTile:uA,rect:CS,rectX:kS,rectY:BS,region:jA,regressionY:hA,requestNamedPlot:yC,restConnector:dM,row_number:NE,ruleX:GS,ruleY:XS,search:sC,seconds:dE,skewness:nE,slider:oC,socketConnector:Q3,sphere:OA,spike:tA,sql:tn,stddev:S0,stddevPop:rE,stringAgg:iE,style:Nw,sum:ee,symbolDomain:Vx,symbolLegend:r3,symbolRange:Wx,symbolScale:Yx,table:aC,text:YS,textX:VS,textY:WS,tickX:HS,tickY:QS,toggle:Po,toggleColor:GA,toggleX:YA,toggleY:VA,toggleZ:WA,varPop:oE,variance:sE,vconcat:uC,vector:JS,vectorX:KS,vectorY:ZS,voronoi:yA,voronoiMesh:mA,vspace:hC,waffleX:LA,waffleY:FA,wasmConnector:YT,width:Rw,xAlign:ev,xAriaDescription:wv,xAriaLabel:_v,xAxis:sv,xBase:Av,xClamp:Zw,xConstant:Ev,xDomain:Gw,xExponent:Iv,xFontVariant:bv,xGrid:hv,xInset:Qw,xInsetLeft:Jw,xInsetRight:Kw,xLabel:pv,xLabelAnchor:yv,xLabelArrow:mv,xLabelOffset:gv,xLine:dv,xNice:Hw,xPadding:nv,xPaddingInner:rv,xPaddingOuter:iv,xPercent:vv,xRange:Xw,xReverse:xv,xRound:tv,xScale:Ww,xTickFormat:lv,xTickPadding:uv,xTickRotate:fv,xTickSize:av,xTickSpacing:cv,xTicks:ov,xZero:Sv,xyDomain:$w,yAlign:Cv,yAriaDescription:e2,yAriaLabel:t2,yAxis:Uv,yBase:s2,yClamp:Lv,yConstant:a2,yDomain:Tv,yExponent:o2,yFontVariant:Zv,yGrid:Gv,yInset:Rv,yInsetBottom:Dv,yInsetTop:Ov,yLabel:Hv,yLabelAnchor:Qv,yLabelArrow:Jv,yLabelOffset:Kv,yLine:Xv,yNice:Nv,yPadding:kv,yPaddingInner:Bv,yPaddingOuter:Pv,yPercent:n2,yRange:$v,yReverse:r2,yRound:Fv,yScale:Mv,yTickFormat:Vv,yTickPadding:Yv,yTickRotate:Wv,yTickSize:qv,yTickSpacing:jv,yTicks:zv,yZero:i2,years:cE},Symbol.toStringTag,{value:"Module"})),AC="spec",i3="literal",kct="dataref",IC="options",EC="selection",MC="paramref",TC="columnparamref",$C="param",NC="include",s3="select",Uy="value",RC="crossfilter",o3="intersect",OC="union",DC="single",LC="data",FC="expression",wc="sql",zy="input",Hl="hconcat",Ql="vconcat",Jl="hspace",Kl="vspace",a3="mark",c3="from",Zl="plot",qy="legend",CC="attribute",u3="transform",kC="windowframe",BC="interactor",tf="Fixed";function jy(e){const t=typeof e;return t==="object"?e?.param:t==="string"?Bct(e):null}function Bct(e){return e?.[0]==="$"?e.slice(1):null}function l3(e){return`$${e}`}function f3(e){return[e].flat()}function Hs(e){return Array.isArray(e)}function Yy(e){return e!==null&&typeof e=="object"&&!Hs(e)}function ef(e){return typeof e=="string"}function h3(e,t){throw Object.assign(Error(e),{data:t})}const Pct=/^(?:[-+]\d{2})?\d{4}(?:-\d{2}(?:-\d{2})?)?(?:T\d{2}:\d{2}(?::\d{2}(?:\.\d{3})?)?(?:Z|[-+]\d{2}:?\d{2})?)?$/;function Uct(e,t){return Pct.test(e+="")?new Date(e):t}class ie{constructor(t,n=null){this.type=t,this.children=n}instantiate(t){throw Error("instantiate not implemented")}codegen(t){return Error("codegen not implemented")}toJSON(){return Error("toJSON not implemented")}}function Er(e,t){const n={};for(const r in e)n[r]=t.maybeSelection(e[r]);return new vc(n)}class vc extends ie{constructor(t){super(IC),this.options=t}filter(t){const n=Object.fromEntries(Object.entries(this.options).filter(([r,i])=>t(r,i)));return new vc(n)}instantiate(t){const{options:n}=this,r={};for(const i in n)r[i]=n[i].instantiate(t);return r}codegen(t){const{options:n}=this,r=[];for(const i in n)r.push(`${i}: ${n[i].codegen(t)}`);return r.length?`{${t.maybeLineWrap(r)}}`:""}toJSON(){const{options:t}=this,n={};for(const r in t)n[r]=t[r].toJSON();return n}}const PC="table",UC="parquet",zC="csv",d3="json",p3="spatial",qC=new Map([[PC,Vct],[UC,Wct],[zC,Gct],[d3,Xct],[p3,Hct]]);function zct(e,t,n){const r=qct(t);if(qC.has(r.type))return qC.get(r.type)(e,r,n);n.error("Unrecognized data format type.",t)}function qct(e){return Hs(e)&&(e={type:"json",data:e}),ef(e)&&(e={type:"table",query:e}),{...e,type:jct(e)}}function jct(e){return e.type||Yct(e.file)||"table"}function Yct(e){const t=e?.lastIndexOf(".");return t>0?e.slice(t+1):null}function Vct(e,t,n){const{query:r,type:i,...s}=t;return new VC(e,r,Er(s,n))}function Wct(e,t,n){const{file:r,type:i,...s}=t;return new GC(e,r,Er(s,n))}function Gct(e,t,n){const{file:r,type:i,...s}=t;return new XC(e,r,Er(s,n))}function Xct(e,t,n){const{data:r,file:i,type:s,...o}=t,a=Er(o,n);return r?new QC(e,r,a):new HC(e,i,a)}function Hct(e,t,n){const{file:r,type:i,...s}=t;return new WC(e,r,Er(s,n))}function jC(e,t){return t?new URL(e,t).toString():e}function Qct(e,t){const n=e?.codegen(t);return n?`, ${n}`:""}class YC extends ie{constructor(t,n){super(LC),this.name=t,this.format=n}}class Vy extends YC{constructor(t,n){super(t,n)}instantiateQuery(t){t.error("instantiateQuery not implemented")}codegenQuery(t){t.error("codegenQuery not implemented")}instantiate(t){const n=this.instantiateQuery(t);if(n)return n}codegen(t){const n=this.codegenQuery(t);if(n)return n}}class VC extends Vy{constructor(t,n,r){super(t,PC),this.query=n?.trim(),this.options=r}instantiateQuery(t){const{name:n,query:r,options:i}=this;if(r)return t.api.createTable(n,r,i.instantiate(t))}codegenQuery(t){const{name:n,query:r,options:i}=this;if(r)return`\`${Ho(n,r,i.instantiate(t))}\``}toJSON(){const{format:t,query:n,options:r}=this;return{type:t,query:n,...r.toJSON()}}}class nf extends Vy{constructor(t,n,r,i,s){super(t,n),this.file=i,this.method=r,this.options=s}instantiateQuery(t){const{name:n,method:r,file:i,options:s}=this,o=jC(i,t.baseURL),a=s?.instantiate(t);return t.api[r](n,o,a)}codegenQuery(t){const{name:n,method:r,file:i,options:s}=this,o=jC(i,t.baseURL),a=Qct(s,t);return`${t.ns()}${r}("${n}", "${o}"${a})`}toJSON(){const{format:t,file:n,options:r}=this;return{type:t,file:n,...r.toJSON()}}}class WC extends nf{constructor(t,n,r){super(t,p3,"loadSpatial",n,r)}}class GC extends nf{constructor(t,n,r){super(t,UC,"loadParquet",n,r)}}class XC extends nf{constructor(t,n,r){super(t,zC,"loadCSV",n,r)}}class HC extends nf{constructor(t,n,r){super(t,d3,"loadJSON",n,r)}}class QC extends Vy{constructor(t,n,r){super(t,d3),this.data=n,this.options=r}instantiateQuery(t){const{name:n,data:r,options:i}=this;return t.api.loadObjects(n,r,i.instantiate(t))}codegenQuery(t){const{name:n,data:r,options:i}=this,s=i?","+i.codegen(t):"",o=`[
    `+r.map(a=>JSON.stringify(a)).join(`,
    `)+`
  ]`;return`${t.ns()}loadObjects("${n}", ${o}${s})`}toJSON(){const{format:t,data:n,options:r}=this;return{type:t,data:n,...r.toJSON()}}}function JC(e){const t=e.config?.extensions,n=new Set(t?f3(t):[]);for(const r of Object.values(e.data))r.format===p3&&n.add("spatial");return n}async function Jct(e,t){const{data:n,params:r,plotDefaults:i}=e,s=new KC({plotDefaults:i,...t}),o=[],a=JC(e);o.push(...Array.from(a).map(c=>N0(c)));for(const c of Object.values(n)){const u=c.instantiate(s);u&&o.push(u)}o.length>0&&await s.coordinator.exec(o);for(const[c,u]of Object.entries(r))if(!s.activeParams.has(c)){const l=u.instantiate(s);s.activeParams.set(c,l)}return{element:e.root.instantiate(s),params:s.activeParams}}class KC{constructor({api:t=SC(),plotDefaults:n=[],params:r=new Map,baseURL:i=null}={}){this.api=t,this.plotDefaults=n,this.activeParams=r,this.baseURL=i,this.coordinator=t.context.coordinator}error(t,n){h3(t,n)}}function Kct(e,t={}){const{root:n,data:r,params:i,plotDefaults:s}=e,{preamble:o,...a}=t,c=new ZC({plotDefaults:s,...a}),u=[];for(const[b,w]of c.imports)u.push(ef(w)?`import ${w} from "${b}";`:`import { ${w.join(", ")} } from "${b}";`);const l=o?f3(o).map(b=>`${c.tab()}${b}`):[],h=[];if(c.connector){const b=`${c.ns()}${c.connector}Connector()`;h.push(`${c.tab()}${c.ns()}coordinator().databaseConnector(${b});`)}const f=[];for(const b of JC(e))f.push(`${c.ns()}loadExtension("${b}")`);for(const b of Object.values(r)){const w=b.codegen(c);w&&f.push(w)}const d=[];f.length&&(d.push(`${c.tab()}await ${c.ns()}coordinator().exec([`),c.indent(),d.push(f.map(b=>`${c.tab()}${b}`).join(`,
`)),c.undent(),d.push(`${c.tab()}]);`));const p=[];for(const[b,w]of Object.entries(i))p.push(`const ${l3(b)} = ${w.codegen(c)};`);let y=[];const g=s;g.length&&(y=["const defaultAttributes = [",g.map(b=>"  "+b.codegen(c)).join(`,
`),"];"]);const m=[`export default ${n.codegen(c)};`];return[...u,...xc(u),...l,...xc(l),...h,...xc(h),...d,...xc(d),...p,...xc(p),...y,...xc(y),...m].join(`
`)}class ZC{constructor({plotDefaults:t=void 0,namespace:n="vg",connector:r=void 0,imports:i=new Map([["@uwdata/vgplot","* as vg"]]),baseURL:s=void 0,depth:o=0}={}){this.plotDefaults=t,this.namespace=`${n}.`,this.connector=r,this.imports=i,this.baseURL=s,this.depth=o}addImport(t,n){this.imports.has(t)?this.imports.get(t).push(n):this.imports.set(t,[n])}setImports(t,n){this.imports.set(t,n)}ns(){return this.namespace}indent(){this.depth+=1}undent(){this.depth-=1}tab(){return Array.from({length:this.depth},()=>"  ").join("")}stringify(t){if(Hs(t)){const n=t.map(r=>this.stringify(r));return`[${this.maybeLineWrap(n)}]`}else if(Yy(t)){const n=Object.entries(t).map(([r,i])=>`${Zct(r)}: ${this.stringify(i)}`);return`{${this.maybeLineWrap(n)}}`}else return JSON.stringify(t)}maybeLineWrap(t){const n=80-2*this.depth;if(2*t.length+t.reduce((i,s)=>i+s.length,0)>n){this.indent();const i=t.map(s=>`
${this.tab()}${s}`).join(",");return this.undent(),i+`
`+this.tab()}else return t.join(", ")}error(t,n){h3(t,n)}}function Zct(e){return/^[A-Za-z_$]\w*/.test(e)?e:JSON.stringify(e)}function xc(e){return e?.length?[""]:[]}class Wy extends ie{constructor(t){super(i3),this.value=t}instantiate(){return this.value}codegen(t){return t.stringify(this.value)}toJSON(){return this.value}}function tut(e,t){const{select:n,include:r,...i}=e,s=Er(i,t);return r&&(s.options.include=new eut(f3(r).map(o=>t.selectionRef(jy(o))))),new Gy(n,s)}class Gy extends ie{constructor(t=o3,n=new vc({})){super(EC),this.select=t,this.options=n}instantiate(t){const{select:n,options:r}=this;return t.api.Selection[n](r.instantiate(t))}codegen(t){const{select:n,options:r}=this;return`${t.ns()}Selection.${n}(${r.codegen(t)})`}toJSON(){const{select:t,options:n}=this;return{select:t,...n.toJSON()}}}class eut extends ie{constructor(t){super(NC),this.refs=t}instantiate(t){return this.refs.map(n=>n.instantiate(t))}codegen(t){return`[${this.refs.map(n=>n.codegen(t)).join(", ")}]`}toJSON(){return this.refs.map(t=>t.toJSON())}}const nut=new Set([Uy,DC,RC,o3,OC]);function rut(e,t){const n=Yy(e)?e:{value:e},{select:r=Uy,value:i,date:s}=n;return nut.has(r)||t.error(`Unrecognized param type: ${r}`,n),r!==Uy?tut(e,t):Hs(i)?new Xy(i.map(o=>t.maybeParam(o))):new Xy(i,s)}class Xy extends ie{constructor(t,n){super($C),this.value=t,this.date=n}instantiate(t){const{date:n,value:r}=this,{Param:i}=t.api;return Hs(r)?i.array(r.map(s=>s.instantiate(t))):i.value(Uct(n,r))}codegen(t){const{value:n,date:r}=this,i=`${t.ns()}Param.`;return Hs(n)?`${i}array([${n.map(s=>s.codegen(t)).join(", ")}])`:r?`${i}value(new Date(${JSON.stringify(r)}))`:`${i}value(${JSON.stringify(n)})`}toJSON(){const{date:t,value:n}=this;return Hs(n)?n.map(r=>r.toJSON()):t?{date:t}:n}}class tk extends ie{constructor(t){super(MC),this.name=t}instantiate(t){return t.activeParams?.get(this.name)}codegen(t){return l3(this.name)}toJSON(){return l3(this.name)}}function ek(e,t,n){return n.plot?.attributes?.has(e)||n.error(`Unrecognized attribute: ${e}`),new nk(e,t===tf?new rk:n.maybeParam(t))}class nk extends ie{constructor(t,n){super(CC),this.name=t,this.value=n}instantiate(t){const{name:n,value:r}=this;return t.api[n](r.instantiate(t))}codegen(t){const{name:n,value:r}=this;return`${t.tab()}${t.ns()}${n}(${r.codegen(t)})`}toJSON(){const{name:t,value:n}=this;return{[t]:n.toJSON()}}}class rk extends ie{constructor(){super(i3),this.value=tf}instantiate(t){return t.api[tf]}codegen(t){return`${t.ns()}${tf}`}toJSON(){return this.value}}class ik extends ie{constructor(t,n,r,i,s,o){super(AC,[t]),this.root=t,this.meta=n,this.config=r,this.data=i,this.params=s,this.plotDefaults=o}toJSON(){const{root:t,meta:n,config:r,plotDefaults:i}=this,s=new Map(Object.entries(this.data)),o=new Map(Object.entries(this.params)),a={};if(n&&(a.meta={...n}),r&&(a.config={...r}),s?.size){const c=a.data={};for(const[u,l]of s)c[u]=l.toJSON()}if(o?.size){const c=a.params={};for(const[u,l]of o)c[u]=l.toJSON()}if(i?.length){const c=a.plotDefaults={};for(const u of i)Object.assign(c,u.toJSON())}return Object.assign(a,t.toJSON())}}function iut(e,t){const n=e[Hl].map(r=>t.parseComponent(r));return new sk(n)}class sk extends ie{constructor(t){super(Hl,t)}instantiate(t){return t.api[Hl](this.children.map(n=>n.instantiate(t)))}codegen(t){t.indent();const n=this.children.map(r=>r.codegen(t));return t.undent(),`${t.tab()}${t.ns()}${this.type}(
${n.join(`,
`)}
${t.tab()})`}toJSON(){return{[this.type]:this.children.map(t=>t.toJSON())}}}function sut(e){return new ok(e[Jl])}class ok extends ie{constructor(t){super(Jl),this.value=t}instantiate(t){return t.api[Jl](this.value)}codegen(t){return`${t.tab()}${t.ns()}${this.type}(${t.stringify(this.value)})`}toJSON(){return{[this.type]:this.value}}}function out(e,t){const{[zy]:n,...r}=e;return t.inputs?.has(n)||t.error(`Unrecognized input type: ${n}`,e),new ak(n,Er(r,t))}class ak extends ie{constructor(t,n){super(zy),this.name=t,this.options=n}instantiate(t){return t.api[this.name](this.options.instantiate(t))}codegen(t){const n=this.options.codegen(t);return`${t.tab()}${t.ns()}${this.name}(${n})`}toJSON(){const{type:t,name:n,options:r}=this;return{[t]:n,...r.toJSON()}}}function ck(e,t){const{[qy]:n,...r}=e,i=`${n}Legend`;return t.plot?.legends?.has(i)||t.error(`Unrecognized legend type: ${n}`,e),new uk(i,n,Er(r,t))}class uk extends ie{constructor(t,n,r){super(qy),this.key=t,this.name=n,this.options=r}instantiate(t){return t.api[this.key](this.options.instantiate(t))}codegen(t){const n=this.options.codegen(t);return`${t.tab()}${t.ns()}${this.key}(${n})`}toJSON(){const{type:t,name:n,options:r}=this;return{[t]:n,...r.toJSON()}}}function aut(e,t){const{[s3]:n,...r}=e;return t.plot?.interactors?.has(n)||t.error(`Unrecognized interactor type: ${n}`,e),new lk(n,Er(r,t))}class lk extends ie{constructor(t,n){super(BC),this.name=t,this.options=n}instantiate(t){return t.api[this.name](this.options.instantiate(t))}codegen(t){const n=this.options.codegen(t);return`${t.tab()}${t.ns()}${this.name}(${n})`}toJSON(){const{name:t,options:n}=this;return{[s3]:t,...n.toJSON()}}}class cut extends ie{constructor(t){super(TC),this.param=t}instantiate(t){return t.api.column(this.param.instantiate(t))}codegen(t){return`${t.ns()}column(${this.param.codegen(t)})`}toJSON(){return`$${this.param.toJSON}`}}const uut=/(\\'|\\"|"(?:\\"|[^"])*"|'(?:\\'|[^'])*'|\${1,2}\w+)/g;function lut(e,t){const n=e[wc],r=n.split(uut),i=[""],s=[];for(let o=0,a=0;o<r.length;++o){const c=r[o];c.startsWith("$")?(s[a]=c.startsWith("$$")?new cut(t.paramRef(c.slice(2))):t.maybeParam(c),i[++a]=""):i[a]+=c}return new fk(n,i,s)}class fk extends ie{constructor(t,n,r){super(FC),this.value=t,this.spans=n,this.params=r}instantiate(t){const{spans:n,params:r}=this,i=t.api[wc],s=r.map(o=>o.instantiate(t));return i(n,...s)}codegen(t){const{spans:n,params:r}=this;let i="";const s=r.length;for(let o=0;o<s;++o)i+=n[o]+"${"+r[o].codegen(t)+"}";return i+=n[s],`${t.ns()}${wc}\`${i}\``}toJSON(){return{[wc]:this.value}}}function fut(e,t){if(!e)return null;if(Hs(e))return new Wy(e);const{from:n,...r}=e;return new hk(t.maybeParam(n),Er(r,t))}class hk extends ie{constructor(t,n){super(c3),this.table=t,this.options=n}instantiate(t){const{table:n,options:r}=this;return t.api[c3](n.instantiate(t),r.instantiate(t))}codegen(t){const n=this.table.codegen(t),r=this.options.codegen(t);return`${t.ns()}${this.type}(${n}${r?", "+r:""})`}toJSON(){const{type:t,table:n,options:r}=this;return{[t]:n.toJSON(),...r.toJSON()}}}function hut(e,t){const n=e.rows?"ROWS":e.range?"RANGE":e.groups?"GROUPS":null;if(!n)return null;const r=e[n.toLowerCase()],i=jy(r),s=i?t.paramRef(i):r.map(o=>Yy(o)?dk(o,t):new y0(o));return new dut(n,s,e.exclude)}class dut extends ie{constructor(t,n,r){super(kC),this.type=t,this.extent=n,this.exclude=r?.toUpperCase()}instantiate(t){const{type:n,extent:r,exclude:i}=this,s=Array.isArray(r)?r.map(o=>o.instantiate(t)):r.instantiate(t);return new Nf(n,s,i?.toUpperCase())}codegen(t){const{type:n,extent:r,exclude:i}=this,s=`frame${n[0].toUpperCase()}${n.slice(1).toLowerCase()}`,o=Array.isArray(r)?`[${r.map(c=>c.codegen(t)).join(", ")}]`:r.codegen(t),a=i?`, '${i.toUpperCase()}'`:"";return`${t.ns()}${s}(${o}${a})`}toJSON(){const{type:t,extent:n,exclude:r}=this,i=t.toLowerCase(),s=Array.isArray(n)?n.map(o=>o.toJSON()):n.toJSON();return{[i]:s,exclude:r}}}function Hy(e,t){return e==null?[]:[e].flat().map(n=>t.maybeParam(n))}function dk(e,t){let n;for(const r in e)t.transforms.has(r)&&(n=r);if(n)if(n==="bin"){const{bin:r,...i}=e,[s]=Hy(r,t);return new put(n,s,Er(i,t))}else{const r=n==="count"&&!e[n]?[]:Hy(e[n],t),i={distinct:e.distinct,orderby:Hy(e.orderby,t),partitionby:Hy(e.partitionby,t),frame:hut(e,t)};return new pk(n,r,i)}}class pk extends ie{constructor(t,n,r){super(u3),this.name=t,this.args=n,this.options=r}instantiate(t){const{name:n,args:r,options:i}=this,{distinct:s,orderby:o,partitionby:a,frame:c}=i;let u=t.api[n](...r.map(l=>l.instantiate(t)));return s&&(u=u.distinct()),o.length&&(u=u.orderby(o.map(l=>l.instantiate(t)))),a.length&&(u=u.partitionby(a.map(l=>l.instantiate(t)))),c&&(u=u.frame(c.instantiate(t))),u}codegen(t){const{name:n,args:r,options:i}=this,{distinct:s,orderby:o,partitionby:a,frame:c}=i;let u=`${t.ns()}${n}(`+r.map(l=>l.codegen(t)).join(", ")+")";if(s&&(u+=".distinct()"),o.length){const l=o.map(h=>h.codegen(t));u+=`.orderby(${l.join(", ")})`}if(a.length){const l=a.map(h=>h.codegen(t));u+=`.partitionby(${l.join(", ")})`}return c&&(u+=`.frame(${c.codegen(t)})`),u}toJSON(){const{name:t,args:n,options:r}=this,{distinct:i,orderby:s,partitionby:o,frame:a}=r,c={[t]:y3(n.map(u=>u.toJSON()))};return i&&(c.distinct=!0),s.length&&(c.orderby=y3(s.map(u=>u.toJSON()))),o.length&&(c.partitionby=y3(o.map(u=>u.toJSON()))),a&&Object.assign(c,a.toJSON()),c}}class put extends ie{constructor(t,n,r){super(u3),this.name=t,this.arg=n,this.options=r}instantiate(t){const{name:n,arg:r,options:i}=this;return t.api[n](r.instantiate(t),i.instantiate(t))}codegen(t){const{name:n,arg:r,options:i}=this,s=i.codegen(t);return`${t.ns()}${n}(`+r.codegen(t)+(s?`, ${s}`:"")+")"}toJSON(){const{name:t,arg:n,options:r}=this;return{[t]:n.toJSON(),...r.toJSON()}}}function y3(e){return e.length===0?"":e.length===1?e[0]:e}function yut(e,t){if(Yy(e))return e[wc]?lut(e,t):dk(e,t)}function mut(e,t){const{mark:n,data:r,...i}=e;t.plot?.marks?.has(n)||t.error(`Unrecognized mark type: ${n}`,e);const s=fut(r,t),o={};for(const a in i){const c=i[a];o[a]=yut(c,t)||t.maybeParam(c)}return new yk(n,s,new vc(o))}class yk extends ie{constructor(t,n,r){super(a3),this.name=t,this.data=n,this.options=r}instantiate(t){const{name:n,data:r,options:i}=this,s=i.instantiate(t);return r?t.api[n](r.instantiate(t),s):t.api[n](s)}codegen(t){const{name:n,data:r,options:i}=this,s=r?r.codegen(t):"",o=i.codegen(t);let a;if(s&&o){t.indent();const c=i.codegen(t);a=`
${t.tab()}${s},
${t.tab()}${c}
`,t.undent(),a+=t.tab()}else a=`${s}${o}`;return`${t.tab()}${t.ns()}${n}(${a})`}toJSON(){const{type:t,name:n,data:r,options:i}=this;return{[t]:n,...r?{data:r.toJSON()}:{},...i.toJSON()}}}function gut(e,t){return mk({plot:[e]},t)}function mk(e,t){const{[Zl]:n,...r}=e,i=Object.entries(r).map(([o,a])=>ek(o,a,t)),s=n.map(o=>ef(o.mark)?mut(o,t):ef(o.legend)?ck(o,t):ef(o.select)?aut(o,t):t.error("Invalid plot entry.",o));return new gk(s,i)}class gk extends ie{constructor(t,n){super(Zl,t),this.attributes=n}instantiate(t){const n=[...t.plotDefaults||[],...this.attributes||[]];return t.api[Zl](this.children.map(r=>r.instantiate(t)),n.map(r=>r.instantiate(t)))}codegen(t){const{type:n,children:r,attributes:i}=this;t.indent();const s=[...r.map(o=>o.codegen(t)),...t.plotDefaults?.length?[`${t.tab()}...defaultAttributes`]:[],...i.map(o=>o.codegen(t))].join(`,
`);return t.undent(),`${t.tab()}${t.ns()}${n}(
${s}
${t.tab()})`}toJSON(){const{type:t,children:n,attributes:r}=this,i={[t]:n.map(s=>s.toJSON())};for(const s of r)Object.assign(i,s.toJSON());return i}}function but(e,t){const n=e[Ql].map(r=>t.parseComponent(r));return new bk(n)}class bk extends ie{constructor(t){super(Ql,t)}instantiate(t){return t.api[Ql](this.children.map(n=>n.instantiate(t)))}codegen(t){t.indent();const n=this.children.map(r=>r.codegen(t));return t.undent(),`${t.tab()}${t.ns()}${this.type}(
${n.join(`,
`)}
${t.tab()})`}toJSON(){return{[this.type]:this.children.map(t=>t.toJSON())}}}function _ut(e){return new _k(e[Kl])}class _k extends ie{constructor(t){super(Kl),this.value=t}instantiate(t){return t.api[Kl](this.value)}codegen(t){return`${t.tab()}${t.ns()}${this.type}(${t.stringify(this.value)})`}toJSON(){return{[this.type]:this.value}}}function wut(e=[]){return new Map([[Zl,mk],[a3,gut],[qy,ck],[zy,out],[Hl,iut],[Ql,but],[Jl,sut],[Kl,_ut],...e])}function vut(e=[]){return new Set(["menu","search","slider","table",...e])}function xut({attributes:e=Sut(),interactors:t=Aut(),legends:n=Iut(),marks:r=Eut()}={}){return{attributes:e,interactors:t,legends:n,marks:r}}function Sut(e=[]){return new Set([...Object.keys(gC),...e])}function Aut(e=[]){return new Set([...Object.keys(wC),...e])}function Iut(e=[]){return new Set([...Object.keys(vC),...e])}function Eut(e=[]){return new Set([...Object.keys(_C),...e])}function Mut(e=[]){return new Set(["argmin","argmax","avg","bin","centroid","centroidX","centroidY","column","count","covariance","covarPop","dateMonth","dateMonthDay","dateDay","first","geomean","geojson","last","max","median","min","mode","product","quantile","stddev","stddevPop","sum","variance","varPop","row_number","rank","dense_rank","percent_rank","cume_dist","ntile","lag","lead","first_value","last_value","nth_value","years","months","days","hours","minutes","seconds","milliseconds","microseconds",...e])}function Tut(e,t){return new $ut(t).parse(e)}class $ut{constructor({components:t=wut(),transforms:n=Mut(),inputs:r=vut(),plot:i=xut(),params:s=[],datasets:o=[]}={}){this.components=t,this.transforms=n,this.inputs=r,this.plot=i,this.params=new Map(s),this.datasets=new Map(o)}parse(t){const{meta:n,config:r,data:i={},params:s,plotDefaults:o={},...a}=t;for(const c in i)this.datasets.set(c,zct(c,i[c],this));this.plotDefaults=Object.entries(o).map(([c,u])=>ek(c,u,this));for(const c in s)this.params.set(c,rut(s[c],this));return new ik(this.parseComponent(a),n?{...n}:void 0,r?{...r}:void 0,Object.fromEntries(this.datasets),Object.fromEntries(this.params),this.plotDefaults)}parseComponent(t){for(const[n,r]of this.components)if(t[n]!=null)return r(t,this);this.error("Invalid specification.",t)}maybeParam(t){const n=jy(t);return n?this.paramRef(n):new Wy(t)}maybeSelection(t){const n=jy(t);return n?this.selectionRef(n):new Wy(t)}paramRef(t,n=()=>new Xy){const{params:r}=this;if(!t)return null;let i=r.get(t);return i||(i=n(),r.set(t,i)),new tk(t)}selectionRef(t,n=!1){const r=this.params.get(t);return n&&r&&!(r instanceof Gy)?null:this.paramRef(t,()=>new Gy)}error(t,n){h3(t,n)}}const Nut=Object.freeze(Object.defineProperty({__proto__:null,ASTNode:ie,ATTRIBUTE:CC,COLUMPARAMREF:TC,CROSSFILTER:RC,CSVDataNode:XC,CodegenContext:ZC,DATA:LC,DATAREF:kct,DataNode:YC,EXPRESSION:FC,ExpressionNode:fk,FIXED:tf,FROM:c3,FileDataNode:nf,HCONCAT:Hl,HConcatNode:sk,HSPACE:Jl,HSpaceNode:ok,INCLUDE:NC,INPUT:zy,INTERACTOR:BC,INTERSECT:o3,InputNode:ak,InstantiateContext:KC,JSONDataNode:HC,LEGEND:qy,LITERAL:i3,LiteralJSONDataNode:QC,LiteralNode:Wy,MARK:a3,OPTIONS:IC,OptionsNode:vc,PARAM:$C,PARAMREF:MC,PLOT:Zl,ParamNode:Xy,ParamRefNode:tk,ParquetDataNode:GC,PlotAttributeNode:nk,PlotFixedNode:rk,PlotFromNode:hk,PlotInteractorNode:lk,PlotLegendNode:uk,PlotMarkNode:yk,PlotNode:gk,QueryDataNode:Vy,SELECT:s3,SELECTION:EC,SINGLE:DC,SPEC:AC,SQL:wc,SelectionNode:Gy,SpatialDataNode:WC,SpecNode:ik,TRANSFORM:u3,TableDataNode:VC,TransformNode:pk,UNION:OC,VALUE:Uy,VCONCAT:Ql,VConcatNode:bk,VSPACE:Kl,VSpaceNode:_k,WINDOW_FRAME:kC,astToDOM:Jct,astToESM:Kct,parseSpec:Tut},Symbol.toStringTag,{value:"Module"}));return Nc.mosaicCore=cY,Nc.mosaicSpec=Nut,Nc.vg=Cct,Object.defineProperty(Nc,Symbol.toStringTag,{value:"Module"}),Nc})({});
//# sourceMappingURL=lib.js.map
